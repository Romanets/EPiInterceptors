//>>built
define("epi/packaging/PackagesGrid",["dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/_base/lang","dojo/dom-construct","dojo/on","dojox/widget/Standby","dgrid/Keyboard","dgrid/OnDemandGrid","dgrid/Selection","epi","epi/datetime","epi/shell/widget/dialog/Confirmation","epi/shell/widget/dialog/Dialog","epi/packaging/ModulesList","epi/packaging/DetailedView","epi/packaging/ModuleSummary","epi/i18n!epi/packaging/nls/EPiServer.Packaging.UI.PackagesGrid","epi/i18n!epi/packaging/nls/EPiServer.Packaging.UI.ModuleSummary"],function(_1,_2,_3,_4,_5,on,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12){return _2("epi.packaging.PackagesGrid",[_e],{templateString:"<div></div>",_createStandbyWidget:function(){return new _6({target:this.domNode});},buildRendering:function(){this.inherited(arguments);var _13={titleWithVersion:{className:"epi-packaging-name",label:_a.resources.header.name,renderCell:_4.hitch(this,function(_14,_15,_16){if(_15){var _17=_5.create("a",{"class":"epi-packaging-namelink",href:"#details",innerHTML:_15});on(_17,"click",_4.hitch(this,function(evt){_3.stop(evt);this._openDetails(_14);}));_5.place(_17,_16);}})},description:{className:"epi-packaging-description",label:_a.resources.header.description},tags:{className:"epi-packaging-tags",label:_11.tags,renderCell:function(_18,_19,_1a){_1.forEach(_19,function(tag){_5.create("span",{"class":"epi-valueItem",innerHTML:tag},_1a);});}},installDate:{className:"epi-packaging-installedDate",label:_11.installdate,formatter:function(_1b){return _b.toUserFriendlyString(_1b);}},installedBy:{className:"epi-packaging-installedBy",label:_11.installby},_item:{className:"epi-packaging-indicators",label:" ",sortable:false,renderCell:function(_1c,_1d,_1e){if(_1c.isSystem){_5.create("span",{"class":"epi-packaging-systemIndicator",innerHTML:_11.systemlabel},_1e);}if(_1c.isUpdateAvailable){_5.create("a",{"class":"epi-packaging-updateslink",href:"#updates",innerHTML:_11.updatelink},_1e);}}}};this.grid=new (_2([_8,_9,_7]))({columns:_13,selectionMode:"single",sort:[{attribute:"titleWithVersion",descending:false}],store:this._dataStore},this.domNode);},_buildModuleList:function(){this._renderModules(this._dataStore);},_renderModules:function(_1f){this._listItems=[];_1.forEach(_1f.data,function(_20){var _21={module:_20,antiForgeryData:this.antiForgeryData,_moduleStandby:this._standbyWigdet,_setButtonVisibility:function(){}};_20.moduleSummary=new _10(_21,null);this._connectModuleSummaryEvents(_20.moduleSummary);},this);this.grid.set("store",_1f);},_openDetails:function(_22){var _23=this;var _24=new _d({content:new _f({currentPackage:_22,installHandler:_4.hitch(_24,function(){_23._showConfirmationDialog(_22,_12.installconfirmation,_4.hitch(_24,function(_25){if(_25){this.hide();_22.moduleSummary._installModule();}}));}),updateHandler:_4.hitch(_24,function(){_23._showConfirmationDialog(_22,_12.updateconfirmation,_4.hitch(_24,function(_26){if(_26){this.hide();_22.moduleSummary._updateModule();}}));}),unInstallHandler:_4.hitch(_24,function(){_23._showConfirmationDialog(_22,_12.uninstallconfirmation,_4.hitch(_24,function(_27){if(_27){this.hide();_22.moduleSummary._uninstallModule();}}));}),closeHandler:_4.hitch(_24,function(){_24.hide();})}),title:_22.title,destroyOnHide:true,defaultActionsVisible:false});_24.show();},_showConfirmationDialog:function(_28,_29,_2a){var _2b=new _c({description:_4.replace(_29,{name:_28.title,version:_28.version}),title:_12.confirmationdialogtitle,onAction:_2a});_2b.show();}});});