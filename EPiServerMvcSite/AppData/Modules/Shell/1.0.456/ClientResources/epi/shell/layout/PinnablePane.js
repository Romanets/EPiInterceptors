//>>built
require({cache:{"url:epi/shell/layout/templates/PinnablePane.html":"<div class=\"epi-pinnableDock\">\r\n    <div class=\"epi-pinnableFacade\">\r\n        <div class=\"epi-pinnablePane\" data-dojo-attach-point=\"pinnableNode\">\r\n            <div data-dojo-attach-point=\"toolbarNode\"></div>\r\n            <div class=\"epi-pinnableContentWrapper\">\r\n                <div class=\"epi-pinnableContent\" data-dojo-attach-point=\"containerNode\"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n"}});define("epi/shell/layout/PinnablePane",["dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/_base/lang","dojo/_base/window","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/text!./templates/PinnablePane.html","dijit/_Contained","dijit/_Container","dijit/_TemplatedMixin","dijit/layout/ContentPane","epi/dependency","epi/i18n!epi/shell/ui/nls/episerver.shell.ui.resources","epi/shell/layout/PinnablePaneSplitter","epi/shell/widget/_ActionConsumerWidget","epi/shell/widget/_ActionProvider","epi/shell/widget/Toolbar"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13){return _2("epi.shell.layout.PinnablePane",[_d,_c,_a,_b,_11],{pinned:false,visible:false,templateString:_9,baseClass:"epi-pinnable",postMixInProperties:function(){var _14=_e.resolve("epi.shell.Profile"),_15=_14.get(this.id,true);this.inherited(arguments);if(_15){this.pinned=_15.pinned;this.visible=_15.visible;this.size=_15.size;}this._profile=_14;},buildRendering:function(){this.inherited(arguments);this.set("definitionConsumer",new _13({baseClass:"epi-pinnableToolbar"},this.toolbarNode));_8.set(this.containerNode,"width",(this.size||this.minSize)+"px");if(!this.pinned){this.set("pinned",this.pinned);}if(!this.visible){this.set("visible",this.visible);}},postCreate:function(){var _16="",ltr=this.isLeftToRight(),_17=function(){if(this.visible){this._dragging=true;}},_18=function(){this._dragging=false;};this.inherited(arguments);if(this.region){switch(this.region){case "trailing":case "right":_16=ltr?"right":"left";break;case "leading":case "left":_16=ltr?"left":"right";break;case "top":_16="top";break;case "bottom":_16="bottom";break;}_6.add(this.domNode,this.baseClass+"-"+_16);}this.subscribe("/epi/layout/pinnable/"+this.id+"/toggle",function(_19){if(typeof _19!=="boolean"){_19=!this.visible;}this.set("visible",_19);});this.subscribe("/dnd/start",_17);this.subscribe("/dnd/drop",_18);this.subscribe("/dnd/cancel",_18);},startup:function(){var _1a=this._splitterWidget;if(this._started){return;}_1.forEach(this.getChildren(),function(_1b){if(_1b.isInstanceOf(_12)){this.addProvider(_1b);}},this);this.inherited(arguments);this._container=this.getParent();if(this.splitter&&_1a){_1a=_10(_1a);if(!this.pinned){_1a.hide();}this.connect(_1a,"_stopDrag",this.persist);}this._refreshState();},resize:function(_1c){var pos=this.region,_1d=this.visible&&this.pinned,_1e=_7.getMarginBox(this.domNode),_1f=_7.getMarginBox(this.containerNode),_20={},_21={t:_1e.t},_22=pos=="left"||pos=="leading",_23=pos=="right"||pos=="trailing";if(!this._toolbarHeight){this._toolbarHeight=_7.getMarginBox(this.definitionConsumer.domNode).h;}_7.setMarginBox(this.domNode,{w:_1d?_1f.w:0});if(_1c){if(_1c.w){_20.w=_1f.w=_1c.w;if(!this.pinned){delete _1c.w;}}if(_1c.h){_1e.h=_1c.h;}}var _24=this._computeMaxSize();if(this._visibilityChanged&&_24<_1f.w){_20.w=_1f.w=_24;}_20.h=_1e.h-this._toolbarHeight;_7.setMarginBox(this.containerNode,_20);if(_22){_21.l=_1e.l;}else{if(_23){_21.l=_1d?0:0-_1f.w;}}_7.setMarginBox(this.pinnableNode,_21);if(this._splitterWidget){var _25=_7.getMarginBox(this._splitterWidget.domNode),_26={t:_1e.t};if(_22){_26.l=_1f.w;}else{if(_23){_26.l=_1d?_1e.l-_25.w:_1e.l-_1f.w;}}_7.setMarginBox(this._splitterWidget.domNode,_26);}this.inherited(arguments);},persist:function(){var _27={pinned:this.pinned,visible:this.visible,size:_8.get(this.containerNode,"width")};this._profile.set(this.id,_27,true);},getActions:function(){var _28=this.inherited(arguments),_29=/left|leading/.test(this.region),pin={name:"pin",widgetType:"dijit.form.ToggleButton",title:this._getPinTitle(),iconClass:"epi-iconPin",settings:{showLabel:false,"class":"epi-chromelessButton",checked:this.pinned},action:_4.hitch(this,this._togglePinned)},_2a={name:"settings",title:_f.gadgetchrome.settingsmenutooltip,type:"dropdown",iconClass:"epi-iconSettings",settings:{showLabel:false,"class":"epi-chromelessButton",dropDownPosition:_29?["below-alt"]:["below"]}};_28.splice(0,0,_2a);_28.splice(_29?_28.length:0,0,pin);return _28;},_setPinnedAttr:function(_2b){this._set("pinned",_2b);_6.toggle(this.pinnableNode,this.baseClass+"-pinned",_2b);_6.toggle(this.pinnableNode,this.baseClass+"-unpinned",!_2b);_8.set(this.pinnableNode,"position",_2b?"relative":"absolute");this.definitionConsumer.setItemProperty("pin","title",this._getPinTitle());if(this._started){this._refreshState();}if(!this.pinned){this.set("visible",false);}},_setVisibleAttr:function(_2c){this._set("visible",_2c);_8.set(this.pinnableNode,"display",_2c?"block":"none");if(this._splitterWidget){(_2c)?this._splitterWidget.show():this._splitterWidget.hide();}if(this._started){this._visibilityChanged=true;this._refreshState();this._visibilityChanged=false;}},_togglePinned:function(){this.set("pinned",!this.pinned);},_refreshState:function(){this._disconnectUnpinnedEvents();if(this.visible&&!this.pinned){this._connectUnpinnedEvents();}this._container.layout();this.resize();this.persist();dojo.publish("/epi/layout/pinnable/"+this.id+"/visibilitychanged",[this.visible]);},_connectUnpinnedEvents:function(){this._unpinnedEvents=[this.connect(this.domNode,"onmousedown",_3.stop),this.connect(this._container.domNode,"onmousedown",_4.hitch(this,this.set,"visible",false)),this.connect(_5.global,"onresize",_4.hitch(this,this.set,"visible",false)),this.connect(this.domNode,"onmouseover",_3.stop),this.connect(this._container.domNode,"onmouseover",function(){if(this._dragging){this.set("visible",false);}}),dojo.subscribe("/epi/shell/action/changeview",_4.hitch(this,this.set,"visible",false))];},_disconnectUnpinnedEvents:function(){_1.forEach(this._unpinnedEvents,dojo.disconnect);},_computeMaxSize:function(){var _2d=_7.getMarginBox(this.domNode).w,_2e=_1.filter(this._container.getChildren(),function(_2f){return _2f.region=="center";})[0],_30=_7.getMarginBox(_2e.domNode).w;return Math.min(this.maxSize,_2d+_30);},_getPinTitle:function(){return this.pinned?_f.pinnablepane.unpin:_f.pinnablepane.pin;}});});