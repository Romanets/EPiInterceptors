//>>built
define("epi/shell/_ContextMixin",["dojo"],function(_1){return _1.declare("epi.shell._ContextMixin",null,{currentContext:null,_contextHandles:null,constructor:function(_2){this._contextHandles={contextchanged:_1.subscribe("/epi/shell/context/changed",this,function(_3,_4){if(!this.currentContext){this._initialContextChanged(_3,_4);}this.currentContext=_3;this.contextChanged(_3,_4);}),contextupdated:_1.subscribe("/epi/shell/context/updated",this,function(_5,_6){this.currentContext=_5;this.contextUpdated(_5,_6);}),contextchangefailed:_1.subscribe("/epi/shell/context/requestfailed",this,"contextChangeFailed"),respondcurrentcontext:_1.subscribe("/epi/shell/context/current",this,function(_7,_8){if(this.currentContext||!_8||_8.sender!==this){return;}this._initialContextChanged(_7,_8);_1.unsubscribe(this._contextHandles.respondcurrentcontext);delete this._contextHandles.respondcurrentcontext;})};if(!_2||!_2.skipInitialRequest){_1.publish("/epi/shell/context/requestcurrent",[{sender:this}]);}},destroy:function(){for(var _9 in this._contextHandles){_1.unsubscribe(this._contextHandles[_9]);delete this._contextHandles[_9];}this.inherited(arguments);},getCurrentContext:function(){if(this.currentContext!=null){return this.currentContext;}if(!this.waitingForContext){this.waitingForContext=new _1.Deferred();}return this.waitingForContext;},contextChanged:function(_a,_b){},contextUpdated:function(_c,_d){},contextChangeFailed:function(_e,_f){},_initialContextChanged:function(ctx,_10){this.currentContext=ctx;if(this.waitingForContext){this.waitingForContext.resolve(ctx);delete this.waitingForContext;}}});});