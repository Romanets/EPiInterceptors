//>>built
define("epi/shell/command/builder/MenuAssembler",["dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","epi/shell/_StatefulGetterSetterMixin"],function(_1,_2,_3,_4,_5){return _3([_5],{commandSource:null,configuration:null,_commandSourceConnect:null,constructor:function(_6){_3.safeMixin(this,_6);},build:function(){this.set("commandSource",this.commandSource);},_setCommandSourceAttr:function(_7){if(this._commandSourceConnect&&this.commandSource){_2.disconnect(this._commandSourceConnect);this._removeCommands(this.commandSource.getCommands());}this.commandSource=_7;if(this.commandSource){this._addCommands(this.commandSource.getCommands());this._commandSourceConnect=_2.connect(this.commandSource,"onCommandsChanged",this,this._commandsChanged);}},_commandsChanged:function(_8,_9,_a){if(_9){this._removeCommands(_9);}if(_a){this._addCommands(_a);}},_getBuildInfo:function(_b){if(_b.category){var i=this.configuration.length-1;for(;i>0;i--){if(this.configuration[i].category==_b.category){return this.configuration[i];}}}return this.configuration[0];},_addCommands:function(_c){_1.forEach(_c,this._addCommand,this);},_addCommand:function(_d){var _e=this._getBuildInfo(_d);_e.builder.create(_d,_e.target);},_removeCommands:function(_f){_1.forEach(_f,function(_10){var _11=this._getBuildInfo(_10);_11.builder.remove(_10,_11.target);},this);}});});