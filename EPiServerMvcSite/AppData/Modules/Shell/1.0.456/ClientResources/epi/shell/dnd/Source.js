//>>built
define("epi/shell/dnd/Source",["epi/dependency","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/topic","dojo/dom-construct","dojo/dnd/Source"],function(_1,_2,_3,_4,_5,_6,_7){return _3("epi.shell.dnd.Source",[_7],{alwaysCopy:true,createItemOnDrop:true,singular:true,generateText:false,_dummyDropItemContainer:null,_converterRegistry:null,readOnly:null,constructor:function(_8){_4.mixin(this,_8);if(!this.createItemOnDrop){this.parent=this._dummyDropItemContainer=_6.create("div");}this._converterRegistry=this._converterRegistry||_1.resolve("epi.objectconverterregistry");},destroy:function(){if(this._dummyDropItemContainer){_6.destroy(this._dummyDropItemContainer);}this.inherited(arguments);},checkAcceptance:function(_9,_a){if(this.readOnly){return false;}var _b=this.inherited(arguments);if(_b){return true;}_b=_a.length>0;for(var i=0;i<_a.length;++i){var _c=_9.getItem(_a[i].id);_b=this._converterExistsForAnyType(_c,this.accept);if(!_b){break;}}return _b;},getOrderedItems:function(){return _2.map(this.getAllNodes(),function(_d){return this.getItem(_d.id);},this);},_converterExistsForAnyType:function(_e,_f){for(var _10 in _f){if(this._converterRegistry.getConverter(_e.type,_10)){return true;}}return false;},_acceptsTypeWithoutConversion:function(_11){var _12=_11.type;var _13=false;for(var j=0;j<_12.length;++j){if(_12[j] in this.accept){_13=true;break;}}return _13;},onDropData:function(_14,_15,_16,_17){},onDrop:function(_18,_19,_1a){var _1b=[],_1c,_1d=[],_1e,_1f;for(var i=0;i<_19.length;++i){_1c=_18.getItem(_19[i].id);_1d.push(_1c);_1e=_1c.data.dndData||_1c.data;if(this._acceptsTypeWithoutConversion(_1c)){_1f={type:_1c.type,data:_1e};_1b.push(_1f);}else{for(var _20 in this.accept){var _21=this._converterRegistry.getConverter(_1c.type,_20);if(_21){_1f={type:[_20]};_1f.data=_21.convert(_1c.type,_20,_1e);_1b.push(_1f);break;}}}if(this!==_18){_1c.data.getNormalizedData=function(){return _1f;};}}this.inherited(arguments,[_18,_19,this.alwaysCopy||_1a]);if(!this.createItemOnDrop){_6.empty(this._dummyDropItemContainer);}this.onDropData(_1b,_18,_19,this.alwaysCopy||_1a);_5.publish("/epi/dnd/dropdata",_1b,_18,_19,this.alwaysCopy||_1a);}});});