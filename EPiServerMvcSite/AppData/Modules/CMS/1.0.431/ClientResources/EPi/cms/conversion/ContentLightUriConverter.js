//>>built
define("epi/cms/conversion/ContentLightUriConverter",["dojo","epi/dependency","epi/UriParser","epi/cms/core/ContentReference"],function(_1,_2,_3,_4){return _1.declare("epi.cms.conversion.ContentLightUriConverter",null,{_pageDataStore:null,constructor:function(_5){_1.mixin(this,_5);this._pageDataStore=this._pageDataStore||_2.resolve("epi.storeregistry").get("epi.cms.contentdata");},registerConverter:function(_6){_6.registerConverter("epi.cms.page.lighturi","link",this);_6.registerConverter("epi.cms.page.lighturi","epi.cms.pagereference",this);_6.registerConverter("epi.cms.block.lighturi","epi.cms.blockreference",this);_6.registerConverter("epi.cms.folder.lighturi","epi.cms.folderreference",this);_6.registerConverter("epi.cms.content.lighturi","epi.cms.contentreference",this);_6.registerConverter("epi.cms.content.lighturi","epi.cms.content.light",this);_6.registerConverter("epi.cms.page.lighturi","epi.cms.content.light",this);_6.registerConverter("epi.cms.block.lighturi","epi.cms.content.light",this);_6.registerConverter("epi.cms.folder.lighturi","epi.cms.content.light",this);},convert:function(_7,_8,_9){if(!_9){return null;}else{if(_8==="epi.cms.content.lighturi"){return _9;}}var _a=new _3(_9.uri);var _b=_a.getId();var _c=new _4(_b).createVersionUnspecificReference().toString();if(_8==="epi.cms.content.light"||_8==="epi.cms.page.light"||_8==="epi.cms.block.light"||_8==="epi.cms.folder.light"){return {contentLink:_c,name:_9.name};}else{if(_8==="epi.cms.contentreference"||_8==="epi.cms.pagereference"||_8==="epi.cms.blockreference"||_8==="epi.cms.folderreference"){return _c;}}if(_8==="link"){return _1.when(this._pageDataStore.get(_c),function(_d){return {url:_d.properties.pageLinkURL,text:_d.name};});}}});});