//>>built
define("epi/cms/contentediting/FlyoutEditorWrapper",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/event","dojo/_base/lang","dojo/dom-geometry","dojo/has","epi/dependency","epi/string","epi/shell/widget/dialog/LightWeight","epi/cms/contentediting/_EditorWrapperBase"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a){return _1("epi.cms.contentediting.FlyoutEditorWrapper",[_a],{formContainerWidgetType:"epi.shell.widget.FormContainer",destroy:function(){this._removeEditingFeatures();this._dialog.destroyRecursive();this.inherited(arguments);},startEdit:function(_b){var _c=new _2();var _d=this;var _e=function(){if(_d._dialog){return true;}return _d._setupDialog();};_2.when(_e(),_4.hitch(this,function(){this._dialog.show();this._startEdit(_b);_c.resolve();}));return _c;},_createDialog:function(_f){return new _9({title:this.propertyDisplayName,content:_f,duration:350,snapToNode:this.blockDisplayNode,positioner:_7.resolve("epi.shell.layout.PositioningUtility")});},_setupDialog:function(){var _10={},_11=this;var _12=_4.hitch(this,function(_13,_14){_10[_13]=_14;});var _15=_4.hitch(this,function(_16){for(var _17 in _10){var _18=_10[_17];_18.set("parent",_11);}});var _19=_4.mixin(this.editorParams||{},{value:this.value,intermediateChanges:true});if(this.editorWidgetType===this.formContainerWidgetType){_19=_4.mixin(this.editorParams||{},{onFieldCreated:_12,onFormCreated:_15});}var def=new _2();var _1a=_8.slashName(this.editorWidgetType);require([_1a],_4.hitch(this,function(_1b){var _1c=new _1b(_19);this.editorWidget=_1c;this.connect(_1c,"onChange",this._onChange);var _1d=this._createDialog(_1c);this.connect(_1d,"onButtonClose",this._onButtonClose);this.connect(_1d.doneButtonNode,"onClick",this._onButtonClose);this._dialog=_1d;this.connect(_1c,"onKeyPress","_onEditorKeyPress");if(this._createdEditor&&this.editorWidget.startup){this.editorWidget.startup();}def.resolve();}));return def;},_removeEditingFeatures:function(){if(this._dialog.open){this._dialog.hide();}},_onTryToStopWithInvalidValue:function(){dijit.focus(this._dialog.titleNode);if(this.editorWidget.focus){this.editorWidget.focus();}},_onButtonClose:function(){if(!this.editorWidget.isShowingChildDialog){this.tryToStopEditing(false);}}});});