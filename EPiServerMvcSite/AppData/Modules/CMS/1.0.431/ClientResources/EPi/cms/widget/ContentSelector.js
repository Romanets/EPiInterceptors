//>>built
require({cache:{"url:epi/cms/widget/templates/ContentSelector.html":"<div class=\"dijitReset dijitInputField dijitInputContainer dijitInline epi-resourceInputContainer\" id=\"widget_${id}\">\r\n    <div data-dojo-attach-point=\"displayNode, dropAreaNode, stateNode\" class=\"dijit dijitReset dijitInline dijitInlineTable dijitLeft dijitTextBox displayNode\">\r\n        <div class=\"dijitReset dijitLeft dijitInputField dijitInputContainer\">\r\n            <div data-dojo-attach-point=\"clearButton\" class=\"epi-clearButton\">&nbsp;</div>\r\n            <div data-dojo-attach-point=\"resourceName\" class=\"dijitInline epi-resourceName dojoxEllipsis\"/>\r\n                <span data-dojo-attach-point=\"selectedContentNameNode\"></span> <span data-dojo-attach-point=\"selectedContentLinkNode\"></span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div data-dojo-type=\"dijit.form.Button\" data-dojo-attach-event=\"onClick: _onButtonClick\" data-dojo-attach-point=\"button\" data-dojo-props=\"label:'...'\"></div>\r\n</div>"}});define("epi/cms/widget/ContentSelector",["dojo","dojo/dom-class","dojo/dom-style","dojo/_base/Deferred","dojo/query","dijit","dijit/focus","dijit/_Widget","dijit/_TemplatedMixin","dijit/_CssStateMixin","dijit/_WidgetsInTemplateMixin","dijit/Tooltip","dijit/form/Button","dijit/layout/ContentPane","epi","epi/dependency","epi/shell/widget/dialog/Dialog","epi/cms/widget/_HasClearButton","epi/cms/widget/_HasChildDialogMixin","epi/cms/widget/_Droppable","epi/cms/widget/ContentSelectorDialog","epi/shell/widget/_ValueRequiredMixin","dojo/text!./templates/ContentSelector.html","epi/i18n!epi/cms/nls/episerver.cms.widget.PageSelector"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,_13,_14,_15,_16,_17,_18){return _1.declare("epi.cms.widget.ContentSelector",[_8,_9,_b,_a,_12,_13,_14,_16],{templateString:_17,localization:_18,root:null,typeIdentifiers:null,value:null,required:false,missingMessage:"",tooltipPosition:[],contentLink:null,canSelectOwnerContent:true,_dropTarget:null,_setSelectedContentNameAttr:function(_19){_5(this.selectedContentNameNode).text(_19);},_setSelectedContentLinkAttr:{node:"selectedContentLinkNode",type:"innerHTML"},postMixInProperties:function(){this.inherited(arguments);var _1a=_10.resolve("epi.storeregistry");this._store=_1a.get("epi.cms.content.light");this.acceptDataTypes=this.acceptDataTypes||["epi.cms.pagereference"];},_setReadOnlyAttr:function(_1b){this._set("readOnly",_1b);_3.set(this.button.domNode,"display",_1b?"none":"");_3.set(this.clearButton,"display",_1b?"none":"");_2.toggle(this.domNode,"dijitReadOnly",_1b);},_setValueAttr:function(_1c){this._setValueAndFireOnChange(_1c);},_getDialog:function(){if(this.dialog){return this.dialog;}var _1d=new _4();_1.when(this._getContentData(this.contentLink),_1.hitch(this,function(_1e){this.contentSelector=new _15({canSelectOwnerContent:this.canSelectOwnerContent&&_1e&&_1e.capabilities&&!_1e.capabilities.isBlock,showButtons:false,root:this.root,typeIdentifiers:this.typeIdentifiers});this.dialog=new _11({title:this.localization.popuptitle,dialogClass:"epi-dialog-portrait",content:this.contentSelector});this.connect(this.dialog,"onExecute","_onDialogExecute");this.connect(this.dialog,"onHide","_onDialogHide");_1d.resolve(this.dialog);}));return _1d;},_onButtonClick:function(){_1.when(this._getDialog(),_1.hitch(this,function(_1f){this.isShowingChildDialog=true;this.contentSelector.set("value",this.value);_1f.show();}));},_onDialogExecute:function(){var _20=this.contentSelector.get("value");this._setValueAndFireOnChange(_20);},_onDialogHide:function(){this.isShowingChildDialog=false;},_setValueAndFireOnChange:function(_21){var _22=_21==="-"?this.contentLink:_21;_1.when(this._getContentData(_22),_1.hitch(this,function(_23){var _24=this.value!==_22;this.value=_22;this._started&&this.validate();this._updateDisplayNode(_23);if(_24){this.onChange(_22);}}));},_getContentData:function(_25){if(!_25){return null;}return this._store.get(_25);},_getValueAttr:function(){return this.value;},_onBlur:function(){this.inherited(arguments);this.validate();},focus:function(){this.button.focus();},onChange:function(_26){},_updateDisplayNode:function(_27){if(_27){_1.removeClass(this.domNode,"epi-noValue");_1.removeClass(this.resourceName,"dijitPlaceHolder");this.set("selectedContentName",_27.name);this.set("selectedContentLink",_27.contentLink);}else{_1.addClass(this.domNode,"epi-noValue");_1.addClass(this.resourceName,"dijitPlaceHolder");this.set("selectedContentName",this.localization.helptext);this.set("selectedContentLink","");}}});});