//>>built
require({cache:{"url:epi/cms/widget/templates/_FolderTreeNode.html":"<div class=\"dijitTreeNode epi-folderTreeNode\" role=\"presentation\">\r\n    <div tabindex=\"-1\" data-dojo-attach-point=\"rowNode\" class=\"dijitTreeRow\" role=\"presentation\" data-dojo-attach-event=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onclick:_onClick, ondblclick:_onDblClick\">\r\n        <span data-dojo-attach-point=\"contentNode\" class=\"dijitTreeContent\" role=\"presentation\">\r\n            <span data-dojo-attach-point=\"expandoNode\" class=\"dijitTreeExpando\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"></span>\r\n            \r\n            <span data-dojo-attach-point=\"labelNode\" class=\"dijitTreeLabel\" role=\"treeitem\"\r\n                tabindex=\"-1\" aria-selected=\"false\" data-dojo-attach-event=\"onfocus:_onLabelFocus\">\r\n            </span>\r\n        </span>\r\n        <span data-dojo-attach-point=\"extraIconsContainer\" class=\"epi-dijitExtraIconContainer\" role=\"presentation\">\r\n            <span data-dojo-attach-point=\"iconNodeMenu\" class=\"dijitTreeIcon\" role=\"presentation\" title=\"${_menuTooltip}\">&nbsp;</span>\r\n        </span>\r\n    </div>\r\n    <div data-dojo-attach-point=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\r\n</div>"}});define("epi/cms/widget/_FolderTreeNode",["dojo/dom-attr","dojo/text!./templates/_FolderTreeNode.html","dijit/InlineEditBox","dijit/form/TextBox","dijit/form/ValidationTextBox","dijit/Tree","epi/i18n!epi/cms/nls/episerver.cms.components.sharedblockscomponent"],function(_1,_2,_3,_4,_5,_6,_7){dojo.declare("_TreeInlineEditor",[dijit._InlineEditor],{postCreate:function(){this.inherited(arguments);dojo.forEach(["onmousedown","onmouseup","onclick","onkeypress"],function(_8){this.connect(this.domNode,_8,function(_9){_9.stopPropagation();});},this);}});var _a={normal:0,root:1};return dojo.declare("epi.cms.widget._FolderTreeNode",[_6._TreeNode],{templateString:_2,_blockFolderRoot:"epi-iconObjectFolder",_blockFolderMenu:"epi-iconContextMenu",_blockFolderDnDIcon:"epi-iconDnD",_blockFolderExpand:"epi-iconObjectFolderOpen",_blockFolderCollapse:"epi-iconObjectFolder",isSelected:false,isRootNode:undefined,_isResetValue:false,_menuTooltip:undefined,contextMenu:null,_rowStates:{NORMAL:1,EXPANDED:2,ENTERED:4,SELECTED:8},_currentRowState:1,postMixInProperties:function(){this.inherited(arguments);this.isRootNode=this.item&&(this.item.isRoot||this.item.isSubRoot);this._menuTooltip=this.isRootNode?_7.rootmenu:_7.foldermenu;},postCreate:function(){this.inherited(arguments);dojo.style(this.iconNodeMenu,"zIndex",dojo.position(this.rowNode).zIndex+1);this._updateStyle();_1.set(this.contentNode,"title",this.label);},buildRendering:function(){this.inherited(arguments);var _b=this;this.labelWidget=new _3({value:this.label,editorWrapper:"_TreeInlineEditor",editor:"dijit.form.ValidationTextBox",width:this.tree.editorWidth,editorParams:{maxLength:255},_onMouseOver:function(){},_onClick:function(){},onChange:function(_c){_b._onChangeLabelValue(_c);}},this.labelNode);},onRename:function(_d){},_onChangeLabelValue:function(_e){_1.set(this.contentNode,"title",_e);if(!this._isResetValue){this.onRename(_e);}this._isResetValue=false;},_onClick:function(_f){this.inherited(arguments);dojo.removeClass(this.labelNode,"dijitInlineEditBoxDisplayModeHover");this.onTreeNodeSelected(this);},rollbackLabel:function(val){this._isResetValue=true;this.labelWidget.set("value",val);},bindContextMenu:function(_10){this.contextMenu=_10;this.connect(this.iconNodeMenu,"onclick","_onIconNodeMenuClick");},collapse:function(){var _11=this,def=new dojo.Deferred();dojo.when(_11.inherited(arguments),function(){_11._currentRowState=_11._currentRowState^_11._rowStates.EXPANDED;_11._updateStyle();var _12=_11._wipeOut;_12.onEnd=function(){_11.onResize();def.resolve(true);};});return def;},expand:function(){var _13=this,def=new dojo.Deferred();dojo.when(_13.inherited(arguments),function(){_13._currentRowState=_13._currentRowState|_13._rowStates.EXPANDED;_13._updateStyle();_13.onResize();def.resolve();});return def;},onResize:function(){},onTreeNodeSelected:function(_14){},setSelected:function(_15){this.inherited(arguments);this.isSelected=_15;var _16=this._currentRowState;this._currentRowState=_15?(this._currentRowState|this._rowStates.SELECTED):parseInt(this._currentRowState&this._rowStates.SELECTED,10)>0?(this._currentRowState^this._rowStates.SELECTED):_16;this._updateStyle();if(_15){this.onTreeNodeSelected(this);}},_updateBlockFolderTypeIcon:function(){if(this.isRootNode){this._iconNodeClass=this._blockFolderRoot;}else{this._iconNodeClass=this.isExpanded?this._blockFolderExpand:this._blockFolderCollapse;}dojo.addClass(this.iconNode,this._iconNodeClass);},_onMouseEnter:function(evt){this.inherited(arguments);this._currentRowState=this._currentRowState|this._rowStates.ENTERED;this._updateStyle();dojo.removeClass(this.labelNode,"dijitInlineEditBoxDisplayModeHover");},_onMouseLeave:function(evt){this.inherited(arguments);this._currentRowState=this._currentRowState^this._rowStates.ENTERED;this._updateStyle();},_onIconNodeMenuClick:function(evt){this.contextMenu&&this.contextMenu.scheduleOpen(evt.target,null,{x:evt.pageX,y:evt.pageY});this.onTreeNodeSelected(this);},_updateStyleBySingleState:function(_17){var _18=this._rowStates;switch(_17){case _18.SELECTED:dojo.addClass(this.iconNodeMenu,this._blockFolderMenu);break;case _18.ENTERED:dojo.addClass(this.iconNodeMenu,this._blockFolderMenu);break;default:dojo.removeClass(this.iconNodeMenu,this._blockFolderMenu);dojo.removeClass(this.iconNode,this._blockFolderExpand);dojo.removeClass(this.iconNode,this._blockFolderCollapse);var _19=this.isExpanded&&this.hasChildren()?this._blockFolderExpand:this._blockFolderCollapse;dojo.addClass(this.iconNode,this.isRootNode?this._blockFolderRoot:_19);break;}},_updateStyle:function(){for(var _1a in this._rowStates){if(parseInt(this._currentRowState&this._rowStates[_1a],10)>0){this._updateStyleBySingleState(this._rowStates[_1a]);}}}});});