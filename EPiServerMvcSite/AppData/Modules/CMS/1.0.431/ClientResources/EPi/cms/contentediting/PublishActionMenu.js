//>>built
require({cache:{"url:epi/cms/contentediting/templates/PublishActionMenu.html":"<div class=\"epi-invertedTooltip epi-publishActionMenu\" role=\"menu\" tabIndex=\"${tabIndex}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\" >\r\n    <div class=\"epi-tooltipDialogTop\" data-dojo-attach-point=\"topInfoSection\">\r\n        <ul>\r\n            <li data-dojo-attach-point=\"lastChangeStatusNode\" class=\"epi-lastchangeStatus\"></li>\r\n            <li data-dojo-attach-point=\"mainButtonSection\">\r\n                <button data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"mainButton\" data-dojo-attach-event=\"onClick: _onMainButtonClick\" class=\"epi-fullWidthButton\"></button>\r\n            </li>            \r\n        </ul>          \r\n        <div data-dojo-attach-point=\"lastPublishedIcon\" class=\"dijitTooltipConnector\"></div>\r\n    </div>\r\n    <div class=\"epi-tooltipDialogInfo\"data-dojo-attach-point=\"publishInfoSection\">\r\n        <ul>\r\n            <li data-dojo-attach-point=\"lastPublishedTitleNode\"></li>\r\n            <li>\r\n                <span data-dojo-attach-point=\"lastPublishedTextNode\"></span>&nbsp;\r\n                <a href=\"#\" title=\"${res.lastpublishedviewlinktooltip}\" data-dojo-attach-point=\"lastPublishedViewLinkNode\">${res.view}</a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class=\"epi-tooltipDialogInfo\" data-dojo-attach-point=\"additionalInfoSection\">\r\n        <ul>\r\n            <li data-dojo-attach-point=\"additionalInfoNode\"></li>\r\n        </ul>\r\n    </div>\r\n    <table class=\"dijitReset epi-tooltipDialogMenu epi-menuInverted\" cellspacing=\"0\">\r\n\t    <tbody data-dojo-attach-point=\"containerNode\" ></tbody>\r\n    </table>\r\n</div>\r\n"}});define("epi/cms/contentediting/PublishActionMenu",["dojo/_base/declare","dojo/_base/array","dojo/_base/Deferred","dojo/_base/lang","dojo/dom-style","dojo/dom-attr","dojo/dom-class","dojo/html","dijit/DropDownMenu","dijit/_KeyNavContainer","dijit/_WidgetsInTemplateMixin","epi/shell/widget/_ModelBindingMixin","epi/shell/command/builder/MenuBuilder","epi/cms/contentediting/ContentActionSupport","dojo/text!./templates/PublishActionMenu.html","epi/i18n!epi/cms/nls/episerver.cms.contentediting.editactionpanel.publishactionmenu"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,res){return _1("epi.cms.contentediting.PublishActionMenu",[_9,_b,_c],{templateString:_f,res:res,_menuBuilder:null,commands:null,mainButtonCommand:null,postMixInProperties:function(){this._menuBuilder=new _d();},modelBindingMap:{"commands":["commands"],"mainButtonCommand":["mainButtonCommand"],"mainButtonSectionVisible":["mainButtonSectionVisible"],"lastChangeStatus":["lastChangeStatus"],"topInfoSectionVisible":["topInfoSectionVisible"],"publishInfoSectionVisible":["publishInfoSectionVisible"],"lastPublishedTitle":["lastPublishedTitle"],"lastPublishedTitleVisible":["lastPublishedTitleVisible"],"lastPublishedText":["lastPublishedText"],"lastPublishedViewLinkVisible":["lastPublishedViewLinkVisible"],"lastPublishedViewLinkHref":["lastPublishedViewLinkHref"],"additionalInfoSectionVisible":["additionalInfoSectionVisible"],"additionalInfoText":["additionalInfoText"]},_setCommandsAttr:function(_10){this.focusedChild=null;this.destroyDescendants();this._addCommandsToMenu(_10);this.focusFirstChild();},_setMainButtonCommandAttr:function(_11){this._set("mainButtonCommand",_11);if(_11){this.mainButton.set("label",_11.label);this.mainButton.set("disabled",!_11.get("canExecute"));_7.remove(this.mainButton.domNode,"epi-loading");if(this._addedMainButtonClass){_7.remove(this.mainButton.domNode,this._addedMainButtonClass);}if(_11.options&&_11.options.mainButtonClass){this._addedMainButtonClass=_11.options.mainButtonClass;_7.add(this.mainButton.domNode,this._addedMainButtonClass);}}},_setMainButtonSectionVisibleAttr:function(_12){_5.set(this.mainButtonSection,"display",_12?"":"none");_5.set(this.mainButton.domNode,"display",_12?"":"none");},_setLastChangeStatusAttr:{node:"lastChangeStatusNode",type:"innerHTML"},_setTopInfoSectionVisibleAttr:function(_13){_5.set(this.topInfoSection,"display",_13?"":"none");},_setPublishInfoSectionVisibleAttr:function(_14){_5.set(this.publishInfoSection,"display",_14?"":"none");},_setLastPublishedTitleAttr:{node:"lastPublishedTitleNode",type:"innerHTML"},_setLastPublishedTitleVisibleAttr:function(_15){_5.set(this.lastPublishedTitleNode,"display",_15?"":"none");},_setLastPublishedTextAttr:{node:"lastPublishedTextNode",type:"innerHTML"},_setLastPublishedViewLinkVisibleAttr:function(_16){_5.set(this.lastPublishedViewLinkNode,"display",_16?"":"none");},_setLastPublishedViewLinkHrefAttr:function(_17){_6.set(this.lastPublishedViewLinkNode,"href",_17);},_setAdditionalInfoSectionVisibleAttr:function(_18){_5.set(this.additionalInfoSection,"display",_18?"":"none");},_setAdditionalInfoTextAttr:{node:"additionalInfoNode",type:"innerHTML"},postCreate:function(){this.inherited(arguments);this.mainButton._setSelected=this.mainButton._onUnhover=function(){};},uninitialize:function(){if(this._commandsChangedHandler){this.disconnect(this._commandsChangedHandler);}this.inherited(arguments);},onOpen:function(){this.model.set("isOpen",true);this.inherited(arguments);},onClose:function(){this.model.set("isOpen",false);this.inherited(arguments);},_setModelAttr:function(){this.inherited(arguments);if(this._commandsChangedHandler){this.disconnect(this._commandsChangedHandler);}this._commandsChangedHandler=this.connect(this.model,"onCommandsChanged","onCommandsChanged");},onCommandsChanged:function(_19,_1a,_1b){if(_1a){this._removeCommandsFromMenu(_4.isArray(_1a)?_1a:[_1a]);}if(_1b){this._addCommandsToMenu(_4.isArray(_1b)?_1b:[_1b]);}},_addCommandsToMenu:function(_1c){_2.forEach(_1c,function(_1d){if(_1d!==this.model.mainButtonCommand){this._menuBuilder.create(_1d,this);}},this);},_removeCommandsFromMenu:function(_1e){var _1f=this.menu.getChildren();_2.forEach(_1e,function(_20){for(var i=_1f.length-1;i>=0;i--){var _21=_1f[i];if(_21._command==_20){this.removeChild(_21);break;}}},this);},_onMainButtonClick:function(){if(this.mainButtonCommand){this.mainButton.set("label",this.mainButtonCommand.executingLabel);_7.add(this.mainButton.domNode,"epi-loading");var _22=_4.hitch(this,function(){if(this.mainButtonCommand.resetLabelAfterExecution){this.mainButton.set("label",this.mainButtonCommand.label);}_7.remove(this.mainButton.domNode,"epi-loading");if(this.mainButtonCommand.options&&!this.mainButtonCommand.options.keepMenuOpen){this.onExecute();}}),_23=_4.hitch(this,function(){this.model.set("lastExecutedCommand",this.mainButtonCommand);});this.mainButtonCommand.execute().then(_22,_22).then(_23);}},focusFirstChild:function(){if(this.mainButton.isFocusable()){return this.focusChild(this.mainButton);}else{return this.inherited(arguments);}},focusNext:function(){var _24=this._getLastFocusableChild();if(!this.focusedChild.focused){return this.focusChild(this._getFirstFocusableChild());}else{if(this.focusedChild===_24){this.focusedChild._setSelected(false);return _5.get(this.mainButton.domNode,"display")==="none"?this.lastPublishedViewLinkNode.focus():this.focusChild(this.mainButton);}else{if(this.focusedChild===this.mainButton){return this.lastPublishedViewLinkNode.focus();}else{return this.inherited(arguments);}}}},focusPrev:function(){var _25=this._getFirstFocusableChild();if(!this.focusedChild.focused){return _5.get(this.mainButton.domNode,"display")==="none"?this.focusChild(this._getLastFocusableChild()):this.focusChild(this.mainButton);}else{if(this.focusedChild===_25){this.focusedChild._setSelected(false);return this.lastPublishedViewLinkNode.focus();}else{return this.inherited(arguments);}}}});});