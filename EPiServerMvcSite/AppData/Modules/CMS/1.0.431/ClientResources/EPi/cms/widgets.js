//>>built
require({cache:{"epi/cms/conversion/ContentLightUriConverter":function(){define("epi/cms/conversion/ContentLightUriConverter",["dojo","epi/dependency","epi/UriParser","epi/cms/core/ContentReference"],function(_1,_2,_3,_4){return _1.declare("epi.cms.conversion.ContentLightUriConverter",null,{_pageDataStore:null,constructor:function(_5){_1.mixin(this,_5);this._pageDataStore=this._pageDataStore||_2.resolve("epi.storeregistry").get("epi.cms.contentdata");},registerConverter:function(_6){_6.registerConverter("epi.cms.page.lighturi","link",this);_6.registerConverter("epi.cms.page.lighturi","epi.cms.pagereference",this);_6.registerConverter("epi.cms.block.lighturi","epi.cms.blockreference",this);_6.registerConverter("epi.cms.folder.lighturi","epi.cms.folderreference",this);_6.registerConverter("epi.cms.content.lighturi","epi.cms.contentreference",this);_6.registerConverter("epi.cms.content.lighturi","epi.cms.content.light",this);_6.registerConverter("epi.cms.page.lighturi","epi.cms.content.light",this);_6.registerConverter("epi.cms.block.lighturi","epi.cms.content.light",this);_6.registerConverter("epi.cms.folder.lighturi","epi.cms.content.light",this);},convert:function(_7,_8,_9){if(!_9){return null;}else{if(_8==="epi.cms.content.lighturi"){return _9;}}var _a=new _3(_9.uri);var _b=_a.getId();var _c=new _4(_b).createVersionUnspecificReference().toString();if(_8==="epi.cms.content.light"||_8==="epi.cms.page.light"||_8==="epi.cms.block.light"||_8==="epi.cms.folder.light"){return {contentLink:_c,name:_9.name};}else{if(_8==="epi.cms.contentreference"||_8==="epi.cms.pagereference"||_8==="epi.cms.blockreference"||_8==="epi.cms.folderreference"){return _c;}}if(_8==="link"){return _1.when(this._pageDataStore.get(_c),function(_d){return {url:_d.properties.pageLinkURL,text:_d.name};});}}});});},"url:epi/cms/contentediting/templates/ScheduledPublishSelector.html":"<div>\r\n    <div data-dojo-type=\"epi.cms.widget.Breadcrumb\" data-dojo-attach-point=\"breadcrumbNode\" data-dojo-props=\"showCurrentNode: false\"></div>\r\n    <h1 data-dojo-attach-point=\"contentNameNode\" class=\"epi-breadCrumbsCurrentItem dijitInline dojoxEllipsis\"></h1>\r\n    <div data-dojo-attach-point=\"publishChangesCaptionNode\"></div>\r\n    <div data-dojo-type=\"epi.shell.widget.DateTimeSelectorDropDown\" data-dojo-attach-point=\"dateTimeSelector\" data-dojo-props=\"required:true\"></div>\r\n</div>","epi/cms/contentediting/command/BlockMoveUp":function(){define("epi/cms/contentediting/command/BlockMoveUp",["dojo/_base/declare","epi","epi/shell/command/_Command"],function(_e,_f,_10){return _e("epi.cms.contentediting.command.BlockMoveUp",[_10],{name:"moveup",label:_f.resources.action.moveup,tooltip:_f.resources.action.moveup,iconClass:"epi-iconUp",postscript:function(){this.inherited(arguments);},_execute:function(){this.model.moveUp();return this.inherited(arguments);},_onModelChange:function(){this.set("canExecute",this.model&&!this.model.get("isTop"));}});});},"epi/cms/widget/_ContentTreeNode":function(){require({cache:{"url:epi/cms/widget/templates/_ContentTreeNode.html":"<div class=\"dijitTreeNode\" role=\"presentation\">\r\n    <a href=\"#\" tabindex=\"-1\" data-dojo-attach-point=\"rowNode\" class=\"dijitTreeRow\" role=\"presentation\" data-dojo-attach-event=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onclick:_onClick, ondblclick:_onDblClick\">\r\n        <span data-dojo-attach-point=\"contentNode\" class=\"dijitTreeContent\" role=\"presentation\">\r\n            <span data-dojo-attach-point=\"expandoNode\" class=\"dijitTreeExpando\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"labelNode\" class=\"dijitTreeLabel\" role=\"treeitem\" tabindex=\"-1\" aria-selected=\"false\" data-dojo-attach-event=\"onfocus:_onLabelFocus\"></span>\r\n        </span>\r\n    </a>\r\n    <div data-dojo-attach-point=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\r\n</div>"}});define("epi/cms/widget/_ContentTreeNode",["epi","dojo","dijit/Tree","dijit/_TemplatedMixin","dojo/text!./templates/_ContentTreeNode.html"],function(epi,_11,_12,_13,_14){return _11.declare("epi.cms.widget._ContentTreeNode",[_12._TreeNode,_13],{templateString:_14});});},"url:epi/cms/contentediting/templates/PublishActionMenu.html":"<div class=\"epi-invertedTooltip epi-publishActionMenu\" role=\"menu\" tabIndex=\"${tabIndex}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\" >\r\n    <div class=\"epi-tooltipDialogTop\" data-dojo-attach-point=\"topInfoSection\">\r\n        <ul>\r\n            <li data-dojo-attach-point=\"lastChangeStatusNode\" class=\"epi-lastchangeStatus\"></li>\r\n            <li data-dojo-attach-point=\"mainButtonSection\">\r\n                <button data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"mainButton\" data-dojo-attach-event=\"onClick: _onMainButtonClick\" class=\"epi-fullWidthButton\"></button>\r\n            </li>            \r\n        </ul>          \r\n        <div data-dojo-attach-point=\"lastPublishedIcon\" class=\"dijitTooltipConnector\"></div>\r\n    </div>\r\n    <div class=\"epi-tooltipDialogInfo\"data-dojo-attach-point=\"publishInfoSection\">\r\n        <ul>\r\n            <li data-dojo-attach-point=\"lastPublishedTitleNode\"></li>\r\n            <li>\r\n                <span data-dojo-attach-point=\"lastPublishedTextNode\"></span>&nbsp;\r\n                <a href=\"#\" title=\"${res.lastpublishedviewlinktooltip}\" data-dojo-attach-point=\"lastPublishedViewLinkNode\">${res.view}</a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class=\"epi-tooltipDialogInfo\" data-dojo-attach-point=\"additionalInfoSection\">\r\n        <ul>\r\n            <li data-dojo-attach-point=\"additionalInfoNode\"></li>\r\n        </ul>\r\n    </div>\r\n    <table class=\"dijitReset epi-tooltipDialogMenu epi-menuInverted\" cellspacing=\"0\">\r\n\t    <tbody data-dojo-attach-point=\"containerNode\" ></tbody>\r\n    </table>\r\n</div>\r\n","epi/cms/contentediting/ScheduledPublishSelectorViewModel":function(){define("epi/cms/contentediting/ScheduledPublishSelectorViewModel",["dojo/_base/declare","dojo/Stateful","epi/shell/_StatefulGetterSetterMixin","epi/i18n!epi/cms/nls/episerver.cms.widget.scheduledpublishselector"],function(_15,_16,_17,_18){return _15([_16,_17],{breadcrumbModel:null,title:"",dateLabel:"",dateValue:null,scheduleButtonEnabled:false,constructor:function(){var _19=new Date();_19.setDate(_19.getDate()+1);_19.setHours(12,0,0,0);this.set("dateValue",_19);},_setIsPublishedAttr:function(_1a){this.set("dateLabel",_1a?_18.publishchangeson:_18.publishon);},_setContentDataAttr:function(_1b){this.set("title",_1b.name);this.set("isPublished",!_1b.isPendingPublish);this.set("breadcrumbModel",_1b.contentLink);},_setDateValueAttr:function(_1c){this._set("dateValue",_1c);this.set("scheduleButtonEnabled",!!_1c);}});});},"epi/cms/widget/_Droppable":function(){define("epi/cms/widget/_Droppable",["epi","dojo","dijit","epi/shell/dnd/Target"],function(epi,_1d,_1e,_1f){return _1d.declare("epi.cms.widget._Droppable",null,{dropAreaNode:null,acceptDataTypes:null,postCreate:function(){this.inherited(arguments);this._dropTarget=new _1f(this.dropAreaNode,{accept:this.acceptDataTypes,createItemOnDrop:false,readOnly:this.readOnly});this.connect(this._dropTarget,"onDropData","_onDropData");},uninitialize:function(){this.inherited(arguments);this._dropTarget.destroy();},onDropping:function(){},onDrop:function(){},_onDropData:function(_20,_21,_22,_23){var _24=_20?(_20.length?_20[0]:_20):null;if(_24){this.onDropping();_1d.when(_24.data,_1d.hitch(this,function(_25){this.set("value",_25);this.onDrop();}));}}});});},"epi/cms/widget/BlockContextMenu":function(){define("epi/cms/widget/BlockContextMenu",["dojo","dojo/i18n","dojo/_base/lang","dojo/date/locale","dojo/string","dojo/html","dojox/html/entities","dijit","dijit/Menu","dijit/MenuItem","dijit/MenuSeparator","dijit/_WidgetsInTemplateMixin","epi","epi/shell/widget/_ModelBindingMixin","epi/cms/contentediting/command/BlockEditing","dojo/text!./templates/BlockContextMenu.html","epi/i18n!epi/cms/nls/episerver.cms.widget.blockcontextmenu"],function(_26,_27,_28,_29,_2a,_2b,_2c,_2d,_2e,_2f,_30,_31,epi,_32,_33,_34,res){return _26.declare("epi.cms.widget.BlockContextMenu",[_2e,_31,_32],{templateString:_34,res:res,actionResources:epi.resources.action,commands:null,model:null,onEdit:function(){},onRemove:function(){},onMoveDown:function(){},onMoveUp:function(){},postMixInProperties:function(){this.inherited(arguments);this.commands=this.commands||new _33();this.commands.remove.watch("canExecute",_26.hitch(this,function(){if(this.removeMenuItem){this.removeMenuItem.set("disabled",!this.commands.remove.canExecute);}}));this.commands.edit.watch("canExecute",_26.hitch(this,function(){if(this.editMenuItem){this.editMenuItem.set("disabled",!this.commands.edit.canExecute);}}));this.commands.moveUp.watch("canExecute",_26.hitch(this,function(){if(this.moveUpMenuItem){this.moveUpMenuItem.set("disabled",!this.commands.moveUp.canExecute);}}));this.commands.moveDown.watch("canExecute",_26.hitch(this,function(){if(this.moveDownMenuItem){this.moveDownMenuItem.set("disabled",!this.commands.moveDown.canExecute);}}));},postCreate:function(){this.inherited(arguments);},_setModelAttr:function(_35){this.commands.set("model",_35);this.inherited(arguments);},_onEdit:function(){this.commands.edit.execute();this.onEdit();},_onRemove:function(){this.commands.remove.execute();this.onRemove();},_onMoveUp:function(){this.commands.moveUp.execute();this.onMoveUp();},_onMoveDown:function(){this.commands.moveDown.execute();this.onMoveDown();}});});},"epi/cms/contentediting/FlyoutEditorWrapper":function(){define("epi/cms/contentediting/FlyoutEditorWrapper",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/event","dojo/_base/lang","dojo/dom-geometry","dojo/has","epi/dependency","epi/string","epi/shell/widget/dialog/LightWeight","epi/cms/contentediting/_EditorWrapperBase"],function(_36,_37,_38,_39,_3a,has,_3b,_3c,_3d,_3e){return _36("epi.cms.contentediting.FlyoutEditorWrapper",[_3e],{formContainerWidgetType:"epi.shell.widget.FormContainer",destroy:function(){this._removeEditingFeatures();this._dialog.destroyRecursive();this.inherited(arguments);},startEdit:function(_3f){var def=new _37();var _40=this;var _41=function(){if(_40._dialog){return true;}return _40._setupDialog();};_37.when(_41(),_39.hitch(this,function(){this._dialog.show();this._startEdit(_3f);def.resolve();}));return def;},_createDialog:function(_42){return new _3d({title:this.propertyDisplayName,content:_42,duration:350,snapToNode:this.blockDisplayNode,positioner:_3b.resolve("epi.shell.layout.PositioningUtility")});},_setupDialog:function(){var _43={},_44=this;var _45=_39.hitch(this,function(_46,_47){_43[_46]=_47;});var _48=_39.hitch(this,function(_49){for(var _4a in _43){var _4b=_43[_4a];_4b.set("parent",_44);}});var _4c=_39.mixin(this.editorParams||{},{value:this.value,intermediateChanges:true});if(this.editorWidgetType===this.formContainerWidgetType){_4c=_39.mixin(this.editorParams||{},{onFieldCreated:_45,onFormCreated:_48});}var def=new _37();var _4d=_3c.slashName(this.editorWidgetType);require([_4d],_39.hitch(this,function(_4e){var _4f=new _4e(_4c);this.editorWidget=_4f;this.connect(_4f,"onChange",this._onChange);var _50=this._createDialog(_4f);this.connect(_50,"onButtonClose",this._onButtonClose);this.connect(_50.doneButtonNode,"onClick",this._onButtonClose);this._dialog=_50;this.connect(_4f,"onKeyPress","_onEditorKeyPress");if(this._createdEditor&&this.editorWidget.startup){this.editorWidget.startup();}def.resolve();}));return def;},_removeEditingFeatures:function(){if(this._dialog.open){this._dialog.hide();}},_onTryToStopWithInvalidValue:function(){dijit.focus(this._dialog.titleNode);if(this.editorWidget.focus){this.editorWidget.focus();}},_onButtonClose:function(){if(!this.editorWidget.isShowingChildDialog){this.tryToStopEditing(false);}}});});},"dijit/form/_FormSelectWidget":function(){define("dijit/form/_FormSelectWidget",["dojo/_base/array","dojo/aspect","dojo/data/util/sorter","dojo/_base/declare","dojo/dom","dojo/dom-class","dojo/_base/kernel","dojo/_base/lang","dojo/query","./_FormValueWidget"],function(_51,_52,_53,_54,dom,_55,_56,_57,_58,_59){return _54("dijit.form._FormSelectWidget",_59,{multiple:false,options:null,store:null,query:null,queryOptions:null,onFetch:null,sortByLabel:true,loadChildrenOnOpen:false,getOptions:function(_5a){var _5b=_5a,_5c=this.options||[],l=_5c.length;if(_5b===undefined){return _5c;}if(_57.isArray(_5b)){return _51.map(_5b,"return this.getOptions(item);",this);}if(_57.isObject(_5a)){if(!_51.some(this.options,function(o,idx){if(o===_5b||(o.value&&o.value===_5b.value)){_5b=idx;return true;}return false;})){_5b=-1;}}if(typeof _5b=="string"){for(var i=0;i<l;i++){if(_5c[i].value===_5b){_5b=i;break;}}}if(typeof _5b=="number"&&_5b>=0&&_5b<l){return this.options[_5b];}return null;},addOption:function(_5d){if(!_57.isArray(_5d)){_5d=[_5d];}_51.forEach(_5d,function(i){if(i&&_57.isObject(i)){this.options.push(i);}},this);this._loadChildren();},removeOption:function(_5e){if(!_57.isArray(_5e)){_5e=[_5e];}var _5f=this.getOptions(_5e);_51.forEach(_5f,function(i){if(i){this.options=_51.filter(this.options,function(_60){return (_60.value!==i.value||_60.label!==i.label);});this._removeOptionItem(i);}},this);this._loadChildren();},updateOption:function(_61){if(!_57.isArray(_61)){_61=[_61];}_51.forEach(_61,function(i){var _62=this.getOptions(i),k;if(_62){for(k in i){_62[k]=i[k];}}},this);this._loadChildren();},setStore:function(_63,_64,_65){var _66=this.store;_65=_65||{};if(_66!==_63){var h;while(h=this._notifyConnections.pop()){h.remove();}if(_63&&_63.getFeatures()["dojo.data.api.Notification"]){this._notifyConnections=[_52.after(_63,"onNew",_57.hitch(this,"_onNewItem"),true),_52.after(_63,"onDelete",_57.hitch(this,"_onDeleteItem"),true),_52.after(_63,"onSet",_57.hitch(this,"_onSetItem"),true)];}this._set("store",_63);}this._onChangeActive=false;if(this.options&&this.options.length){this.removeOption(this.options);}if(_63){this._loadingStore=true;_63.fetch(_57.delegate(_65,{onComplete:function(_67,_68){if(this.sortByLabel&&!_65.sort&&_67.length){_67.sort(_53.createSortFunction([{attribute:_63.getLabelAttributes(_67[0])[0]}],_63));}if(_65.onFetch){_67=_65.onFetch.call(this,_67,_68);}_51.forEach(_67,function(i){this._addOptionForItem(i);},this);this._loadingStore=false;this.set("value","_pendingValue" in this?this._pendingValue:_64);delete this._pendingValue;if(!this.loadChildrenOnOpen){this._loadChildren();}else{this._pseudoLoadChildren(_67);}this._fetchedWith=_68;this._lastValueReported=this.multiple?[]:null;this._onChangeActive=true;this.onSetStore();this._handleOnChange(this.value);},scope:this}));}else{delete this._fetchedWith;}return _66;},_setValueAttr:function(_69,_6a){if(this._loadingStore){this._pendingValue=_69;return;}var _6b=this.getOptions()||[];if(!_57.isArray(_69)){_69=[_69];}_51.forEach(_69,function(i,idx){if(!_57.isObject(i)){i=i+"";}if(typeof i==="string"){_69[idx]=_51.filter(_6b,function(_6c){return _6c.value===i;})[0]||{value:"",label:""};}},this);_69=_51.filter(_69,function(i){return i&&i.value;});if(!this.multiple&&(!_69[0]||!_69[0].value)&&_6b.length){_69[0]=_6b[0];}_51.forEach(_6b,function(i){i.selected=_51.some(_69,function(v){return v.value===i.value;});});var val=_51.map(_69,function(i){return i.value;}),_6d=_51.map(_69,function(i){return i.label;});this._set("value",this.multiple?val:val[0]);this._setDisplay(this.multiple?_6d:_6d[0]);this._updateSelection();this._handleOnChange(this.value,_6a);},_getDisplayedValueAttr:function(){var val=this.get("value");if(!_57.isArray(val)){val=[val];}var ret=_51.map(this.getOptions(val),function(v){if(v&&"label" in v){return v.label;}else{if(v){return v.value;}}return null;},this);return this.multiple?ret:ret[0];},_loadChildren:function(){if(this._loadingStore){return;}_51.forEach(this._getChildren(),function(_6e){_6e.destroyRecursive();});_51.forEach(this.options,this._addOptionItem,this);this._updateSelection();},_updateSelection:function(){this._set("value",this._getValueFromOpts());var val=this.value;if(!_57.isArray(val)){val=[val];}if(val&&val[0]){_51.forEach(this._getChildren(),function(_6f){var _70=_51.some(val,function(v){return _6f.option&&(v===_6f.option.value);});_55.toggle(_6f.domNode,this.baseClass+"SelectedOption",_70);_6f.domNode.setAttribute("aria-selected",_70);},this);}},_getValueFromOpts:function(){var _71=this.getOptions()||[];if(!this.multiple&&_71.length){var opt=_51.filter(_71,function(i){return i.selected;})[0];if(opt&&opt.value){return opt.value;}else{_71[0].selected=true;return _71[0].value;}}else{if(this.multiple){return _51.map(_51.filter(_71,function(i){return i.selected;}),function(i){return i.value;})||[];}}return "";},_onNewItem:function(_72,_73){if(!_73||!_73.parent){this._addOptionForItem(_72);}},_onDeleteItem:function(_74){var _75=this.store;this.removeOption(_75.getIdentity(_74));},_onSetItem:function(_76){this.updateOption(this._getOptionObjForItem(_76));},_getOptionObjForItem:function(_77){var _78=this.store,_79=_78.getLabel(_77),_7a=(_79?_78.getIdentity(_77):null);return {value:_7a,label:_79,item:_77};},_addOptionForItem:function(_7b){var _7c=this.store;if(!_7c.isItemLoaded(_7b)){_7c.loadItem({item:_7b,onItem:function(i){this._addOptionForItem(i);},scope:this});return;}var _7d=this._getOptionObjForItem(_7b);this.addOption(_7d);},constructor:function(_7e){this._oValue=(_7e||{}).value||null;this._notifyConnections=[];},buildRendering:function(){this.inherited(arguments);dom.setSelectable(this.focusNode,false);},_fillContent:function(){var _7f=this.options;if(!_7f){_7f=this.options=this.srcNodeRef?_58("> *",this.srcNodeRef).map(function(_80){if(_80.getAttribute("type")==="separator"){return {value:"",label:"",selected:false,disabled:false};}return {value:(_80.getAttribute("data-"+_56._scopeName+"-value")||_80.getAttribute("value")),label:String(_80.innerHTML),selected:_80.getAttribute("selected")||false,disabled:_80.getAttribute("disabled")||false};},this):[];}if(!this.value){this._set("value",this._getValueFromOpts());}else{if(this.multiple&&typeof this.value=="string"){this._set("value",this.value.split(","));}}},postCreate:function(){this.inherited(arguments);this.connect(this,"onChange","_updateSelection");this.connect(this,"startup","_loadChildren");this._setValueAttr(this.value,null);},startup:function(){this.inherited(arguments);var _81=this.store,_82={};_51.forEach(["query","queryOptions","onFetch"],function(i){if(this[i]){_82[i]=this[i];}delete this[i];},this);if(_81&&_81.getFeatures()["dojo.data.api.Identity"]){this.store=null;this.setStore(_81,this._oValue,_82);}},destroy:function(){var h;while(h=this._notifyConnections.pop()){h.remove();}this.inherited(arguments);},_addOptionItem:function(){},_removeOptionItem:function(){},_setDisplay:function(){},_getChildren:function(){return [];},_getSelectedOptionsAttr:function(){return this.getOptions(this.get("value"));},_pseudoLoadChildren:function(){},onSetStore:function(){}});});},"url:epi/cms/contentediting/templates/PageDataController.html":"<div style=\"width: 100%; height: 100%;\">\r\n    <div data-dojo-attach-point=\"layoutContainer\" data-dojo-type=\"dijit.layout.BorderContainer\" data-dojo-props=\"gutters: false, livesplitters: false\" style=\"width: 100%; height: 100%\">\r\n        <div data-dojo-attach-point=\"toolbarContainer\" data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-props=\"region:'top'\">\r\n            <div data-dojo-attach-point=\"toolbar\" data-dojo-type=\"epi.cms.contentediting.EditToolbar\"></div>\r\n            <div data-dojo-attach-point=\"notificationBar\" data-dojo-type=\"epi.cms.contentediting.NotificationBar\"></div>\r\n        </div>\r\n        <div data-dojo-attach-point=\"iframeWithOverlay\" data-dojo-type=\"epi.shell.widget.IframeWithOverlay\" data-dojo-props=\"region: 'center'\"></div>\r\n    </div>\r\n</div>","url:epi/cms/widget/templates/TooltipDialog.html":"<div class=\"epi-dijitTooltipDialog\" role=\"presentation\" tabindex=\"-1\">\r\n    <div class=\"dijitTooltipContainer epi-dijitTooltipContainer\" role=\"presentation\">\r\n        <div class=\"dijitTooltipContents dijitTooltipFocusNode epi-dijitTooltipContents\" data-dojo-attach-point=\"containerNode\" role=\"dialog\"></div>\r\n    </div>\r\n    <div class=\"dijitTooltipConnector epi-dijitTooltipConnector\" data-dojo-attach-point=\"connectorNode\" role=\"presentation\"></div>\r\n</div>","dgrid/List":function(){define("dgrid/List",["dojo/_base/array","dojo/_base/kernel","dojo/_base/declare","dojo/on","dojo/has","./util/misc","dojo/has!touch?./TouchScroll","xstyle/has-class","put-selector/put","dojo/_base/sniff","xstyle/css!./css/dgrid.css"],function(_83,_84,_85,_86,has,_87,_88,_89,put){_89("mozilla","opera","webkit","ie","ie-6","ie-6-7","quirks","no-quirks","touch");var _8a;var _8b=put(document.getElementsByTagName("head")[0],"style"),_8c=[],_8d="dgrid-row-odd",_8e="dgrid-row-even";_8b=_8b.sheet||_8b.styleSheet;function _8f(_90,css){var _91=_8c.length;_8c[_91]=(_8b.cssRules||_8b.rules).length;_8b.addRule?_8b.addRule(_90,css):_8b.insertRule(_90+"{"+css+"}",_8c[_91]);return {remove:function(){_92(_91);}};};function _92(_93){var _94=_8c[_93],i,l=_8c.length;if(_94===undefined){return;}_8b.deleteRule?_8b.deleteRule(_94):_8b.removeRule(_94);_8c[_93]=undefined;for(i=_93;i<l;i++){if(_8c[i]>_94){_8c[i]--;}}};function _95(id){return document.getElementById(id);};function _96(_97,_98,_99,_9a){var _9b,_9c,_9d;_9d=_9c=_97.element;_98=_98||1;do{if(_9b=_9c[_98<0?"previousSibling":"nextSibling"]){do{_9c=_9b;if(((_9c&&_9c.className)+" ").indexOf(_99+" ")>-1){_9d=_9c;_98+=_98<0?1:-1;break;}}while(_9b=(!_9a||!_9c.hidden)&&_9c[_98<0?"lastChild":"firstChild"]);}else{if((_9c=_9c.parentNode)==this.domNode||(_9c.className+" ").indexOf("dgrid-row ")>-1){break;}}}while(_98);return _9d;};var _9e=0;function _9f(){return "dgrid_"+_9e++;};var _a0=has("ie")<7&&!has("quirks")?function(_a1){var _a2,w,h,_a3;if(!_a1._started){return;}_a2=document.documentElement;w=_a2.clientWidth;h=_a2.clientHeight;_a3=_a1._prevWinDims||[];if(_a3[0]!==w||_a3[1]!==h){_a1.resize();_a1._prevWinDims=[w,h];}}:function(_a4){_a4._started&&_a4.resize();};return _85(_88?[_88]:[],{tabableHeader:false,showHeader:false,showFooter:false,maintainOddEven:true,postscript:function(_a5,_a6){var _a7=this;(this._Row=function(id,_a8,_a9){this.id=id;this.data=_a8;this.element=_a9;}).prototype.remove=function(){_a7.removeRow(this.element);};if(_a6){this.srcNodeRef=_a6=_a6.nodeType?_a6:_95(_a6);}this.create(_a5,_a6);},listType:"list",create:function(_aa,_ab){if(_aa){this.params=_aa;_85.safeMixin(this,_aa);this._sort=_aa.sort||[];delete this.sort;}else{this._sort=[];}var _ac=this.domNode=_ab||put("div");this.observers=[];this._listeners=[];this._rowIdToObject={};this.postMixInProperties&&this.postMixInProperties();this.id=_ac.id=_ac.id||this.id||_9f();this.buildRendering();this.postCreate&&this.postCreate();delete this.srcNodeRef;if(this.domNode.offsetHeight){this.startup();}},buildRendering:function(){var _ad=this.domNode,_ae=this,_af,_b0,_b1,_b2,_b3;_b3=this.isRTL=(document.body.dir||document.documentElement.dir||document.body.style.direction).toLowerCase()=="rtl";put(_ad,"[role=grid].ui-widget.dgrid.dgrid-"+this.listType);_af=this.headerNode=put(_ad,"div.dgrid-header.dgrid-header-row.ui-widget-header"+(this.showHeader?"":".dgrid-header-hidden"));if(has("quirks")||has("ie")<8){_b0=put(_ad,"div.dgrid-spacer");}_b1=this.bodyNode=this.touchNode=put(_ad,"div.dgrid-scroller");_b1.tabIndex=-1;this.headerScrollNode=put(_ad,"div.dgrid-header-scroll.dgrid-scrollbar-width.ui-widget-header");_b2=this.footerNode=put("div.dgrid-footer");if(!this.showFooter){_b2.style.display="none";}put(_ad,_b2);if(_b3){_ad.className+=" dgrid-rtl"+(has("webkit")?"":" dgrid-rtl-nonwebkit");}_86(_b1,"scroll",function(_b4){_af.scrollLeft=_b1.scrollLeft;_b4.stopPropagation();_86.emit(_ad,"scroll",{scrollTarget:_b1});});this.configStructure();this.renderHeader();this.contentNode=put(this.bodyNode,"div.dgrid-content.ui-widget-content");this._listeners.push(this._resizeHandle=_86(window,"resize",_87.debounce(_a0)));},startup:function(){this.inherited(arguments);if(this._started){return;}this._started=true;this.resize();this.set("sort",this._sort);},configStructure:function(){},resize:function(){var _b5=this.bodyNode,_b6=this.headerNode,_b7=this.footerNode,_b8=_b6.offsetHeight,_b9=this.showFooter?_b7.offsetHeight:0,_ba=has("quirks")||has("ie")<7;this.headerScrollNode.style.height=_b5.style.marginTop=_b8+"px";if(_b9){_b5.style.marginBottom=_b9+"px";}if(_ba){_b5.style.height="";_b5.style.height=Math.max((this.domNode.offsetHeight-_b8-_b9),0)+"px";if(_b9){_b7.style.bottom="1px";setTimeout(function(){_b7.style.bottom="";},0);}}if(!_8a){var _bb=put(document.body,"div.dgrid-scrollbar-measure");_8a=_bb.offsetWidth-_bb.clientWidth;put(_bb,"!");if(has("ie")===7){_8a++;}this.addCssRule(".dgrid-scrollbar-width","width: "+_8a+"px");this.addCssRule(".dgrid-scrollbar-height","height: "+_8a+"px");if(_8a!=17&&!_ba){this.addCssRule(".dgrid-header","right: "+_8a+"px");this.addCssRule(".dgrid-rtl-nonwebkit .dgrid-header","left: "+_8a+"px");}}if(_ba){_b6.style.width=_b5.clientWidth+"px";setTimeout(function(){_b6.scrollLeft=_b5.scrollLeft;},0);}},addCssRule:_8f,on:function(_bc,_bd){var _be=_86(this.domNode,_bc,_bd);if(!has("dom-addeventlistener")){this._listeners.push(_be);}return _be;},cleanup:function(){var _bf=this.observers,i;for(i in this._rowIdToObject){if(this._rowIdToObject[i]!=this.columns){var _c0=_95(i);if(_c0){this.removeRow(_c0,true);}}}for(i=0;i<_bf.length;i++){var _c1=_bf[i];_c1&&_c1.cancel();}this.observers=[];this.preload=null;},destroy:function(){for(var i=this._listeners.length;i--;){this._listeners[i].remove();}delete this._listeners;this.cleanup();put("!",this.domNode);},refresh:function(){this.cleanup();this._rowIdToObject={};this._autoId=0;this.contentNode.innerHTML="";},newRow:function(_c2,_c3,to,_c4){if(_c3.parentNode){var i=_c4.start+to;var row=this.insertRow(_c2,_c3.parentNode,_c3,i,_c4);put(row,".ui-state-highlight");setTimeout(function(){put(row,"!ui-state-highlight");},250);return row;}},adjustRowIndices:function(_c5){if(this.maintainOddEven){var _c6=_c5;var _c7=_c6.rowIndex;do{if(_c6.rowIndex>-1){put(_c6,"."+(_c7%2==1?_8d:_8e)+"!"+(_c7%2==0?_8d:_8e));_c6.rowIndex=_c7++;}}while((_c6=_c6.nextSibling)&&_c6.rowIndex!=_c7);}},renderArray:function(_c8,_c9,_ca){_ca=_ca||{};var _cb=this,_cc=_ca.start||0,row,_cd,_ce;if(!_c9){this._lastCollection=_c8;}if(_c8.observe){var _cf=this.observers.push(_c8.observe(function(_d0,_d1,to){var _d2;if(_d1>-1&&_cd[_d1]){row=_cd.splice(_d1,1)[0];if(row.parentNode==_ce){_d2=row.nextSibling;if(_d2){_d2.rowIndex--;_cb.removeRow(row);}}if(_cb._processScroll){_cb._processScroll();}}if(to>-1){row=_cb.newRow(_d0,_cd[to]||_c9.parentNode?_c9:(_cd[to-1]&&_cd[to-1].nextSibling),to,_ca);if(row){row.observerIndex=_cf;_cd.splice(to,0,row);if(!_d2||to<_d2.rowIndex){_d2=row;}}_ca.count++;}_d1!=to&&_d2&&_cb.adjustRowIndices(_d2);},true))-1;}var _d3=document.createDocumentFragment();if(_c8.map){_cd=_c8.map(_d4,console.error);if(_cd.then){return _cd.then(_d5);}}else{_cd=[];for(var i=0,l=_c8.length;i<l;i++){_cd[i]=_d4(_c8[i]);}}var _d6;function _d4(_d7){_d6=_cb.insertRow(_d7,_d3,null,_cc++,_ca);_d6.observerIndex=_cf;return _d6;};function _d5(_d8){_ce=_c9?_c9.parentNode:_cb.contentNode;if(_ce){_ce.insertBefore(_d3,_c9||null);_d6=_d8[_d8.length-1];_d6&&_cb.adjustRowIndices(_d6);}return (_cd=_d8);};return _d5(_cd);},renderHeader:function(){},_autoId:0,insertRow:function(_d9,_da,_db,i,_dc){var id=this.id+"-row-"+((this.store&&this.store.getIdentity)?this.store.getIdentity(_d9):this._autoId++);var row=_95(id);if(!row||(_db&&row.parentNode!=_db.parentNode)){if(row){this.removeRow(row);}row=this.renderRow(_d9,_dc);row.className=(row.className||"")+" ui-state-default dgrid-row "+(i%2==1?_8d:_8e);this._rowIdToObject[row.id=id]=_d9;}_da.insertBefore(row,_db);row.rowIndex=i;return row;},renderRow:function(_dd,_de){return put("div",""+_dd);},removeRow:function(_df,_e0){_df=_df.element||_df;delete this._rowIdToObject[_df.id];if(!_e0){put(_df,"!");}},row:function(_e1){var id;if(_e1 instanceof this._Row){return _e1;}if(_e1.target&&_e1.target.nodeType){_e1=_e1.target;}if(_e1.nodeType){var _e2;do{var _e3=_e1.id;if((_e2=this._rowIdToObject[_e3])){return new this._Row(_e3.substring(this.id.length+5),_e2,_e1);}_e1=_e1.parentNode;}while(_e1&&_e1!=this.domNode);return;}if(typeof _e1=="object"){id=this.store.getIdentity(_e1);}else{id=_e1;_e1=this._rowIdToObject[this.id+"-row-"+id];}return new this._Row(id,_e1,_95(this.id+"-row-"+id));},cell:function(_e4){return {row:this.row(_e4)};},_move:_96,up:function(row,_e5,_e6){return this.row(_96(row,-(_e5||1),"dgrid-row",_e6));},down:function(row,_e7,_e8){return this.row(_96(row,_e7||1,"dgrid-row",_e8));},get:function(_e9){var fn="_get"+_e9.charAt(0).toUpperCase()+_e9.slice(1);if(typeof this[fn]==="function"){return this[fn].apply(this,[].slice.call(arguments,1));}if(!1&&typeof this[fn+"Attr"]==="function"){}return this[_e9];},set:function(_ea,_eb){if(typeof _ea==="object"){for(var k in _ea){this.set(k,_ea[k]);}}else{var fn="_set"+_ea.charAt(0).toUpperCase()+_ea.slice(1);if(typeof this[fn]==="function"){this[fn].apply(this,[].slice.call(arguments,1));}else{if(!1&&typeof this[fn+"Attr"]==="function"){}this[_ea]=_eb;}}return this;},_setSort:function(_ec,_ed){this._sort=typeof _ec!="string"?_ec:[{attribute:_ec,descending:_ed}];this.refresh();if(this._lastCollection){if(_ec.length){if(typeof _ec!="string"){_ed=_ec[0].descending;_ec=_ec[0].attribute;}this._lastCollection.sort(function(a,b){var _ee=a[_ec],_ef=b[_ec];if(_ee===undefined){_ee="";}if(_ef===undefined){_ef="";}return _ee==_ef?0:(_ee>_ef==!_ed?1:-1);});}this.renderArray(this._lastCollection);}},sort:function(_f0,_f1){_84.deprecated("sort(...)","use set(\"sort\", ...) instead","dgrid 1.0");this.set("sort",_f0,_f1);},_getSort:function(){return this._sort;},_setShowHeader:function(_f2){this.showHeader=_f2;put(this.headerNode,(_f2?"!":".")+"dgrid-header-hidden");this.renderHeader();this.resize();},setShowHeader:function(_f3){_84.deprecated("setShowHeader(...)","use set(\"showHeader\", ...) instead","dgrid 1.0");this.set("showHeader",_f3);}});});},"epi/cms/contentediting/command/Translate":function(){define(["dojo/_base/declare","epi/cms/command/_TranslateContent"],function(_f4,_f5){return _f4([_f5],{_execute:function(){this._executeCommand(this.model.contentData);},_onModelChange:function(){this._canExecute(this.model.contentData,this.model.contentData.capabilities,this.model.languageContext);}});});},"epi/cms/component/CreateContent":function(){require({cache:{"url:epi/cms/component/templates/CreateContent.html":"<div class=\"epi-createContent\">\r\n    <div class=\"epi-listingTopContainer\" data-dojo-attach-point=\"selectTypeNode\">\r\n        <h1 data-dojo-attach-point=\"titleNode\"></h1>\r\n        <div class=\"epi-breadCrumb\" data-dojo-attach-point=\"breadcrumbNode\" data-dojo-type=\"epi.cms.widget.Breadcrumb\" data-dojo-props=\"showLastBracket:true\"></div>\r\n        <label data-dojo-attach-point=\"contentNameLabelNode\"></label>\r\n        <input type=\"text\" size=\"40\" data-dojo-attach-point=\"contentNameNode\" data-dojo-type=\"dijit.form.TextBox\" />\r\n        <div class=\"epi-cancelLink\">\r\n            <button data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"cancelButton\" data-dojo-attach-event=\"onClick: _onCancelClick\">${resources.cancel}</button>\r\n        </div>\r\n    </div>\r\n    <div class=\"epi-listingTopContainer\" data-dojo-attach-point=\"requiredPropertiesNode\" style=\"display:none\">\r\n        <h1 data-dojo-attach-point=\"selectedTypeTitle\"></h1>\r\n        <div data-dojo-attach-point=\"breadcrumbRequiredNode\" data-dojo-type=\"epi.cms.widget.Breadcrumb\"></div>\r\n        <span class=\"epi-contentName\" data-dojo-attach-point=\"contentName\"></span>\r\n    </div>\r\n    <div data-dojo-attach-point=\"stackContainer\">\r\n        <h4 data-dojo-attach-point=\"requiredPropTitleNode\" class=\"epi-formsDescriptionHeader\"></h4>\r\n    </div>\r\n</div>"}});define("epi/cms/component/CreateContent",["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/_base/window","dojo/dom-attr","dojo/dom-geometry","dojo/dom-style","dojo/dom-class","dojo/dom-construct","dojo/topic","dijit/_Widget","dijit/layout/StackContainer","dijit/form/Button","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","epi","epi/cms/_ContentContextMixin","epi/cms/widget/ContentTypeList","epi/dependency","epi/shell/widget/dialog/Alert","epi/string","epi/shell/widget/FormContainer","epi/cms/component/ContentFilter","epi/cms/contentediting/ContentModelServerSync","epi/cms/widget/Breadcrumb","epi/cms/contentediting/NewContentNameInputDialog","epi/shell/widget/dialog/Dialog","epi/cms/core/ContentReference","dojo/text!./templates/CreateContent.html","epi/i18n!epi/cms/nls/shell.common.buttons","epi/i18n!epi/cms/nls/episerver.cms.components.requiredproperties"],function(_f6,_f7,_f8,_f9,win,_fa,_fb,_fc,_fd,_fe,_ff,_100,_101,_102,_103,_104,epi,_105,_106,_107,_108,_109,_10a,_10b,_10c,_10d,_10e,_10f,_110,_111,_112,_113){return _f7("epi.cms.component.CreateContent",[_100,_103,_104,_105],{resources:_112,contentTypeList:null,templateString:_111,container:null,selectedContentType:null,contentDataStore:null,parentContent:null,metadataManager:null,defaultContainerWidget:"epi.cms.widget.CreateContentFormLayout",res:null,requestedTypes:[],type:null,skipContentTypeSelection:false,requiredPropertiesTitleNode:null,saveButton:null,postMixInProperties:function(){this.inherited(arguments);var _114=_107.resolve("epi.storeregistry");if(!this.contentDataStore){this.contentDataStore=_114.get("epi.cms.contentdata");}if(!this.contentVersionStore){this.contentVersionStore=_114.get("epi.cms.contentversion");}if(!this.metadataManager){this.metadataManager=_107.resolve("epi.shell.MetadataManager");}},postCreate:function(){this.container=new _101({"class":"epi-newContentContainer"},this.stackContainer);if(!this.skipContentTypeSelection){var list=new _106({onContentTypeSelected:_f9.hitch(this,this._onContentTypeSelected),requestedTypes:this.requestedTypes,type:this.type});this.contentTypeList=list;this.container.selectedChildWidget=list;this.container.addChild(list);}_fa.set(this.requiredPropTitleNode,"innerHTML",_113.title);},destroy:function(){if(this.container){this.container.destroyRecursive();delete this.container;}this.inherited(arguments);},resize:function(_115){if(_115){_fb.setMarginBox(this.domNode,_115);}},_setContentNameTextBoxDefaultName:function(){this.contentNameNode.set("value",this.res.defaultname);this.contentNameNode.focus();this.contentNameNode.focusNode.select();},updateView:function(data){this.addToDestination=null;for(var key in data){this.set(key,data[key]);}this._setContentNameTextBoxDefaultName();if(this._formContainer){this.container.removeChild(this._formContainer);this._formContainer.destroyRecursive();this._formContainer=null;this.container.selectChild(this.contentTypeList);this._changeTitle();}if(this.saveButton){_fc.set(this.saveButton.domNode,"display","none");this.saveButton.set("disabled",true);}_fc.set(this.requiredPropTitleNode,"display","none");_fd.remove(this.stackContainer,"epi-containerLayout");_fd.add(this.stackContainer,"epi-newContentContainer");},getContentName:function(){var _116=this.contentNameNode.get("value");return _f9.trim(_116);},_setRequestedTypesAttr:function(_117){this.requestedTypes=_117;if(this.contentTypeList){this.contentTypeList.set("requestedTypes",_117);}},_setTypeAttr:function(_118){this.type=_118;if(this.contentTypeList){this.contentTypeList.set("type",_118);}},_setResAttr:function(_119){this.res=_119;this._setupWidgetTemplate();},_setupWidgetTemplate:function(){_fa.set(this.titleNode,"innerHTML",this.res.title);_fa.set(this.contentNameLabelNode,"innerHTML",epi.resources.header.name);if(this.saveButton){this.saveButton.set("label",epi.resources.action.done);}},_setParentAttr:function(_11a){if(this.contentTypeList){this.contentTypeList.set("parent",_11a);}this.breadcrumbNode.set("contentLink",_11a.contentLink);this.breadcrumbRequiredNode.set("content",_11a);this.parentContent=_11a;},_onContentTypeSelected:function(item){var _11b=function(name,item,_11c){_11c._tryCreateContent(name,item);_11c.contentTypeList.clear();};this.selectedContentType=item;var _11d=this.getContentName();if(_11d.length>0){if(_11d==this.res.defaultname){var _11e=new _10e({defaultContentName:this.res.defaultname});var _11f=new _10f({defaultActionsVisible:false,content:_11e,title:_11e.title});dojo.connect(_11f,"onExecute",_f9.hitch(this,function(){var name=_11e.get("value");this.contentNameNode.set("value",name);_11b(name,item,this);}));_11f.show();}else{_11b(_11d,item,this);}}else{this._showNotificationMessage(this.res.emptynameerror);}},_onButtonSaveClick:function(_120){this.saveButton.set("disabled",true);if(this._formContainer.validate()){_120.properties=this._formContainer.get("value");this._saveContentChanges(_120);}else{this.saveButton.set("disabled",false);}},_onCancelClick:function(){_f8.when(this.getCurrentContent(),_f9.hitch(this,function(_121){this._redirectToViewMode(_121.contentLink);}));},_tryCreateContent:function(name,_122){var _123={name:name,parentLink:this.parentContent.contentLink,contentTypeId:_122.id};_f8.when(this._getNewContentMetadata(_123.parentLink,_123.contentTypeId),_f9.hitch(this,function(_124){var _125=_f6.filter(_124.properties,_f9.hitch(this,function(prop){return this._filterMandatoryProperties(_124,prop);}));if(_125.length<=0){this._saveContentChanges(_123);}else{_123.resourceFolderId=_124.additionalValues.resourceFolderId;this._editMandatoryProperties(_124,_123);}}));},_redirectToViewMode:function(_126){_ff.publish("/epi/shell/context/request",{uri:"epi.cms.contentdata:///"+_126},{sender:this});},_saveContentChanges:function(_127){var _128=function(_129){this.contentDataStore.refresh(_129);var _12a=new _110(_129);if(this.addToDestination){this.addToDestination.save({contentLink:_12a.createVersionUnspecificReference().toString(),name:_127.name});_ff.publish("/epi/shell/action/changeview","epi/cms/contentediting/PageDataController",null);}else{this._redirectToViewMode(_12a.createVersionUnspecificReference());}};var _12b=function(_12c){if(this.saveButton){this.saveButton.set("disabled",false);}};_f8.when(this.contentDataStore.put(_127),_f9.hitch(this,_128),_f9.hitch(this,_12b));},_changeTitle:function(){if(this.container.selectedChildWidget&&this.container.selectedChildWidget.declaredClass=="epi.cms.widget.ContentTypeList"){_fc.set(this.selectTypeNode,"display","block");_fc.set(this.requiredPropertiesNode,"display","none");}else{_fc.set(this.selectTypeNode,"display","none");_fc.set(this.requiredPropertiesNode,"display","block");}},_editMandatoryProperties:function(_12d,_12e){_12d.layoutType=this.defaultContainerWidget;this._formContainer=this._setupForm(_12d);this._formContainer.startup();this.container.addChild(this._formContainer);this.container.forward();this._changeTitle();this.contentName.innerHTML="";this.contentName.appendChild(win.doc.createTextNode(this.getContentName()));this.selectedTypeTitle.innerHTML=this.res.contenttypetitle.replace("{0}",this.selectedContentType.localizedName);if(!this.saveButton){this.saveButton=new _102({label:epi.resources.action.done});}_fc.set(this.saveButton.domNode,"display","");this.saveButton.onClick=_f9.hitch(this,"_onButtonSaveClick",_12e);this.saveButton.set("disabled",false);this.saveButton.placeAt(this.container,"last");_fd.add(this.stackContainer,"epi-containerLayout");_fd.remove(this.stackContainer,"epi-newContentContainer");_fc.set(this.requiredPropTitleNode,"display","");},_filterMandatoryProperties:function(_12f,_130){var _131=_f6.filter(_12f.groups,function(_132){return _132.displayui===false;});var _133=function(_134){if(_134.name=="PageName"||_134.name=="icontent_name"||!_134.showForEdit){return false;}var resp=_f6.some(_131,function(_135){return (_135.title===_134.groupName);});return !resp;};var _136=function(obj){return (_f9.isObject(obj)&&obj.properties.length>0?true:false);};var self=this;var _137=function(_138){var _139=false;_f6.forEach(_138,function(prop){if(_136(prop)){_139=_137(prop.properties);}else{if(self._isPropertyRequired(prop)){if(_133(prop)&&!prop.additionalValues.hasValue){_139=true;}}}});return _139;};if(_136(_130)){if(_137(_130.properties)){return true;}}else{if(self._isPropertyRequired(_130)){if(_133(_130)&&!_130.additionalValues.hasValue){return true;}}}return false;},_isPropertyRequired:function(_13a){return _13a.settings&&_13a.settings.required;},_setupForm:function(_13b){var _13c=_f9.hitch(this,function(_13d,_13e){});var _13f=_f9.hitch(this,function(_140){});return new _10a({metadata:_13b,propertyFilter:_f9.hitch(this,this._filterMandatoryProperties),onFieldCreated:_13c,onFormCreated:_13f});},_getNewContentMetadata:function(_141,_142){return this.metadataManager.getMetadataForType("EPiServer.Core.ContentData",{parentLink:_141,contentTypeId:_142});},_showNotificationMessage:function(_143){var _144=new _108({description:_109.toHTML(_143)});_144.show();}});});},"epi/cms/component/command/GlobalToolbarCommandProvider":function(){define("epi/cms/component/command/GlobalToolbarCommandProvider",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/topic","dijit/form/ToggleButton","dijit/layout/ContentPane","epi/cms/component/ContentFilter","epi/shell/command/_Command","epi/shell/command/ToggleCommand","epi/shell/widget/ExpandoButton","epi/cms/widget/ViewSettingsExpandoButton","epi/cms/widget/VisitorGroupButton","epi/cms/widget/ChannelsButton","epi/cms/widget/command/CreateNewPageSelector","epi/cms/widget/command/CreateNewBlockSelector","epi/cms/component/command/_GlobalToolbarCommandProvider","epi/i18n!epi/cms/nls/episerver.cms.contentediting","epi/i18n!epi/cms/nls/episerver.cms.components.createblock","epi/i18n!epi/cms/nls/episerver.cms.components.createpage"],function(_145,_146,lang,_147,_148,_149,_14a,_14b,_14c,_14d,_14e,_14f,_150,_151,_152,_153,_154,_155,_156){var _157=_145([_14c],{iconClass:"epi-iconTree",tooltip:_154.toolbar.buttons.togglenavigationpane,label:_154.toolbar.buttons.togglenavigationpane,canExecute:true,constructor:function(){_147.subscribe("/epi/layout/pinnable/navigation/visibilitychanged",lang.hitch(this,function(_158){this.set("active",_158);}));},_execute:function(){_147.publish("/epi/layout/pinnable/navigation/toggle");}});var _159=_145([_14c],{iconClass:"epi-iconFolder",tooltip:_154.toolbar.buttons.toggleassetspane,label:_154.toolbar.buttons.toggleassetspane,canExecute:true,constructor:function(){_147.subscribe("/epi/layout/pinnable/tools/visibilitychanged",lang.hitch(this,function(_15a){this.set("active",_15a);}));},_execute:function(){_147.publish("/epi/layout/pinnable/tools/toggle");}});var _15b=_145([_14b],{iconClass:"epi-iconEye",canExecute:true,label:_154.toolbar.buttons.viewsetting.viewsettingbutton,constructor:function(){_147.subscribe("/epi/shell/action/viewchanged",lang.hitch(this,function(type){this.set("isAvailable",type=="epi/cms/contentediting/PageDataController");}));}});var _15c=_145([_14c],{iconClass:"epi-iconPreview",tooltip:_154.toolbar.buttons.togglepreviewmode.label,label:_154.toolbar.buttons.togglepreviewmode.label,canExecute:true,constructor:function(){_147.subscribe("/epi/layout/pinnable/navigation/visibilitychanged",lang.hitch(this,function(_15d){if(!this._isExecuting){this.set("isNavigationVisible",_15d);}}));_147.subscribe("/epi/layout/pinnable/tools/visibilitychanged",lang.hitch(this,function(_15e){if(!this._isExecuting){this.set("isAssetsVisible",_15e);}}));_147.subscribe("/epi/cms/action/disablepreview",lang.hitch(this,function(){this.set("active",false);this._restoreSidePanels();}));_147.subscribe("/epi/shell/action/viewchanged",lang.hitch(this,function(type){this.set("isAvailable",type=="epi/cms/contentediting/PageDataController");}));},_restoreSidePanels:function(){_147.publish("/epi/layout/pinnable/navigation/toggle",this.active?false:this.isNavigationVisible);_147.publish("/epi/layout/pinnable/tools/toggle",this.active?false:this.isAssetsVisible);},_execute:function(){this._isExecuting=true;this.set("active",!this.active);this._restoreSidePanels();if(this.active){_147.publish("/epi/cms/action/displaypreview");}else{_147.publish("/epi/cms/action/switcheditmode",[true]);}this._isExecuting=false;}});var _15f=_145([_151],{order:10,iconClass:"epi-iconPage",label:_156.command.label});return _145([_153],{constructor:function(){this.addToLeading(new _157(),{widget:_148,"class":"epi-leadingToggleButton epi-mediumButton"});this.addCommand(new _15f(),{category:"create"});this.addCommand(new _152({order:20,iconClass:"epi-iconSharedBlock",label:_155.command.label}),{category:"create"});this.addCommand(new _15b(),{widget:_14e,showInGroup:true,buttons:[new _14f(),new _150()],category:"view"});this.addCommand(new _15c(),{widget:_14d,showInGroup:true,hasToggleableChildren:false,buttons:[new _149({iconClass:"",content:"<span>"+_154.toolbar.buttons.togglepreviewmode.message+"</span>"})],category:"view"});this.addToTrailing(new _159(),{widget:_148,"class":"epi-trailingToggleButton epi-mediumButton"});}});});},"epi/shell/selection":function(){define(["dojo/_base/declare","./StatefulArray"],function(_160,_161){return _160(_161,{data:null,constructor:function(){this.data=[];}});});},"dijit/form/_ListMouseMixin":function(){define("dijit/form/_ListMouseMixin",["dojo/_base/declare","dojo/_base/event","dojo/touch","./_ListBase"],function(_162,_163,_164,_165){return _162("dijit.form._ListMouseMixin",_165,{postCreate:function(){this.inherited(arguments);this.connect(this.domNode,_164.press,"_onMouseDown");this.connect(this.domNode,_164.release,"_onMouseUp");this.connect(this.domNode,"onmouseover","_onMouseOver");this.connect(this.domNode,"onmouseout","_onMouseOut");},_onMouseDown:function(evt){_163.stop(evt);if(this._hoveredNode){this.onUnhover(this._hoveredNode);this._hoveredNode=null;}this._isDragging=true;this._setSelectedAttr(this._getTarget(evt));},_onMouseUp:function(evt){_163.stop(evt);this._isDragging=false;var _166=this._getSelectedAttr();var _167=this._getTarget(evt);var _168=this._hoveredNode;if(_166&&_167==_166){this.onClick(_166);}else{if(_168&&_167==_168){this._setSelectedAttr(_168);this.onClick(_168);}}},_onMouseOut:function(){if(this._hoveredNode){this.onUnhover(this._hoveredNode);if(this._getSelectedAttr()==this._hoveredNode){this.onSelect(this._hoveredNode);}this._hoveredNode=null;}if(this._isDragging){this._cancelDrag=(new Date()).getTime()+1000;}},_onMouseOver:function(evt){if(this._cancelDrag){var time=(new Date()).getTime();if(time>this._cancelDrag){this._isDragging=false;}this._cancelDrag=null;}var node=this._getTarget(evt);if(!node){return;}if(this._hoveredNode!=node){if(this._hoveredNode){this._onMouseOut({target:this._hoveredNode});}if(node&&node.parentNode==this.containerNode){if(this._isDragging){this._setSelectedAttr(node);}else{this._hoveredNode=node;this.onHover(node);}}}}});});},"epi/cms/widget/VisitorGroupButton":function(){define("epi/cms/widget/VisitorGroupButton",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/Deferred","dojo/dom-class","dijit/DropDownMenu","dijit/form/DropDownButton","dijit/focus","epi","epi/dependency","epi/cms/widget/VisitorGroupsSelector","epi/i18n!epi/cms/nls/episerver.cms.widget.visitorgroupsbutton"],function(dojo,_169,lang,_16a,_16b,_16c,_16d,_16e,_16f,epi,_170,_171,_172){return _169("epi.cms.widget.VisitorGroupButton",[_16e],{_contextMenu:null,baseClass:"epi-mediumButton epi-chromelessButton",iconClass:"epi-iconUsers",contextMenuProperties:{},_visitorGroupsSelector:null,_viewSettingsManager:null,postMixInProperties:function(){this.inherited(arguments);lang.mixin(this.contextMenuProperties,{"class":"epi-DropDownMenu"});},postCreate:function(){this.inherited(arguments);this._viewSettingsManager=_170.resolve("epi.viewsettingsmanager");var _173=this._viewSettingsManager.getSettingProperty("visitorgroup");if(!this.dropDown){this.dropDown=dijit.DropDownMenu(this.contextMenuProperties);this._visitorGroupsSelector=new _171({checkedItem:_173});_16a.connect(this._visitorGroupsSelector,"onItemSelected",this,this._onVisitorGroupSelected);this._addChildren(this._visitorGroupsSelector);_16b.when(this._visitorGroupsSelector.isSetupFinished(),lang.hitch(this,function(_174){this._activeButton(!this._isDefaultSelection());this._updateTooltip();}));}_16a.connect(this.dropDown,"onOpen",this,function(e){_16f.focus(this._visitorGroupsSelector.menuNode.domNode);});},_updateTooltip:function(){var _175=null;if(this._isDefaultSelection()){_175=_172.defaulttooltip;}else{var _176=this._visitorGroupsSelector.currentSelectedItem;_175=lang.replace(_172.tooltip,{visitorgroup:_176.name});}this.set("title",_175);},_isDefaultSelection:function(){return this._visitorGroupsSelector.isDefaultItemSelected();},_onVisitorGroupSelected:function(_177){this._changeView(_177);},_changeView:function(_178){if(_178){if(_178.name==this._visitorGroupsSelector.defaultItem.name){_16a.publish("/epi/cms/action/viewsettingvaluechanged",["visitorgroup",null]);}else{_16a.publish("/epi/cms/action/viewsettingvaluechanged",["visitorgroup",_178.id]);}}this._activeButton(!this._isDefaultSelection());this._updateTooltip();},_addChildren:function(item){this.dropDown.addChild(item);},_activeButton:function(_179){if(!this.dropDown){return;}if(_179){_16c.add(this.domNode,"dijitChecked");}else{_16c.remove(this.domNode,"dijitChecked");}}});});},"epi/shell/command/_WidgetCommandConsumerMixin":function(){define(["dojo/_base/declare","epi/shell/command/_CommandConsumerMixin","epi/shell/command/_WidgetCommandProviderMixin"],function(_17a,_17b,_17c){return _17a([_17b,_17c],{});});},"url:epi/shell/widget/dialog/templates/LightWeight.html":"<div class=\"epi-lfw-dialog dijitDialog\" role=\"dialog\" aria-labelledby=\"${id}_title\">\r\n    <div data-dojo-attach-point=\"titleBar\" class=\"dijitDialogTitleBar\">\r\n        <span data-dojo-attach-point=\"titleNode\" class=\"dijitDialogTitle\" id=\"${id}_title\"></span>\r\n         <span data-dojo-attach-point=\"closeButtonNode\" class=\"dijitDialogCloseIcon\" data-dojo-attach-event=\"ondijitclick: onButtonClose\" title=\"${buttonCloseText}\" role=\"button\" tabIndex=\"-1\">\r\n            <span data-dojo-attach-point=\"closeText\" class=\"closeText\" title=\"${buttonCloseText}\">x</span>\r\n        </span>\r\n    </div>\r\n    <div class=\"dijitDialogPaneContent\">\r\n        <div data-dojo-attach-point=\"containerNode\" class=\"dijitDialogPaneContentArea\" data-dojo-attach-event=\"onclick:_onContainerNodeClick\"></div>\r\n        <div data-dojo-attach-point=\"buttonContainerNode\" class=\"dijitDialogPaneActionBar clearfix\">\r\n            <button data-dojo-attach-point=\"doneButtonNode\" data-dojo-type=\"dijit.form.Button\" type=\"button\">${buttonDoneText}</button>\r\n        </div>\r\n    </div>\r\n</div>\r\n","epi/cms/widget/FolderTreeStoreModel":function(){define("epi/cms/widget/FolderTreeStoreModel",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/Deferred","dojo/aspect","epi/dependency","epi/cms/contentediting/ContentActionSupport","epi/cms/widget/sharedContentDialogHandler","epi/cms/widget/ContentTreeStoreModel"],function(_17d,lang,_17e,_17f,_180,_181,_182,_183,_184){return _17d("epi.cms.widget.FolderTreeStoreModel",_184,{typeIdentifiers:["epi.cms.folder"],_dataStore:null,childrenChangedTopic:"/epi/cms/blocktree/childrenchanged",constructor:function(){var _185=_181.resolve("epi.storeregistry");this._dataStore=_185.get("epi.cms.contentdata");this._subscribeHandle=dojo.subscribe(this.childrenChangedTopic,lang.hitch(this,this._childrenChanged));},destroy:function(){this.inherited(arguments);if(this._subscribeHandle){this._subscribeHandle.remove();}},_childrenChanged:function(_186,_187){var dfd=this.inherited(arguments);dfd.then(lang.hitch(this,function(){if(_187){this._select(_187);}}));return dfd;},add:function(item){this._dataStore.add(item).then(lang.hitch(this,this.onAdd));},rename:function(id,_188){var _189={id:id,properties:_188};var def=new _17f();_17f.when(this._dataStore.patch(_189,{id:_189.id}),lang.hitch(this,function(item){_17f.when(this._dataStore.patchCache({contentLink:_189.id,properties:_189.properties,capabilities:{supportsVersions:false}}),function(){def.resolve(item);},function(){def.cancel();});}),function(){def.cancel();});return def;},getRoot:function(_18a,_18b){if(!this.root){_17f.when(this.store.query({typeIdentifiers:this.typeIdentifiers}),lang.hitch(this,function(_18c){this.root={children:_18c,isRoot:true,label:"Folder root",id:"folder ID"};_18a(this.root);}),_18b);}else{_18a(this.root);}},getChildren:function(_18d,_18e){if(_18d===this.root){if(this.root.children){_18e(this.root.children);}else{_17f.when(this.store.query({typeIdentifiers:this.typeIdentifiers}),lang.hitch(this,function(_18f){this.root.children=_18f;_18e(_18f);}));}}else{this.inherited(arguments);}},_getAncestors:function(_190){var _191=_17e.some(_190,lang.hitch(this,function(_192){if(!this.root){return false;}return _17e.some(this.root.children,function(_193){return _193.contentLink===_192.contentLink;});}));if(_191){_190.unshift(this.root);return this.inherited(arguments);}return this.inherited(arguments);},getIdentity:function(item){return (item===this.root)?this.root:this.inherited(arguments);},getLabel:function(item){return (item===this.root)?this.root.label:this.inherited(arguments);},canPaste:function(item,_194,_195){var _196=_182.hasAccess(_194.accessMask,_182.accessLevel.Create);if(!_196||_195){return _196;}if(this._isParent(item,_194)){return false;}return _17f.when(this.isAncestor(item,_194),function(_197){return !_197;});},copy:function(_198,_199){return _17f.when(this.inherited(arguments),lang.hitch(this,function(_19a){this._childrenChanged(_199,_199.contentLink);return _19a;}));},move:function(_19b,_19c){return _17f.when(this.inherited(arguments),lang.hitch(this,function(_19d){this._childrenChanged(_19c,_19c.contentLink);return _19d;}));},onAdd:function(){},select:function(item){},_select:function(_19e){if(_19e){_17f.when(this.store.get(_19e),lang.hitch(this,function(item){this.select(item);}));}},onDeleted:function(item){if(item&&item.parentLink){this._select(item.parentLink);}},_isParent:function(_19f,_1a0){if(!_19f.parentLink){return false;}return (_19f.parentLink==_1a0.contentLink);}});});},"dojox/encoding/digests/SHA1":function(){define("dojox/encoding/digests/SHA1",["./_base"],function(dxd){var _1a1=8,mask=(1<<_1a1)-1;function R(n,c){return (n<<c)|(n>>>(32-c));};function FT(t,b,c,d){if(t<20){return (b&c)|((~b)&d);}if(t<40){return b^c^d;}if(t<60){return (b&c)|(b&d)|(c&d);}return b^c^d;};function KT(t){return (t<20)?1518500249:(t<40)?1859775393:(t<60)?-1894007588:-899497514;};function core(x,len){x[len>>5]|=128<<(24-len%32);x[((len+64>>9)<<4)+15]=len;var w=new Array(80),a=1732584193,b=-271733879,c=-1732584194,d=271733878,e=-1009589776;for(var i=0;i<x.length;i+=16){var olda=a,oldb=b,oldc=c,oldd=d,olde=e;for(var j=0;j<80;j++){if(j<16){w[j]=x[i+j];}else{w[j]=R(w[j-3]^w[j-8]^w[j-14]^w[j-16],1);}var t=dxd.addWords(dxd.addWords(R(a,5),FT(j,b,c,d)),dxd.addWords(dxd.addWords(e,w[j]),KT(j)));e=d;d=c;c=R(b,30);b=a;a=t;}a=dxd.addWords(a,olda);b=dxd.addWords(b,oldb);c=dxd.addWords(c,oldc);d=dxd.addWords(d,oldd);e=dxd.addWords(e,olde);}return [a,b,c,d,e];};function hmac(data,key){var wa=_1a2(key);if(wa.length>16){wa=core(wa,key.length*_1a1);}var ipad=new Array(16),opad=new Array(16);for(var i=0;i<16;i++){ipad[i]=wa[i]^909522486;opad[i]=wa[i]^1549556828;}var hash=core(ipad.concat(_1a2(data)),512+data.length*_1a1);return core(opad.concat(hash),512+160);};function _1a2(s){var wa=[];for(var i=0,l=s.length*_1a1;i<l;i+=_1a1){wa[i>>5]|=(s.charCodeAt(i/_1a1)&mask)<<(32-_1a1-i%32);}return wa;};function _1a3(wa){var h="0123456789abcdef",s=[];for(var i=0,l=wa.length*4;i<l;i++){s.push(h.charAt((wa[i>>2]>>((3-i%4)*8+4))&15),h.charAt((wa[i>>2]>>((3-i%4)*8))&15));}return s.join("");};function _1a4(wa){var s=[];for(var i=0,l=wa.length*32;i<l;i+=_1a1){s.push(String.fromCharCode((wa[i>>5]>>>(32-_1a1-i%32))&mask));}return s.join("");};function _1a5(wa){var p="=",tab="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=[];for(var i=0,l=wa.length*4;i<l;i+=3){var t=(((wa[i>>2]>>8*(3-i%4))&255)<<16)|(((wa[i+1>>2]>>8*(3-(i+1)%4))&255)<<8)|((wa[i+2>>2]>>8*(3-(i+2)%4))&255);for(var j=0;j<4;j++){if(i*8+j*6>wa.length*32){s.push(p);}else{s.push(tab.charAt((t>>6*(3-j))&63));}}}return s.join("");};dxd.SHA1=function(data,_1a6){var out=_1a6||dxd.outputTypes.Base64;var wa=core(_1a2(data),data.length*_1a1);switch(out){case dxd.outputTypes.Raw:return wa;case dxd.outputTypes.Hex:return _1a3(wa);case dxd.outputTypes.String:return _1a4(wa);default:return _1a5(wa);}};dxd.SHA1._hmac=function(data,key,_1a7){var out=_1a7||dxd.outputTypes.Base64;var wa=hmac(data,key);switch(out){case dxd.outputTypes.Raw:return wa;case dxd.outputTypes.Hex:return _1a3(wa);case dxd.outputTypes.String:return _1a4(wa);default:return _1a5(wa);}};return dxd.SHA1;});},"epi/cms/store/CustomQueryEngine":function(){define("epi/cms/store/CustomQueryEngine",["dojo/_base/array"],function(_1a8){return function(_1a9,_1aa){switch(typeof _1a9){case "object":case "undefined":var _1ab=_1a9;_1a9=function(_1ac){for(var key in _1ab){if(_1aa&&_1aa.ignore){var _1ad;for(var _1ae in _1aa.ignore){if(key==_1aa.ignore[_1ae]){_1ad=true;break;}}if(_1ad){_1ad=false;continue;}}var _1af=_1ab[key];if(_1aa&&_1aa.comparers&&_1aa.comparers[key]){if(!_1aa.comparers[key](_1af,_1ac)){return false;}}else{if(_1af&&_1af.test){if(!_1af.test(_1ac[key])){return false;}}else{if(_1af&&_1af!=_1ac[key]){return false;}}}}return true;};break;case "string":if(!this[_1a9]){throw new Error("No filter function "+_1a9+" was found in store");}_1a9=this[_1a9];break;case "function":break;default:throw new Error("Can not query with a "+typeof _1a9);}function _1b0(_1b1){var _1b2=_1a8.filter(_1b1,_1a9);if(_1aa&&_1aa.sort){_1b2.sort(function(a,b){for(var sort,i=0;sort=_1aa.sort[i];i++){var _1b3=a[sort.attribute];var _1b4=b[sort.attribute];if(_1b3!=_1b4){return sort.descending==(_1b3>_1b4)?-1:1;}}return 0;});}if(_1aa&&(_1aa.start||_1aa.count)){var _1b5=_1b2.length;_1b2=_1b2.slice(_1aa.start||0,(_1aa.start||0)+(_1aa.count||Infinity));_1b2.total=_1b5;}return _1b2;};_1b0.matches=_1a9;return _1b0;};});},"epi/cms/contentediting/InUseNotificationManager":function(){define("epi/cms/contentediting/InUseNotificationManager",["dojo","dojo/_base/array","dojo/_base/declare","dojo/date","dojo/aspect","epi","epi/dependency","epi/datetime","epi/cms/core/ContentReference","epi/i18n!epi/cms/nls/episerver.cms.contentediting.permanenteditindication"],function(dojo,_1b6,_1b7,_1b8,_1b9,epi,_1ba,_1bb,_1bc,res){return _1b7([],{contextTypeName:"",_postFlag:false,_inUseNotificationStore:null,_currentUsername:null,_messageService:null,currentModel:null,_eventHandlers:null,ignoreOthersNotifications:null,constructor:function(_1bd){this.inherited(arguments);dojo.mixin(this,_1bd);this._inUseNotificationStore=this.store||_1ba.resolve("epi.storeregistry").get("epi.cms.inusenotification");this._currentUsername=this.username||_1ba.resolve("epi.cms.Application").getUserName();this._messageService=this.messageService||_1ba.resolve("epi.shell.MessageService");this._eventHandlers=[];},updateCommandModel:function(_1be){this.inherited(arguments);if(this.currentModel&&!_1bc.compareIgnoreVersion(this.currentModel.contentData.contentLink,_1be.contentData.contentLink)){this.ignoreOthersNotifications=false;}this.currentModel=_1be;_1b6.forEach(this._eventHandlers,function(_1bf){_1bf.remove();});this.updateMessageService(this.currentModel.contentData);this._eventHandlers=[_1b9.after(_1be,"suspend",dojo.hitch(this,this._onViewModelSuspended)),_1b9.after(_1be,"destroyed",dojo.hitch(this,this._onViewModelSuspended)),_1b9.after(_1be,"onPropertyEdited",dojo.hitch(this,this._onPropertyEdited)),_1b9.around(_1be,"canChangeContent",dojo.hitch(this,this._canChangeContentAdvisor))];},_canChangeContentAdvisor:function(_1c0){return dojo.hitch(this,function(){if(!this.ignoreOthersNotifications){var _1c1=this.getOtherUsersInUseNotifications(this.currentModel.contentData.inUseNotifications);if(_1c1&&_1c1.length){return false;}}return _1c0.apply(this.currentModel,arguments);});},_onViewModelSuspended:function(){var _1c2=this.currentModel.contentData;this.removeAutomaticInUseNotification(_1c2);},_onPropertyEdited:function(){var _1c3=this.currentModel.contentData;this.ensureAutomaticInUseNotification(_1c3);},ensureAutomaticInUseNotification:function(_1c4){var _1c5;dojo.some(_1c4.inUseNotifications,function(item){if(item.userName==this._currentUsername){_1c5=item;return true;}},this);if(!_1c5){return this.put(this._createNotification(_1c4,false),_1c4.inUseNotifications);}else{if(_1c5.addedManually){return;}else{var _1c6=_1bb.deserialize(_1c5.modified);if(_1b8.difference(_1c6,new Date(),"minute")>30){return this.put(_1c5,_1c4.inUseNotifications);}}}},removeAutomaticInUseNotification:function(_1c7){dojo.forEach(_1c7.inUseNotifications,function(item){if(item.userName==this._currentUsername&&!item.addedManually){this.remove(item,_1c7.inUseNotifications);}},this);},_createNotification:function(_1c8,_1c9){var _1ca=_1bb.serialize(new Date());return {userName:this._currentUsername,contentLink:_1c8.contentLink,languageBranch:_1c8.currentLanguageBranch.languageId,addedManually:_1c9,created:_1ca,modified:_1ca};},put:function(_1cb,_1cc){_1cb.modified=_1bb.serialize(new Date());if(!this._postFlag){this._postFlag=true;return dojo.when(this._inUseNotificationStore.put(_1cb),dojo.hitch(this,function(_1cd){var _1ce=dojo.indexOf(_1cc,_1cb);if(_1ce>=0){_1cc[_1ce]=_1cb;}else{_1cc.push(_1cb);}this._updateDependentStores(_1cb.contentLink,_1cc);this._postFlag=false;}));}},remove:function(_1cf,_1d0){return dojo.when(this._inUseNotificationStore.remove(_1cf.id),dojo.hitch(this,function(){var _1d1=dojo.indexOf(_1d0,_1cf);_1d0.splice(_1d1,1);this._updateDependentStores(_1cf.contentLink,_1d0);}));},_updateDependentStores:function(_1d2,_1d3){var _1d4={contentLink:_1d2,inUseNotifications:_1d3};this._inUseNotificationStore.updateDependentStores(_1d4);},togglePermanentEditIndication:function(_1d5,_1d6){var _1d7;var _1d8=dojo.some(_1d5.inUseNotifications,function(item){if(item.userName==this._currentUsername){_1d7=item;if(item.addedManually){return true;}}},this);if(_1d8){if(_1d6){_1d7.addedManually=false;return this.put(_1d7,_1d5.inUseNotifications);}else{return this.remove(_1d7,_1d5.inUseNotifications);}}else{if(_1d7&&_1d6){_1d7.addedManually=true;}else{_1d7=this._createNotification(_1d5,true);}return this.put(_1d7,_1d5.inUseNotifications);}},updateMessageService:function(_1d9){var _1da=_1d9.contentLink+"_permanentEdit";this._messageService.remove({externalItemId:_1da});var _1db=this._getManualInUseNotification(_1d9.inUseNotifications);if(_1db){this._notificationHandlerId=this._messageService.put("note",res.permanenteditison,this.contextTypeName,_1d9.contentLink,_1da,null);}},_getManualInUseNotification:function(_1dc){var _1dd;var _1de=dojo.forEach(_1dc,function(item){if(item.userName==this._currentUsername&&item.addedManually){_1dd=item;}},this);return _1dd;},currentUserHasInUseNotification:function(_1df,_1e0){return dojo.some(_1df,function(item){return item.userName==this._currentUsername&&(!_1e0||item.addedManually);},this);},getOtherUsersInUseNotifications:function(_1e1){var _1e2=[];dojo.forEach(_1e1,function(item){if(item.userName!=this._currentUsername){_1e2.push(item.userName);}},this);return _1e2;},hasInUseNotificationWarning:function(_1e3){if(this.ignoreOthersNotifications){return false;}return this.getOtherUsersInUseNotifications(_1e3).length;}});});},"epi/cms/widget/ViewSettingsExpandoButton":function(){define("epi/cms/widget/ViewSettingsExpandoButton",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/dom-style","dojo/topic","epi/dependency","epi/shell/widget/ExpandoButton"],function(_1e4,lang,_1e5,_1e6,_1e7,_1e8,_1e9){return _1e4("epi.cms.widget.ViewSettingsExpandoButton",[_1e9],{_toggleStateInitialized:null,postCreate:function(){this.inherited(arguments);var _1ea=_1e8.resolve("epi.viewsettingsmanager");var _1eb=_1e5.filter(_1ea.viewSettingsHashValue,function(item){return item.type=="active";})[0];this.isExpand=_1eb?_1eb.id==="true":false;},onChange:function(_1ec){if(this._toggleStateInitialized){_1e7.publish("/epi/cms/action/eyetoggle",_1ec);return;}this._toggleStateInitialized=true;}});});},"dojo/data/util/sorter":function(){define(["dojo/_base/lang"],function(lang){var _1ed=lang.getObject("dojo.data.util.sorter",true);_1ed.basicComparator=function(a,b){var r=-1;if(a===null){a=undefined;}if(b===null){b=undefined;}if(a==b){r=0;}else{if(a>b||a==null){r=1;}}return r;};_1ed.createSortFunction=function(_1ee,_1ef){var _1f0=[];function _1f1(attr,dir,comp,s){return function(_1f2,_1f3){var a=s.getValue(_1f2,attr);var b=s.getValue(_1f3,attr);return dir*comp(a,b);};};var _1f4;var map=_1ef.comparatorMap;var bc=_1ed.basicComparator;for(var i=0;i<_1ee.length;i++){_1f4=_1ee[i];var attr=_1f4.attribute;if(attr){var dir=(_1f4.descending)?-1:1;var comp=bc;if(map){if(typeof attr!=="string"&&("toString" in attr)){attr=attr.toString();}comp=map[attr]||bc;}_1f0.push(_1f1(attr,dir,comp,_1ef));}}return function(rowA,rowB){var i=0;while(i<_1f0.length){var ret=_1f0[i++](rowA,rowB);if(ret!==0){return ret;}}return 0;};};return _1ed;});},"epi/cms/contentediting/command/PermanentInUseToggle":function(){define("epi/cms/contentediting/command/PermanentInUseToggle",["dojo/_base/declare","epi/dependency","epi/shell/command/ToggleCommand","epi/i18n!epi/cms/nls/episerver.cms.contentediting.permanenteditindication"],function(_1f5,_1f6,_1f7,_1f8){return _1f5([_1f7],{name:"PermanentInUseNotification",label:_1f8.title,tooltip:_1f8.tooltip,inUseNotificationManager:null,postscript:function(){this.inherited(arguments);if(this.inUseNotificationManager===null){this.inUseNotificationManager=_1f6.resolve("epi.cms.contentediting.inUseNotificationManager");}this.set("canExecute",true);this.set("isAvailable",true);},_execute:function(){this.inherited(arguments);var _1f9=this.model.contentData;this.inUseNotificationManager.togglePermanentEditIndication(_1f9,true);this._updateCanExecute();},_onModelChange:function(){var _1fa=this.model.contentData,_1fb=this.model.canChangeContent(),_1fc=this.inUseNotificationManager.currentUserHasInUseNotification(_1fa.inUseNotifications,true);this.set("active",_1fc);this._updateCanExecute();},_updateCanExecute:function(){this.set("canExecute",this.active||this.model.canChangeContent());}});});},"epi/cms/contentediting/UpdateController":function(){define("epi/cms/contentediting/UpdateController",["dojo","dojo/_base/declare","dojo/dom-style","dojo/dom-geometry","dojo/dom-attr","dijit"],function(dojo,_1fd,_1fe,_1ff,_200,_201){return _1fd("epi.cms.contentediting.UpdateController",[],{_showEmptyNode:true,_hasEmptyHtml:false,emptyValue:"&nbsp;",minWidth:18,minHeight:14,displayNode:null,contentModel:null,contentLink:null,modelPropertyName:null,nodePropertyName:null,renderManager:null,displayName:null,renderSettings:null,rendererClass:null,constructor:function(_202){dojo.mixin(this,_202);},postscript:function(){if(this.contentModel){this._modelWatchHandle=[];dojo.forEach(dojo.isArray(this.modelPropertyName)?this.modelPropertyName:[this.modelPropertyName],dojo.hitch(this,function(_203){this._modelWatchHandle.push(this.contentModel.watch(_203,dojo.hitch(this,this._renderNode)));}));}this.checkEmptyHtml();},destroy:function(){dojo.forEach(this._modelWatchHandle,function(_204){_204.unwatch();});dojo.disconnect(this._renderDisplayNodeConnect);delete this.srcNodeRef;delete this.displayNode;this.inherited(arguments);},onReloadRequired:function(_205){},onRender:function(_206){},_renderNode:function(_207,_208,_209){if(this.displayNode.tagName=="IMG"){if(dojo.isChrome){this.displayNode.src=_209+(_209&&_209.indexOf("?")>=0?"&":"?")+new Date().getTime();}else{this.displayNode.src=_209;}if(this._isEmptyHtml(this.displayNode)){this._updateRendering("");}if(!this._renderDisplayNodeConnect){this._renderDisplayNodeConnect=dojo.connect(this.displayNode,"onload",this,function(){this.onRender(this);});}return false;}var _20a=this.contentLink;var _20b=this.renderSettings;var _20c=this.rendererClass;var _20d=this.nodePropertyName||this.modelPropertyName;var def=this.renderManager.renderValue(_20a,_20d,_209,_20b,_20c);if(def!==this._lastRenderDeferred){this._lastRenderDeferred=def;dojo.when(def,dojo.hitch(this,function(_20e){if(this._lastRenderDeferred){if(_20e.doReload!==undefined&&_20e.doReload){this.onReloadRequired(this);}else{if(dojo.isString(_20e)){this._updateRendering(_20e);}else{if(_20e.content!==undefined){this._updateRendering(_20e.content);}else{if(_20e.error!==undefined){this._handleValidationError(_20e.error);}}}}if(def==this._lastRenderDeferred){this._lastRenderDeferred=null;}}}));}},_isEmptyHtml:function(_20f){var html="";if(_20f.tagName=="IMG"){html=dojo.attr(_20f,"src")||"";}else{html=_20f.innerHTML;}html=html.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");return (typeof html=="string")&&(html.replace(/\s*/g,"").length===0);},checkEmptyHtml:function(){var _210;if(!this._showEmptyNode){return;}_210=this._isEmptyHtml(this.displayNode);if(_210){this.displayNode.innerHTML=dojo.string.substitute(this.emptyValue,this);}this._ensureSize();},_ensureSize:function(){try{this._clearComputedStyle();this._computeStyle();}catch(e){}},_clearComputedStyle:function(){var _211=this._originalStyle;if(_211){for(var prop in _211){if(_211.hasOwnProperty(prop)){_1fe.set(this.displayNode,prop,this._originalStyle[prop]);}}this._originalStyle=null;}},_computeStyle:function(){var _212=_1fe.get(this.displayNode),_213={"minWidth":_1fe.toPixelValue(this.displayNode,_212.minWidth),"minHeight":_1fe.toPixelValue(this.displayNode,_212.minHeight),"display":_212.display},_214={},_215=_213.minHeight===0,_216=_213.minWidth===0,_217=_213.display==="inline",_218=_1ff.getMarginBox(this.displayNode,_212);if(_218.h<(_215?this.minHeight:_213.minHeight)||_218.w<(_216?this.minWidth:_213.minWidth)){if(_215){_214.minHeight=this.minHeight+"px";}if(_216){_214.minWidth=this.minWidth+"px";}if(_217){_214.display="inline-block";}if(_217||_215||_216){this._originalStyle=_213;_1fe.set(this.displayNode,_214);}}},_updateRendering:function(html){this.displayNode.innerHTML=html;this._hasEmptyHtml=this._isEmptyHtml(this.displayNode);if(this._hasEmptyHtml){this.checkEmptyHtml();if(!this._showEmptyNode){_1fe.set(this.displayNode,"display","none");}}else{if(this._showEmptyNode){this._ensureSize();}}this.onRender(this);},_handleValidationError:function(_219){},render:function(){var val=this.contentModel.get(this.modelPropertyName);this._renderNode(this.modelPropertyName,val,val);},focus:function(){_201.focus(this.displayNode);},setShowEmptyNode:function(val){this._showEmptyNode=val;if(this._hasEmptyHtml){this._updateRendering("");}}});});},"epi/shell/command/_WidgetCommandProviderMixin":function(){define(["dojo/_base/declare","epi/shell/command/_CommandConsumerMixin","epi/shell/command/_GlobalCommandProviderMixin"],function(_21a,_21b,_21c){return _21a([_21c],{startup:function(){if(this._started){return;}this.inherited(arguments);var _21d=this.getConsumer();if(!_21d){return;}this._consumer=_21d.addProvider(this);this.initializeCommandProviders();},getConsumer:function(){if(this.isInstanceOf(_21b)){return this;}var _21e=this.getParent();while(_21e){if(_21e.isInstanceOf(_21b)){return _21e;}_21e=_21e.getParent();}},uninitialize:function(){if(this._consumer){this._consumer.removeProvider();}}});});},"url:epi/cms/contentediting/templates/NewContentNameInputDialog.html":"<div class=\"epi-formContainer\">\r\n    <div data-dojo-attach-point=\"messageNode\"></div>\r\n    <br />\r\n    <div>\r\n        <label data-dojo-attach-point=\"contentNameLabelNode\">${nameLabel}</label>\r\n        <input type=\"text\" size=\"40\" data-dojo-attach-point=\"contentNameTextbox\" data-dojo-type=\"dijit.form.ValidationTextBox\"\r\n                data-dojo-props=\"required: true, trim:true\"\r\n                missingMessage: \"${res.errormessage.missingmessage}\" />\r\n    </div>\r\n</div>","epi/cms/widget/_UserResizable":function(){define("epi/cms/widget/_UserResizable",["epi","dojo"],function(epi,dojo){return dojo.declare("epi.cms.widget._UserResizable",null,{onResizeStart:function(){},onResizeStop:function(){}});});},"epi/cms/command/PasteContent":function(){define("epi/cms/command/PasteContent",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","epi","epi/shell/command/_Command","epi/shell/command/_ClipboardCommandMixin","epi/shell/command/_SelectionCommandMixin"],function(_21f,_220,lang,epi,_221,_222,_223){return _21f([_221,_222,_223],{label:epi.resources.action.paste,iconClass:"epi-iconPaste",_execute:function(){var _224=this._getSource(),_225=this._getTarget();if(this.clipboard.copy){return this.model.copy(_224,_225);}else{return _220.when(this.model.move(_224,_225),lang.hitch(this,function(_226){if(_226.isSuccess){this.clipboard.clear();}return _226;}));}},_onModelChange:function(){var _227=this.model,_228=this._getSource(),_229=this._getTarget();if(_227&&_228&&_229){_220.when(_227.canPaste(_228,_229,this.clipboard.copy),lang.hitch(this,function(_22a){this.set("canExecute",_22a);}));}else{this.set("canExecute",false);}},_getSource:function(){var _22b=this.clipboard&&this.clipboard.data;var _22c=_22b&&_22b.length==1&&_22b[0];return (_22c!=null&&_22c.type=="epi.cms.contentdata")?_22c.data:null;},_getTarget:function(){var _22d=this.selection&&this.selection.data;var _22e=_22d&&_22d.length==1&&_22d[0];return (_22e!=null&&_22e.type=="epi.cms.contentdata")?_22e.data:null;}});});},"epi/cms/component/SiteTree":function(){define("epi/cms/component/SiteTree",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/dom-style","dijit/layout/_LayoutWidget","dijit/Tooltip","epi/cms/component/SiteTreeModel","epi/cms/component/SiteTreeNode","epi/dependency","epi/shell/command/_WidgetCommandProviderMixin","epi/shell/command/ToggleCommand","epi/shell/widget/Tree","epi/i18n!epi/cms/nls/episerver.cms.components.sitetree"],function(_22f,_230,lang,_231,_232,_233,_234,_235,_236,_237,_238,Tree,_239){return _22f("epi.cms.component.SiteTree",[_232,_237],{buildRendering:function(){this.inherited(arguments);_231.set(this.domNode,"overflow","auto");},postCreate:function(){this.inherited(arguments);var _23a=_236.resolve("epi.storeregistry");var _23b=_23a.get("epi.cms.sitestructure");var _23c=this._treeModel=new _234(_23b);var _23d=new _238({category:"setting",label:_239.showalllanguages,model:_23c,property:"showAllLanguages"});this.commands.push(_23d);this._tree=new Tree({model:_23c,showRoot:false,"class":"epi-simpleTree",persist:false,onClick:function(item){window.top.location.replace(item.editUrl);},_createTreeNode:function(args){return new _235(args);},_onNodeMouseEnter:function(node){if(node.item.isLanguageNode&&!node.item.isAvailable){_233.show(_239.notavailabletooltip,node.labelNode,["after-centered","below"]);}},_onNodeMouseLeave:function(node){_233.hide(node.labelNode);}});this.addChild(this._tree);},startup:function(){this.inherited(arguments);this._setTreePath();},_setTreePath:function(){_230.when(this._treeModel.getCurrentSite(),lang.hitch(this,function(_23e){this._tree.set("path",["root",_23e.currentSite,_23e.currentEditLanguageId]);}));}});});},"epi/cms/contentediting/DialogEditorWrapper":function(){define("epi/cms/contentediting/DialogEditorWrapper",["epi","dojo","epi/cms/contentediting/_EditorWrapperBase","epi/shell/widget/dialog/Dialog"],function(epi,dojo,_23f,_240){return dojo.declare("epi.cms.contentediting.DialogEditorWrapper",[_23f],{closeOnChange:true,showButtons:false,_dialog:null,buildRendering:function(){this.inherited(arguments);if(!this.editorWidget){dojo["require"](this.editorWidgetType);var cls=dojo.getObject(this.editorWidgetType);var _241=this.editorParams||{};if("displayedValue" in cls.prototype||"value" in cls.prototype){_241["displayedValue" in cls.prototype?"displayedValue":"value"]=this.value;}this.editorWidget=new cls(_241);}var ew=this.editorWidget;var _242=new _240({content:ew,title:this.propertyDisplayName,defaultActionsVisible:this.showButtons,contentClass:"epi-dialog-fullWidth"});this.connect(ew,"onKeyPress",this._onKeyPress);this.connect(ew,"onCancel",this._onCancel);this.connect(ew,"onResize",dojo.hitch(this,function(){this._dialog.layout();}));if("intermediateChanges" in this.editorWidget){ew.set("intermediateChanges",true);this.connect(ew,"onChange","_onIntermediateChange");}else{this.connect(ew,"onChange","_onChange");}this.connect(_242,"onHide",this._onHide);this.connect(_242,"onCancel",this._onCancel);this._dialog=_242;},destroy:function(){this._dialog.destroyRecursive();this.inherited(arguments);},_onKeyPress:function(e){if(this.autoSave&&this.editing){if(e.altKey||e.ctrlKey){return;}if(e.charOrCode==dojo.keys.ESCAPE){dojo.stopEvent(e);this.cancel();}else{if(e.charOrCode==dojo.keys.ENTER&&e.target.tagName=="INPUT"){dojo.stopEvent(e);this._stopEdit();}}}},_onCancel:function(){this.cancel();this.editorWidget.set("value",this.value);if(this._dialog.open){this._dialog.hide();}},_onChange:function(){this.inherited(arguments);if(this.closeOnChange){this._stopEdit();}},_onHide:function(){if(this.editing){this._stopEdit();}},startEdit:function(){this.inherited(arguments);this._dialog.show();},_stopEdit:function(){this.inherited(arguments);if(this._dialog.open){this._dialog.hide();}},_setTitleAttr:function(_243){if(this._dialog){this._dialog.set("title",_243);}this._set("title",_243);}});});},"epi/cms/widget/_ContentListKeyMixin":function(){define("epi/cms/widget/_ContentListKeyMixin",["dojo/_base/declare","dojo/keys"],function(_244,keys){return _244("epi.cms.widget._ContentListKeyMixin",null,{handleKey:function(evt){switch(evt.charOrCode){case keys.DOWN_ARROW:this.selectNextNode();return false;case keys.UP_ARROW:this.selectPreviousNode();return false;case keys.ENTER:case keys.SPACE:if(this.selected&&this.grid.row(this.selected)){this._onSelect(this.grid.row(this.selected).data);}return false;default:return true;}}});});},"epi/cms/command/_TranslateContent":function(){define("epi/cms/command/_TranslateContent",["dojo/_base/declare","dojo/topic","epi/shell/command/_Command","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons"],function(_245,_246,_247,_248){return _245([_247],{label:_248.translate.label,executingLabel:_248.translate.executinglabel,tooltip:_248.translate.title,iconClass:"dijitIconEdit",category:"context",_executeCommand:function(_249){_246.publish("/epi/shell/action/changeview","epi/cms/component/CreateLanguageBranch",null,{contentData:_249});},_canExecute:function(_24a,_24b,_24c){var _24d=_24b.language&&!!_24c&&_24c.isTranslationNeeded&&_24c.isPreferredLanguageAvailable&&_24c.hasTranslationAccess&&!(_24a.isWastebasket||_24a.isDeleted);var _24e=!!_24c&&_24c.isTranslationNeeded;this.set("canExecute",_24d);this.set("isAvailable",_24e);}});});},"epi/shell/dgrid/Formatter":function(){define(["dojo/_base/declare","dojo/_base/array","epi/shell/dgrid/TemplateColumn","epi/shell/dgrid/util/misc"],function(_24f,_250,_251,_252){return _24f("epi.shell.dgrid.Formatter",null,{configStructure:function(){this.inherited(arguments);this._setupTemplateColumns();},_setupTemplateColumns:function(){if(!this.subRows){return;}var _253;_250.forEach(this.subRows,function(_254){_250.forEach(_254,function(_255){_253=[];if(!!_255.htmlEncode){_253.push(_252.htmlEncode);}if(!!_255.icon){_253.push(function(_256){return _252.icon(_255.icon,_256);});}if(!!_255.ellipsis){_253.push(_252.ellipsis);}if(!!_255.ellipsisNoTooltip){_253.push(_252.ellipsisNoTooltip);}if(_255.formatters&&_255.formatters.length>0){_253=_253.concat(_255.formatters);}if(_253.length>0){_255=_251(_255,_253);}},this);},this);}});});},"epi/cms/contentediting/ContentModel":function(){define("epi/cms/contentediting/ContentModel",["epi","dojo","epi/shell/Stateful"],function(epi,dojo,_257){return dojo.declare("epi.cms.contentediting.ContentModel",_257,{_validState:null,constructor:function(){this._validState=new _257();},setValidState:function(_258,_259){if(_259&&_259.isValid){this._validState.set(_258,null);}else{this._validState.set(_258,_259.message);}},watchValidState:function(_25a,_25b){this._validState.watch(_25a,_25b);}});});},"epi/cms/core/ContentReference":function(){define("epi/cms/core/ContentReference",["dojo/_base/declare","epi/epi"],function(_25c,epi){var _25d=_25c("epi.cms.core.ContentReference",null,{id:0,workId:0,providerName:null,isSelfReference:false,constructor:function(_25e){if(_25e){this._parse(_25e);}},_parse:function(_25f){if(typeof _25f==="object"){this.id=parseInt(_25f.ID||_25f.id||_25f.iD||_25f.Id,10);this.workId=parseInt(_25f.WorkID||_25f.workId||0,10);this.providerName=_25f.ProviderName||_25f.providerName||null;}else{if(typeof _25f==="string"){if(_25f==="-"){this.isSelfReference=true;this.id=0;this.workId=-1;}else{this.isSelfReference=false;var v=String();v.split("_");var _260=_25f.split("_");this.id=parseInt(_260[0],10);this.workId=parseInt(_260[1],10)||0;this.providerName=_260[2]||"";}}}if(typeof _25f==="number"){this.id=_25f;this.workId=0;this.providerName="";}if(typeof this.id!=="number"){throw new Error("The id parameter of a content reference must be an integer");}if(typeof this.workId!=="number"&&!this.isSelfReference){throw new Error("The workId of a content reference must be an integer");}},toString:function(){if(this.isSelfReference){return "-";}var _261=String(this.id);if(this.workId!==0){_261+="_"+this.workId;}if(this.providerName){_261+=(this.workId===0?"__":"_")+this.providerName;}return _261;},createVersionUnspecificReference:function(){return new _25d({id:this.id,providerName:this.providerName});}});_25d.toContentReference=function(obj){if(obj instanceof _25d){return obj;}else{if(typeof obj==="string"){return new _25d(obj);}}};_25d.compareIgnoreVersion=function(_262,_263){var c1=_25d.toContentReference(_262);var c2=_25d.toContentReference(_263);var pub1=c1.createVersionUnspecificReference();var pub2=c2.createVersionUnspecificReference();return epi.areEqual(pub1,pub2);};return _25d;});},"epi/cms/legacy/navigationSupport":function(){define([],function(){return {registerFor:function(_264){_264.navigateEvent=function(_265,_266){contextParameters={uri:"epi.cms.contentdata:///"+_266};dojo.publish("/epi/shell/context/request",[contextParameters]);};}};});},"url:epi/shell/widget/templates/RadioMenuItem.htm":"<tr class=\"dijitReset dijitMenuItem\" data-dojo-attach-point=\"focusNode\" role=\"menuitemradio\" tabIndex=\"-1\"\n\t\tdata-dojo-attach-event=\"onmouseenter:_onHover,onmouseleave:_onUnhover,ondijitclick:_onClick\">\n\t<td class=\"dijitReset dijitMenuItemIconCell\" role=\"presentation\">\n\t\t<img src=\"${_blankGif}\" alt=\"\" class=\"dijitMenuItemIcon dijitCheckedMenuItemIcon\" data-dojo-attach-point=\"iconNode\"/>\n\t\t<span class=\"dijitCheckedMenuItemIconChar\">&#10003;</span>\n\t</td>\n\t<td class=\"dijitReset dijitMenuItemLabel\" colspan=\"2\" data-dojo-attach-point=\"containerNode,labelNode\"></td>\n\t<td class=\"dijitReset dijitMenuItemAccelKey\" style=\"display: none\" data-dojo-attach-point=\"accelKeyNode\"></td>\n\t<td class=\"dijitReset dijitMenuArrowCell\" role=\"presentation\">&#160;</td>\n</tr>","epi/cms/_ContentContextMixin":function(){define("epi/cms/_ContentContextMixin",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/_base/connect","epi/dependency","epi/shell/_ContextMixin"],function(_267,_268,lang,_269,_26a,_26b){return _267("epi.cms._ContentContextMixin",[_26b],{_currentContentContext:null,_contentDataStore:null,constructor:function(){var _26c=_26a.resolve("epi.storeregistry");this._contentDataStore=_26c.get("epi.cms.contentdata");_269.connect(this._contentDataStore,"onItemChanged",this,"itemChanged");},getCurrentContent:function(){var _26d=new _268();_268.when(this.getCurrentContext(),lang.hitch(this,function(ctx){if(ctx.type!=="epi.cms.contentdata"){_26d.reject({message:"Not a content data",context:ctx});return;}_268.when(this._contentDataStore.query({id:ctx.id}),function(_26e){_26d.resolve(_26e);});}));return _26d;},contextChanged:function(ctx,_26f){this.inherited(arguments);if(!ctx||ctx.type!=="epi.cms.contentdata"){this._currentContentContext=null;return;}var _270=(_26f&&_26f.forceContextChange?_26f.forceContextChange:false);if(!_270&&this._currentContentContext&&this._currentContentContext.id===ctx.id){return;}this._currentContentContext=ctx;this.contentContextChanged(ctx,_26f);},contextUpdated:function(ctx,_271){if(!ctx||ctx.type!=="epi.cms.contentdata"){this._currentContentContext=null;return;}this._currentContentContext=ctx;this.contentContextUpdated(ctx,_271);},contentContextChanged:function(ctx,_272){},contentContextUpdated:function(ctx,_273){},itemChanged:function(id,item){}});});},"epi/cms/widget/overlay/Block":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/form/DropDownButton","epi","epi/shell/widget/overlay/_Base","epi/cms/widget/overlay/_OverlayItemInfoMixin","epi/cms/widget/BlockContextMenu","epi/i18n!epi/cms/nls/episerver.cms.widget.blockcontextmenu","dojo/text!../templates/Block.html"],function(_274,lang,_275,_276,_277,_278,_279,_27a,_27b,_27c,epi,_27d,_27e,_27f,_280,_281){return _274("epi.cms.widget.overlay.Block",[_27d,_27a,_27b,_27e],{templateString:_281,actionResources:epi.resources.action,headerResources:epi.resources.header,res:_280,_setMissingRendererAttr:function(val){_276.toggle(this.domNode,"epi-overlay-item-missing-renderer",val);},_getIsTopAttr:function(){var _282=this.domNode.previousSibling;return !_282||!/epi-overlay-block/.test(_282.className);},_getIsBottomAttr:function(){var _283=this.domNode.nextSibling;return !_283||!/epi-overlay-block/.test(_283.className);},postCreate:function(){this.inherited(arguments);this._injectDynamicStyles();this.model.set("contentLink",this.contentLink);this._setupContextMenu();if(this.blockInfo&&"missingrenderer" in this.blockInfo){this.set("missingRenderer",this.blockInfo.missingrenderer);}this.connect(this.domNode,"click",this._onClick);},_injectDynamicStyles:function(){/inline|inline-block/.test(_279.get(this.sourceItemNode,"display"))?_276.add(this.sourceItemNode,"epi-injected-minSize-inline"):_276.add(this.sourceItemNode,"epi-injected-minSize");},moveUp:function(){this.onChange(this,"moveUp");},moveDown:function(){this.onChange(this,"moveDown");},remove:function(){this.onChange(this,"remove");},edit:function(){this.onChange(this,"edit");},onChange:function(_284,_285){},onClick:function(_286,e){},_onClick:function(e){var _287=dijit.getEnclosingWidget(e.originalTarget||e.target);dojo.stopEvent(e);if(_287&&_287.isInstanceOf(_27c)){return;}this.onClick(this,e);},_setupContextMenu:function(){if(this.settingsButton.dropDownPosition){this.settingsButton.dropDownPosition=["above-alt","below-alt"];}if(!this.settingsButton.dropDown){this.settingsButton.dropDown=this.contextMenu;}this.connect(this.contextMenu,"onOpen","_onContextMenuOpen");},_onContextMenuOpen:function(){this.contextMenu.set("model",this);}});});},"epi/cms/contentediting/PropertyRenderer":function(){define("epi/cms/contentediting/PropertyRenderer",["dojo/_base/json","dojo/_base/declare","epi","epi/shell/XhrWrapper","epi/cms/contentediting/_Renderer","epi/cms/core/ContentReference","epi/dependency","epi/routes","dojo/string"],function(json,_288,epi,_289,_28a,_28b,_28c,_28d,_28e){return _288("epi.cms.contentediting.PropertyRenderer",[_28a],{_routes:_28d,_xhrHandler:null,constructor:function(){if(!this._routes){this._routes=epi.routes;}if(!this._xhrHandler){this._xhrHandler=new _289();}},render:function(_28f,_290,_291,_292){var _293=_28b.toContentReference(_28f);var url=null;if(_292.useMvc){url=this._routes.getActionPath({moduleArea:"CMS",controller:"PropertyRender",action:"Render",epieditmode:true,visitorgroupsByID:_292.visitorgroup});}else{url=this._routes.getActionPath({moduleArea:"LegacyCMS",path:"edit/RenderProperty.aspx",id:_293.toString(),epieditmode:true,visitorgroupsByID:_292.visitorgroup});}var _294={propertyName:_290,propertyValue:json.toJson(_291),id:_293.toString(),renderSettings:""};if(_292&&_292.propertyRenderSettings){_294.renderSettings=_292.propertyRenderSettings;}return this._xhrHandler.xhrPost({url:url,handleAs:"json",content:_294});}});});},"epi/cms/contentediting/ExpirationNotification":function(){define("epi/cms/contentediting/ExpirationNotification",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/Stateful","dojo/string","epi/datetime","epi/dependency","epi/i18n!epi/cms/nls/episerver.cms.widget.expirationeditor","epi/i18n!epi/cms/nls/episerver.cms.contentediting.versionstatus"],function(_295,_296,lang,_297,_298,_299,_29a,_29b,_29c){return _296([_297],{command:null,postscript:function(){this.inherited(arguments);if(!this.command){var _29d=_29a.resolve("epi.cms.contentEditing.command.Editing");this.command=_29d.manageExpiration;}this._setupWatchForCommand(this.command);},update:function(_29e){var _29f=_29e.contentData.properties.iversionable_expire;this._setNotification(_29f);},_setNotification:function(_2a0){var _2a1=_2a0?_2a0.stopPublish:null,_2a2=new Date(_2a1);if(_2a1&&_299.isDateValid(_2a2)){var text=new Date(_2a1)<new Date()?_29c.expired:_298.substitute(_29b.expiretimetext,[_299.timeToGo(_2a2)]);this.set("notification",{content:text,commands:[this.command]});}else{this.set("notification",null);}},_setupWatchForCommand:function(_2a3){if(this._commandWatchHandle){this._commandWatchHandle.unwatch();}this._commandWatchHandle=_2a3.watch("viewModel",lang.hitch(this,function(name,_2a4,_2a5){_2a5.watch("value",lang.hitch(this,function(name,_2a6,_2a7){this._setNotification(_2a7);}));}));}});});},"dgrid/util/mouse":function(){define("dgrid/util/mouse",["dojo/on","dojo/dom","dojo/query"],function(on,dom){function _2a8(_2a9,type){return function(node,_2aa){return on(node,_2a9+":"+type,function(evt){if(!dom.isDescendant(evt.relatedTarget,this)){return _2aa.call(this,evt);}});};};return {enterRow:_2a8(".dgrid-content .dgrid-row","mouseover"),enterCell:_2a8(".dgrid-content .dgrid-cell","mouseover"),enterHeaderCell:_2a8(".dgrid-header .dgrid-cell","mouseover"),leaveRow:_2a8(".dgrid-content .dgrid-row","mouseout"),leaveCell:_2a8(".dgrid-content .dgrid-cell","mouseout"),leaveHeaderCell:_2a8(".dgrid-header .dgrid-cell","mouseout"),createDelegatingHandler:_2a8};});},"epi/cms/widget/overlay/BlockArea":function(){require({cache:{"url:epi/cms/widget/templates/BlockArea.html":"<div data-dojo-attach-point=\"item\" class=\"epi-overlay-item\">\r\n    <div class=\"epi-overlay-item-container\">\r\n        <span class=\"epi-overlay-item-info\">${displayName}</span>\r\n        <div class=\"epi-overlay-bracket\"></div>\r\n    </div>\r\n    <div data-dojo-attach-point=\"containerNode\" class=\"epi-overlay-blockarea-container\"></div>\r\n    <div data-dojo-attach-point=\"actionsNode\" class=\"epi-overlay-blockarea-actionscontainer\">\r\n        <div data-dojo-attach-point=\"actionsNodeControls\" class=\"epi-overlay-blockarea-actions\">\r\n        </div>\r\n    </div>\r\n</div>"}});define("epi/cms/widget/overlay/BlockArea",["dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/json","dojo/_base/lang","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/_base/Deferred","dojo/NodeList-dom","dojo/on","dojo/query","dojo/topic","dijit/_Container","dijit/registry","epi/shell/widget/overlay/Item","epi/shell/dnd/Source","epi/shell/dnd/_MarkerSource","epi/shell/widget/TextWithActionLinks","epi/cms/widget/overlay/Block","epi/cms/contentediting/editors/ContentBlockEditor","epi/cms/widget/command/CreateNewBlockSelector","dojo/text!../templates/BlockArea.html","epi/i18n!epi/cms/nls/episerver.cms.widget.overlay.blockarea"],function(_2ab,_2ac,_2ad,json,lang,_2ae,_2af,_2b0,_2b1,_2b2,_2b3,_2b4,on,_2b5,_2b6,_2b7,_2b8,Item,_2b9,_2ba,_2bb,_2bc,_2bd,_2be,_2bf,_2c0){var _2c1=_2ad([_2b9,_2ba]);return _2ad("epi.cms.widget.overlay.BlockArea",[Item,_2b7],{"class":"epi-overlay-blockarea",contentModel:null,dropTargetType:["epi.cms.content.light"],layout:"",selectedBlockIndex:null,templateString:_2bf,hasChildren:false,_setHasChildrenAttr:function(_2c2){this._set("hasChildren",_2c2);_2b2.set(this.actionsNode,"display",_2c2?"none":"");},_getMinHeightAttr:function(){if(!this.hasMinHeight){this._set("minHeight",_2b2.get(this.sourceItemNode,"minHeight"));this.hasMinHeight=true;}return this.minHeight;},onValueChange:function(_2c3){},buildRendering:function(){this.inherited(arguments);this._setupEmptyInfo();},postCreate:function(){this.inherited(arguments);this._setupDirectionality();this._setupBlocks();},destroy:function(){this.inherited(arguments);this._source.destroy();if(this._emptyWidget){this._emptyWidget.destroyRecursive();this._emptyWidget=null;}},resize:function(size){},updatePosition:function(_2c4){if(!this.canUpdatePosition()){return false;}var _2c5=this.inherited(arguments);var _2c6;var _2c7;var _2c8;var _2c9;if(this.hasChildren){this._setupDirectionality();this._positionBlocks();}else{_2c6=Math.floor(_2b1.position(this.actionsNodeControls,false).h);_2c8=Math.floor(_2b1.position(this.sourceItemNode,false).h);if(_2c6===0){this._clearPosition();return false;}if(!this.actionNodeHeight&&_2c6<=_2c8||this.actionNodeHeight&&this.actionNodeHeight===_2c6){_2c5=false;}else{_2c7=this.get("minHeight");_2c9=Math.min(_2c7,_2c8);_2c9=Math.max(_2c9,_2c6);_2b2.set(this.sourceItemNode,"minHeight",_2c9+"px");this.actionNodeHeight=_2c6;_2c5=true;}}return _2c5;},refresh:function(){this._showStandby(false);this._reset();this._setupBlocks();this.onResize();},_setupDnd:function(){this._source=new _2c1(this.domNode,{_skipStartup:true,creator:lang.hitch(this,this._creator),copyOnly:false,alwaysCopy:false,dropParent:this.containerNode,type:this.dropTargetType,accept:this.dropTargetType,singular:true,propertyName:this.name});this._source.defaultCheckAcceptance=this._source.checkAcceptance;this._source.checkAcceptance=lang.hitch(this,this._checkAcceptance),this.connect(this._source,"onDropData",this._onDrop);},_creator:function(item,hint){var node,_2ca,data={};if(hint=="avatar"){node=_2b0.create("div");}else{node=this._createBlock(null,false).domNode;}if(item.getNormalizedData){_2ca=item.getNormalizedData().data;}else{_2ca=item;}data.contentLink=_2ca.contentLink;data.name=_2ca.name;return {"node":node,"type":this.dropTargetType,"data":data};},_setupBlocks:function(){if(!this.sourceItemNode){return;}var _2cb=this._getBlockNodes();if(_2cb.length>0){_2ab.forEach(_2cb,function(item){this._createBlock(item,true);},this);this.set("hasChildren",true);}else{this.set("hasChildren",false);}},_createBlock:function(node,_2cc){var id,_2cd,_2ce=this.contentModel.get(this.name),_2cf,_2d0,_2d1;if(!this.hasChildren){this.set("hasChildren",true);}if(node){id=_2ae.get(node,"data-epi-block-id");_2cd=json.fromJson(_2ae.get(node,"data-epi-block-info"));}else{node=this.sourceItemNode;}_2ab.some(_2ce,function(item){if(item&&item.contentLink===id){_2cf=item;return true;}return false;},this);_2d1={displayName:_2cf?_2cf.name:"",disabled:this.disabled,sourceItemNode:node,blockInfo:_2cd,contentLink:id};_2d0=new _2bc(_2d1);this.addChild(_2d0);if(_2cc){this._source.setItem(_2d0.domNode.id,{name:_2cf?_2cf.name:"",data:_2cf,type:this.dropTargetType});this.connect(_2d0,"onClick",this._onBlockClick);this.connect(_2d0,"onChange",this._onBlockChange);}return _2d0;},_positionBlocks:function(){var _2d2=this.getChildren(),_2d3=[],_2d4=this.get("position");_2ab.forEach(_2d2,function(_2d5,i){var _2d6,_2d7,_2d8;if(!_2d3[i]){_2d3[i]=_2b1.position(_2d5.sourceItemNode,false);}_2d6=_2d3[i];_2d6.x-=_2d4.x;_2d6.y-=_2d4.y;_2d5.resize(_2d6);},this);},_showStandby:function(show){_2af.toggle(this.domNode,"epi-overlay-block-standby",show);},_reset:function(){this.inherited(arguments);if(this.hasMinHeight&&this.sourceItemNode){_2b2.set(this.sourceItemNode,"minHeight",this.get("minHeight")+"px");}this._source.clearItems();this.destroyDescendants();this.set("hasMinHeight",false);this.set("actionNodeHeight",null);this.set("hasChildren",false);this.set("selectedBlock",null);},_checkAcceptance:function(_2d9,_2da){var _2db=_2b8.getEnclosingWidget(_2da[0]);if(_2db.isInstanceOf(_2bd)){return false;}return this._source.defaultCheckAcceptance(_2d9,_2da);},_getBlockNodes:function(){var _2dc=_2b5("[data-epi-block-id]",this.sourceItemNode);var _2dd=_2b5("[data-epi-block-id] [data-epi-block-id]",this.sourceItemNode);return _2ab.filter(_2dc,function(node){return _2dd.indexOf(node)===-1;});},_setupDirectionality:function(){if(this.layout==="vertical"){this._isHorizontal=false;}else{if(this.layout==="horizontal"){this._isHorizontal=true;}else{if(this.sourceItemNode){_2ab.some(this._getBlockNodes(),function(item){var _2de=_2b2.get(item),_2df=false,_2e0=false;if(_2de){_2df=/left|right/.test(_2de.cssFloat),_2e0=/inline|inline-block/.test(_2de.display);}this._isHorizontal=_2df||_2e0;return this._isHorizontal;},this);}else{this._isHorizontal=false;}}}this._source.setHorizontal(this._isHorizontal);},_setupEmptyInfo:function(){this._emptyWidget=new _2bb({contentString:_2c0.emptyactions.template,namedActions:_2c0.emptyactions.actions});this._connects.push(on(this._emptyWidget,"onActionClick",lang.hitch(this,function(_2e1){if(_2e1==="createnewblock"){var _2e2=new _2be();_2e2.set("model",{save:lang.hitch(this,function(_2e3){this.onValueChange({propertyName:this._source.propertyName,value:[_2e3]});})});_2e2.execute();}else{_2b6.publish("/epi/layout/pinnable/"+_2e1+"/toggle",true);}})));this._emptyWidget.placeAt(this.actionsNodeControls);},_onDrop:function(_2e4,_2e5,_2e6,copy){var _2e7,_2e8,_2e9,_2ea,_2eb;var _2ec=_2e4?(_2e4.length?_2e4[0]:_2e4):null;if(!_2ec){return;}this._showStandby(true);_2b3.when(_2ec,lang.hitch(this,function(data){_2e7=_2ab.map(this._source.getOrderedItems(),function(item){return item.data;});_2eb=_2e8={propertyName:this._source.propertyName,value:_2e7};if(this._source!==_2e5&&_2e5.propertyName&&!copy){_2e9=_2ab.map(_2e5.getOrderedItems(),function(item){return item.data;});_2ea={propertyName:_2e5.propertyName,value:_2e9};_2eb=[_2ea,_2e8];}this.onValueChange(_2eb);}));},_onBlockChange:function(_2ed,_2ee){var item,_2ef;switch(_2ee){case "moveUp":this._source.current=_2ed.domNode.previousSibling;this._source.before=true;this._source.onDrop(this._source,[_2ed.domNode],false);break;case "moveDown":this._source.current=_2ed.domNode.nextSibling;this._source.before=false;this._source.onDrop(this._source,[_2ed.domNode],false);break;case "remove":this._source.delItem(_2ed.id);this.removeChild(_2ed);_2ed.destroyRecursive();this._onDrop({data:{}},this._source,[_2ed.domNode],false);break;case "edit":item=this._source.getItem(_2ed.id);_2ef={uri:"epi.cms.contentdata:///"+item.data.contentLink};_2ac.publish("/epi/shell/context/request",[_2ef,{}]);break;default:}},_onBlockClick:function(_2f0,e){var _2f1=-1;_2ab.some(this.getChildren(),function(item,i){if(item===_2f0){_2f1=i;return true;}},this);this.selectedBlockIndex=_2f1;this.onClick(this,e);}});});},"epi/cms/contentediting/viewmodel/ExpirationDialogViewModel":function(){define(["dojo/_base/declare","dojo/Stateful","dojo/string","epi/epi","epi/datetime","epi/shell/_StatefulGetterSetterMixin","epi/i18n!epi/cms/nls/episerver.cms.widget.expirationeditor","epi/i18n!epi/cms/nls/episerver.cms.contentediting.versionstatus"],function(_2f2,_2f3,_2f4,epi,_2f5,_2f6,_2f7,_2f8){return _2f2([_2f3,_2f6],{value:null,intermediateValue:null,contentLink:null,contentName:null,enableSaveButton:null,showRemoveButton:null,infoText:null,state:null,enableArchiveLink:null,postscript:function(){this.inherited(arguments);this.set("intermediateValue",this.value);this.set("minimumExpireDate",this.minimumExpireDate);},_setIntermediateValueAttr:function(_2f9){this._set("intermediateValue",_2f9);this.set("enableSaveButton",!epi.areEqual(this.intermediateValue,this.value));this.set("enableArchiveLink",_2f9&&_2f9.stopPublish?true:false);if(_2f9&&_2f9.stopPublish){var _2fa=_2f9.stopPublish instanceof Date?_2f9.stopPublish:_2f5.deserialize(_2f9.stopPublish);this.set("showRemoveButton",true);this.set("infoText",_2fa<new Date()?_2f8.expired:_2f4.substitute(_2f7.expiretimetext,[_2f5.timeToGo(_2fa)]));this.set("state","Expiring");}else{this.set("showRemoveButton",false);this.set("infoText",_2f7.neverexpiretext);this.set("state","NotExpiring");}},_setValueAttr:function(_2fb){this._set("value",_2fb);this.set("enableSaveButton",false);},_setMinimumExpireDateAttr:function(_2fc){var date=new Date(_2fc);this._set("minimumExpireDate",_2f5.isDateValid(date)?date:null);this._set("minimumExpireDateMessage",_2f7.minimumdatevalidation);},save:function(){this.set("value",this.intermediateValue);}});});},"url:epi/cms/contentediting/editors/templates/_PreviewableEditor.html":"<div class=\"dijitReset dijitInline epi-previewableTextBox-wrapper\">\r\n    <span data-dojo-attach-point=\"labelNode\" class=\"epi-previewableTextBox-text dojoxEllipsis dijitInline\"></span>\r\n    <a href=\"#\" data-dojo-attach-point=\"changeNode, focusNode\" class=\"epi-functionLink\">${changeLabel}</a>\r\n</div>\r\n","epi/cms/component/ContextHistory":function(){define(["dojo/_base/declare","dojo/_base/lang","epi/cms/core/ContentReference","epi/cms/widget/_GridWidgetBase","epi/dependency"],function(_2fd,lang,_2fe,_2ff,_300){return _2fd("epi.cms.component.ContextHistory",[_2ff],{postMixInProperties:function(){var _301=_300.resolve("epi.shell.ContextHistory");this.store=_301.store;this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);var _302=lang.mixin({columns:{name:{renderCell:lang.hitch(this,this._renderContentItem)}},store:this.store,selectionMode:"single"},this.defaultGridMixin);this.grid=new this._gridClass(_302,this.domNode);this.grid.set("showHeader",false);},startup:function(){this.inherited(arguments);this.fetchData();},contextChanged:function(){this.inherited(arguments);this.grid.set("sort","dateAdded",true);},fetchData:function(){var _303=_300.resolve("epi.cms.Application");var _304=_303.getWastebasketPage();this.grid.set("query",{uri:new RegExp("epi\\.cms\\.contentdata:///([^"+_304+"]|\\d{2,})")});this.grid.set("sort","dateAdded",true);}});});},"epi/cms/contentediting/viewmodel/_ContentViewModelObserver":function(){define("epi/cms/contentediting/viewmodel/_ContentViewModelObserver",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/Stateful","epi/shell/_StatefulGetterSetterMixin"],function(_305,_306,lang,_307,_308){return _305("epi.cms.contentediting.viewmodel._ContentViewModelObserver",[_307,_308],{dataModel:null,_watchers:null,postscript:function(){this.inherited(arguments);if(this.dataModel){this.set("dataModel",this.dataModel);}},uninitialize:function(){this._unbindDataModel();},_bindDataModel:function(){this._watchers=[];this._watchers.push(this.dataModel.watch("status",lang.hitch(this,this.onDataModelChange)));this._watchers.push(this.dataModel.watch("contentData",lang.hitch(this,this.onDataModelChange)));},_unbindDataModel:function(){_306.forEach(this._watchers,function(w){w.unwatch();});},_setDataModelAttr:function(_309){this._unbindDataModel();this._set("dataModel",_309);this.onDataModelChange();this._bindDataModel();},onDataModelChange:function(name,_30a,_30b){}});});},"dojox/html/ellipsis":function(){define("dojox/html/ellipsis",["dojo/_base/kernel","dojo/_base/lang","dojo/_base/array","dojo/_base/Color","dojo/colors"],function(d){if(d.isFF<7){var _30c=1;if("dojoxFFEllipsisDelay" in d.config){_30c=Number(d.config.dojoxFFEllipsisDelay);if(isNaN(_30c)){_30c=1;}}try{var _30d=(function(){var sNS="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul";var xml=document.createElementNS(sNS,"window");var _30e=document.createElementNS(sNS,"description");_30e.setAttribute("crop","end");xml.appendChild(_30e);return function(n){var x=xml.cloneNode(true);x.firstChild.setAttribute("value",n.textContent);n.innerHTML="";n.appendChild(x);};})();}catch(e){}var _30f=d.create;var dd=d.doc;var dp=d.place;var _310=_30f("iframe",{className:"dojoxEllipsisIFrame",src:"javascript:'<html><head><script>if(\"loadFirebugConsole\" in window){window.loadFirebugConsole();}</script></head><body></body></html>'"});var _311=function(r,cnt){if(r.collapsed){return;}if(cnt>0){do{_311(r);cnt--;}while(cnt);return;}if(r.endContainer.nodeType==3&&r.endOffset>0){r.setEnd(r.endContainer,r.endOffset-1);}else{if(r.endContainer.nodeType==3){r.setEndBefore(r.endContainer);_311(r);return;}else{if(r.endOffset&&r.endContainer.childNodes.length>=r.endOffset){var _312=r.endContainer.childNodes[r.endOffset-1];if(_312.nodeType==3){r.setEnd(_312,_312.length-1);}else{if(_312.childNodes.length){r.setEnd(_312,_312.childNodes.length);_311(r);return;}else{r.setEndBefore(_312);_311(r);return;}}}else{r.setEndBefore(r.endContainer);_311(r);return;}}}};var _313=function(n){var c=_30f("div",{className:"dojoxEllipsisContainer"});var e=_30f("div",{className:"dojoxEllipsisShown",style:{display:"none"}});n.parentNode.replaceChild(c,n);c.appendChild(n);c.appendChild(e);var i=_310.cloneNode(true);var ns=n.style;var es=e.style;var _314;var _315=function(){ns.display="";es.display="none";if(n.scrollWidth<=n.offsetWidth){return;}var r=dd.createRange();r.selectNodeContents(n);ns.display="none";es.display="";var done=false;do{var _316=1;dp(r.cloneContents(),e,"only");var sw=e.scrollWidth,ow=e.offsetWidth;done=(sw<=ow);var pct=(1-((ow*1)/sw));if(pct>0){_316=Math.max(Math.round(e.textContent.length*pct)-1,1);}_311(r,_316);}while(!r.collapsed&&!done);};i.onload=function(){i.contentWindow.onresize=_315;_315();};c.appendChild(i);};var hc=d.hasClass;var doc=d.doc;var s,fn,opt;if(doc.querySelectorAll){s=doc;fn="querySelectorAll";opt=".dojoxEllipsis";}else{if(doc.getElementsByClassName){s=doc;fn="getElementsByClassName";opt="dojoxEllipsis";}else{s=d;fn="query";opt=".dojoxEllipsis";}}fx=function(){d.forEach(s[fn].apply(s,[opt]),function(n){if(!n||n._djx_ellipsis_done){return;}n._djx_ellipsis_done=true;if(_30d&&n.textContent==n.innerHTML&&!hc(n,"dojoxEllipsisSelectable")){_30d(n);}else{_313(n);}});};d.addOnLoad(function(){var t=null;var c=null;var _317=function(){if(c){d.disconnect(c);c=null;}if(t){clearTimeout(t);}t=setTimeout(function(){t=null;fx();c=d.connect(d.body(),"DOMSubtreeModified",_317);},_30c);};_317();});}});},"url:epi/cms/widget/templates/TinyMCEEditor.html":"<div id=\"widget_${id}\" style=\"position: relative; display: inline-block;\">\r\n    <div style=\"display: inline-block\" data-dojo-attach-point=\"stateNode, tooltipNode\">\r\n        <textarea data-dojo-attach-point=\"editorFrame\" id=\"${id}_editorFrame\" style=\"border: none;\"></textarea>\r\n    </div>\r\n    <div data-dojo-attach-point=\"dndOverlay\" style=\"background: rgba(0, 0, 0, 0.01); position: absolute; left: 0; top: 0; right: 0; bottom: 0; display: none\"></div>\r\n</div>\r\n","epi/cms/widget/command/CreateNewBlockSelector":function(){define("epi/cms/widget/command/CreateNewBlockSelector",["dojo/_base/declare","dojo/topic","epi/cms/component/ContentFilter","epi/cms/widget/FolderTreeStoreModel","epi/cms/widget/command/_CreateContentFromSelectorBase","epi/i18n!epi/cms/nls/episerver.cms.components.createblock","epi/i18n!epi/cms/nls/episerver.cms.widget.blockfolderselector","epi/i18n!epi/cms/nls/episerver.cms.widget.createcontentselector"],function(_318,_319,_31a,_31b,_31c,_31d,_31e,_31f){return _318([_31c],{res:_31d,contentType:_31a.BlockType,showRoot:false,typeIdentifiers:"epi.cms.folder",confirmActionText:_31f.buttons.confirmation,description:_31f.descriptionblock,title:_31e.title,postscript:function(){this.inherited(arguments);this.value=this.application.getSiteBlockFolder();this.modelContent=new _31b({additionalQueryOptions:{sort:[{attribute:"name",descending:false}]}});},_switchView:function(_320){_319.publish("/epi/shell/action/changeview","epi/cms/component/CreateContent",null,{requestedTypes:[this.contentType],res:this.res,type:this.contentType,parent:_320,addToDestination:this.model});}});});},"url:epi/cms/component/templates/_PageTreeNode.html":"<div class=\"dijitTreeNode\" role=\"presentation\">\r\n    <div data-dojo-attach-point=\"rowNode\" class=\"dijitTreeRow\" role=\"presentation\" data-dojo-attach-event=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onclick:_onClick, ondblclick:_onDblClick\">\r\n        <span data-dojo-attach-point=\"contentNode\" class=\"dijitTreeContent\" role=\"presentation\">\r\n            <span data-dojo-attach-point=\"expandoNode\" class=\"dijitTreeExpando\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"></span>\r\n            \r\n            <span data-dojo-attach-point=\"labelNode\" class=\"dijitTreeLabel\" role=\"treeitem\"\r\n                  tabindex=\"-1\" aria-selected=\"false\" data-dojo-attach-event=\"onfocus:_onLabelFocus\">\r\n            </span>\r\n        </span>\r\n        <span data-dojo-attach-point=\"extraIconsContainer\" class=\"epi-dijitExtraIconContainer\" role=\"presentation\">       \r\n            <span data-dojo-attach-point=\"iconNodeLanguage\" class=\"epi-pt-currentLanguageMissing\" role=\"presentation\">&nbsp;</span>\r\n            <span data-dojo-attach-point=\"iconNodeAccess\" class=\"dijitTreeIcon\" role=\"presentation\">&nbsp;</span>\r\n            <span data-dojo-attach-point=\"iconNodeStatus\" class=\"dijitTreeIcon\" role=\"presentation\">&nbsp;</span>\r\n            <span data-dojo-attach-point=\"iconNodeMenu\" class=\"dijitTreeIcon\" role=\"presentation\" data-dojo-attach-event=\"onmousedown:_onMouseDownIconNodeMenu, click: _onClickIconNodeMenu\" >&nbsp;</span>\r\n        </span>\r\n    </div>\r\n    <div data-dojo-attach-point=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\r\n</div>","epi/cms/contentediting/editors/ContentBlockEditor":function(){require({cache:{"url:epi/cms/contentediting/editors/templates/ContentBlockEditor.html":"<div class=\"epi-content-block-editor\">\r\n    <a href=\"#\" data-dojo-attach-point=\"itemNode\" style=\"display: block;\" data-dojo-attach-event=\"onclick:_onClick\">\r\n        <span data-dojo-attach-point=\"contentNode\" class=\"epi-content-block-node\">\r\n            <span data-dojo-attach-point=\"labelNode\" class=\"dojoxEllipsis\"></span>\r\n            <span data-dojo-attach-point=\"extraIconsContainer\" class=\"epi-floatRight\">\r\n                <span data-dojo-attach-point=\"iconNodeMenu\" class=\"epi-iconContextMenu\" style=\"visibility: hidden;\" data-dojo-attach-event=\"onclick:_onContextMenu\"></span>\r\n            </span>\r\n        </span>\r\n    </a>\r\n</div>"}});define("epi/cms/contentediting/editors/ContentBlockEditor",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/event","dojo/dom-attr","dojo/dom-class","dojo/dom-style","dojo/html","dojo/NodeList-dom","dojo/query","dijit/_Widget","dijit/_TemplatedMixin","dijit/popup","dojox/html/ellipsis","epi/shell/widget/_ModelBindingMixin","epi/cms/widget/BlockContextMenu","epi/cms/contentediting/command/BlockEditing","epi/cms/contentediting/editors/ContentBlockEditorViewModel","dojo/text!./templates/ContentBlockEditor.html"],function(_321,_322,_323,_324,_325,_326,html,_327,_328,_329,_32a,pm,_32b,_32c,_32d,_32e,_32f,_330){return _321("epi.cms.contentediting.editors.ContentBlockEditor",[_329,_32a,_32c],{templateString:_330,model:null,modelData:null,contextMenu:null,modelBindingMap:{"contentLink":["contentLink"],"name":["name"],"selected":["selected"]},_setSelectedAttr:function(_331){this.inherited(arguments);_325.toggle(this.itemNode,"epi-content-block-editor-node-selected",_331);_326.set(this.iconNodeMenu,"visibility",_331?"visible":"hidden");},_setNameAttr:function(_332){this.inherited(arguments);_328(this.labelNode).text(_332);_324.set(this.iconNodeMenu,"title",_332);},postMixInProperties:function(){this.inherited(arguments);this.model=this.model||new _32f(this.modelData);this.model.set("contentLink",this.modelData.contentLink);},onClick:function(_333){},_onClick:function(evt){_323.stop(evt);this.contextMenu&&pm.close(this.contextMenu);this.onClick(this);},_onContextMenu:function(evt){_323.stop(evt);this.contextMenu&&this.contextMenu.scheduleOpen(evt.target,null,{x:evt.pageX,y:evt.pageY});}});});},"url:epi/cms/widget/templates/ContentTypeGroup.html":"<div class=\"epi-listingContainer\" data-dojo-attach-point=\"focusNode\" tabIndex=\"${tabIndex}\">\r\n    <h2 data-dojo-attach-point=\"titleNode\" class=\"epi-ribbonHeader\"></h2>\r\n    <ul data-dojo-attach-point=\"containerNode\" class=\"epi-advancedListing\"></ul>\r\n</div>","epi/shell/command/builder/GroupedButtonBuilder":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-class","epi/shell/command/_CommandModelBindingMixin","epi/shell/command/builder/_Builder","epi/shell/widget/ListContainer","epi/shell/widget/ExpandoButton"],function(_334,lang,_335,_336,_337,_338,_339){return _334([_337],{_create:function(_33a){var _33b=_334([_33a.settings.widget,_336]),_33c=new _33b(lang.mixin(_33a.settings,this.itemSettings));return _33c;},_addToContainer:function(_33d,_33e){this._createListContainer(_33d,_33e);if(this._containerAdded){if(_33d.model){_33d.model.watch("isAvailable",lang.hitch(this,function(){if(this._listContainer.updateVisibility){this._listContainer.updateVisibility();}}));}}this.inherited(arguments,[_33d,this._listContainer]);if(this._listContainer.getChildren().length>1){_335.add(_33d.getParent().domNode,"epi-leftSeparator");}},_createListContainer:function(_33f,_340){if(this._containerAdded){return;}this._listContainer=new _338(this.settings);this._listContainer._commandCategory=_33f._commandCategory;if(_340.addChild){_340.addChild(this._listContainer);}else{this._listContainer.placeAt(_340);this._listContainer.startup();}this._containerAdded=true;}});});},"dojox/html":function(){define("dojox/html",["./html/_base"],function(html){return html;});},"epi/cms/ContextSynchronizer":function(){define("epi/cms/ContextSynchronizer",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","epi/shell/_ContextMixin","epi/cms/core/ContentReference"],function(_341,lang,_342,_343,_344){return _341([_343],{_subscribeHandle:null,constructor:function(){this._subscribeHandle=_342.subscribe("/epi/cms/contentdata/updated",this,this._updateCurrentContext);},_updateCurrentContext:function(_345){var _346=_345.contentLink;if(this.currentContext&&_344.compareIgnoreVersion(this.currentContext.id,_346)){_342.publish("/epi/shell/context/updateRequest",{uri:"epi.cms.contentdata:///"+_346});}},destroy:function(){_342.unsubscribe(this._subscribeHandle);}});});},"epi/cms/contentediting/command/ScheduleForPublish":function(){define("epi/cms/contentediting/command/ScheduleForPublish",["dojo/_base/declare","dojo/aspect","dojo/on","dojo/topic","epi/shell/widget/dialog/Dialog","epi/cms/contentediting/command/_ContentCommandBase","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/ScheduledPublishSelector","epi/cms/contentediting/ScheduledPublishSelectorViewModel","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons","epi/i18n!epi/cms/nls/episerver.cms.widget.scheduledpublishselector"],function(_347,_348,on,_349,_34a,_34b,_34c,_34d,_34e,_34f,_350){return _347("epi.cms.contentediting.command.ScheduleForPublish",[_34b],{name:"reject",label:_34f.scheduleforpublish.label,tooltip:_34f.scheduleforpublish.title,iconClass:"epi-iconClock",_execute:function(){var _351=new _34e();_351.set("contentData",this.model.contentData);var _352=new _34d({model:_351});var _353=_34c.saveAction;var self=this;var _354=new _34a({content:_352,title:_350.title,defaultActionsVisible:false});on(_354,"execute",function(){self.model.setProperty("iversionable_startpublish",_351.dateValue);var _355=_353.CheckIn|_353.DelayedPublish|_353.ForceCurrentVersion;dojo.when(self.model.changeContentStatus(_355),function(_356){self._requestContextChange(_356.id,true);});});_354.show(true);_348.after(_354,"_onSubmit",function(){_349.publish("/epi/cms/action/disableundoredoactions");});},_onModelChange:function(){this.inherited(arguments);var _357=this.model.contentData,_358=(_357.status===_34c.versionStatus.CheckedOut)||(_357.status===_34c.versionStatus.Rejected)||(_357.status===_34c.versionStatus.Published&&_357.isCommonDraft),_359=_358&&this.model.canChangeContent(_34c.action.Publish);this.set("canExecute",_359);this.set("isAvailable",_358);},_requestContextChange:function(id,_35a){var _35b={uri:"epi.cms.contentdata:///"+id};var _35c={sender:this,trigger:"internal",forceContextChange:_35a};dojo.publish("/epi/shell/context/request",[_35b,_35c]);}});});},"dgrid/OnDemandList":function(){define("dgrid/OnDemandList",["./List","./_StoreMixin","dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/on","./util/misc","put-selector/put"],function(List,_35d,_35e,lang,_35f,_360,_361,put){return _35e([List,_35d],{minRowsPerPage:25,maxRowsPerPage:100,maxEmptySpace:Infinity,bufferRows:10,farOffRemoval:10000,rowHeight:22,queryRowsOverlap:1,pagingDelay:_361.defaultDelay,postCreate:function(){this.inherited(arguments);var self=this;_360(this.bodyNode,"scroll",_361.throttleDelayed(function(_362){self._processScroll(_362);},null,this.pagingDelay));},renderQuery:function(_363,_364){var _365={query:_363,count:0,node:_364};if(!_364){var _366=true;var _367={node:put(this.contentNode,"div.dgrid-preload",{rowIndex:0}),count:0,query:_363,next:_365};_365.node=_364=put(this.contentNode,"div.dgrid-preload");_365.previous=_367;}_364.rowIndex=this.minRowsPerPage;var _368=this.preload;if(_368){if((_365.next=_368.next)&&this.bodyNode.scrollTop>=_368.node.offsetTop){_365.previous=_368;}else{_365.next=_368;_365.previous=_368.previous;}_365.previous.next=_365;_365.next.previous=_365;}else{this.preload=_365;}var _369=put(_364,"-div.dgrid-loading");put(_369,"div.dgrid-below",this.loadingMessage);var _36a=lang.mixin(this.get("queryOptions"),{start:0,count:this.minRowsPerPage,query:_363});var _36b=_363(_36a);var self=this;_35f.when(this.renderArray(_36b,_364,_36a),function(trs){return _35f.when(_36b.total||_36b.length,function(_36c){put(_369,"!");var _36d=trs.length;_36c=_36c||_36d;if(!_36c){put(self.contentNode,"div.dgrid-no-data").innerHTML=self.noDataMessage;}var _36e=0;for(var i=0;i<_36d;i++){_36e+=trs[i].offsetHeight;}if(_36d&&_36e){self.rowHeight=_36e/_36d;}_36c-=_36d;_365.count=_36c;_364.rowIndex=_36d;if(_36c){_364.style.height=Math.min(_36c*self.rowHeight,self.maxEmptySpace)+"px";}else{_364.style.display="none";}self._processScroll();return trs;});});return _36b;},refresh:function(){this.inherited(arguments);if(this.store){var self=this;this._trackError(function(){return self.renderQuery(function(_36f){return self.store.query(self.query,_36f);});});}},_calcRowHeight:function(_370){return _370.offsetHeight;},lastScrollTop:0,_processScroll:function(){var grid=this,_371=grid.bodyNode,_372=grid.contentNode.style.webkitTransform,_373=_371.scrollTop+(_372?-_372.match(/translate[\w]*\(.*?,(.*?)px/)[1]:0),_374=_371.offsetHeight+_373,_375,_376,_377=grid.preload,_378=grid.lastScrollTop,_379=grid.bufferRows*grid.rowHeight,_37a=_379-grid.rowHeight;var _37b=1;grid.lastScrollTop=_373;function _37c(_37d,_37e,_37f,_380){var _381=grid.farOffRemoval,_376=_37d.node;if(_37e>2*_381){var row,_382=_376[_37f];var _383=0;var _384=0;var _385=[];while((row=_382)){var _386=grid._calcRowHeight(row);if(_383+_386+_381>_37e||(_382.className.indexOf("dgrid-row")<0&&_382.className.indexOf("dgrid-loading")<0)){break;}var _382=row[_37f];var _387,_388=row.observerIndex;if(_388!=_387&&_387>-1){var _389=grid.observers;var _38a=_389[_387];_38a&&_38a.cancel();_389[_387]=0;}_383+=_386;_384+=row.count||1;_387=_388;grid.removeRow(row,true);_385.push(row);}_37d.count+=_384;if(_380){_376.rowIndex-=_384;_38b(_37d);}else{_376.style.height=(_376.offsetHeight+_383)+"px";}var _38c=put("div");for(var i=0;i<_385.length;i++){put(_38c,_385[i]);}setTimeout(function(){put(_38c,"!");},1);}};function _38b(_38d,_38e){_38d.node.style.height=Math.min(_38d.count*grid.rowHeight,_38e?Infinity:grid.maxEmptySpace)+"px";};while(_377&&_377!=_375){_375=grid.preload;grid.preload=_377;_376=_377.node;var _38f=_376.offsetTop;var _390;if(_374+_37b+_37a<_38f){do{_377=_377.previous;}while(_377&&!_377.node.offsetWidth);}else{if(_373-_37b-_37a>(_38f+(_390=_376.offsetHeight))){do{_377=_377.next;}while(_377&&!_377.node.offsetWidth);}else{var _391=((_376.rowIndex?_373-_379:_374)-_38f)/grid.rowHeight;var _392=(_374-_373+2*_379)/grid.rowHeight;var _393=Math.max(Math.min((_373-_378)*grid.rowHeight,grid.maxRowsPerPage/2),grid.maxRowsPerPage/-2);_392+=Math.min(Math.abs(_393),10);if(_376.rowIndex==0){_391-=_392;}_391=Math.max(_391,0);if(_391<10&&_391>0&&_392+_391<grid.maxRowsPerPage){_392+=Math.max(0,_391);_391=0;}_392=Math.min(Math.max(_392,grid.minRowsPerPage),grid.maxRowsPerPage,_377.count);if(_392==0){return;}_392=Math.ceil(_392);_391=Math.min(Math.floor(_391),_377.count-_392);var _394=grid.get("queryOptions");_377.count-=_392;var _395=_376,_396,_397=grid.queryRowsOverlap,_398=_376.rowIndex>0&&_377;if(_398){var _399=_377.previous;if(_399){_37c(_399,_373-(_399.node.offsetTop+_399.node.offsetHeight),"nextSibling");if(_391>0&&_399.node==_376.previousSibling){_391=Math.min(_377.count,_391);_377.previous.count+=_391;_38b(_377.previous,true);_377.count-=_391;_376.rowIndex+=_391;_397=0;}else{_392+=_391;}}_394.start=_376.rowIndex-_397;_376.rowIndex+=_392;}else{if(_377.next){_37c(_377.next,_377.next.node.offsetTop-_374,"previousSibling",true);var _395=_376.nextSibling;if(_395==_377.next.node){_377.next.count+=_377.count-_391;_377.next.node.rowIndex=_391+_392;_377.count=_391;_397=0;}else{_396=true;}}_394.start=_377.count;}_394.count=_392+_397;if(_396){_396=_395.offsetTop;}_38b(_377);var _39a=put(_395,"-div.dgrid-loading[style=height:"+_392*grid.rowHeight+"px]");put(_39a,"div.dgrid-"+(_398?"below":"above"),grid.loadingMessage);_39a.count=_392;_394.query=_377.query;var _39b=_377.query(_394),_39c=grid._trackError(function(){return _39b;});if(_39c===undefined){return;}(function(_39d,_39e,_39f,_3a0,_3a1){_35f.when(grid.renderArray(_3a1,_39d,_394),function(){_395=_39d.nextSibling;put(_39d,"!");if(_3a0&&_395){_39e.scrollTop+=_395.offsetTop-_3a0;}if(_39f){_35f.when(_3a1.total||_3a1.length,function(_3a2){_39f.count=_3a2-_39f.node.rowIndex;_38b(_39f);});}});}).call(this,_39a,_371,_398,_396,_39b);_377=_377.previous;}}}}});});},"epi/cms/contentediting/command/BlockEdit":function(){define("epi/cms/contentediting/command/BlockEdit",["dojo/_base/declare","epi","epi/shell/command/_Command"],function(_3a3,epi,_3a4){return _3a3("epi.cms.contentediting.command.BlockEdit",[_3a4],{name:"edit",label:epi.resources.action.edit,tooltip:epi.resources.action.edit,iconClass:"epi-iconPen",category:"menuWithSeparator",postscript:function(){this.inherited(arguments);},_execute:function(){this.model.edit();return this.inherited(arguments);},_onModelChange:function(){if(this.model&&this.model.model){this.set("canExecute",this.model&&this.model.model&&!this.model.model.isDeleted);}else{this.set("canExecute",this.model&&!this.model.selectedItem.isDeleted);}}});});},"epi/cms/contentediting/EditToolbar":function(){define("epi/cms/contentediting/EditToolbar",["dojo","dojo/_base/lang","dojo/_base/array","dojo/DeferredList","dojo/dom-class","dojox/html/ellipsis","epi","epi/dependency","epi/shell/widget/Toolbar","epi/shell/command/withConfirmation","epi/cms/contentediting/command/Editing","epi/cms/contentediting/viewmodel/EditActionPanelViewModel","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons","epi/i18n!epi/cms/nls/episerver.cms.contentediting.editactionpanel.publishactionmenu","epi/cms/widget/NotificationStatusBar","epi/cms/contentediting/EditActionPanel"],function(dojo,lang,_3a5,_3a6,_3a7,_3a8,epi,_3a9,_3aa,_3ab,_3ac,_3ad,res,_3ae){return dojo.declare("epi.cms.contentediting.EditToolbar",[_3aa],{res:res,_editActionViewModel:null,_commands:null,_revertToPublished:null,_toolbarInitialized:null,_queueTasks:null,postCreate:function(){this.inherited(arguments);this._commands=_3ac;this._revertToPublished=_3ab(this._commands.revertToPublished,null,{title:_3ae.reverttopublishconfirmation.dialogtitle,heading:_3ae.reverttopublishconfirmation.confirmquestion,description:_3ae.reverttopublishconfirmation.description});this._commands.revertToPublished.watch("canExecute",dojo.hitch(this,function(){this.setItemProperty(this._commands.revertToPublished.name,"disabled",!this._commands.revertToPublished.canExecute);}));this._editActionViewModel=new _3ad();this._setupToolbar();},uninitialize:function(){if(this._editActionViewModel&&this._editActionViewModel.uninitialize){this._editActionViewModel.uninitialize();}this.inherited(arguments);},resize:function(_3af){this.inherited(arguments);_3a7.toggle(this.domNode,"epi-editToolbarNarrow",_3af.w<620);_3a7.toggle(this.domNode,"epi-editToolbarMedium",_3af.w>=620&&_3af.w<1000);},_setupToolbar:function(){this._toolbarInitialized=false;var _3b0=[{name:"toolbarGroupContainer",type:"toolbargroup",settings:{"class":"epi-toolbarGroupContainer"}},{parent:"toolbarGroupContainer",name:"leading",type:"toolbargroup",settings:{"class":"epi-toolbarLeading epi-toolbarGroup"}},{parent:"toolbarGroupContainer",name:"center",type:"toolbargroup",settings:{"class":"epi-toolbarCenter epi-toolbarGroup"}},{parent:"toolbarGroupContainer",name:"trailing",type:"toolbargroup",settings:{"class":"epi-toolbarTrailing epi-toolbarGroup"}}];var _3b1=[{parent:"leading",name:"breadcrumbs",widgetType:"epi.cms.widget.Breadcrumb",settings:{showCurrentNode:false}},{parent:"leading",name:"pagename",type:"label",settings:{"class":"dojoxEllipsis"}},{parent:"center",name:"save",label:this.res.autosave.savinglabel,type:"dropdown",settings:{"class":"epi-autosave-hidden"}},{parent:"save",name:"undo",title:this.res.undo.title,label:epi.resources.action.undo,type:"menuitem",iconClass:"epi-iconUndo",settings:{disabled:true,showLabel:false},action:function(){dojo.publish("/epi/cms/action/undo",[]);}},{parent:"save",name:"redo",title:this.res.redo.title,label:epi.resources.action.redo,type:"menuitem",iconClass:"epi-iconRedo",settings:{disabled:true,showLabel:false},action:function(){dojo.publish("/epi/cms/action/redo",[]);}},{parent:"save",name:"reverttopublished",title:this._commands.revertToPublished.tooltip,label:this._commands.revertToPublished.label,type:"menuitem",iconClass:"epi-iconRevert",settings:{separate:true},action:dojo.hitch(this,function(){this._revertToPublished.execute();})},{parent:"trailing",name:"notifications",widgetType:"epi.cms.widget.NotificationStatusBar"},{name:"editactionpanel",label:epi.resources.action.publish,parent:"trailing",widgetType:"epi.cms.contentediting.EditActionPanel",settings:{model:this._editActionViewModel}},{parent:"trailing",name:"editmodeswitch",title:this.res.formedit.title,label:this.res.formedit.label,widgetType:"dijit.form.ToggleButton",iconClass:"epi-iconForms",settings:{showLabel:false,"class":"epi-mediumButton epi-chromelessButton"},action:function(){setTimeout(function(){dojo.publish("/epi/cms/action/switcheditmode");},0);}}];var _3b2=new _3a6([this.add(_3b0),this.add(_3b1)]);_3b2.then(lang.hitch(this,function(_3b3){this._toolbarInitialized=true;this._processInQueueTasks();}));},_setContentViewModelAttr:function(_3b4){this._set("contentViewModel",_3b4);if(!this._toolbarInitialized){this._pushInQueue(this._updateToolbarItems,[_3b4]);return;}this._updateToolbarItems(_3b4);},_pushInQueue:function(_3b5,_3b6){if(!this._queueTasks){this._queueTasks=[];}this._queueTasks.push({callback:_3b5,parameters:_3b6 instanceof Array?_3b6:[_3b6]});},_processInQueueTasks:function(){if(!this._queueTasks||this._queueTasks.length<=0){return;}_3a5.forEach(this._queueTasks,lang.hitch(this,function(_3b7){if(_3b7){_3b7.callback.apply(this,_3b7.parameters);}}));delete this._queueTasks;this._queueTasks=[];},_updateToolbarItems:function(_3b8){this.setItemProperty("save","label","");this.setItemVisibility("save",false);this.setItemProperty("save","class","epi-autoSaveButton epi-disabledDropdownArrow");var _3b9=_3b8.contentData;this.setItemProperty("breadcrumbs","displayAsText",_3b9.capabilities.isBlock);this.setItemProperty("breadcrumbs","contentLink",_3b9.contentLink);this.setItemProperty("pagename","label",_3b9.name);this.setItemProperty("notifications","page",_3b9);var _3ba="",_3bb="";if(_3b8.viewName==="formedit"){_3ba=this.res.onpageedit.title;_3bb=this.res.onpageedit.label;}else{this.setItemProperty("editmodeswitch","checked",false);_3ba=this.res.formedit.title;_3bb=this.res.formedit.label;}this.setItemProperty("editmodeswitch","title",_3ba);this.setItemProperty("editmodeswitch","label",_3bb);this.setItemVisibility("editmodeswitch",_3b8.hasEditAccess()&&_3b9.hasTemplate);this._editActionViewModel.set("dataModel",_3b8);}});});},"epi/shell/ClipboardManager":function(){define(["dojo/_base/declare","dojo/Stateful"],function(_3bc,_3bd){return _3bc(_3bd,{copy:true,data:null,constructor:function(){this.data=[];},clear:function(){this.set("data",null);},isCopy:function(){return this.get("copy");},setDataObject:function(_3be,copy){this.set("copy",copy);this.set("data",_3be);},getDataObject:function(){return this.data;},containsData:function(){return !!this.data;}});});},"epi/cms/contentediting/AutoSaveButton":function(){define("epi/cms/contentediting/AutoSaveButton",["dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/dom-style","dojo/string","dijit/_WidgetBase","epi/datetime","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons.autosave"],function(_3bf,_3c0,_3c1,lang,_3c2,_3c3,_3c4,_3c5,_3c6,res){var _3c7={Saving:0,Offline:1,Saved:2};return _3c1("epi.cms.contentediting.AutoSaveButton",[_3c5],{_state:null,button:undefined,lastSaved:undefined,model:null,_currentlySavingClass:"epi-autosave-saving",_errorClass:"epi-autosave-error",_savedClass:"epi-autosave-saved",_hoverClass:"epi-autosave-hover",_modelHandles:null,postMixInProperties:function(){this.inherited(arguments);this._modelHandles=[];},postCreate:function(){this.inherited(arguments);if(!this.button){return;}this.connect(this.button.domNode,"onmouseover",this._addHoverClass);this.connect(this.button.domNode,"onmouseout",this._removeHoverClass);},_setModelAttr:function(_3c8){_3bf.forEach(this._modelHandles,function(_3c9){_3c9.unwatch();});this._set("model",_3c8);if(_3c8){this._modelHandles=[_3c8.watch("isOnline",lang.hitch(this,"_isOnlineChanged")),_3c8.watch("lastSaved",lang.hitch(this,"_lastSavedChanged")),_3c8.watch("isSaved",lang.hitch(this,"_isSavedChanged")),_3c8.watch("isSaving",lang.hitch(this,"_isSavingChanged")),_3c8.watch("hasErrors",lang.hitch(this,"_hasErrorsChanged"))];this.set("lastSaved",_3c8.lastSaved);if(this.lastSaved){this._setVisibility(true);this.updateButton();}else{this._setVisibility(false);}}},_setLastSavedAttr:function(_3ca){this._set("lastSaved",_3ca);this.updateLastSaveTime();},_isOnlineChanged:function(name,_3cb,_3cc){if(_3cc===_3cb){return;}if(_3cc){this.revertToLastAutoSaveTime();}else{this.showOfflineStatus();}},_lastSavedChanged:function(name,_3cd,_3ce){this.set("lastSaved",_3ce);},_isSavedChanged:function(name,_3cf,_3d0){if(_3d0){this.updateLastSaveTime();}},_isSavingChanged:function(name,_3d1,_3d2){if(_3d2){this.showSavingStatus();}else{if(!this.model.isSaved){this.revertToLastAutoSaveTime();}}},_hasErrorsChanged:function(name,_3d3,_3d4){if(_3d3===_3d4){return;}if(!_3d4){this.revertToLastAutoSaveTime();}else{_3c0.publish("/epi/cms/action/showerror");}},_animateSaving:function(){_3c2.replace(this.button.domNode,this._currentlySavingClass,[this._errorClass,this._savedClass]);this._removeHoverClass();},_animateOffline:function(){_3c2.replace(this.button.domNode,this._errorClass,[this._currentlySavingClass,this._savedClass]);this._removeHoverClass();},_animateSaved:function(){_3c2.replace(this.button.domNode,this._savedClass,[this._currentlySavingClass,this._errorClass]);this._removeHoverClass();},_addHoverClass:function(){if(this._state==null||this._state==_3c7.Saving||this._hasDropDownOpen()){return;}if(this._state==_3c7.Saved){_3c2.add(this.button.domNode,this._hoverClass);}},_removeHoverClass:function(){if(!this._hasDropDownOpen()){_3c2.remove(this.button.domNode,this._hoverClass);}},_updateState:function(text){this.button.set("label",text);this.button.set("disabled",this._state!=_3c7.Saved);this._setVisibility(true);},_setVisibility:function(_3d5){if(this.button){_3c3.set(this.button.domNode,{visibility:_3d5?"visible":"hidden"});}},_hasDropDownOpen:function(){return this.button._popupStateNode?_3c2.contains(this.button._popupStateNode,"dijitHasDropDownOpen"):false;},revertToLastAutoSaveTime:function(){if(this.lastSaved===undefined){this._setVisibility(false);return;}this.updateLastSaveTime();},updateLastSaveTime:function(){if(!this.lastSaved){return;}if(!this.model.isOnline){return;}setTimeout(lang.hitch(this,function(){if(this.model.isOnline){this.updateButton();this._animateSaved();}}),1000);},showSavingStatus:function(){this._state=_3c7.Saving;this._updateState(res.savinglabel);this._animateSaving();},showOfflineStatus:function(){this._state=_3c7.Offline;this._updateState(res.offlinelabel);this._animateOffline();},updateButton:function(){if(!this.lastSaved){this._setVisibility(false);return;}this._state=_3c7.Saved;var _3d6="<span class=\"dijitReset dijitInline clearfix\">${autosavelabel} ${timestamp}</span>&nbsp;<span class=\"epi-inlineButtonLink\">${undolabel}</span>";var _3d7={autosavelabel:res.autosavelabel,undolabel:res.undolabel,timestamp:_3c6.toUserFriendlyHtml(this.lastSaved,null,true)};this._updateState(_3c4.substitute(_3d6,_3d7));}});});},"epi/cms/contentediting/commandproviders/ContentDetails":function(){define("epi/cms/contentediting/commandproviders/ContentDetails",["dojo","dojo/_base/declare","epi/shell/command/_CommandProviderMixin","epi/cms/contentediting/command/PermanentInUseToggle"],function(dojo,_3d8,_3d9,_3da){return _3d8([_3d9],{constructor:function(){this.inherited(arguments);this.add("commands",new _3da());}});});},"epi/shell/widget/SearchBox":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-attr","dojo/dom-class","dojo/dom-style","dojo/Evented","dojo/keys","dijit/_TemplatedMixin","dijit/_Widget","dijit/_WidgetsInTemplateMixin","dijit/focus","dijit/form/TextBox","dojox/html/entities","dgrid/util/misc","dojo/text!./templates/SearchBox.html","epi/i18n!epi/shell/ui/nls/EPiServer.Shell.UI.Resources.SearchBox"],function(_3db,lang,_3dc,_3dd,_3de,_3df,keys,_3e0,_3e1,_3e2,_3e3,_3e4,_3e5,_3e6,_3e7,_3e8){return _3db("epi.shell.widget.SearchBox",[_3e4,_3df],{templateString:_3e7,placeHolder:epi.resources.action.search,commonRes:epi.resources,defaultDelay:500,encodeSearchText:false,postCreate:function(){this.inherited(arguments);_3dc.set(this.clearButton,"title",_3e8.clear);this.connect(this.clearButton,"onclick",lang.hitch(this,function(){this.set("value","");this.focus();this.toggleClearButton();this._valueChanged();}));this.toggleClearButton();this.connect(this,"_onInput",_3e6.debounce(lang.hitch(this,function(_3e9){this.toggleClearButton();this._valueChanged(_3e9);}),null,this.defaultDelay));},toggleClearButton:function(){_3de.set(this.clearButton,"visibility",this.textbox.value?"visible":"hidden");},focus:function(){_3e3.focus(this.textbox);},_setValueAttr:function(_3ea){this.textbox.value=_3ea;},_valueChanged:function(_3eb){if(_3eb&&_3eb.charOrCode){switch(_3eb.charOrCode){case keys.PAGE_DOWN:case keys.DOWN_ARROW:case keys.PAGE_UP:case keys.UP_ARROW:case keys.LEFT_ARROW:case keys.RIGHT_ARROW:return;}}this.emit("searchBoxChange",this.encodeSearchText?_3e5.encode(this.textbox.value):this.textbox.value);}});});},"epi/cms/BackContextHistory":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/store/Memory","epi/shell/ContextHistory"],function(_3ec,lang,_3ed,_3ee){return _3ec("epi.cms.BackContextHistory",[_3ee],{createStoreItem:function(){var _3ef=this.inherited(arguments);lang.mixin(_3ef,{index:this.store.data.length});return _3ef;},createStore:function(){return new _3ed({data:[],idProperty:"index"});},onContextChanged:function(_3f0,_3f1,_3f2){if(_3f1&&_3f1.trigger==="back"){this._removeLastItem();return;}this.inherited(arguments);},getPrevious:function(){var _3f3=this.store.query({},{count:2,sort:[{attribute:"dateAdded",descending:true}]});return (_3f3&&_3f3.length>1)?_3f3[1]:null;},_removeLastItem:function(){if(this.store.data&&this.store.data.length>0){var key=this.store.data[this.store.data.length-1].index;this.store.remove(key);}}});});},"url:epi/cms/widget/templates/ReadOnlyDateTimeEditor.html":"<div class=\"dijit dijitReset dijitInline dijitLeft\" data-dojo-attach-point=\"valueNode\"></div>","epi/cms/contentediting/command/Publish":function(){define("epi/cms/contentediting/command/Publish",["dojo/_base/declare","dojo/_base/Deferred","epi/shell/command/_Command","epi/cms/core/ContentReference","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/command/_ChangeContentStatus","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons"],function(_3f4,_3f5,_3f6,_3f7,_3f8,_3f9,_3fa){return _3f4("epi.cms.contentediting.command.Publish",[_3f9],{name:"publish",label:_3fa.publish.label,executingLabel:_3fa.publish.executinglabel,tooltip:_3fa.publish.title,action:_3f8.action.Publish,_execute:function(){var def=new _3f5();_3f5.when(this.inherited(arguments),function(_3fb){var _3fc=new _3f7(_3fb.oldId).createVersionUnspecificReference().toString();dojo.publish("/epi/cms/contentdata/childrenchanged",_3fc);def.resolve();},function(){def.cancel();});return def;},_onModelChange:function(){this.inherited(arguments);var _3fd=this.model.contentData,_3fe=_3fd.status,_3ff=this.model.canChangeContent(_3f8.action.Publish),_400=_3ff&&!(_3fe===_3f8.versionStatus.Published&&!_3fd.isCommonDraft),res=null;switch(_3fe){case _3f8.versionStatus.CheckedIn:res=_3fa.approveandpublish;break;case _3f8.versionStatus.PreviouslyPublished:res=_3fa.republish;break;case _3f8.versionStatus.CheckedOut:if(_3fd.isMasterVersion){res=_3fa.publish;}else{res=_3fa.publishchanges;}break;default:res=_3fa.publishchanges;}this.set("label",res.label);this.set("title",res.title);this.set("executingLabel",res.executinglabel);this.set("canExecute",_400);this.set("isAvailable",_3ff);}});});},"epi/cms/widget/XFormPropertyWidget":function(){define("epi/cms/widget/XFormPropertyWidget",["dojo/_base/declare","dojo/_base/lang","epi/epi","epi/routes","epi/cms/legacy/LegacyDialogWrapper","epi/cms/core/ContentReference","epi/i18n!epi/cms/nls/episerver.cms.widget.xformeditor"],function(_401,lang,epi,_402,_403,_404,res){return _401("epi.cms.widget.XFormPropertyWidget",[_403],{title:res.selectform,onChange:function(_405){},postMixInProperties:function(){this.features=lang.mixin({width:800,height:400},this.editorFeatures);this.autoFit=true;this.connect(this,"onCallback","_onCallback");this.inherited(arguments);},startup:function(){this.inherited(arguments);this.set("url",this._buildIframeUrl());},onCancel:function(){},_buildIframeUrl:function(){var _406={moduleArea:"LegacyCMS",path:"edit/XFormSelect.aspx",epslanguage:this.contentLanguage,propertyname:this.fullName};lang.mixin(_406,{"pageId":new _404(this.contentLink).createVersionUnspecificReference().id,"form":this.value?this.value:""});return _402.getActionPath(_406);},_onCallback:function(_407){var _408=_407?_407.id:null;if(!epi.areEqual(this.value,_408)&&_407!==null){this.value=_408;this.onChange(_408);}else{this.onCancel();}}});});},"epi/cms/contentediting/OnPageEditing":function(){define("epi/cms/contentediting/OnPageEditing",["dojo","epi/cms/contentediting/EditingBase"],function(dojo,_409){return dojo.declare("epi.cms.contentediting.OnPageEditing",[_409],{onReadySetupEditMode:function(){this.inherited(arguments);this.toolbar.setItemProperty("editmodeswitch","checked",false);this.onSetupEditModeComplete();},onSetActiveProperty:function(_40a){var _40b=this._mappingManager.findOne("propertyName",_40a);if(!_40b){dojo.publish("/epi/cms/action/switcheditmode",[null,{activePropertyOnStartup:_40a}]);}else{this.inherited(arguments);}},_onOverlayItemClick:function(_40c,e){if(this._activeEditor!=null){this._closeEditorWrapper(this._activeEditor);return;}this.inherited(arguments);},_closeEditorWrapper:function(_40d){_40d.tryToStopEditing();}});});},"epi/cms/widget/ContentType":function(){require({cache:{"url:epi/cms/widget/templates/ContentType.html":"<li class=\"clearfix\" data-dojo-attach-event=\"onkeypress:_onKeyPress, onmouseover:_onMouseOver, onmouseout:_onMouseOut\" data-dojo-attach-point=\"focusNode\">\r\n    <div class=\"epi-browserWindow\"><div class=\"epi-browserWindowContent\" data-dojo-attach-point=\"iconNode\">${emptyIconTemplate}</div></div>\r\n    <h3 data-dojo-attach-point=\"nameNode\"></h3>\r\n    <p data-dojo-attach-point=\"descriptionNode\"></p>\r\n</li>"}});define("epi/cms/widget/ContentType",["dojo","dojo/dom-class","dojo/string","dijit/focus","dijit/_Widget","dijit/_TemplatedMixin","epi/i18n!epi/cms/nls/episerver.cms.widget.pagetype","dojo/text!./templates/ContentType.html"],function(dojo,_40e,_40f,_410,_411,_412,i18n,_413){return dojo.declare("epi.cms.widget.ContentType",[_411,_412],{templateString:_413,contentType:null,iconTemplate:"<img src=\"${0}\" alt=\"${1}\" class=\"epi-preview\" />",emptyIconTemplate:_40f.substitute("<div class=\"epi-noPreviewIcon\"><span class=\"epi-noPreview\">${0}</span></div>",[i18n.nopreview]),buildRendering:function(){this.inherited(arguments);this.connect(this.domNode,"onclick",this._onClick);this.render();},render:function(){var type=this.contentType;if(type){this.set("name",type.localizedName);this.set("description",type.localizedDescription||i18n.nodescription);this.set("icon",type.imagePath);}},_setContentTypeAttr:function(_414){this._set("contentType",_414);if(this._created){this.render();}},_setNameAttr:{node:"nameNode",type:"innerText"},_setDescriptionAttr:{node:"descriptionNode",type:"innerText"},_setIconAttr:function(_415){this._set("icon",_415);this.iconNode.innerHTML=_415?_40f.substitute(this.iconTemplate,[_415,this.name]):this.emptyIconTemplate;},focus:function(){this.inherited(arguments);_40e.add(this.focusNode,"epi-advancedListingItemActive");_410.focus(this.focusNode);},_onBlur:function(){this.inherited(arguments);_40e.remove(this.focusNode,"epi-advancedListingItemActive");},_onKeyPress:function(e){if(e.keyCode===13||e.keyCode===32){this.onSelect(this.contentType);}},_onClick:function(){this.onSelect(this.contentType);},_onMouseOver:function(){_40e.add(this.focusNode,"epi-advancedListingItemActive");},_onMouseOut:function(){_40e.remove(this.focusNode,"epi-advancedListingItemActive");},onSelect:function(item){}});});},"epi/cms/contentediting/editors/ShortcutEditor":function(){define("epi/cms/contentediting/editors/ShortcutEditor",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/dom-style","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/form/Button","epi","epi/shell/widget/dialog/Dialog","epi/cms/contentediting/ShortcutDialog","../viewmodel/ShortcutDialogViewModel","../../widget/_HasChildDialogMixin","epi/i18n!epi/cms/nls/episerver.cms.widget.shortcutblockeditor","epi/i18n!epi/cms/nls/shell.common.buttons"],function(_416,lang,_417,_418,_419,_41a,_41b,_41c,epi,_41d,_41e,_41f,_420,_421,_422){return _416("epi.cms.contentediting.editors.ShortcutEditor",[_419,_41a,_41b,_420],{templateString:"<div><span data-dojo-attach-point=\"shortcutTypeNameNode\" class=\"dijitInline\"></span> <div data-dojo-attach-point=\"button\" data-dojo-type=\"dijit.form.Button\" data-dojo-attach-event=\"onClick:_showDialog\" >${resources.action.manage}</div></div>",resources:epi.resources,value:null,contentLink:null,metadata:null,watchHandlers:null,postCreate:function(){this.inherited(arguments);_417.add(this.button.domNode,"epi-chromelessButton epi-chromelessLinkButton epi-functionLink");},destroy:function(){if(this.button){this.button.destroyRecursive();}this.inherited(arguments);},onChange:function(_423){},_showDialog:function(){var _424=new _41e({metadata:this.metadata,contentLink:this.contentLink,value:this.value,model:new _41f({contentLink:this.contentLink,contentName:this.contentName,value:this.value})});var _425=new _41d({destroyOnHide:true,defaultActionsVisible:false,confirmActionText:_422.save,content:_424,title:_421.dialogtitle});_425.connect(_425,"onExecute",lang.hitch(this,function(_426){this.set("value",_424.get("value"));this.onChange(_424.get("value"));}));_425.connect(_425,"onHide",lang.hitch(this,function(){this.isShowingChildDialog=false;}));this.isShowingChildDialog=true;_425.show();},_setShortcutTypeNameAttr:{node:"shortcutTypeNameNode",type:"innerHTML"},_setReadOnlyAttr:function(_427){this._set("readOnly",_427);_418.set(this.button.domNode,"display",_427?"none":"");},_setValueAttr:function(_428){this._set("value",_428);this.set("ShortcutTypeName",_428&&_428.pageShortcutTypeName?_428.pageShortcutTypeName:"");}});});},"url:epi/cms/widget/templates/FilesUploadDropZone.html":"<div class=\"epi-filesUploadDropZone\">\r\n    <div>\r\n        <span data-dojo-attach-point=\"description\">${res.description}</span>\r\n    </div>\r\n</div>","epi/cms/contentediting/PageDataController":function(){define("epi/cms/contentediting/PageDataController",["dojo","dojo/i18n","dojo/_base/Deferred","dojo/_base/lang","dojo/DeferredList","dijit/_TemplatedMixin","dijit/_Widget","dijit/_WidgetsInTemplateMixin","dijit/layout/BorderContainer","epi/Url","epi/dependency","epi/routes","epi/string","epi/shell/widget/dialog/Alert","epi/shell/widget/Iframe","epi/shell/widget/IframeWithOverlay","epi/shell/widget/Toolbar","epi/cms/_ContentContextMixin","epi/cms/contentediting/EditToolbar","epi/cms/contentediting/ContentViewModel","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/ExpirationNotification","epi/cms/contentediting/NotificationBar","epi/cms/contentediting/ContentReferencesNotification","epi/cms/contentediting/LanguageNotification","epi/cms/contentediting/ShortcutNotification","epi/cms/contentediting/ViewSettingsNotification","epi/cms/contentediting/command/Editing","epi/cms/core/ContentReference","epi/i18n!epi/cms/nls/episerver.cms.contentediting","dojo/text!./templates/PageDataController.html"],function(dojo,i18n,_429,lang,_42a,_42b,_42c,_42d,_42e,Url,_42f,_430,_431,_432,_433,_434,_435,_436,_437,_438,_439,_43a,_43b,_43c,_43d,_43e,_43f,_440,_441,res,_442){return dojo.declare("epi.cms.contentediting.PageDataController",[_42c,_42b,_42d,_436],{templateString:_442,contextTypeName:"epi.cms.contentdata",pendingNotificationTimeOutId:null,isActive:true,_startViewName:"view",_defaultEditViewName:"onpageedit",_currentViewComponent:null,_viewModels:null,_notificationHandlerId:null,_messageService:null,_editingCommands:null,_currentViewModel:null,_pageDataStore:null,_contentReferencesNotification:null,_shortcutNotification:null,_languageNotification:null,_viewMap:{"view":"epi.cms.contentediting.ContentPreview","onpageedit":"epi.cms.contentediting.OnPageEditing","formedit":"epi.cms.contentediting.FormEditing","readonly":"epi.cms.contentediting.ReadOnlyView"},_previewQueryParameters:null,_viewSettingsManager:null,_inUseNotificationManager:null,_showOverlay:true,postMixInProperties:function(){this.inherited(arguments);this._viewSettingsManager=_42f.resolve("epi.viewsettingsmanager");this.connect(this._viewSettingsManager,"onReloadRequired","_onViewRequireReload");this._messageService=this._messageService||_42f.resolve("epi.shell.MessageService");this._profile=this._profile||_42f.resolve("epi.shell.Profile");var _443=_42f.resolve("epi.storeregistry");this._pageDataStore=_443.get("epi.cms.contentdata");this._editingCommands=_440;if(!this._viewModels){this._viewModels=[];}this._previewQueryParameters={epiworkspaceactive:!this._profile.get("view_publicsite")};this._inUseNotificationManager=this.inUseNotificationManager||_42f.resolve("epi.cms.contentediting.inUseNotificationManager");this._contentReferencesNotification=new _43c();this._languageNotification=new _43d();this._expirationNotification=new _43a();this._shortcutNotification=new _43e();this._viewSettingsNotification=new _43f();},postCreate:function(){this.inherited(arguments);this._profile.watch("view_publicsite",dojo.hitch(this,function(){var _444=!this._profile.get("view_publicsite");if(this._previewQueryParameters){if(this._previewQueryParameters.epiworkspaceactive!=_444){this._previewQueryParameters.epiworkspaceactive=_444;}}}));this.subscribe("/epi/cms/action/switcheditmode",dojo.hitch(this,this._switchEditMode));this.subscribe("/epi/cms/action/displaypreview",dojo.hitch(this,function(){var _445=this._currentContentContext;var _446=this._getPreviewUrl(_445,"view");this._previousEditMode=this._currentViewModel.viewName;this._ensurePreviewReady(this.setView("view"),_446);}));var cs=_42f.resolve("epi.shell.ContextService");this._interceptorHandle=cs.registerRequestInterceptor(dojo.hitch(this,this._interceptRequestContext));this.notificationBar.on("notificationsChanged",dojo.hitch(this,function(){this.layoutContainer.layout();}));this._contentReferencesNotification.watch("notification",dojo.hitch(this,function(name,_447,_448){if(_447){this.notificationBar.remove(_447);}if(_448&&_448.content){this.notificationBar.add(_448);}this.notificationBar.set("viewModel",this._currentViewModel.contentData);}));this._languageNotification.watch("notification",lang.hitch(this,"_defaultNotificationWatchHandler"));this._expirationNotification.watch("notification",lang.hitch(this,"_defaultNotificationWatchHandler"));this._shortcutNotification.watch("notification",lang.hitch(this,"_shortcutNotificationWatchHandler"));this._viewSettingsNotification.watch("notification",lang.hitch(this,"_defaultNotificationWatchHandler"));},startup:function(){if(this._started){return;}this.inherited(arguments);var url=new Url(window.location.href);var _449=url.getQueryParameterValue("view");this.iFrame=this.iframeWithOverlay.iframe;this.connect(this.iFrame,"onLoad","_iFrameLoaded");this.connect(this.iFrame,"onUnload","_iFrameUnLoaded");this.connect(this.iFrame,"onLoading","_iFrameLoading");dojo.addClass(this.toolbar.domNode,"epi-localToolbar");this._injectCssRules();if(_449 in this._viewMap){this._startViewName=_449;}_429.when(this.getCurrentContext(),dojo.hitch(this,function(_44a){this.contextChanged(_44a);}));},_shortcutNotificationWatchHandler:function(name,_44b,_44c){this._defaultNotificationWatchHandler(name,_44b,_44c);this._showOverlay=_43e.LinkTypes[_44c.shortcutType]!=="fetchdata";},_defaultNotificationWatchHandler:function(name,_44d,_44e){if(_44d){this.notificationBar.remove(_44d);}if(_44e&&_44e.content){this.notificationBar.add(_44e);}},_switchEditMode:function(_44f,_450){var _451;var _452=this._currentViewModel.viewName;if(_44f&&_452==="view"){_451=this._previousEditMode;}else{if(_452==="formedit"){_451=this._currentViewModel.canChangeContent()?"onpageedit":"readonly";}else{_451="formedit";}}var _453=null;if(this._currentViewComponent&&this._currentViewComponent.get("noPreview")){_453=this._currentContentContext.previewUrl;}this._ensurePreviewReady(this.setView(_451,_450),_453,function(view){});},destroy:function(){this._interceptorHandle.remove();this._destroyCurrentViewComponent();this._viewModels=null;this.inherited(arguments);},_iFrameLoading:function(url){if(this._currentViewComponent){this._currentViewComponent.onPreviewLoading();}},_iFrameLoaded:function(url,_454){var _455=this.iFrame.isInspectable();if(!_455){return;}if(!_454){this._requestContextChangeByUrl(url,true,true);}},_iFrameUnLoaded:function(url){this.iframeWithOverlay.overlay.set("enabled",false);},_destroyCurrentViewComponent:function(){if(this._currentViewComponentReloadRequireHandle){this._currentViewComponentReloadRequireHandle.remove();}if(this._currentViewComponent){this._currentViewComponent.destroyRecursive();delete this._currentViewComponent;}},_getViewModelIndex:function(id){var _456=-1;dojo.some(this._viewModels,function(item,idx){if(item.contentLink==id){_456=idx;return true;}});return _456;},_getViewModel:function(id){var _457=this._getViewModelIndex(id);if(_457>=0){return this._viewModels[_457];}else{return null;}},_removeViewModel:function(id){var _458=this._getViewModelIndex(id);if(_458>=0){var _459=this._viewModels.splice(_458,1)[0];_459.clear();}},_createViewModel:function(_45a,ctx){var _45b=new _438({contentLink:_45a.contentLink,contextTypeName:this.contextTypeName});_45b.setContentData(_45a,ctx);this._viewModels.push(_45b);return _45b;},contentContextChanged:function(ctx,_45c,_45d){if(!this.isActive){return;}this.inherited(arguments);if(_45c&&_45c.contentLinkSyncChange){this._pageDataStore.refresh(ctx.id).then(dojo.hitch(this,function(_45e){this._currentViewModel.setContentData(_45e,ctx);this._currentViewComponent.onContentLinkSyncChange();this.toolbar.set("contentViewModel",this._currentViewModel);this._editingCommands.set("model",this._currentViewModel);}));}else{this._previousEditMode=null;if(this._currentViewModel){this._currentViewModel.suspend();}var _45f=_45c?_45c.viewName:null;if(!_45f&&this._currentViewComponent&&this._currentViewComponent.isSticky){_45f=this._currentViewModel.viewName;}var _460=this._getPreviewUrl(ctx,_45f);if(_45c&&_45c.triggeredByPreview){_460=null;}this._ensurePreviewReady(this._loadContentDataAndSetView(ctx.id,_45f,ctx),_460);}},contentContextUpdated:function(ctx,_461){var _462=ctx.id;this._pageDataStore.refresh(_462).then(dojo.hitch(this,function(_463){if(this._currentViewModel){this._currentViewModel.set("contentData",_463);}}));},_getPreviewUrl:function(_464,_465){var _466=(_465==="view"&&!_464.capabilities.isBlock&&_464.hasTemplate)?_464.publicUrl:_464.previewUrl;var _467=new Url(_466);_467.query.id=_464.id;return _467.toString();},_ensurePreviewReady:function(_468,_469){var _46a=[];if(_468){_46a.push(_468);}if(_469!==null&&_469!==undefined){_46a.push(this._changeUrl(_469));}var dl=new _42a(_46a);_429.when(dl,dojo.hitch(this,function(){var doc=this.iFrame.getDocument();var _46b=this.connect(this._currentViewComponent,"onPrepareOverlayComplete",function(){this.disconnect(_46b);this.iframeWithOverlay.overlay.set("enabled",this._showOverlay&&this.iFrame.isInspectable());this.iframeWithOverlay.layout(true);});this._viewSettingsManager.onPreviewReady(this.iframeWithOverlay);this._currentViewComponent.onPreviewReady(this._currentViewModel,doc);this._viewSettingsNotification.set("model",{viewModel:this._currentViewModel,viewSetting:this._viewSettingsManager});}));},_loadContentDataAndSetView:function(_46c,_46d,ctx){var def=new _429();this._pageDataStore.refresh(_46c).then(dojo.hitch(this,function(_46e){if(!_46e){return;}this._currentViewModel=this._getViewModel(_46e.contentLink);this.notificationBar.clear();if(!this._currentViewModel){this._currentViewModel=this._createViewModel(_46e,ctx);}else{this._currentViewModel.setContentData(_46e,ctx);}this._inUseNotificationManager.updateCommandModel(this._currentViewModel);this._editingCommands.set("model",this._currentViewModel);this._contentReferencesNotification.set("contentData",_46e);this._languageNotification.set("contentData",_46e);this._shortcutNotification.set("viewModel",this._currentViewModel);this._expirationNotification.update(this._currentViewModel);_429.when(this.setView(_46d),function(){def.resolve();},function(){def.cancel();});}),function(){def.cancel();});return def;},itemChanged:function(id,item){if(this._currentViewComponent){this._currentViewComponent.set("page",item);}},setView:function(_46f,_470){var def=new _429();if(_46f&&!(_46f in this._viewMap)){return;}var _471=dojo.hitch(this,function(){_429.when(this._setView(_46f,_470),function(){def.resolve();},function(){def.cancel();});});var _472=dojo.hitch(this,function(){dojo.publish("/epi/cms/action/showerror");def.cancel();});_429.when(this._savePendingChanges(),_471,_472);return def;},_setView:function(_473,_474){var def=new _429();_473=_473||this._getDefaultView(this._currentViewModel);var _475=this._currentViewComponent;var _476=_475&&_475.viewModel&&_475.viewModel.viewName===_473;if(_476){this._currentViewModel.viewName=_473;def.resolve();}else{if(_473!=="view"){dojo.publish("/epi/cms/action/disablepreview");}this._destroyCurrentViewComponent();var _477=_431.slashName(this._viewMap[_473]);require([_477],dojo.hitch(this,function(_478){this._currentViewComponent=new _478(lang.mixin({layoutContainer:this.layoutContainer,iframeWithOverlay:this.iframeWithOverlay,contextTypeName:this.contextTypeName,toolbar:this.toolbar},_474));this._currentViewComponentReloadRequireHandle=this.connect(this._currentViewComponent,"onReloadRequired",dojo.hitch(this,this._onViewRequireReload));this._currentViewComponent.startup();this._currentViewModel.viewName=_473;def.resolve();}));}this.toolbar.set("contentViewModel",this._currentViewModel);return def;},_onViewRequireReload:function(){this._ensurePreviewReady(null,this._currentContentContext.previewUrl);},resize:function(size){this.inherited(arguments);this.layoutContainer.resize(size);},onShow:function(){this.iframeWithOverlay.overlay.set("enabled",this._showOverlay);},onHide:function(){this.iframeWithOverlay.overlay.set("enabled",false);},_clearNotifications:function(){if(this._currentViewModel&&this._currentViewModel.validator){this._currentViewModel.validator.clear();}},_requestContextChangeByUrl:function(url,_479,_47a,_47b,_47c){var _47d=new Url(url,_47b,_47c);var _47e={url:_47d.toString()};dojo.publish("/epi/shell/context/request",[_47e,{sender:this,forceContextChange:_479,triggeredByPreview:_47a}]);},_changeUrl:function(url){var _47f=lang.mixin(this._previewQueryParameters,this._viewSettingsManager.get("previewParams"));return this.iFrame.load(url,{query:_47f},true);},_getDefaultView:function(_480){return _480.contentData.hasTemplate?(_480.canChangeContent()?this._defaultEditViewName:"readonly"):"formedit";},_interceptRequestContext:function(_481,_482){if(!(_482&&_482.sender&&_482.sender===this)){return this._savePendingChanges();}else{var def=new _429();def.resolve();return def;}},_savePendingChanges:function(){if(this._currentViewModel&&!this._currentViewModel.isSaved){return this._currentViewModel.save();}else{var def=new _429();def.resolve();return def;}},savePendingChanges:function(){return this._savePendingChanges();},_injectCssRules:function(){this.iFrame.addCssRules([{selector:".epi-injected-minSize",css:"min-height: 30px;"},{selector:".epi-injected-minSize-inline",css:"min-height: 30px; min-width: 100px; display: inline-block !important;"}]);}});});},"epi/cms/contentediting/ContentReferencesNotification":function(){define("epi/cms/contentediting/ContentReferencesNotification",["dojo/_base/declare","dojo/_base/lang","dojo/dom-construct","dojo/Stateful","dojo/on","epi/cms/widget/sharedContentDialogHandler","epi/dependency","epi/i18n!epi/cms/nls/episerver.cms.contentediting.notificationbar","epi/cms/command/BackCommand"],function(_483,lang,_484,_485,on,_486,_487,_488,_489){return _483("epi.cms.contentediting.ContentReferencesNotification",[_485],{contentData:null,notification:null,_referencesStore:null,_resources:_488,_command:null,constructor:function(){this.inherited(arguments);this._command=new _489();var _48a=_487.resolve("epi.storeregistry");this._referencesStore=_48a.get("epi.cms.contentreferences");},set:function(name,_48b){if(name==="contentData"&&_48b.capabilities.isBlock){dojo.when(this._referencesStore.refresh(_48b.contentLink),dojo.hitch(this,"_referencesLoaded"));}this.inherited(arguments);},_referencesLoaded:function(_48c){var _48d=0;var _48e=0;dojo.forEach(_48c,function(item){if(item.isPage){_48d++;}if(item.isBlock){_48e++;}});var _48f=_484.create("div",{innerHTML:this._resources.sharedblock+" "});if(_48d>0||_48e>0){_48f.innerHTML+=this._resources.affect;var _490="";if(_48d>0){_490+=_48d+" "+(_48d>1?this._resources.pages:this._resources.page);}if(_48d>0&&_48e>0){_490+=" "+this._resources.and+" ";}if(_48e>0){_490+=_48e+" "+(_48e>1?this._resources.blocks:this._resources.block);}var _491=_484.create("a",{href:"#",innerHTML:_490,title:this._resources.referencestooltip},_48f);on(_491,"click",lang.hitch(this,function(e){dojo.stopEvent(e);this._showBlockReferenceDialog();}));}this._command.set("model",{});this.set("notification",{content:_48f,commands:[this._command]});},_showBlockReferenceDialog:function(){_486({contentData:this.contentData,showToolbar:true,mode:_486.mode.show});}});});},"epi/cms/contentediting/editors/SelectionEditor":function(){define("epi/cms/contentediting/editors/SelectionEditor",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/on","dijit/form/Select","dijit/MenuItem","dijit/MenuSeparator","epi/shell/layout/_LayoutWidget","epi/shell/widget/_ValueRequiredMixin"],function(_492,_493,lang,_494,on,_495,_496,_497,_498,_499){return _493([_498,_495,_499],{baseClass:"dijitSelect",actualValue:null,value:null,maxHeight:-1,postMixInProperties:function(){this.inherited(arguments);this.options=_492.map(this.selections,function(item){return {label:item.text,value:item.value,selected:(item.value==this.value)||(!item.value&&!this.value)};},this);this.actualValue=this.value;},postCreate:function(){this.inherited(arguments);on(this,"change",lang.hitch(this,function(){this.validate();this.onLayoutChanged();}));},_getMenuItemForOption:function(_49a){if(_49a.type=="separator"){return new _497();}else{var _49b=lang.hitch(this,"_setValueAttr",_49a);var item=new _496({option:_49a,label:_49a.label||this.emptyLabel,onClick:_49b,disabled:_49a.disabled||false});item.focusNode.setAttribute("role","listitem");return item;}},_getValueFromOpts:function(){var _49c=this.getOptions()||[];if(!this.multiple&&_49c.length){var _49d=_492.filter(_49c,function(i){return i.selected;})[0];if(_49d&&_49d.value!==undefined){return _49d.value;}else{_49c[0].selected=true;return _49c[0].value;}}else{if(this.multiple){return _492.map(_492.filter(_49c,function(i){return i.selected;}),function(i){return i.value;})||[];}}return "";},_setValueAttr:function(_49e,_49f){var _4a0=this.getOptions()||[];if(_49e===null||typeof _49e!="object"){_49e=_492.filter(_4a0,function(i){return (i.value==_49e)||(!i.value&&!_49e);});}if(!lang.isArray(_49e)){_49e=[_49e];}if(this._onChangeActive){var _4a1=_49e[0]?_49e[0].value:null;this._pendingOnChange=this.actualValue!==_4a1;this.actualValue=_4a1;}_492.forEach(_4a0,function(i){i.selected=_492.some(_49e,function(v){return v.value===i.value;});});var val=_492.map(_49e,function(i){return i.value;}),disp=_492.map(_49e,function(i){return i.label;});this._set("value",this.multiple?val:val[0]);this._setDisplay(this.multiple?disp:disp[0]);this._updateSelection();this._handleOnChange(this.value,_49f);},_updateSelection:function(){this._set("value",this._getValueFromOpts());var _4a2=this.value;if(_4a2!==undefined){if(!lang.isArray(_4a2)){_4a2=[_4a2];}_492.forEach(this._getChildren(),function(_4a3){var _4a4=_492.some(_4a2,function(v){return _4a3.option&&(v===_4a3.option.value);});_494.toggle(_4a3.domNode,this.baseClass+"SelectedOption",_4a4);_4a3.domNode.setAttribute("aria-selected",_4a4);},this);}}});});},"epi/cms/contentediting/viewmodel/EditActionPanelViewModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/Stateful","dojo/string","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/viewmodel/_ContentViewModelObserver","epi/cms/contentediting/viewmodel/PublishMenuViewModel","epi/datetime","epi/dependency","epi/i18n!epi/cms/nls/episerver.cms.contentediting.editactionpanel"],function(_4a5,_4a6,lang,_4a7,_4a8,_4a9,_4aa,_4ab,_4ac,_4ad,res){return _4a6("epi.cms.contentediting.viewmodel.EditActionPanelViewModel",[_4aa],{state:null,buttonText:null,statusText:null,statusIcon:null,additionalClass:null,nonEditableIndicator:null,visible:null,publishMenuViewModel:null,inUseNotificationManager:null,skipChildModels:false,_virtualStatusEnum:{NotCreated:0,NotPublishedYet:1,NoChangeToPublish:2,ChangesToPublish:3,ReadyToPublish:4,ScheduledPublish:5,Published:6,PreviouslyPublished:7,Expired:8,InUse:9,Deleted:10},_virtualStatusCssState:[],_virtualStatusLocalization:[],_statusIcon:[],_watchers:null,_statusMap:{},postscript:function(){this.inherited(arguments);this.res=this.res||res;this.inUseNotificationManager=this.inUseNotificationManager||_4ad.resolve("epi.cms.contentediting.inUseNotificationManager");if(this._virtualStatusCssState.length===0){for(var _4ae in this._virtualStatusEnum){this._virtualStatusCssState.push(_4ae);this._virtualStatusLocalization.push(this.res["status"][_4ae.toLowerCase()]);}this._statusMap[_4a9.versionStatus.CheckedOut]=this._virtualStatusEnum.NotPublishedYet;this._statusMap[_4a9.versionStatus.CheckedIn]=this._virtualStatusEnum.ReadyToPublish;this._statusMap[_4a9.versionStatus.Rejected]=this._virtualStatusEnum.ChangesToPublish;this._statusMap[_4a9.versionStatus.DelayedPublish]=this._virtualStatusEnum.ScheduledPublish;this._statusMap[_4a9.versionStatus.Published]=this._virtualStatusEnum.Published;this._statusMap[_4a9.versionStatus.PreviouslyPublished]=this._virtualStatusEnum.PreviouslyPublished;this._statusMap[_4a9.versionStatus.Expired]=this._virtualStatusEnum.Expired;this._statusIcon[_4a9.versionStatus.DelayedPublish]="epi-iconClock";this._statusIcon[_4a9.versionStatus.Rejected]="epi-iconStop";}if(!this.skipChildModels){this.publishMenuViewModel=new _4ab({inUseNotificationManager:this.inUseNotificationManager});}},uninitialize:function(){if(this.publishMenuViewModel){this.publishMenuViewModel.uninitialize();}this.inherited(arguments);},_setDataModelAttr:function(_4af){this.inherited(arguments);if(this.publishMenuViewModel){this.publishMenuViewModel.set("dataModel",_4af);}},onDataModelChange:function(name,_4b0,_4b1){var _4b2=this.dataModel.contentData,_4b3=this._getVirtualStatus(_4b2);this.set("state",this._virtualStatusCssState[_4b3]);this.set("additionalClass",_4b3===this._virtualStatusEnum.ChangesToPublish?"animated8 shake":"");this._setStatusText(_4b3,_4b2);this.set("buttonText",this._getButtonText(_4b3,_4b2));this.set("statusIcon",this._statusIcon[_4b2.versionStatus]||"");var _4b4=this.dataModel.canChangeContent(_4a9.action.Edit);this.set("nonEditableIndicator",!_4b4);this.set("visible",!_4b2.isWastebasket);},_setStatusText:function(_4b5,_4b6){if(_4b6.status===_4a9.versionStatus.DelayedPublish){this.set("statusText",_4a8.substitute(this._virtualStatusLocalization[_4b5],[_4ac.toUserFriendlyHtml(_4b6.properties.iversionable_startpublish)]));}else{if(_4b5===this._virtualStatusEnum.InUse){var _4b7=this.inUseNotificationManager.getOtherUsersInUseNotifications(_4b6.inUseNotifications);this.set("statusText",_4a8.substitute(this._virtualStatusLocalization[_4b5],[_4b7.join(",")]));}else{this.set("statusText",this._virtualStatusLocalization[_4b5]);}}},_getButtonText:function(_4b8,_4b9){if((_4b8==this._virtualStatusEnum.NotPublishedYet||_4b8==this._virtualStatusEnum.ChangesToPublish||_4b8==this._virtualStatusEnum.ReadyToPublish)&&this.dataModel.canChangeContent(_4a9.action.Publish)){return this.res.buttonlabel.publish;}else{return this.res.buttonlabel.option;}},_getVirtualStatus:function(_4ba){if(_4ba.isDeleted){return this._virtualStatusEnum.Deleted;}var _4bb,_4bc,_4bd;_4bb=this.inUseNotificationManager.ignoreOthersNotifications;this.inUseNotificationManager.ignoreOthersNotifications=true;_4bc=this.dataModel.canChangeContent();this.inUseNotificationManager.ignoreOthersNotifications=_4bb;_4bd=this.inUseNotificationManager.hasInUseNotificationWarning(_4ba.inUseNotifications);if(_4bd&&_4bc){return this._virtualStatusEnum.InUse;}if(_4ba.isCommonDraft){if(_4ba.status===_4a9.versionStatus.Published){return this._virtualStatusEnum.NoChangeToPublish;}if(_4ba.status===_4a9.versionStatus.CheckedOut){return _4ba.isMasterVersion?this._virtualStatusEnum.NotPublishedYet:this._virtualStatusEnum.ChangesToPublish;}}return this._statusMap[_4ba.status];}});});},"dijit/form/_ComboBoxMenuMixin":function(){define("dijit/form/_ComboBoxMenuMixin",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/i18n","dojo/_base/window","dojo/i18n!./nls/ComboBox"],function(_4be,_4bf,_4c0,i18n,win){return _4bf("dijit.form._ComboBoxMenuMixin",null,{_messages:null,postMixInProperties:function(){this.inherited(arguments);this._messages=i18n.getLocalization("dijit.form","ComboBox",this.lang);},buildRendering:function(){this.inherited(arguments);this.previousButton.innerHTML=this._messages["previousMessage"];this.nextButton.innerHTML=this._messages["nextMessage"];},_setValueAttr:function(_4c1){this.value=_4c1;this.onChange(_4c1);},onClick:function(node){if(node==this.previousButton){this._setSelectedAttr(null);this.onPage(-1);}else{if(node==this.nextButton){this._setSelectedAttr(null);this.onPage(1);}else{this.onChange(node);}}},onChange:function(){},onPage:function(){},onClose:function(){this._setSelectedAttr(null);},_createOption:function(item,_4c2){var _4c3=this._createMenuItem();var _4c4=_4c2(item);if(_4c4.html){_4c3.innerHTML=_4c4.label;}else{_4c3.appendChild(win.doc.createTextNode(_4c4.label));}if(_4c3.innerHTML==""){_4c3.innerHTML="&#160;";}this.applyTextDir(_4c3,(_4c3.innerText||_4c3.textContent||""));_4c3.item=item;return _4c3;},createOptions:function(_4c5,_4c6,_4c7){this.previousButton.style.display=(_4c6.start==0)?"none":"";_4c0.set(this.previousButton,"id",this.id+"_prev");_4be.forEach(_4c5,function(item,i){var _4c8=this._createOption(item,_4c7);_4c0.set(_4c8,"id",this.id+i);this.nextButton.parentNode.insertBefore(_4c8,this.nextButton);},this);var _4c9=false;if(_4c5.total&&!_4c5.total.then&&_4c5.total!=-1){if((_4c6.start+_4c6.count)<_4c5.total){_4c9=true;}else{if((_4c6.start+_4c6.count)>_4c5.total&&_4c6.count==_4c5.length){_4c9=true;}}}else{if(_4c6.count==_4c5.length){_4c9=true;}}this.nextButton.style.display=_4c9?"":"none";_4c0.set(this.nextButton,"id",this.id+"_next");return this.containerNode.childNodes;},clearResultList:function(){var _4ca=this.containerNode;while(_4ca.childNodes.length>2){_4ca.removeChild(_4ca.childNodes[_4ca.childNodes.length-2]);}this._setSelectedAttr(null);},highlightFirstOption:function(){this.selectFirstNode();},highlightLastOption:function(){this.selectLastNode();},selectFirstNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.previousButton){this.selectNextNode();}},selectLastNode:function(){this.inherited(arguments);if(this.getHighlightedOption()==this.nextButton){this.selectPreviousNode();}},getHighlightedOption:function(){return this._getSelectedAttr();}});});},"epi/cms/contentediting/SideBySideEditorWrapper":function(){define("epi/cms/contentediting/SideBySideEditorWrapper",["epi","dojo","epi/cms/contentediting/_EditorWrapperBase"],function(epi,dojo,_4cb){return dojo.declare("epi.cms.contentediting.SideBySideEditorWrapper",[_4cb],{_grabFocusOnStartEdit:true,postCreate:function(){this.inherited(arguments);if(this.editorWidget){this.connect(this.editorWidget,"onChange","_onChange");this.connect(this.editorWidget,"onDoubleChange","_onDoubleChange");this.connect(this.editorWidget,"onFocus",dojo.hitch(this,function(){setTimeout(dojo.hitch(this,function(){this._tryToStartEditing(false);}),0);}));this.connect(this.editorWidget,"onBlur",dojo.hitch(this,function(){setTimeout(dojo.hitch(this,function(){this.tryToStopEditing(true);}),0);}));this.connect(this.editorWidget,"onDropping",dojo.hitch(this,function(){this._tryToStartEditing(true);}));}},contentModelChanged:function(name,_4cc,_4cd){this.set("value",_4cd);},_onDoubleChange:function(val,_4ce,_4cf){this.inherited(arguments);this.set("editing",false);_4ce.set("editing",false);},_tryToStartEditing:function(_4d0){if(this.editing){return;}this._grabFocusOnStartEdit=_4d0;this.startEdit();this._grabFocusOnStartEdit=true;},_onChange:function(){if(!this._cancelChange){this.inherited(arguments);}},_setValueAttr:function(_4d1){this._cancelChange=true;this.inherited(arguments);this._cancelChange=false;},startEdit:function(){if(this._grabFocusOnStartEdit){this.editorWidget.focus();this.editorWidget.domNode.scrollIntoView();}this.inherited(arguments);},stopEdit:function(_4d2){this.set("value",this.getEditorValue());this.inherited(arguments);}});});},"epi/cms/widget/FileList":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-attr","dojo/dom-construct","dojo/dom-class","dojo/dom-style","dojox/form/uploader/Base","dgrid/OnDemandGrid","dgrid/Selection","dgrid/Keyboard","dijit/ProgressBar","epi/shell/widget/_ModelBindingMixin","epi/shell/dgrid/Formatter","epi/cms/widget/UploadUtil","epi/i18n!epi/cms/nls/episerver.cms.widget.uploadmultiplefiles.uploadform","dojo/text!./templates/FileList.html"],function(_4d3,lang,_4d4,_4d5,_4d6,_4d7,_4d8,_4d9,_4da,_4db,_4dc,_4dd,_4de,_4df,_4e0,_4e1){return _4d3("epi.cms.widget.FileList",[_4d8,_4dd],{templateString:_4e1,modelBindingMap:{"showProgressBar":["showProgressBar"],"progress":["progress"],"uploadFiles":["uploadFiles"]},postCreate:function(){this.inherited(arguments);this._buildGrid();},uninitialize:function(){this._grid.destroyRecursive();},_setUploadFilesAttr:function(_4e2){this._bindData(_4e2);},_setShowProgressBarAttr:function(show){_4df.toggleVisibility(this.progressBar.domNode,show);},_setProgressAttr:function(_4e3){if(!_4e3){return;}this.progressBar.update({progress:_4e3.percent.replace("%","")});},_bindData:function(data){data=data||[];this._grid.refresh();this._grid.renderArray(data);},_buildGrid:function(){var _4e4=_4d3([_4d9,_4db,_4de]);this._grid=new _4e4({columns:{fileName:{label:_4e0.uploadfilename,field:"fileName",htmlEncode:true},size:{label:_4e0.uploadfilesize,field:"size",get:lang.hitch(this,function(file){var _4e5=this.convertBytes(file.size).value;if(isNaN(_4e5)){return _4e5;}var _4e6=_4e5===0?_4e0.bytetext:_4e0.bytestext;return lang.replace("{0} {1}",[_4e5,_4e6]);})},status:{label:_4e0.uploadfilestatus,field:"status",renderCell:lang.hitch(this,function(item,_4e7,node,_4e8){_4d4.set(node,"title",item.statusMessage?item.statusMessage:"");_4d6.toggle(node,"epi-failedStatus",item.status===_4e0.failed);node.innerHTML=item.status;})}}});_4d5.place(this._grid.domNode,this.domNode);}});});},"epi/cms/contentediting/command/BlockEditing":function(){define("epi/cms/contentediting/command/BlockEditing",["dojo/_base/declare","dojo/_base/lang","dojo/Stateful","epi","epi/shell/_StatefulGetterSetterMixin","epi/cms/contentediting/command/BlockRemove","epi/cms/contentediting/command/BlockEdit","epi/cms/contentediting/command/BlockMoveUp","epi/cms/contentediting/command/BlockMoveDown"],function(_4e9,lang,_4ea,epi,_4eb,_4ec,_4ed,_4ee,_4ef){return _4e9("epi.cms.contentediting.command.BlockEditing",[_4ea,_4eb],{model:null,remove:null,edit:null,moveUp:null,moveDown:null,constructor:function(_4f0){lang.mixin(this,_4f0);this.remove=this.remove||new _4ec();this.edit=this.edit||new _4ed();this.moveUp=this.moveUp||new _4ee();this.moveDown=this.moveDown||new _4ef();},_setModelAttr:function(_4f1){this._set("model",_4f1);this.remove.set("model",_4f1);this.edit.set("model",_4f1);this.moveUp.set("model",_4f1);this.moveDown.set("model",_4f1);}});});},"epi/cms/conversion/PropertyDateConverter":function(){define("epi/cms/conversion/PropertyDateConverter",["dojo/_base/declare","epi/datetime"],function(_4f2,_4f3){return _4f2(null,{sourceDataType:"epi.cms.propertydate",targetDataType:"runtimeType",registerConverter:function(_4f4){_4f4.registerConverter(this.sourceDataType,this.targetDataType,this);},convert:function(_4f5,_4f6,data){if(data&&_4f5===this.sourceDataType&&_4f6===this.targetDataType){return _4f3.deserialize(data);}return null;}});});},"epi/cms/contentediting/command/BlockRemove":function(){define("epi/cms/contentediting/command/BlockRemove",["dojo/_base/declare","epi","epi/shell/command/_Command"],function(_4f7,epi,_4f8){return _4f7("epi.cms.contentediting.command.BlockRemove",[_4f8],{name:"remove",label:epi.resources.action.remove,tooltip:epi.resources.action.remove,iconClass:"epi-iconTrash",postscript:function(){this.inherited(arguments);},_execute:function(){this.model.remove();return this.inherited(arguments);},_onModelChange:function(){this.set("canExecute",this.model?true:false);}});});},"epi/cms/widget/ResolutionSelector":function(){define("epi/cms/widget/ResolutionSelector",["dojo","dojo/_base/lang","dojo/_base/array","epi","epi/dependency","epi/cms/widget/_ItemSelectorBase","epi/cms/widget/_DropDownWidgetItemMixin","epi/i18n!epi/cms/nls/episerver.cms.widget.resolutionselector"],function(dojo,lang,_4f9,epi,_4fa,_4fb,_4fc,res){return dojo.declare("epi.cms.widget.ResolutionSelector",[_4fb,_4fc],{_resolutionHash:{},defaultItem:{name:res.defaultitem,width:1,height:1},postMixInProperties:function(){this.inherited(arguments);var _4fd=_4fa.resolve("epi.cms.Application");this._availableResolutions=_4fd.getDisplayResolutions();this._availableResolutions.unshift(this.defaultItem);_4f9.forEach(this._availableResolutions,lang.hitch(this,function(_4fe){var _4ff=_4fe.width+"x"+_4fe.height;this._resolutionHash[_4ff]=_4fe.name;}));this.checkedItem=(this.checkedItem?this._resolutionHash[this.checkedItem]:this.defaultItem.name);},postCreate:function(){this.inherited(arguments);this.set("header",res.header);this.set("items",this._availableResolutions);},getDefaultResolution:function(_500){var _501=this.defaultItem;var _502=dojo.filter(this._availableResolutions,function(_503){if(_503.id==_500.resolutionId){return _503;}});if(_502!=null&&lang.isArray(_502)&&_502.length>=1){_501=_502[0];}return _501;}});});},"epi/cms/CMSModule":function(){define("epi/cms/CMSModule",["epi","dojo","dojo/_base/declare","epi/_Module","epi/routes","epi/cms/Application","epi/cms/BackContextHistory","epi/cms/ContextSynchronizer","epi/cms/conversion/ContentLightUriConverter","epi/cms/conversion/PropertyDateConverter","epi/cms/core/ContentReference","epi/cms/store/CustomQueryEngine","epi/cms/store/PageVersionQueryEngine","epi/cms/component/command/GlobalToolbarCommandProvider","epi/cms/contentediting/EditorFactory","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/ViewSettingsManager","epi/cms/contentediting/command/Editing","epi/cms/contentediting/commandproviders/ContentDetails","epi/cms/contentediting/commandproviders/PublishMenu","epi/cms/contentediting/commandproviders/PublishMenuGlobal","epi/cms/contentediting/viewsettings/ResolutionViewSetting","epi/cms/contentediting/viewsettings/VisitorGroupViewSetting","epi/cms/contentediting/viewsettings/ChannelViewSetting","epi/cms/contentediting/InUseNotificationManager","epi/dependency","epi/shell/store/JsonRest","epi/shell/store/Throttle","./legacy/navigationSupport"],function(epi,dojo,_504,_505,_506,_507,_508,_509,_50a,_50b,_50c,_50d,_50e,_50f,_510,_511,_512,_513,_514,_515,_516,_517,_518,_519,_51a,_51b,_51c,_51d,_51e){return _504([_505],{_settings:null,_hashWrapper:null,_firstTimeHashUpdated:false,constructor:function(_51f){this._settings=_51f;},initialize:function(){this.inherited(arguments);this.registerDependency("epi.cms.Application",new _507(this._settings));this.registerDependency("epi.cms.BackContextHistory",new _508());this.registerDependency("epi.cms.ContextSynchronizer",new _509(),undefined,function(_520){_520.destroy();});this.registerDependency("epi.cms.contentEditing.command.Editing",_513);this._hashWrapper=_51b.resolve("epi.shell.HashWrapper");var _521=_51b.resolve("epi.globalcommandregistry");var _522=new _516();_521.registerProvider("epi.cms.publishmenu",_522);var _523=this.resolveDependency("epi.shell.ContextService");if(!_523.initialUri){_523.initialUri="epi.cms.contentdata:///"+this._settings.startPage;}_523.registerRoute("epi.cms.contentdata",dojo.hitch(this,this._redirectPageDataContext));var _524=this.resolveDependency("epi.shell.ViewComponentDictionary");dojo.mixin(_524,{"epi.cms.contentdata":"epi/cms/contentediting/PageDataController","epi.cms.pagedata.wastebasket":"epi/cms/component/Trash","epi.cms.pagedata.root":"epi/cms/contentediting/PageDataController"});this._initializeEditorFactory();this._initializeStores();this._initializeSystemTrash();this._setupConverters(_51b);this._setupViewSettings();_521.registerProvider("epi.cms.globalToolbar",new _50f());this._setupInUseNotificationManager(_521);_51e.registerFor(window.top);},_redirectPageDataContext:function(_525,_526,uri){var _527=_51b.resolve("epi.shell.controller.Views");if(_527.viewName=="/episerver/dashboard"){var _528=_51b.resolve("epi.cms.Application");if(_528.isLegacyEditMode()){var url=_506.getActionPath({moduleArea:"LegacyCMS",path:"edit/default.aspx",id:uri.getId()});this._redirect(url);}else{var _529=_506.getActionPath({moduleArea:"CMS",controller:"Home",action:""});_529=_529.substring(0,_529.length-1);var _52a=_529+"#"+this._hashWrapper.extractHash(_525,_526);this._redirect(_52a);}}else{if(_525.hasSiteChanged){var _52b=_525.fullHomeUrl+"#"+this._hashWrapper.extractHash(_525,_526);this._redirect(_52b);}else{if(_526&&_526.trigger=="internal"&&this._firstTimeHashUpdated){return;}this._firstTimeHashUpdated=true;this._hashWrapper.onContextChange(_525,_526);}}},_redirect:function(url){window.location=url;},_setupConverters:function(_52c){var _52d=this.resolveDependency("epi.objectconverterregistry"),_52e=new _50a(),_52f=new _50b();_52e.registerConverter(_52d);_52f.registerConverter(_52d);},_setupViewSettings:function(){var _530=new _512({viewSettings:[new _517(),new _518(),new _519()]});this.registerDependency("epi.viewsettingsmanager",_530);},_initializeStores:function(){var _531=this.resolveDependency("epi.storeregistry"),_532=_531.create("epi.cms.contentdata",this._getRestPath("contentdata"),{idProperty:"contentLink"}),_533=_531.create("epi.cms.content.light",this._getRestPath("contentstructure"),{idProperty:"contentLink",queryEngine:_50d}),_534=_531.create("epi.cms.contentreferences",this._getRestPath("contentreferences"),{idProperty:"ownerContentLink"}),_535=_531.create("epi.cms.contentversion",this._getRestPath("contentversion"),{idProperty:"contentLink",queryEngine:_50e});var _536=new _51c(dojo.mixin({target:this._getRestPath("contentstructure"),preventCache:true},{idProperty:"contentLink"}));_531.add("epi.cms.content.search",new _51d(_536));_532.addDependentStore(_533,{refreshOnPatch:true,refresh:function(_537){var id=_532.getIdentity(_537);var _538=new _50c(id).createVersionUnspecificReference().toString();_533.refresh(_538);}});_532.addDependentStore(_535,{transformDelegate:function(_539){if(_539.capabilities&&!_539.capabilities.supportsVersions){return null;}if(!_539.properties){return null;}var _53a={"pageChangedBy":"savedBy","pageSaved":"savedDate","pageLanguageBranch":"language","pageName":"name","name":"name","icontent_name":"name"};var _53b=dojo.mixin({},_539);for(var p in _53a){if(p in _53b.properties){_53b[_53a[p]]=_53b.properties[p];}}return _53b;}});_531.create("epi.cms.contenttype",this._getRestPath("contenttype"));_531.create("epi.cms.category",this._getRestPath("categories"));var _53c=_531.create("epi.cms.inusenotification",this._getRestPath("inusenotification"));_53c.addDependentStore(_532);_531.create("epi.cms.visitorgroup",this._getRestPath("visitorgroup"));_531.create("epi.cms.sitestructure",this._getRestPath("sitestructure"),{idProperty:"url"});_531.create("epi.cms.displaychannels",this._getRestPath("channel"));_531.create("epi.cms.wastebasket",this._getRestPath("wastebasket"));_531.create("epi.cms.xform",this._getRestPath("xform"));},_getRestPath:function(name){return _506.getRestPath({moduleArea:"cms",storeName:name});},_initializeEditorFactory:function(){this.registerDependency("epi.cms.contentediting.EditorFactory",function(){var _53d=new _510();_53d.registerEditorWrapper("inline","epi.cms.contentediting.InlineEditorWrapper",function(_53e,_53f){});_53d.registerEditorWrapper("flyout","epi.cms.contentediting.FlyoutEditorWrapper",function(_540,_541){});_53d.registerEditorWrapper("floating","epi.cms.contentediting.FloatingEditorWrapper",function(_542,_543){});_53d.registerEditorWrapper("dialog","epi.cms.contentediting.DialogEditorWrapper",function(_544,_545){_544.closeOnChange=false;_544.showButtons=true;});_53d.registerEditorWrapper("legacyProperty","epi.cms.contentediting.DialogEditorWrapper",function(_546,_547){_546.closeOnChange=true;_546.showButtons=false;});return _53d;});},_initializeSystemTrash:function(){var app=_51b.resolve("epi.cms.Application");var _548=app.getGlobalBlockFolder(),_549=app.getSiteBlockFolder();this.registerDependency("epi.cms.contentediting.systemtrash",{pages:{typeIdentifiers:["epi.cms.page"],contentSearchAreas:["CMS/Pages"],restoreRoot:app.getRootPage()},blocks:{typeIdentifiers:["epi.cms.folder","epi.cms.block"],contentSearchAreas:["CMS/Blocks"],restoreRoot:_548!==_549?[_548,_549]:_548}});},_setupInUseNotificationManager:function(_54a){var _54b=new _51a();this.registerDependency("epi.cms.contentediting.inUseNotificationManager",_54b);_54a.registerProvider("epi.cms.publishmenu",new _515());_54a.registerProvider("epi.cms.contentdetailsmenu",new _514());}});});},"epi/cms/widget/FolderList":function(){define("epi/cms/widget/FolderList",["dojo","dojo/dom-class","dojo/_base/array","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","epi/dependency","epi/cms/command/CopyContent","epi/cms/command/CutContent","epi/cms/command/DeleteContent","epi/cms/command/NewContent","epi/cms/command/PasteContent","epi/cms/component/ContentFilter","epi/cms/widget/command/NewFolder","epi/cms/widget/command/RenameFolder","epi/cms/widget/ContextMenu","epi/cms/widget/FolderTree","epi/cms/widget/FolderTreeStoreModel","epi/shell/command/_WidgetCommandProviderMixin","epi/shell/selection","epi/i18n!epi/cms/nls/episerver.cms.components.createblock"],function(dojo,_54c,_54d,_54e,_54f,_550,_551,_552,_553,_554,_555,_556,_557,_558,_559,_55a,_55b,_55c,_55d,_55e,_55f){return dojo.declare("epi.cms.widget.FolderList",[_54e,_54f,_550,_55d],{_application:null,_renamingNode:null,_store:null,isTreeLoaded:null,deferredSelectedItem:null,templateString:"<div>                              <div data-dojo-attach-point=\"treeNode\" id=\"${id}_treeNode\"></div>                         </div>",postMixInProperties:function(){this.inherited(arguments);this._application=_551.resolve("epi.cms.Application");this.siteBlockFolder=this._application.getSiteBlockFolder();this.globalBlockFolder=this._application.getGlobalBlockFolder();this.selection=new _55e();},postCreate:function(){this.inherited(arguments);var _560=_551.resolve("epi.storeregistry");this._store=_560.get("epi.cms.content.light");this._bindingTree();this.connect(this._tree,"onResize",dojo.hitch(this,this._onResize));this.connect(this._tree,"onLoad","_onTreeLoaded");this.connect(this._tree,"onFolderSelected","_onTreeNodeSelected");this.connect(this._tree,"_onCopyOrCut","_executeCopyOrCut");this.connect(this._tree,"_onPaste","_executePaste");this.connect(this._tree,"_onDelete","_executeDelete");},_onResize:function(){this.onResize();},onResize:function(){},startup:function(){if(this._started){return;}this.inherited(arguments);var _561=this._tree.model,_562={category:"context",model:_561,selection:this.selection,clipboard:this._tree.clipboardManager};this.connect(_561,"onAdd","_onAdded");this.connect(_561,"onDelete","_onDeleted");this._newBlockCommand=new _555({category:"context",contentType:_557.BlockType,iconClass:"epi-iconSharedBlock",label:_55f.command.label,resources:_55f,showForRoot:true});this._newFolderCommand=new _558({category:"context",model:_561,selection:this.selection,showForRoot:true});this._renameCommand=new _559({category:"context"});this._copyCommand=new _552(_562);this._cutCommand=new _553(_562);this._pasteCommand=new _556(dojo.mixin({showForRoot:true},_562));this._deleteCommand=new _554(_562);this.set("commands",[this._newFolderCommand,this._newBlockCommand,this._cutCommand,this._copyCommand,this._pasteCommand,this._renameCommand,this._deleteCommand]);},_bindingTree:function(){var _563=new _55a();_563.addProvider(this);this._tree=new _55b({model:new _55c({store:this._store,additionalQueryOptions:{sort:[{attribute:"name",descending:false}]}}),contextMenu:_563,showRoot:false},this.treeNode);},onFolderChanged:function(_564){var _565=_564?[{type:"epi.cms.contentdata",data:_564.item}]:[];this._renameCommand.set("model",_564);this._newBlockCommand.set("model",_564.item);this.selection.set("data",_565);},_onTreeLoaded:function(){this.isTreeLoaded=true;this._selectFolderNode();},_selectFolderNode:function(_566){if(!this.isTreeLoaded){this.deferredSelectedItem=_566;return;}var _567=_566?_566:this.deferredSelectedItem?this.deferredSelectedItem:this.siteBlockFolder.toString();this._tree.selectContent(_567,true);},_onTreeNodeSelected:function(_568){if(_568&&_568.item){this.onFolderChanged(_568);if(this._renamingNode&&this._renamingNode===_568.item.contentLink){this._renameCommand.execute();this._renamingNode=null;}}},_onAdded:function(_569){if(_569){var _56a=this.selection,_56b=_56a.data&&_56a.data[0];_569=_569.replace(new RegExp("_.*"),"");this._renamingNode=_569;dojo.publish("/epi/cms/blocktree/childrenchanged",[_56b.data,_569]);}},_onDeleted:function(item){this._selectFolderNode(item.parentLink);},_executeDelete:function(){this._deleteCommand.execute();},_executeCopyOrCut:function(copy){if(copy){this._copyCommand.execute();}else{this._cutCommand.execute();}},_executePaste:function(){this._pasteCommand.execute();},highlightNode:function(_56c){var _56d=new dojo.Deferred();if(!_56c){_56d.resolve();}dojo.when(_56c,dojo.hitch(this,function(id){if(!id){var _56e=this._tree.get("SelectedNode");if(_56e){this._tree.selectContent(_56e.item.contentLink,true);}}else{this._selectFolderNode(id);}_56d.resolve();}));return _56d;},showCommands:function(_56f){_54d.forEach(this.commands,function(_570){_570.set("isAvailable",!_56f||_570.showForRoot);});},hideCommands:function(){_54d.forEach(this.commands,function(_571){_571.set("isAvailable",false);});},toggleCuttingNodeUI:function(item,_572){var node=this._tree.getNodesByItem(item)[0];if(node){_54c.toggle(node.rowNode,"epi-opacity50",_572);}}});});},"epi/cms/widget/ContentTypeList":function(){define("epi/cms/widget/ContentTypeList",["dojo","epi/i18n!epi/cms/nls/episerver.cms.widget.contenttypelist","dojo/DeferredList","dijit/layout/_LayoutWidget","epi/dependency","epi/cms/widget/ContentTypeGroup","epi/cms/component/ContentFilter","dojo/dom-class"],function(dojo,i18n,_573,_574,_575,_576,_577,_578){return dojo.declare("epi.cms.widget.ContentTypeList",[_574],{store:null,parent:null,groups:null,requestedTypes:[],type:null,postMixInProperties:function(){this.inherited(arguments);this.groups={};if(!this.store){var _579=_575.resolve("epi.storeregistry");this.store=_579.get("epi.cms.contenttype");}},buildRendering:function(){this.inherited(arguments);var _57a=new _576();this.connect(_57a,"onSelect",this.onContentTypeSelected);this.addChild(_57a);this._suggestedContentTypes=_57a;},refresh:function(){this.clear();this._setupWidgetTemplate();dojo.when(this._getSuggestedContentTypes(this.requestedTypes),dojo.hitch(this,function(_57b){if(_57b.length<=0){this._suggestedContentTypes.setVisibility(false);}else{_578.add(this._suggestedContentTypes.titleNode,"epi-ribbonHeaderSpecial");this._suggestedContentTypes.set("title",this._suggestedTypesTitle);this._suggestedContentTypes.set("contentTypes",_57b);this._suggestedContentTypes.setVisibility(true);}}));dojo.when(this._groupContentTypes(),dojo.hitch(this,function(_57c){var key,_57d;for(key in _57c){_57d=this._getOrCreateGroup(key);_57d.set("contentTypes",_57c[key]);}}));},_setupWidgetTemplate:function(){this._suggestedTypesTitle=i18n.suggestedtypes[this.type.toLowerCase()];this._otherTypesTitle=i18n.othertypes[this.type.toLowerCase()];},clear:function(){this._suggestedContentTypes.clear();for(var key in this.groups){this.groups[key].destroyRecursive();delete this.groups[key];}},_getOrCreateGroup:function(name){var _57e=this.groups[name];if(!_57e){_57e=new _576({title:name});_57e.connect(_57e,"onSelect",this.onContentTypeSelected);this.addChild(_57e);this.groups[name]=_57e;}return _57e;},_getAvailableContentTypes:function(type){return this.store.query({id:this.parent.contentTypeID,query:"getavailablecontenttypes",parentReference:this.parent.contentLink,requestedTypes:type});},_getSuggestedContentTypes:function(type){return this.store.query({id:this.parent.contentTypeID,query:"getsuggestedcontenttypes",parentReference:this.parent.contentLink,requestedTypes:type});},_groupContentTypes:function(){var _57f={},_580=new dojo.Deferred(),_581=this._otherTypesTitle;dojo.when(this._getAvailableContentTypes(this.requestedTypes),function(_582){var _583=_582.length;dojo.forEach(_582,function(item){dojo.when(item,function(type){var _584=type.groupName||_581,_585=_57f[_584]||[];_585.push(type);_57f[_584]=_585;_583--;if(_583===0){_580.resolve(_57f);}});});});return _580;},_setParentAttr:function(_586){this._set("parent",_586);this.refresh();},_setRequestedTypesAttr:function(_587){this._set("requestedTypes",_587);},_setTypeAttr:function(_588){this._set("type",_588);},onContentTypeSelected:function(){}});});},"dgrid/_StoreMixin":function(){define("dgrid/_StoreMixin",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/on"],function(_589,_58a,lang,_58b,_58c){function _58d(err){if(_58c.emit(this.domNode,"dgrid-error",{error:err,cancelable:true,bubbles:true})){console.error(err);}};return _58a(null,{store:null,query:null,queryOptions:null,getBeforePut:true,noDataMessage:"",loadingMessage:"",constructor:function(){this.query={};this.queryOptions={};this.dirty={};this._updating={};},_configColumn:function(_58e){if(_58e.set){if(!this._columnsWithSet){this._columnsWithSet={};}this._columnsWithSet[_58e.field]=_58e;}},_configColumns:function(){this._columnsWithSet=null;return this.inherited(arguments);},_setStore:function(_58f,_590,_591){this.store=_58f;this.dirty={};this.set("query",_590,_591);},_setQuery:function(_592,_593){var sort=_593&&_593.sort;this.query=_592!==undefined?_592:this.query;this.queryOptions=_593||this.queryOptions;sort?this.sort(sort):this.refresh();},setStore:function(_594,_595,_596){_589.deprecated("setStore(...)","use set(\"store\", ...) instead","dgrid 1.0");this.set("store",_594,_595,_596);},setQuery:function(_597,_598){_589.deprecated("setQuery(...)","use set(\"query\", ...) instead","dgrid 1.0");this.set("query",_597,_598);},_getQueryOptions:function(){var _599=lang.delegate(this.queryOptions,{});if(this._sort.length){_599.sort=this._sort;}return _599;},_getQuery:function(){var q=this.query;return typeof q=="object"&&q!=null?lang.delegate(q,{}):q;},_setSort:function(_59a,_59b){if(this.store){this._lastCollection=null;}this.inherited(arguments);},insertRow:function(_59c,_59d,_59e,i,_59f){var _5a0=this.store,_5a1=this.dirty,id=_5a0&&_5a0.getIdentity(_59c),_5a2;if(id in _5a1&&!(id in this._updating)){_5a2=_5a1[id];}if(_5a2){_59c=lang.delegate(_59c,_5a2);}return this.inherited(arguments);},updateDirty:function(id,_5a3,_5a4){var _5a5=this.dirty,_5a6=_5a5[id];if(!_5a6){_5a6=_5a5[id]={};}_5a6[_5a3]=_5a4;},setDirty:function(id,_5a7,_5a8){_589.deprecated("setDirty(...)","use updateDirty() instead","dgrid 1.0");this.updateDirty(id,_5a7,_5a8);},save:function(){var self=this,_5a9=this.store,_5aa=this.dirty,dfd=new _58b(),_5ab=dfd.promise,_5ac=function(id){var data;return (self.getBeforePut||!(data=self.row(id).data))?function(){return _5a9.get(id);}:function(){return data;};};function _5ad(id,_5ae){return function(_5af){var _5b0=self._columnsWithSet,_5b1=self._updating,key,data;for(key in _5ae){_5af[key]=_5ae[key];}if(_5b0){for(key in _5b0){data=_5b0[key].set(_5af);if(data!==undefined){_5af[key]=data;}}}_5b1[id]=true;return _58b.when(_5a9.put(_5af),function(){delete _5aa[id];delete _5b1[id];});};};for(var id in _5aa){var put=_5ad(id,_5aa[id]);_5ab=_5ab.then(_5ac(id)).then(put);}dfd.resolve();return _5ab;},revert:function(){this.dirty={};this.refresh();},_trackError:function(func){var _5b2;if(typeof func=="string"){func=lang.hitch(this,func);}try{_5b2=func();}catch(err){_58d.call(this,err);}return _58b.when(_5b2,null,lang.hitch(this,_58d));}});});},"epi/cms/widget/viewmodel/FileListViewModel":function(){define(["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/Stateful","epi/shell/_StatefulGetterSetterMixin","epi/cms/widget/UploadUtil","epi/i18n!epi/cms/nls/episerver.cms.widget.uploadmultiplefiles"],function(_5b3,_5b4,lang,_5b5,_5b6,_5b7,_5b8){return _5b3([_5b5,_5b6],{progress:null,uploadFiles:null,uploadStatus:null,showProgressBar:false,_setUploadFilesAttr:function(_5b9){if(!_5b7.validUploadFiles(_5b9)){return;}var _5ba=[];_5b4.forEach(_5b9,function(file){_5ba.push({fileName:file.name,size:file.size,status:_5b8.uploadform.uploading});},this);this._set("uploadFiles",_5ba);},_setUploadStatusAttr:function(_5bb){var _5bc=this.get("uploadFiles");if(_5b4.some(_5bc,function(item){return item.status!==_5b8.uploadform.uploading;})){return;}_5b4.forEach(_5bc,function(item){if(!_5bb||_5bb.length<=0){item.status=_5b8.uploadform.uploaded;return false;}if(_5bb[0]&&_5bb[0].scope===_5b7.StatusScope.All&&_5bb[0].itemName===""){item.status=_5b8.uploadform.failed;item.statusMessage=_5bb[0].message;return false;}var _5bd=_5b4.filter(_5bb,function(_5be){return item.fileName===_5be.itemName;});if(_5bd&&_5bd.length>0){item.status=_5b8.uploadform.failed;item.statusMessage=_5bd[0].message;}else{item.status=_5b8.uploadform.uploaded;}},this);this._set("uploadFiles",_5bc);},clear:function(){this._set("uploadFiles",null);}});});},"epi/cms/contentediting/SettingsPanel":function(){require({cache:{"url:epi/cms/contentediting/templates/SettingsPanel.html":"<div class=\"epi-documentHeader\">\r\n    <div data-dojo-type=\"epi.shell.widget.ContainerLayout\" data-dojo-attach-point=\"widgetContainer\"></div>\r\n    <div data-dojo-type=\"epi.cms.contentediting.ContentDetails\" data-dojo-attach-point=\"contentDetails\"></div>\r\n</div>"}});define("epi/cms/contentediting/SettingsPanel",["dojo/_base/declare","dojo/_base/lang","dojo/dom-geometry","dijit/_Container","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/layout/_LayoutWidget","dijit/layout/BorderContainer","epi/cms/contentediting/ContentDetails","epi/cms/contentediting/viewmodel/ContentDetailsViewModel","epi/shell/widget/ContainerLayout","dojo/text!./templates/SettingsPanel.html"],function(_5bf,lang,_5c0,_5c1,_5c2,_5c3,_5c4,_5c5,_5c6,_5c7,_5c8,_5c9){return _5bf("epi.cms.contentediting.SettingsPanel",[_5c4,_5c1,_5c2,_5c3],{templateString:_5c9,contentViewModel:null,_setContentViewModelAttr:function(_5ca){this._set("contentViewModel",_5ca);var _5cb=new _5c7({dataModel:_5ca});this.contentDetails.set("model",_5cb);},addChild:function(w){this.widgetContainer.addChild(w);}});});},"epi/cms/contentediting/viewmodel/PublishMenuViewModel":function(){define("epi/cms/contentediting/viewmodel/PublishMenuViewModel",["dojo/_base/declare","dojo/_base/lang","epi","epi/datetime","epi/dependency","epi/username","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/viewmodel/_ContentViewModelObserver","epi/shell/command/_CommandConsumerMixin","epi/shell/command/_GlobalCommandProviderMixin","epi/i18n!epi/cms/nls/episerver.cms.contentediting.editactionpanel.publishactionmenu"],function(_5cc,lang,epi,_5cd,_5ce,_5cf,_5d0,_5d1,_5d2,_5d3,res){return _5cc([_5d1,_5d2,_5d3],{commandKey:"epi.cms.publishmenu",contentActionSupport:null,inUseNotificationManager:null,_currentUser:null,commands:null,mainButtonCommand:null,lastExecutedCommand:null,mainButtonSectionVisible:null,lastChangeStatus:null,topInfoSectionVisible:null,publishInfoSectionVisible:null,lastPublishedText:null,lastPublishedViewLinkVisible:null,lastPublishedViewLinkHref:null,additionalInfoSectionVisible:null,additionalInfoText:null,isOpen:null,postscript:function(){this.inherited(arguments);this.res=this.res||res;this.contentActionSupport=this.contentActionSupport||_5d0;this.initializeCommandProviders();},_setDataModelAttr:function(_5d4){this.updateCommandModel(_5d4);this.inherited(arguments);},_setIsOpenAttr:function(_5d5){if(_5d5){this.set("lastChangeStatus",this._getLastChangeStatus(this.dataModel.contentData));}},onDataModelChange:function(name,_5d6,_5d7){var _5d8=this.dataModel.contentData,_5d9=(_5d8.publishedBy!==null&&_5d8.publishedBy!==undefined);this._updateCommands();this.set("lastChangeStatus",this._getLastChangeStatus(_5d8));this.set("topInfoSectionVisible",this._getTopInfoSectionVisible(_5d8));this.set("publishInfoSectionVisible",this._getPublishInfoSectionVisible(_5d8));this.set("lastPublishedTitle",this._getLastPublishedTitle(_5d8));this.set("lastPublishedTitleVisible",_5d9);this.set("lastPublishedText",this._getLastPublishedText(_5d8));this.set("lastPublishedViewLinkVisible",this._getLastPublishedViewLinkVisible(_5d8,_5d9));this.set("lastPublishedViewLinkHref",_5d8.publicUrl);this._setAdditionalInfo(_5d8);},_updateCommands:function(){var _5da=this.getCommands(),_5db=null;dojo.forEach(_5da,dojo.hitch(this,function(_5dc){if(_5dc.canExecute&&_5dc.options&&_5dc.options.isMain&&_5dc.options.priority&&(!_5db||_5db.options.priority<_5dc.options.priority)){_5db=_5dc;}}));this.set("mainButtonCommand",_5db);this.set("commands",_5da);this.set("mainButtonSectionVisible",_5db!==null);},_getTopInfoSectionVisible:function(_5dd){return this.mainButtonCommand||!((_5dd.status===_5d0.versionStatus.Published||_5dd.status===_5d0.versionStatus.Expired)&&!_5dd.isCommonDraft);},_getPublishInfoSectionVisible:function(_5de){var _5df=this.inUseNotificationManager.hasInUseNotificationWarning(_5de.inUseNotifications),_5e0=this._isOriginallyEditable();return !(_5df&&_5e0);},_getLastPublishedViewLinkVisible:function(_5e1,_5e2){return _5e2&&!_5e1.capabilities.isBlock&&_5e1.hasTemplate;},_getLastChangeStatus:function(_5e3){if(this.lastExecutedCommand&&this.lastExecutedCommand.options&&this.lastExecutedCommand.options.successStatus){var _5e4=this.lastExecutedCommand.options.successStatus;this.lastExecutedCommand=null;return _5e4;}if(_5e3.missingLanguageBranch&&_5e3.missingLanguageBranch.isTranslationNeeded){return lang.replace(this.res.nottranslated,{languageName:epi.resources.language[_5e3.missingLanguageBranch.languageId],languageId:_5e3.missingLanguageBranch.languageId});}if(_5e3.status==_5d0.versionStatus.Published||_5e3.status==_5d0.versionStatus.Expired){return this.res.notmodifiedsincelastpublish;}if(_5e3.status==_5d0.versionStatus.PreviouslyPublished){return this._getTemplatedText(this.res.previouslypublished,_5e3.versionCreatedBy,_5e3.versionCreatedTime);}if(_5e3.status==_5d0.versionStatus.CheckedIn){return this._getTemplatedText(this.res.pendingapproval,_5e3.versionCreatedBy,_5e3.versionCreatedTime);}return this._getTemplatedText(this.res.lastchangestatus,_5e3.changedBy,_5e3.saved);},_getLastPublishedTitle:function(_5e5){return _5e5.status===_5d0.versionStatus.PreviouslyPublished?this.res.currentlypublished:this.res.lastpublishedby;},_getLastPublishedText:function(_5e6){return (_5e6.publishedBy===null||_5e6.publishedBy===undefined)?this.res.notpublishedbefore:this._getTemplatedText(this.res.publishedtime,_5e6.publishedBy,_5e6.lastPublished,true);},_setAdditionalInfo:function(_5e7){var _5e8=this.inUseNotificationManager.hasInUseNotificationWarning(_5e7.inUseNotifications),_5e9=this._isOriginallyEditable(),_5ea=_5e8&&_5e9;this.set("additionalInfoSectionVisible",_5ea);if(_5ea){var _5eb=this.inUseNotificationManager.getOtherUsersInUseNotifications(_5e7.inUseNotifications);this.set("additionalInfoText",this._getTemplatedText(this.res.inusewarning,_5eb.join(",")));}},_isOriginallyEditable:function(){var _5ec=this.inUseNotificationManager.ignoreOthersNotifications;this.inUseNotificationManager.ignoreOthersNotifications=true;var _5ed=this.dataModel.canChangeContent();this.inUseNotificationManager.ignoreOthersNotifications=_5ec;return _5ed;},_getFriendlyUsername:function(name,_5ee){return _5cf.toUserFriendlyHtml(name,null,_5ee);},_getTemplatedText:function(_5ef,_5f0,_5f1,_5f2){var date=_5cd.deserialize(_5f1);return dojo.replace(_5ef,{username:this._getFriendlyUsername(_5f0,_5f2),time:_5cd.toUserFriendlyHtml(date),timepassed:_5cd.timePassed(date)});}});});},"epi/cms/widget/_FolderTreeNode":function(){require({cache:{"url:epi/cms/widget/templates/_FolderTreeNode.html":"<div class=\"dijitTreeNode epi-folderTreeNode\" role=\"presentation\">\r\n    <div tabindex=\"-1\" data-dojo-attach-point=\"rowNode\" class=\"dijitTreeRow\" role=\"presentation\" data-dojo-attach-event=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onclick:_onClick, ondblclick:_onDblClick\">\r\n        <span data-dojo-attach-point=\"contentNode\" class=\"dijitTreeContent\" role=\"presentation\">\r\n            <span data-dojo-attach-point=\"expandoNode\" class=\"dijitTreeExpando\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"></span>\r\n            \r\n            <span data-dojo-attach-point=\"labelNode\" class=\"dijitTreeLabel\" role=\"treeitem\"\r\n                tabindex=\"-1\" aria-selected=\"false\" data-dojo-attach-event=\"onfocus:_onLabelFocus\">\r\n            </span>\r\n        </span>\r\n        <span data-dojo-attach-point=\"extraIconsContainer\" class=\"epi-dijitExtraIconContainer\" role=\"presentation\">\r\n            <span data-dojo-attach-point=\"iconNodeMenu\" class=\"dijitTreeIcon\" role=\"presentation\" title=\"${_menuTooltip}\">&nbsp;</span>\r\n        </span>\r\n    </div>\r\n    <div data-dojo-attach-point=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\r\n</div>"}});define("epi/cms/widget/_FolderTreeNode",["dojo/dom-attr","dojo/text!./templates/_FolderTreeNode.html","dijit/InlineEditBox","dijit/form/TextBox","dijit/form/ValidationTextBox","dijit/Tree","epi/i18n!epi/cms/nls/episerver.cms.components.sharedblockscomponent"],function(_5f3,_5f4,_5f5,_5f6,_5f7,Tree,res){dojo.declare("_TreeInlineEditor",[dijit._InlineEditor],{postCreate:function(){this.inherited(arguments);dojo.forEach(["onmousedown","onmouseup","onclick","onkeypress"],function(name){this.connect(this.domNode,name,function(evt){evt.stopPropagation();});},this);}});var _5f8={normal:0,root:1};return dojo.declare("epi.cms.widget._FolderTreeNode",[Tree._TreeNode],{templateString:_5f4,_blockFolderRoot:"epi-iconObjectFolder",_blockFolderMenu:"epi-iconContextMenu",_blockFolderDnDIcon:"epi-iconDnD",_blockFolderExpand:"epi-iconObjectFolderOpen",_blockFolderCollapse:"epi-iconObjectFolder",isSelected:false,isRootNode:undefined,_isResetValue:false,_menuTooltip:undefined,contextMenu:null,_rowStates:{NORMAL:1,EXPANDED:2,ENTERED:4,SELECTED:8},_currentRowState:1,postMixInProperties:function(){this.inherited(arguments);this.isRootNode=this.item&&(this.item.isRoot||this.item.isSubRoot);this._menuTooltip=this.isRootNode?res.rootmenu:res.foldermenu;},postCreate:function(){this.inherited(arguments);dojo.style(this.iconNodeMenu,"zIndex",dojo.position(this.rowNode).zIndex+1);this._updateStyle();_5f3.set(this.contentNode,"title",this.label);},buildRendering:function(){this.inherited(arguments);var _5f9=this;this.labelWidget=new _5f5({value:this.label,editorWrapper:"_TreeInlineEditor",editor:"dijit.form.ValidationTextBox",width:this.tree.editorWidth,editorParams:{maxLength:255},_onMouseOver:function(){},_onClick:function(){},onChange:function(val){_5f9._onChangeLabelValue(val);}},this.labelNode);},onRename:function(val){},_onChangeLabelValue:function(val){_5f3.set(this.contentNode,"title",val);if(!this._isResetValue){this.onRename(val);}this._isResetValue=false;},_onClick:function(evt){this.inherited(arguments);dojo.removeClass(this.labelNode,"dijitInlineEditBoxDisplayModeHover");this.onTreeNodeSelected(this);},rollbackLabel:function(val){this._isResetValue=true;this.labelWidget.set("value",val);},bindContextMenu:function(menu){this.contextMenu=menu;this.connect(this.iconNodeMenu,"onclick","_onIconNodeMenuClick");},collapse:function(){var self=this,def=new dojo.Deferred();dojo.when(self.inherited(arguments),function(){self._currentRowState=self._currentRowState^self._rowStates.EXPANDED;self._updateStyle();var _5fa=self._wipeOut;_5fa.onEnd=function(){self.onResize();def.resolve(true);};});return def;},expand:function(){var self=this,def=new dojo.Deferred();dojo.when(self.inherited(arguments),function(){self._currentRowState=self._currentRowState|self._rowStates.EXPANDED;self._updateStyle();self.onResize();def.resolve();});return def;},onResize:function(){},onTreeNodeSelected:function(_5fb){},setSelected:function(_5fc){this.inherited(arguments);this.isSelected=_5fc;var _5fd=this._currentRowState;this._currentRowState=_5fc?(this._currentRowState|this._rowStates.SELECTED):parseInt(this._currentRowState&this._rowStates.SELECTED,10)>0?(this._currentRowState^this._rowStates.SELECTED):_5fd;this._updateStyle();if(_5fc){this.onTreeNodeSelected(this);}},_updateBlockFolderTypeIcon:function(){if(this.isRootNode){this._iconNodeClass=this._blockFolderRoot;}else{this._iconNodeClass=this.isExpanded?this._blockFolderExpand:this._blockFolderCollapse;}dojo.addClass(this.iconNode,this._iconNodeClass);},_onMouseEnter:function(evt){this.inherited(arguments);this._currentRowState=this._currentRowState|this._rowStates.ENTERED;this._updateStyle();dojo.removeClass(this.labelNode,"dijitInlineEditBoxDisplayModeHover");},_onMouseLeave:function(evt){this.inherited(arguments);this._currentRowState=this._currentRowState^this._rowStates.ENTERED;this._updateStyle();},_onIconNodeMenuClick:function(evt){this.contextMenu&&this.contextMenu.scheduleOpen(evt.target,null,{x:evt.pageX,y:evt.pageY});this.onTreeNodeSelected(this);},_updateStyleBySingleState:function(_5fe){var _5ff=this._rowStates;switch(_5fe){case _5ff.SELECTED:dojo.addClass(this.iconNodeMenu,this._blockFolderMenu);break;case _5ff.ENTERED:dojo.addClass(this.iconNodeMenu,this._blockFolderMenu);break;default:dojo.removeClass(this.iconNodeMenu,this._blockFolderMenu);dojo.removeClass(this.iconNode,this._blockFolderExpand);dojo.removeClass(this.iconNode,this._blockFolderCollapse);var _600=this.isExpanded&&this.hasChildren()?this._blockFolderExpand:this._blockFolderCollapse;dojo.addClass(this.iconNode,this.isRootNode?this._blockFolderRoot:_600);break;}},_updateStyle:function(){for(var _601 in this._rowStates){if(parseInt(this._currentRowState&this._rowStates[_601],10)>0){this._updateStyleBySingleState(this._rowStates[_601]);}}}});});},"epi/cms/component/ContentContextMenuCommandProvider":function(){define(["dojo/_base/declare","epi/shell/command/_CommandProviderMixin","../command/CopyContent","../command/CutContent","../command/PasteContent","../command/TranslateContent","../command/DeleteContent","epi/cms/command/NewContent","epi/shell/selection","epi/cms/component/ContentFilter","epi/i18n!epi/cms/nls/episerver.cms.components.createpage"],function(_602,_603,_604,_605,_606,_607,_608,_609,_60a,_60b,_60c){return _602([_603],{treeModel:null,clipboardManager:null,_settings:null,_newContentCommand:null,_translateContentCommand:null,constructor:function(_60d){_602.safeMixin(this,_60d);},postscript:function(){this.inherited(arguments);var _60e=new _60a();this._settings={category:"context",model:this.treeModel,clipboard:this.clipboardManager,selection:_60e};this._newContentCommand=new _609({contentType:_60b.PageType,iconClass:"epi-iconPage",label:_60c.command.label,resources:_60c});this._translateContentCommand=new _607();this.commands=[this._newContentCommand,this._translateContentCommand,new _604(this._settings),new _605(this._settings),new _606(this._settings),new _608(this._settings)];},updateCommandModel:function(_60f){this._newContentCommand.set("model",_60f);this._translateContentCommand.set("model",_60f);this._settings.selection.set("data",[{type:"epi.cms.contentdata",data:_60f}]);}});});},"epi/cms/widget/Trash":function(){require({cache:{"url:epi/cms/widget/templates/Trash.html":"<div class=\"epi-trash\">\r\n    <div class=\"epi-listingTopContainer\">\r\n        <h1 class=\"dijitInline\">${resources.heading}</h1>\r\n        <div class=\"epi-mediumButton epi-boldButton epi-emptyCommand\" data-dojo-attach-point=\"emptyTrashMenu\" data-dojo-type=\"epi.cms.widget.EmptyTrashMenu\"\r\n            data-dojo-props=\"title: '${resources.emptytrash.tooltip}'\"></div>\r\n    </div>\r\n    <div data-dojo-attach-point=\"stackContainer\">\r\n        <div data-dojo-type=\"dijit.layout.TabContainer\" data-dojo-attach-point=\"tabContainer\" data-dojo-props=\"doLayout:false, useMenu:true, useSlider:false\"> <!-- doLayout=\"false\" for flexible height -->\r\n        </div>\r\n    </div>\r\n</div>\r\n"}});define("epi/cms/widget/Trash",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/dom-construct","dojo/Evented","dojo/_base/Deferred","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/layout/TabContainer","dijit/layout/ContentPane","dijit/registry","epi/shell/widget/_ModelBindingMixin","epi/shell/widget/dialog/Alert","epi/shell/command/withConfirmation","epi/cms/widget/TrashItemList","epi/cms/widget/EmptyTrashMenu","epi/cms/widget/TrashViewModelConfirmation","epi/cms/widget/command/EmptyTrash","epi/cms/widget/command/RestoreContent","epi/i18n!epi/cms/nls/episerver.cms.components.trash","dojo/text!./templates/Trash.html"],function(_610,_611,lang,_612,_613,_614,_615,_616,_617,_618,_619,_61a,_61b,_61c,_61d,_61e,_61f,_620,_621,_622,_623,_624,_625){return _611("epi.cms.widget.Trash",[_616,_617,_618,_61c,_614],{resources:null,templateString:_625,_restoreContentCommand:null,typeIdentifiers:null,modelBindingMap:{"contentStore":["store"],"queryOptions":["queryOptions"],"actionResponse":["actionResponse"],"trashes":["trashes"]},postCreate:function(){this.inherited(arguments);this.tabContainer.watch("selectedChildWidget",lang.hitch(this,function(name,_626,_627){if(_627.itemListId){var _628=_61b.byId(_627.itemListId);_628.bindUserSelector(_627.feeder.deletedByUsers);}this.model.set("currentFeeder",_627.feeder);}));this._restoreContentCommand=new _623({model:this.model});this.watch("model",lang.hitch(this,function(){this.model=_621(this.model);this._restoreContentCommand.set("model",this.model);}));this.on("itemClick",this._onItemClick);this.on("deletedByChange",this._onDeletedByChange);this.on("searchBoxChange",this._onSearchBoxChange);},postMixInProperties:function(){this.resources=this.resources||_624;},_setTrashesAttr:function(_629){this.tabContainer.destroyDescendants();var _62a=[];_610.forEach(_629,function(_62b){if(_62b&&_62b.active){this._addFeeders(_62b.feeders);var _62c=new _622({label:_62b.name,tooltip:_62b.name,trashId:_62b.wasteBasketLink,model:this.model});_62a.push(_61e(_62c,null,{title:_624.emptytrash.title,description:_624.emptytrash.description.replace("{0}",_62c.label),onShow:lang.hitch(this,function(){var _62d=this.tabContainer.selectedChildWidget.getChildren()[0];_62d.clearSelection();})}));}},this);this.emptyTrashMenu.set("commands",_62a);this.tabContainer.startup();this.tabContainer.layout();},_addFeeders:function(_62e){var _62f=null;_610.forEach(_62e,function(_630){if(_630.active){_630.isRequireLoad=true;var item=new _61a({title:_630.name,feeder:_630});this.tabContainer.addChild(item);if(this._isSelected(_630)){_62f=item;}}},this);if(_62f){this.tabContainer.selectChild(_62f);}},_isSelected:function(_631){var _632=false;_610.some(_631.typeIdentifiers,lang.hitch(this,function(_633){return _610.some(this.typeIdentifiers,function(type){if(_633==type){_632=true;return false;}});}));return _632;},_setQueryOptionsAttr:function(_634){if(_634){var _635=this.tabContainer.selectedChildWidget;if(_635){var _636=this.get("store"),_637=null;if(_635.itemListId){_637=_61b.byId(_635.itemListId);_637.set("queryOptions",_634);}else{_637=new _61f({queryOptions:_634,store:_636,model:this.model});_637.on("itemClick",lang.hitch(this,function(row){this.emit("itemClick",row);}));_637.on("deletedByChange",lang.hitch(this,function(_638){this.emit("deletedByChange",_638);}));_637.on("searchBoxChange",lang.hitch(this,function(_639){this.emit("searchBoxChange",_634.query.contentSearchAreas,_639);}));_635.set("content",_637);_635.itemListId=_637.id;}_637.updateRemovedBy(_634);}}},_setActionResponseAttr:function(_63a){if(!_63a){return;}if(!_63a.isSuccess){this._showNotificationMessage(_63a.message);}},_showNotificationMessage:function(_63b){new _61d({destroyOnHide:true,description:_63b?_63b:""}).show();},_onItemClick:function(row){if(row&&row.data&&this.model.get("currentFeeder")){this._restoreContentCommand.set("content",row.data);this._restoreContentCommand.execute();}},_onDeletedByChange:function(_63c){var _63d=this.model.get("currentFeeder");_63d.deletedBy=_63c;_63d.isRequireLoad=true;this.model.set("currentFeeder",_63d);},_onSearchBoxChange:function(_63e,_63f){var _640=this.model.get("currentFeeder");_640.contentSearchAreas=_63e;_640.queryText=_63f;_640.isRequireLoad=true;this.model.set("currentFeeder",_640);}});});},"epi/cms/widget/command/RenameFolder":function(){define("epi/cms/widget/command/RenameFolder",["dojo/_base/declare","epi/i18n!epi/cms/nls/episerver.cms.components.sharedblockscomponent","epi/cms/contentediting/ContentActionSupport","epi/shell/command/_Command"],function(_641,_642,_643,_644){return _641([_644],{label:_642.contextmenu.rename,contentActionSupport:null,postscript:function(){this.inherited(arguments);this.contentActionSupport=this.contentActionSupport||_643;},_execute:function(){this.model.labelWidget.edit();},_onModelChange:function(){var _645=this.model&&this.model.labelWidget&&this.contentActionSupport.hasAccess(this.model.item.accessMask,_643.accessLevel[_643.action.Edit]);this.set("canExecute",_645);}});});},"epi/cms/widget/TrashItemList":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/window","dojo/_base/Deferred","dojo/aspect","dojo/keys","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/Evented","dojo/query","dojo/html","dojo/Stateful","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/form/Select","dojox/widget/Standby","dgrid/OnDemandGrid","dgrid/Selection","dgrid/Keyboard","dgrid/Tree","dgrid/extensions/ColumnResizer","dgrid/util/mouse","put-selector/put","epi/dependency","epi/shell/dgrid/Formatter","epi/shell/dgrid/util/misc","epi/shell/widget/SearchBox","epi/shell/widget/_ModelBindingMixin","epi/datetime","epi/username","epi/i18n!epi/cms/nls/episerver.cms.components.trash","dojo/text!./templates/TrashItemList.html"],function(_646,_647,lang,_648,_649,_64a,keys,_64b,_64c,_64d,_64e,_64f,_650,html,_651,_652,_653,_654,_655,_656,_657,_658,_659,Tree,_65a,_65b,put,_65c,_65d,_65e,_65f,_660,_661,_662,_663,_664){return _647("epi.cms.widget.TrashItemList",[_652,_653,_654,_64f,_651,_660],{resources:null,templateString:_664,_grid:null,_observers:{},_setQueryOptionsAttr:function(_665){this._set("queryOptions",_665);this._initialize();},updateRemovedBy:function(_666){var _667=this.model.get("currentFeeder");if(this.model.isEmptyTrash){this.bindDefaultUserSelector();return;}var _668=this.store.query({referenceId:_666.query.referenceId});var _669=lang.hitch(this,function(item,_66a,_66b){var _66c=_667.isDefaultProvider?"":_667.name;_649.when(this.model.trashStore.query({providerName:_66c}),lang.hitch(this,function(_66d){if(_66d){var _66e=_66d.deletedByUsers;var _66f=_646.filter(this.model.get("trashes"),function(item){return item.wasteBasketLink===_66d.wasteBasketLink;})[0];_66f.deletedByUsers=_66e;_646.forEach(_66f.feeders,function(_670){_670.deletedByUsers=_66e;});this.bindUserSelector(_66e);}}));});var id=_667.name,_671=this._observers[id];if(_671){_671.cancel();delete this._observers[id];}this._observers[id]=_668.observe(_669,true);},destroy:function(){for(var id in this._observers){this._observers[id].cancel();delete this._observers[id];}if(this._standby){this._standby.destroyRecursive();this._standby=null;}if(this._grid){this._grid.destroy();this._grid=null;}this.inherited(arguments);},clearSelection:function(){this._grid.clearSelection();this._grid._lastSelected=null;},postMixInProperties:function(){this.resources=this.resources||_663;var _672=_65c.resolve("epi.cms.Application");this._typeDescriptor=_672.getTypeUIDescriptors();},postCreate:function(){this.inherited(arguments);this.bindUserSelector(this.model.get("currentFeeder").deletedByUsers);this.searchBox.encodeSearchText=true;this.searchBox.on("searchBoxChange",lang.hitch(this,function(_673){this.emit("searchBoxChange",_673);}));this.removedBy._updateSelection=function(){this._set("value",this._getValueFromOpts());var val=this.value;if(!lang.isArray(val)){val=[val];}_646.forEach(this._getChildren(),function(_674){var _675=_646.some(val,function(v){return _674.option&&(v===_674.option.value);});_64b.toggle(_674.domNode,this.baseClass+"SelectedOption",_675);_674.domNode.setAttribute("aria-selected",_675);},this);};},resize:function(){if(this._grid){var top=_64d.position(this._grid.domNode).y;var _676=_64d.position(_648.body()).h;_64e.set(this._grid.domNode,"height",(_676-top)+"px");}},_initialize:function(){this.searchBox.set("disabled",!this.queryOptions.query.isSearchable);if(!this._grid){this._grid=this._createGrid(this.store,this.queryOptions);_64c.place(this._grid.domNode,this.gridContainerNode);}else{this._showStandby(true);if(this.queryOptions){this._grid.set("queryOptions",this.queryOptions.options);this._grid.set("query",this.queryOptions.query);}}this.resize();},bindDefaultUserSelector:function(){this.removedBy._onChangeActive=false;this.removedBy.removeOption(this.removedBy.options);this.removedBy.addOption({label:this.resources.any,value:""});this.removedBy._onChangeActive=true;},bindUserSelector:function(_677){if(_677){var _678=this.removedBy.get("value");this.bindDefaultUserSelector();this.removedBy._onChangeActive=false;_646.forEach(_677,function(_679){this.removedBy.addOption({label:this._createUserFriendlyUsername(_679),value:_679});},this);this.removedBy.set("value",_678);this.removedBy._onChangeActive=true;}},_createGrid:function(_67a,_67b){var _67c=_647([_657,_658,_659,_65d,_65a]);var grid=new _67c({store:_67a,columns:{name:Tree({field:"name",label:_663.name,renderCell:lang.hitch(this,this._renderTreeNode)}),removedOn:{field:"deleted",label:_663.removedon,formatters:[this._localizeDate,_65e.ellipsis]},by:{field:"deletedBy",label:_663.by,formatters:[this._createUserFriendlyUsername,_65e.ellipsis]},action:{label:" ",formatter:this._renderActionMenu,sortable:false}},minWidth:100,noDataMessage:this._getNoDataMessage(),selectionMode:"single"});this._standby=new _656({target:grid.domNode}).placeAt(document.body);this._standby.startup();_64a.after(grid,"_processScroll",lang.hitch(this,function(){this._showStandby(false);}));this._showStandby(true);_64a.before(grid,"adjustRowIndices",function(_67d){if(_67d){_646.forEach(_650("div.dgrid-no-data",this.contentNode),function(div){html.set(div,"");});}});_64a.before(grid,"renderArray",lang.hitch(this,function(_67e,_67f,_680){var _681=this.queryOptions.query;if(_681&&_681.query==="searchcontent"){_67e.map(function(_682){if(_682){_682.hasChildren=false;}});}}));if(_67b){grid.set("queryOptions",_67b.options);grid.set("query",_67b.query);}var _683="epi-dgrid-mouseover";grid.on(_65b.enterRow,function(evt){_64b.add(this,_683);});grid.on(_65b.leaveRow,function(evt){_64b.remove(this,_683);});grid.on(".epi-gridAction:click",lang.hitch(this,function(evt){var row=grid.row(evt);this.emit("itemClick",row);}));grid.on(".dgrid-column-action:keydown",lang.hitch(this,function(e){if(e.keyCode==keys.ENTER&&!e.shiftKey&&!e.altKey&&!e.ctrlKey){var row=grid.row(e);this.emit("itemClick",row);}}));return grid;},_renderTreeNode:function(_684,data,td,_685){var _686="epi-iconObjectPage";if(data&&this._typeDescriptor&&_684.typeIdentifier){var _687=this._typeDescriptor[_684.typeIdentifier];if(_687.iconClass){_686=_687.iconClass;}}_64c.place(_65e.icon(_686+" epi-objectIcon",_65e.ellipsis(_65e.htmlEncode(data))),td);},_renderActionMenu:function(_688){var data={"title":_663.restore.tooltip,"label":_663.restore.label};return lang.replace("<a class=\"epi-gridAction\" title=\"{title}\">{label}</a>",data);},_localizeDate:function(_689){return _661.toUserFriendlyString(_689);},_createUserFriendlyUsername:function(name){return _662.toUserFriendlyString(_65e.htmlEncode(name));},_onDeletedByChange:function(_68a){if(this.model.isEmptyTrash){this.model.isEmptyTrash=false;return;}this.emit("deletedByChange",_68a);},_showStandby:function(_68b){if(!this._standby){return;}if(_68b){if(!this._standby.isVisible()){this._standby.show();}}else{this._standby.hide();}},_getNoDataMessage:function(){return "<span><span class=\"dijitReset dijitInline\">"+_663.trashitemempty+"</span></span>";}});});},"epi/cms/contentediting/FormEditing":function(){define("epi/cms/contentediting/FormEditing",["dojo","dojo/_base/Deferred","dojo/i18n","dijit","dijit/_Contained","dijit/_Container","dijit/layout/BorderContainer","dijit/layout/TabContainer","epi","epi/cms/contentediting/EditingBase","epi/cms/contentediting/SideBySideEditorWrapper","epi/shell/widget/FormContainer"],function(dojo,_68c,i18n,_68d,_68e,_68f,_690,_691,epi,_692,_693,_694){return dojo.declare("epi.cms.contentediting.FormEditing",[_692],{_formWidgets:null,_formEditorWrappers:null,_formContainer:null,_formPane:null,_formPaneRegion:null,_formPaneWidth:null,_watchHandles:null,postMixInProperties:function(){this.inherited(arguments);this._formPaneWidth="100%";this._formPaneRegion="right";this._watchHandles=[];},destroy:function(){dojo.forEach(this._watchHandles,function(_695){_695.unwatch();});this._watchHandles=null;if(this._formPane){this.layoutContainer.removeChild(this._formPane);this._formPane.destroyRecursive();}this.layoutContainer.layout();this.inherited(arguments);},_setupForm:function(){if(this._formContainer){this.layoutContainer.removeChild(this._formPane);this._formContainer.destroyRecursive();this._formPane.destroyRecursive();}this._formWidgets={};var _696=dojo.hitch(this,function(_697,_698){this._formWidgets[_697]=_698;this._addStateWatch(_698);});var _699=dojo.hitch(this,function(_69a,_69b){if(_69b.contentViewModel!==undefined){_69b.set("contentViewModel",this.viewModel);}});var _69c=dojo.hitch(this,function(_69d){this.layoutContainer.addChild(this._formPane);this._createFormEditorWrappers(_69d);this.onSetupEditModeComplete();this.connect(this.layoutContainer.getSplitter(this._formPaneRegion),"_stopDrag",dojo.hitch(this,function(){if(this.get("noPreview")){this.onReloadRequired();this.set("noPreview",false);}else{var pos=dojo.position(this.iFrame.domNode);if(pos.w===0){this.set("noPreview",true);}}}));});this._formPane=new _690({splitter:this.viewModel.contentData.hasTemplate,gutters:false,region:this._formPaneRegion,style:{width:this._formPaneWidth}});this._formContainer=new _694({splitter:false,region:"center",readOnly:!this.viewModel.canChangeContent(),metadata:this.viewModel.metadata,onFieldCreated:_696,onGroupCreated:_699,onFormCreated:_69c});this._formPane.addChild(this._formContainer);this._formPane.startup();dojo.addClass(this._formContainer.domNode,"epi-cmsEditingForm");},_createFormEditorWrappers:function(_69e){this._formEditorWrappers={};for(var _69f in this._formWidgets){var _6a0={name:_69f,metadata:this.viewModel.getPropertyMetaData(_69f)};var _6a1=dojo.clone(this.viewModel.getProperty(_6a0.name),true);var _6a2=new _693({property:_6a0,propertyName:_69f,value:_6a1,editorWidget:this._formWidgets[_69f],contentModel:this.viewModel.contentModel});_6a2.editorWidget.set("parent",_6a2);_6a2.editorWidget.set("editMode","formedit");this.connect(_6a2,"onValueChange","_onWrapperValueChange");this.connect(_6a2,"onDoubleValueChange","_onDoubleValueChange");this.connect(_6a2,"onCancel","_onWrapperCancel");this.connect(_6a2,"onStopEdit","_onWrapperStopEdit");this._formEditorWrappers[_69f]=_6a2;this._connectWrappersToBlocks(_69f,_6a2);}},_connectWrappersToBlocks:function(_6a3,_6a4){var _6a5=_6a3.split(".");var _6a6=false;while(_6a5.length>0){var _6a7=_6a5.join(".");var _6a8=this._mappingManager.find("propertyName",_6a7);dojo.forEach(_6a8,function(_6a9){_6a6=true;_6a9.propertyName=_6a3;_6a9.wrapper=_6a9.wrapper||_6a4;});_6a5.pop();}if(!_6a6){this._mappingManager.add({propertyName:_6a3,wrapper:_6a4});}},_addStateWatch:function(_6aa){var _6ab=_6aa.get("name");this._watchHandles.push(_6aa.watch("state",dojo.hitch(this,function(name,_6ac,_6ad){if(_6ac==="Error"&&_6ad!=="Error"){this.viewModel.validator.clearPropertyErrors(_6ab,this.viewModel.validator.validationSource.client);}else{if(_6ac!=="Error"&&_6ad==="Error"){this.viewModel.validator.setPropertyErrors(_6ab,[{"severity":this.viewModel.validator.severity.error,"errorMessage":_6aa.getErrorMessage()}],this.viewModel.validator.validationSource.client);}}})));},onReadySetupEditMode:function(){this.inherited(arguments);this.toolbar.setItemProperty("editmodeswitch","checked",true);this.set("noPreview",true);this._setupForm();},remapEditMode:function(){this.inherited(arguments);this._formContainer.set("readOnly",!this.viewModel.canChangeContent());},_createEditorWrapperForBlock:function(_6ae,_6af,_6b0){return this._formEditorWrappers[_6ae.name];}});});},"epi/shell/command/_GlobalCommandProviderMixin":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","epi/shell/command/_CommandProviderMixin","epi/dependency"],function(_6b1,_6b2,lang,_6b3,_6b4){return _6b2([_6b3],{commandKey:null,commandProviders:null,_consumer:null,_currentCommandModel:null,_providerWatch:null,_initialized:false,initializeCommandProviders:function(){if(this.initialized){return;}if(!this.commandKey){return;}this._consumer=this.getConsumer();if(!this._consumer){return;}this.commandRegistry=this.commandRegistry||_6b4.resolve("epi.globalcommandregistry");this.commandProviders=this.commandRegistry.get(this.commandKey,true);_6b1.forEach(this.commandProviders.providers,function(_6b5){this._consumer.addProvider(_6b5);},this);this._providerWatch=this.commandProviders.watch("providers",lang.hitch(this,this.onProvidersChanged));this.initialized=true;},updateCommandModel:function(_6b6){this._currentCommandModel=_6b6;_6b1.forEach(this.commandProviders.providers,function(_6b7){if(_6b7.updateCommandModel){_6b7.updateCommandModel(_6b6);}},this);},onProvidersChanged:function(name,_6b8,_6b9){if(_6b8){_6b1.forEach(_6b8,this._consumer.removeProvider,this._consumer);}if(_6b9){_6b1.forEach(_6b9,function(item){this._consumer.addProvider(item);if(item.updateCommandModel){item.updateCommandModel(this._currentCommandModel);}},this);}},uninitialize:function(){this.inherited(arguments);if(this._consumer){_6b1.forEach(this.commandProviders.providers,this._consumer.removeProvider,this);}this._providerWatch.unwatch();}});});},"epi/cms/contentediting/ViewSettingsManager":function(){define("epi/cms/contentediting/ViewSettingsManager",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/connect","dojo/_base/Deferred","dojo/Stateful","epi/epi","epi/dependency","epi/shell/_StatefulGetterSetterMixin","epi/UriParser","epi/Url"],function(_6ba,_6bb,lang,_6bc,_6bd,_6be,epi,_6bf,_6c0,_6c1,Url){return _6ba("epi.cms.contentediting.ViewSettingsManager",[_6be,_6c0],{_hashWrapper:null,viewSettings:null,_viewSettingsMap:null,viewSettingsHashValue:[],_activeKey:"active",_settingEnabled:false,previewParams:null,postscript:function(){this.inherited(arguments);this._hashWrapper=_6bf.resolve("epi.shell.HashWrapper");this.previewParams={};this._viewSettingsMap={};_6bb.forEach(this.viewSettings,lang.hitch(this,function(_6c2){if(!this._viewSettingsMap[_6c2.key]){this._viewSettingsMap[_6c2.key]=_6c2;}else{throw "Duplicated view settings key.";}}));_6bc.subscribe("/epi/cms/action/viewsettingvaluechanged",lang.hitch(this,this._viewSettingChanged));_6bc.subscribe("/epi/cms/action/eyetoggle",lang.hitch(this,this._viewSettingEnabledChanged));var obj=this._hashWrapper.getHash();if(obj&&obj.viewsetting){this.viewSettingsHashValue=this._toObjects(obj.viewsetting);}this._settingEnabled=this._loadProperty(this._activeKey)==="true";_6bb.forEach(this.viewSettingsHashValue,lang.hitch(this,function(item){var _6c3=this._viewSettingsMap[item.type];if(_6c3){_6c3.value=item.id;_6c3.beforePreviewLoad(this.previewParams,this._settingEnabled);}}));},onReloadRequired:function(){},onPreviewReady:function(_6c4){this._preview=_6c4;_6bb.forEach(this.viewSettings,lang.hitch(this,function(_6c5){_6c5.afterPreviewLoad(_6c4,this._settingEnabled);}));},getSettingProperty:function(_6c6){var _6c7=_6bb.filter(this.viewSettingsHashValue,function(_6c8){return _6c8.type==_6c6;});return _6c7.length>0?_6c7[0].id:null;},hasVisitorGroup:function(){return this.getSettingProperty("visitorgroup")!==null&&this.getSettingProperty("visitorgroup").id!==null;},_getEnabledAttr:function(){return this._settingEnabled;},_setEnabledAttr:function(_6c9){this._settingEnabled=_6c9;var _6ca={};_6bb.forEach(this.viewSettings,lang.hitch(this,function(_6cb){_6cb.beforePreviewLoad(_6ca,_6c9);}));if(!epi.areEqual(this.previewParams,_6ca)){this.previewParams=_6ca;this.onReloadRequired();}else{_6bb.forEach(this.viewSettings,lang.hitch(this,function(_6cc){_6cc.afterPreviewLoad(this._preview,_6c9);}));}},_applyViewSettingValue:function(key,_6cd){var _6ce,_6cf=this._viewSettingsMap[key];if(_6cf){_6ce=lang.clone(this.previewParams);_6cf.value=_6cd;_6cf.beforePreviewLoad(_6ce,true);if(!epi.areEqual(this.previewParams,_6ce)){this.previewParams=_6ce;this.onReloadRequired();}else{_6cf.afterPreviewLoad(this._preview,true);}}},_viewSettingChanged:function(key,_6d0){this._saveProperty(key,_6d0);this._applyViewSettingValue(key,_6d0);},_viewSettingEnabledChanged:function(_6d1){var _6d2=this._hasSetting();if(_6d1){this._saveProperty(this._activeKey,"true");}else{this._saveProperty(this._activeKey,_6d2?false:null);}this.set("enabled",_6d1);},_addProperty:function(_6d3,_6d4){this.viewSettingsHashValue.push({type:_6d3,id:_6d4});},_updateProperty:function(_6d5,_6d6){var _6d7=-1;_6bb.forEach(this.viewSettingsHashValue,function(item,_6d8){if(item.type==_6d5){_6d7=_6d8;return;}});if(_6d7>-1){this.viewSettingsHashValue[_6d7].id=_6d6;}else{this._addProperty(_6d5,_6d6);}},_toObjects:function(url){var _6d9=[];_6bb.forEach(url.split("|"),function(item,_6da){var uri=new _6c1(item);_6d9.push({type:uri.getType(),id:uri.getId()});});return _6d9;},_deleteProperty:function(_6db){var _6dc=-1;_6bb.forEach(this.viewSettingsHashValue,function(item,_6dd){if(item.type==_6db){_6dc=_6dd;return;}});if(_6dc>-1){this.viewSettingsHashValue.splice(_6dc,1);}},_updateHash:function(){var obj=this._hashWrapper.getHash();var _6de=[];_6bb.forEach(this.viewSettingsHashValue,function(item,_6df){_6de.push(item.type+":///"+item.id);});if(_6de.length>0){obj.viewsetting=_6de.join("|");}else{delete obj.viewsetting;}this._hashWrapper.setHash(obj);},_saveProperty:function(_6e0,_6e1){var obj=this._hashWrapper.getHash();if(obj&&obj.viewsetting){this.viewSettingsHashValue=this._toObjects(obj.viewsetting);if(_6e1!=null){this._updateProperty(_6e0,_6e1);}else{this._deleteProperty(_6e0);}this._updateHash();}else{if(_6e1!=null){this._updateProperty(_6e0,_6e1);this._updateHash();}}},_loadProperty:function(_6e2){var obj=this._hashWrapper.getHash();var _6e3=null;if(obj&&obj.viewsetting){var _6e4=this._toObjects(obj.viewsetting);var _6e5=_6bb.filter(_6e4,function(item){return item.type==_6e2;})[0];if(_6e5){_6e3=_6e5.id;}}return _6e3;},_hasSetting:function(){var obj=this._hashWrapper.getHash();if(obj&&obj.viewsetting){if(obj.viewsetting.split("|").length>1){return true;}}return false;},getRenderingViewSettings:function(){return _6bb.filter(this.viewSettings,lang.hitch(this,function(_6e6){return _6e6.usedForRendering;}));}});});},"epi/cms/component/Trash":function(){define(["dojo/_base/declare","dojo/dom-construct","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","epi/shell/widget/_FocusableMixin","epi/cms/widget/Trash","epi/cms/widget/viewmodel/TrashViewModel"],function(_6e7,_6e8,_6e9,_6ea,_6eb,_6ec,_6ed,_6ee){return _6e7("epi.cms.component.Trash",[_6e9,_6ea,_6eb,_6ec],{templateString:"<div class=\"epi-trashComponent\"><div data-dojo-type='epi.cms.widget.Trash' data-dojo-attach-point='trash'></div></div>",updateView:function(data){if(data){this.trash.set("typeIdentifiers",data.typeIdentifiers);}this.trash.set("model",new _6ee());}});});},"epi/cms/widget/sharedContentDialogHandler":function(){define("epi/cms/widget/sharedContentDialogHandler",["dojo/_base/Deferred","epi","epi/shell/widget/dialog/Dialog","epi/cms/widget/ContentReferences","epi/cms/widget/ContentReferencesViewModel","epi/cms/command/ReloadContent"],function(_6ef,epi,_6f0,_6f1,_6f2,_6f3){var _6f4=function(_6f5){var _6f6=new _6ef(),_6f7,_6f8,data=_6f5.selection?_6f5.selection.data[0].data:_6f5.contentData,mode=_6f5.mode||_6f4.mode.confirm,_6f9=mode===_6f4.mode.confirm,_6fa=new _6f2({contentData:data,showToolbar:!_6f9,mode:mode}),_6fb=new _6f3({model:_6fa});_6fa.update().then(function(){_6f7=new _6f0({destroyOnHide:true,defaultActionsVisible:_6f9,dialogClass:"epi-dialog-confirm"}),_6f8=new _6f1({model:_6fa,dialog:_6f7});if(!_6f9){_6f7.definitionConsumer.add({name:"close",label:epi.resources.action.close,settings:{type:"submit"}});}_6f7.connect(_6f7,"onExecute",function(){_6fb.execute();_6f6.resolve();});_6f7.connect(_6f7,"onCancel",_6f6.cancel);_6f7.set("content",_6f8);_6f7.show();});return _6f6;};_6f4.mode={confirm:"confirm",show:"show"};return _6f4;});},"epi/cms/component/ContentQueryGrid":function(){define("epi/cms/component/ContentQueryGrid",["dojo","dojo/_base/lang","epi","epi/dependency","epi/cms/dgrid/DnD","epi/cms/widget/_GridWidgetBase"],function(dojo,lang,epi,_6fc,DnD,_6fd){return dojo.declare("epi.cms.component.ContentQueryGrid",[_6fd],{queryName:null,queryParameters:null,dndTypes:["epi.cms.contentreference"],postMixInProperties:function(){this.storeKeyName="epi.cms.content.search";this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);var _6fe=lang.mixin({columns:{name:{className:"epi-width50",renderCell:lang.hitch(this,this._renderContentItem)}},store:this.store,dndSourceType:this.dndTypes},this.defaultGridMixin);this.grid=new this._gridClass(_6fe,this.domNode);this.grid.set("showHeader",false);},fetchData:function(){this.grid.set("queryOptions",{ignore:["query"],sort:[{attribute:"name",descending:true}]});var _6ff=this.queryParameters||{};_6ff.query=this.queryName;this.grid.set("query",_6ff);},_setQueryNameAttr:function(_700){this.queryName=_700;this.fetchData();}});});},"epi/cms/contentediting/ShortcutNotification":function(){define("epi/cms/contentediting/ShortcutNotification",["dojo/_base/declare","dojo/_base/lang","dojo/Stateful","epi/string","epi/shell/_StatefulGetterSetterMixin","epi/i18n!epi/cms/nls/episerver.cms.contentediting.shortcutnotification"],function(_701,lang,_702,_703,_704,_705){var _706=["normal","shortcut","external","inactive","fetchdata"];var _707=_701("epi.cms.contentediting.ShortcutNotification",[_702,_704],{contentData:null,notification:null,res:_705,viewModel:null,postscript:function(){this.inherited(arguments);},_setViewModelAttr:function(_708){this._set("viewModel",_708);if(this._viewModelWatch){this._viewModelWatch.unwatch();}this._viewModelWatch=this.viewModel.watch("contentModel",lang.hitch(this,function(name,_709,_70a){if(this._contentModelWatch){this._contentModelWatch.unwatch();}this._contentModelWatch=_70a.watch("iversionable_shortcut",lang.hitch(this,function(name,_70b,_70c){var type=_70c&&_70c.pageShortcutType;this._updateNotificationMessage(type);}));}));this.set("contentData",this.viewModel.contentData);},_setContentDataAttr:function(_70d){this._set("contentData",_70d);if(_70d&&_70d.capabilities.isPage){var type=_70d.properties.pageShortcutType;this._updateNotificationMessage(type);}},_updateNotificationMessage:function(_70e){var _70f,_710=null;if(_70e>0){_70f=_706[_70e];_710=_703.toHTML(this.res[_70f]);}this.set("notification",{shortcutType:_70e,content:_710});}});_707.LinkTypes=_706;return _707;});},"epi/cms/contentediting/editors/ContentBlockEditorViewModel":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/Stateful","epi/cms/widget/viewmodel/ContentStatusViewModel"],function(_711,lang,_712,_713){return _711([_712,_713],{contentLink:"",selected:false,name:"",index:0,getValue:function(){return {contentLink:this.contentLink,name:this.name};}});});},"epi/shell/widget/dialog/LightWeight":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-style","dijit/_WidgetsInTemplateMixin","dijit/focus","dijit/Dialog","dijit/DialogUnderlay","epi/shell/widget/dialog/_DialogMixin","dojo/text!./templates/LightWeight.html"],function(_714,lang,_715,_716,_717,_718,_719,_71a,_71b){return _714("epi.shell.widget.dialog.LightWeight",[_718,_71a,_716],{templateString:_71b,buttonCloseText:epi.resources.action.close,buttonDoneText:epi.resources.action.done,buttonLearnMoreText:epi.resources.action.learnmore,useGlassUnderlay:false,_glassUnderlay:null,"class":"epi-lfw-dialog",snapToNode:null,positioner:null,destroy:function(){if(this._glassUnderlay){this._glassUnderlay.destroyRecursive();delete this._glassUnderlay;}this.inherited(arguments);},show:function(){return this.inherited(arguments).then(lang.hitch(this,this._onAfterShow));},_size:function(){this.inherited(arguments);if(this.positioner){this._relativePosition=this.positioner.findPosition(this.domNode,{snapTo:this.snapToNode});}},resize:function(){this._size();this._position();},_onAfterShow:function(){if(this.content&&this.content.focus){this.content.focus();}if(this.useGlassUnderlay){this._createUnderlay();}else{if(this._moveable&&!this._attachedMoveEvents){this.connect(this._moveable,"onMoveStart",lang.hitch(this,this._createUnderlay));this.connect(this._moveable,"onMoveStop",lang.hitch(this,this._removeUnderlay));this._attachedMoveEvents=true;}if(this.content&&this.content.onResizeStart&&this.content.onResizeStop&&!this._attachedContentResizeEvents){this.connect(this.content,"onResizeStart",lang.hitch(this,this._createUnderlay));this.connect(this.content,"onResizeStop",lang.hitch(this,this._removeUnderlay));this._attachedContentResizeEvents=true;}}this.onAfterShow();},_createUnderlay:function(){if(this._glassUnderlay){this._glassUnderlay.show();}else{this._glassUnderlay=new _719();this._glassUnderlay.show();var _71c=_715.get(this.domNode,"zIndex");_715.set(this._glassUnderlay.domNode,"zIndex",_71c-1);_715.set(this._glassUnderlay.domNode,"filter","alpha(opacity=0)");_715.set(this._glassUnderlay.domNode,"opacity","0");}},_removeUnderlay:function(){this._glassUnderlay.hide();},_onContainerNodeClick:function(e){if(e.target===this.containerNode){this._getFocusItems();this._firstFocusItem&&_717.focus(this._firstFocusItem);}},onButtonClose:function(){},onAfterShow:function(){},onAfterHide:function(){},hide:function(){return this.inherited(arguments).then(lang.hitch(this,this._onAfterHide));},_onAfterHide:function(){if(this.useGlassUnderlay){this._removeUnderlay();}this.onAfterHide();},layout:function(){if(this._glassUnderlay&&_715.get(this._glassUnderlay.domNode,"display")!="none"){this._glassUnderlay.layout();}var _71d=dijit._underlay?_715.get(dijit._underlay.domNode,"display"):null;this.inherited(arguments);if(dijit._underlay){_715.set(dijit._underlay.domNode,"display",_71d);}}});});},"dijit/tree/_dndContainer":function(){define("dijit/tree/_dndContainer",["dojo/aspect","dojo/_base/declare","dojo/dom-class","dojo/_base/event","dojo/_base/lang","dojo/mouse","dojo/on"],function(_71e,_71f,_720,_721,lang,_722,on){return _71f("dijit.tree._dndContainer",null,{constructor:function(tree,_723){this.tree=tree;this.node=tree.domNode;lang.mixin(this,_723);this.current=null;this.containerState="";_720.add(this.node,"dojoDndContainer");this.events=[on(this.node,_722.enter,lang.hitch(this,"onOverEvent")),on(this.node,_722.leave,lang.hitch(this,"onOutEvent")),_71e.after(this.tree,"_onNodeMouseEnter",lang.hitch(this,"onMouseOver"),true),_71e.after(this.tree,"_onNodeMouseLeave",lang.hitch(this,"onMouseOut"),true),on(this.node,"dragstart",lang.hitch(_721,"stop")),on(this.node,"selectstart",lang.hitch(_721,"stop"))];},destroy:function(){var h;while(h=this.events.pop()){h.remove();}this.node=this.parent=null;},onMouseOver:function(_724){this.current=_724;},onMouseOut:function(){this.current=null;},_changeState:function(type,_725){var _726="dojoDnd"+type;var _727=type.toLowerCase()+"State";_720.replace(this.node,_726+_725,_726+this[_727]);this[_727]=_725;},_addItemClass:function(node,type){_720.add(node,"dojoDndItem"+type);},_removeItemClass:function(node,type){_720.remove(node,"dojoDndItem"+type);},onOverEvent:function(){this._changeState("Container","Over");},onOutEvent:function(){this._changeState("Container","");}});});},"dijit/Tree":function(){require({cache:{"url:dijit/templates/TreeNode.html":"<div class=\"dijitTreeNode\" role=\"presentation\"\n\t><div data-dojo-attach-point=\"rowNode\" class=\"dijitTreeRow\" role=\"presentation\" data-dojo-attach-event=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onclick:_onClick, ondblclick:_onDblClick\"\n\t\t><img src=\"${_blankGif}\" alt=\"\" data-dojo-attach-point=\"expandoNode\" class=\"dijitTreeExpando\" role=\"presentation\"\n\t\t/><span data-dojo-attach-point=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"\n\t\t></span\n\t\t><span data-dojo-attach-point=\"contentNode\"\n\t\t\tclass=\"dijitTreeContent\" role=\"presentation\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" data-dojo-attach-point=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"\n\t\t\t/><span data-dojo-attach-point=\"labelNode\" class=\"dijitTreeLabel\" role=\"treeitem\" tabindex=\"-1\" aria-selected=\"false\" data-dojo-attach-event=\"onfocus:_onLabelFocus\"></span>\n\t\t</span\n\t></div>\n\t<div data-dojo-attach-point=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\n</div>\n","url:dijit/templates/Tree.html":"<div class=\"dijitTree dijitTreeContainer\" role=\"tree\"\n\tdata-dojo-attach-event=\"onkeypress:_onKeyPress\">\n\t<div class=\"dijitInline dijitTreeIndent\" style=\"position: absolute; top: -9999px\" data-dojo-attach-point=\"indentDetector\"></div>\n</div>\n"}});define("dijit/Tree",["dojo/_base/array","dojo/_base/connect","dojo/cookie","dojo/_base/declare","dojo/_base/Deferred","dojo/DeferredList","dojo/dom","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/_base/event","dojo/fx","dojo/_base/kernel","dojo/keys","dojo/_base/lang","dojo/topic","./focus","./registry","./_base/manager","./_Widget","./_TemplatedMixin","./_Container","./_Contained","./_CssStateMixin","dojo/text!./templates/TreeNode.html","dojo/text!./templates/Tree.html","./tree/TreeStoreModel","./tree/ForestStoreModel","./tree/_dndSelector"],function(_728,_729,_72a,_72b,_72c,_72d,dom,_72e,_72f,_730,_731,_732,_733,keys,lang,_734,_735,_736,_737,_738,_739,_73a,_73b,_73c,_73d,_73e,_73f,_740,_741){var _742=_72b("dijit._TreeNode",[_738,_739,_73a,_73b,_73c],{item:null,isTreeNode:true,label:"",_setLabelAttr:{node:"labelNode",type:"innerText"},isExpandable:null,isExpanded:false,state:"UNCHECKED",templateString:_73d,baseClass:"dijitTreeNode",cssStateNodes:{rowNode:"dijitTreeRow",labelNode:"dijitTreeLabel"},_setTooltipAttr:{node:"rowNode",type:"attribute",attribute:"title"},buildRendering:function(){this.inherited(arguments);this._setExpando();this._updateItemClasses(this.item);if(this.isExpandable){this.labelNode.setAttribute("aria-expanded",this.isExpanded);}this.setSelected(false);},_setIndentAttr:function(_743){var _744=(Math.max(_743,0)*this.tree._nodePixelIndent)+"px";_730.set(this.domNode,"backgroundPosition",_744+" 0px");_730.set(this.rowNode,this.isLeftToRight()?"paddingLeft":"paddingRight",_744);_728.forEach(this.getChildren(),function(_745){_745.set("indent",_743+1);});this._set("indent",_743);},markProcessing:function(){this.state="LOADING";this._setExpando(true);},unmarkProcessing:function(){this._setExpando(false);},_updateItemClasses:function(item){var tree=this.tree,_746=tree.model;if(tree._v10Compat&&item===_746.root){item=null;}this._applyClassAndStyle(item,"icon","Icon");this._applyClassAndStyle(item,"label","Label");this._applyClassAndStyle(item,"row","Row");},_applyClassAndStyle:function(item,_747,_748){var _749="_"+_747+"Class";var _74a=_747+"Node";var _74b=this[_749];this[_749]=this.tree["get"+_748+"Class"](item,this.isExpanded);_72e.replace(this[_74a],this[_749]||"",_74b||"");_730.set(this[_74a],this.tree["get"+_748+"Style"](item,this.isExpanded)||{});},_updateLayout:function(){var _74c=this.getParent();if(!_74c||!_74c.rowNode||_74c.rowNode.style.display=="none"){_72e.add(this.domNode,"dijitTreeIsRoot");}else{_72e.toggle(this.domNode,"dijitTreeIsLast",!this.getNextSibling());}},_setExpando:function(_74d){var _74e=["dijitTreeExpandoLoading","dijitTreeExpandoOpened","dijitTreeExpandoClosed","dijitTreeExpandoLeaf"],_74f=["*","-","+","*"],idx=_74d?0:(this.isExpandable?(this.isExpanded?1:2):3);_72e.replace(this.expandoNode,_74e[idx],_74e);this.expandoNodeText.innerHTML=_74f[idx];},expand:function(){if(this._expandDeferred){return this._expandDeferred;}this._wipeOut&&this._wipeOut.stop();this.isExpanded=true;this.labelNode.setAttribute("aria-expanded","true");if(this.tree.showRoot||this!==this.tree.rootNode){this.containerNode.setAttribute("role","group");}_72e.add(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);if(this==this.tree.rootNode){this.tree.domNode.setAttribute("aria-expanded","true");}var def,_750=_732.wipeIn({node:this.containerNode,duration:_737.defaultDuration,onEnd:function(){def.callback(true);}});def=(this._expandDeferred=new _72c(function(){_750.stop();}));_750.play();return def;},collapse:function(){if(!this.isExpanded){return;}if(this._expandDeferred){this._expandDeferred.cancel();delete this._expandDeferred;}this.isExpanded=false;this.labelNode.setAttribute("aria-expanded","false");if(this==this.tree.rootNode){this.tree.domNode.setAttribute("aria-expanded","false");}_72e.remove(this.contentNode,"dijitTreeContentExpanded");this._setExpando();this._updateItemClasses(this.item);if(!this._wipeOut){this._wipeOut=_732.wipeOut({node:this.containerNode,duration:_737.defaultDuration});}this._wipeOut.play();},indent:0,setChildItems:function(_751){var tree=this.tree,_752=tree.model,defs=[];_728.forEach(this.getChildren(),function(_753){_73a.prototype.removeChild.call(this,_753);},this);this.state="LOADED";if(_751&&_751.length>0){this.isExpandable=true;_728.forEach(_751,function(item){var id=_752.getIdentity(item),_754=tree._itemNodesMap[id],node;if(_754){for(var i=0;i<_754.length;i++){if(_754[i]&&!_754[i].getParent()){node=_754[i];node.set("indent",this.indent+1);break;}}}if(!node){node=this.tree._createTreeNode({item:item,tree:tree,isExpandable:_752.mayHaveChildren(item),label:tree.getLabel(item),tooltip:tree.getTooltip(item),dir:tree.dir,lang:tree.lang,textDir:tree.textDir,indent:this.indent+1});if(_754){_754.push(node);}else{tree._itemNodesMap[id]=[node];}}this.addChild(node);if(this.tree.autoExpand||this.tree._state(node)){defs.push(tree._expandNode(node));}},this);_728.forEach(this.getChildren(),function(_755){_755._updateLayout();});}else{this.isExpandable=false;}if(this._setExpando){this._setExpando(false);}this._updateItemClasses(this.item);if(this==tree.rootNode){var fc=this.tree.showRoot?this:this.getChildren()[0];if(fc){fc.setFocusable(true);tree.lastFocused=fc;}else{tree.domNode.setAttribute("tabIndex","0");}}return new _72d(defs);},getTreePath:function(){var node=this;var path=[];while(node&&node!==this.tree.rootNode){path.unshift(node.item);node=node.getParent();}path.unshift(this.tree.rootNode.item);return path;},getIdentity:function(){return this.tree.model.getIdentity(this.item);},removeChild:function(node){this.inherited(arguments);var _756=this.getChildren();if(_756.length==0){this.isExpandable=false;this.collapse();}_728.forEach(_756,function(_757){_757._updateLayout();});},makeExpandable:function(){this.isExpandable=true;this._setExpando(false);},_onLabelFocus:function(){this.tree._onNodeFocus(this);},setSelected:function(_758){this.labelNode.setAttribute("aria-selected",_758);_72e.toggle(this.rowNode,"dijitTreeRowSelected",_758);},setFocusable:function(_759){this.labelNode.setAttribute("tabIndex",_759?"0":"-1");},_onClick:function(evt){this.tree._onClick(this,evt);},_onDblClick:function(evt){this.tree._onDblClick(this,evt);},_onMouseEnter:function(evt){this.tree._onNodeMouseEnter(this,evt);},_onMouseLeave:function(evt){this.tree._onNodeMouseLeave(this,evt);},_setTextDirAttr:function(_75a){if(_75a&&((this.textDir!=_75a)||!this._created)){this._set("textDir",_75a);this.applyTextDir(this.labelNode,this.labelNode.innerText||this.labelNode.textContent||"");_728.forEach(this.getChildren(),function(_75b){_75b.set("textDir",_75a);},this);}}});var Tree=_72b("dijit.Tree",[_738,_739],{store:null,model:null,query:null,label:"",showRoot:true,childrenAttr:["children"],paths:[],path:[],selectedItems:null,selectedItem:null,openOnClick:false,openOnDblClick:false,templateString:_73e,persist:true,autoExpand:false,dndController:_741,dndParams:["onDndDrop","itemCreator","onDndCancel","checkAcceptance","checkItemAcceptance","dragThreshold","betweenThreshold"],onDndDrop:null,itemCreator:null,onDndCancel:null,checkAcceptance:null,checkItemAcceptance:null,dragThreshold:5,betweenThreshold:0,_nodePixelIndent:19,_publish:function(_75c,_75d){_734.publish(this.id,lang.mixin({tree:this,event:_75c},_75d||{}));},postMixInProperties:function(){this.tree=this;if(this.autoExpand){this.persist=false;}this._itemNodesMap={};if(!this.cookieName&&this.id){this.cookieName=this.id+"SaveStateCookie";}this._loadDeferred=new _72c();this.inherited(arguments);},postCreate:function(){this._initState();if(!this.model){this._store2model();}this.connect(this.model,"onChange","_onItemChange");this.connect(this.model,"onChildrenChange","_onItemChildrenChange");this.connect(this.model,"onDelete","_onItemDelete");this._load();this.inherited(arguments);if(this.dndController){if(lang.isString(this.dndController)){this.dndController=lang.getObject(this.dndController);}var _75e={};for(var i=0;i<this.dndParams.length;i++){if(this[this.dndParams[i]]){_75e[this.dndParams[i]]=this[this.dndParams[i]];}}this.dndController=new this.dndController(this,_75e);}},_store2model:function(){this._v10Compat=true;_733.deprecated("Tree: from version 2.0, should specify a model object rather than a store/query");var _75f={id:this.id+"_ForestStoreModel",store:this.store,query:this.query,childrenAttrs:this.childrenAttr};if(this.params.mayHaveChildren){_75f.mayHaveChildren=lang.hitch(this,"mayHaveChildren");}if(this.params.getItemChildren){_75f.getChildren=lang.hitch(this,function(item,_760,_761){this.getItemChildren((this._v10Compat&&item===this.model.root)?null:item,_760,_761);});}this.model=new _740(_75f);this.showRoot=Boolean(this.label);},onLoad:function(){},_load:function(){this.model.getRoot(lang.hitch(this,function(item){var rn=(this.rootNode=this.tree._createTreeNode({item:item,tree:this,isExpandable:true,label:this.label||this.getLabel(item),textDir:this.textDir,indent:this.showRoot?0:-1}));if(!this.showRoot){rn.rowNode.style.display="none";this.domNode.setAttribute("role","presentation");rn.labelNode.setAttribute("role","presentation");rn.containerNode.setAttribute("role","tree");}this.domNode.appendChild(rn.domNode);var _762=this.model.getIdentity(item);if(this._itemNodesMap[_762]){this._itemNodesMap[_762].push(rn);}else{this._itemNodesMap[_762]=[rn];}rn._updateLayout();this._expandNode(rn).addCallback(lang.hitch(this,function(){this._loadDeferred.callback(true);this.onLoad();}));}),function(err){console.error(this,": error loading root: ",err);});},getNodesByItem:function(item){if(!item){return [];}var _763=lang.isString(item)?item:this.model.getIdentity(item);return [].concat(this._itemNodesMap[_763]);},_setSelectedItemAttr:function(item){this.set("selectedItems",[item]);},_setSelectedItemsAttr:function(_764){var tree=this;this._loadDeferred.addCallback(lang.hitch(this,function(){var _765=_728.map(_764,function(item){return (!item||lang.isString(item))?item:tree.model.getIdentity(item);});var _766=[];_728.forEach(_765,function(id){_766=_766.concat(tree._itemNodesMap[id]||[]);});this.set("selectedNodes",_766);}));},_setPathAttr:function(path){if(path.length){return this.set("paths",[path]);}else{return this.set("paths",[]);}},_setPathsAttr:function(_767){var tree=this;return new _72d(_728.map(_767,function(path){var d=new _72c();path=_728.map(path,function(item){return lang.isString(item)?item:tree.model.getIdentity(item);});if(path.length){tree._loadDeferred.addCallback(function(){_768(path,[tree.rootNode],d);});}else{d.errback("Empty path");}return d;})).addCallback(_769);function _768(path,_76a,def){var _76b=path.shift();var _76c=_728.filter(_76a,function(node){return node.getIdentity()==_76b;})[0];if(!!_76c){if(path.length){tree._expandNode(_76c).addCallback(function(){_768(path,_76c.getChildren(),def);});}else{def.callback(_76c);}}else{def.errback("Could not expand path at "+_76b);}};function _769(_76d){tree.set("selectedNodes",_728.map(_728.filter(_76d,function(x){return x[0];}),function(x){return x[1];}));};},_setSelectedNodeAttr:function(node){this.set("selectedNodes",[node]);},_setSelectedNodesAttr:function(_76e){this._loadDeferred.addCallback(lang.hitch(this,function(){this.dndController.setSelection(_76e);}));},mayHaveChildren:function(){},getItemChildren:function(){},getLabel:function(item){return this.model.getLabel(item);},getIconClass:function(item,_76f){return (!item||this.model.mayHaveChildren(item))?(_76f?"dijitFolderOpened":"dijitFolderClosed"):"dijitLeaf";},getLabelClass:function(){},getRowClass:function(){},getIconStyle:function(){},getLabelStyle:function(){},getRowStyle:function(){},getTooltip:function(){return "";},_onKeyPress:function(e){if(e.altKey){return;}var _770=_736.getEnclosingWidget(e.target);if(!_770){return;}var key=e.charOrCode;if(typeof key=="string"&&key!=" "){if(!e.altKey&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey){this._onLetterKeyNav({node:_770,key:key.toLowerCase()});_731.stop(e);}}else{if(this._curSearch){clearTimeout(this._curSearch.timer);delete this._curSearch;}var map=this._keyHandlerMap;if(!map){map={};map[keys.ENTER]="_onEnterKey";map[keys.SPACE]=map[" "]="_onEnterKey";map[this.isLeftToRight()?keys.LEFT_ARROW:keys.RIGHT_ARROW]="_onLeftArrow";map[this.isLeftToRight()?keys.RIGHT_ARROW:keys.LEFT_ARROW]="_onRightArrow";map[keys.UP_ARROW]="_onUpArrow";map[keys.DOWN_ARROW]="_onDownArrow";map[keys.HOME]="_onHomeKey";map[keys.END]="_onEndKey";this._keyHandlerMap=map;}if(this._keyHandlerMap[key]){this[this._keyHandlerMap[key]]({node:_770,item:_770.item,evt:e});_731.stop(e);}}},_onEnterKey:function(_771){this._publish("execute",{item:_771.item,node:_771.node});this.dndController.userSelect(_771.node,_729.isCopyKey(_771.evt),_771.evt.shiftKey);this.onClick(_771.item,_771.node,_771.evt);},_onDownArrow:function(_772){var node=this._getNextNode(_772.node);if(node&&node.isTreeNode){this.focusNode(node);}},_onUpArrow:function(_773){var node=_773.node;var _774=node.getPreviousSibling();if(_774){node=_774;while(node.isExpandable&&node.isExpanded&&node.hasChildren()){var _775=node.getChildren();node=_775[_775.length-1];}}else{var _776=node.getParent();if(!(!this.showRoot&&_776===this.rootNode)){node=_776;}}if(node&&node.isTreeNode){this.focusNode(node);}},_onRightArrow:function(_777){var node=_777.node;if(node.isExpandable&&!node.isExpanded){this._expandNode(node);}else{if(node.hasChildren()){node=node.getChildren()[0];if(node&&node.isTreeNode){this.focusNode(node);}}}},_onLeftArrow:function(_778){var node=_778.node;if(node.isExpandable&&node.isExpanded){this._collapseNode(node);}else{var _779=node.getParent();if(_779&&_779.isTreeNode&&!(!this.showRoot&&_779===this.rootNode)){this.focusNode(_779);}}},_onHomeKey:function(){var node=this._getRootOrFirstNode();if(node){this.focusNode(node);}},_onEndKey:function(){var node=this.rootNode;while(node.isExpanded){var c=node.getChildren();node=c[c.length-1];}if(node&&node.isTreeNode){this.focusNode(node);}},multiCharSearchDuration:250,_onLetterKeyNav:function(_77a){var cs=this._curSearch;if(cs){cs.pattern=cs.pattern+_77a.key;clearTimeout(cs.timer);}else{cs=this._curSearch={pattern:_77a.key,startNode:_77a.node};}var self=this;cs.timer=setTimeout(function(){delete self._curSearch;},this.multiCharSearchDuration);var node=cs.startNode;do{node=this._getNextNode(node);if(!node){node=this._getRootOrFirstNode();}}while(node!==cs.startNode&&(node.label.toLowerCase().substr(0,cs.pattern.length)!=cs.pattern));if(node&&node.isTreeNode){if(node!==cs.startNode){this.focusNode(node);}}},isExpandoNode:function(node,_77b){return dom.isDescendant(node,_77b.expandoNode);},_onClick:function(_77c,e){var _77d=e.target,_77e=this.isExpandoNode(_77d,_77c);if((this.openOnClick&&_77c.isExpandable)||_77e){if(_77c.isExpandable){this._onExpandoClick({node:_77c});}}else{this._publish("execute",{item:_77c.item,node:_77c,evt:e});this.onClick(_77c.item,_77c,e);this.focusNode(_77c);}_731.stop(e);},_onDblClick:function(_77f,e){var _780=e.target,_781=(_780==_77f.expandoNode||_780==_77f.expandoNodeText);if((this.openOnDblClick&&_77f.isExpandable)||_781){if(_77f.isExpandable){this._onExpandoClick({node:_77f});}}else{this._publish("execute",{item:_77f.item,node:_77f,evt:e});this.onDblClick(_77f.item,_77f,e);this.focusNode(_77f);}_731.stop(e);},_onExpandoClick:function(_782){var node=_782.node;this.focusNode(node);if(node.isExpanded){this._collapseNode(node);}else{this._expandNode(node);}},onClick:function(){},onDblClick:function(){},onOpen:function(){},onClose:function(){},_getNextNode:function(node){if(node.isExpandable&&node.isExpanded&&node.hasChildren()){return node.getChildren()[0];}else{while(node&&node.isTreeNode){var _783=node.getNextSibling();if(_783){return _783;}node=node.getParent();}return null;}},_getRootOrFirstNode:function(){return this.showRoot?this.rootNode:this.rootNode.getChildren()[0];},_collapseNode:function(node){if(node._expandNodeDeferred){delete node._expandNodeDeferred;}if(node.isExpandable){if(node.state=="LOADING"){return;}node.collapse();this.onClose(node.item,node);this._state(node,false);}},_expandNode:function(node,_784){if(node._expandNodeDeferred&&!_784){return node._expandNodeDeferred;}var _785=this.model,item=node.item,_786=this;switch(node.state){case "UNCHECKED":node.markProcessing();var def=(node._expandNodeDeferred=new _72c());_785.getChildren(item,function(_787){node.unmarkProcessing();var scid=node.setChildItems(_787);var ed=_786._expandNode(node,true);scid.addCallback(function(){ed.addCallback(function(){def.callback();});});},function(err){console.error(_786,": error loading root children: ",err);});break;default:def=(node._expandNodeDeferred=node.expand());this.onOpen(node.item,node);this._state(node,true);}return def;},focusNode:function(node){_735.focus(node.labelNode);},_onNodeFocus:function(node){if(node&&node!=this.lastFocused){if(this.lastFocused&&!this.lastFocused._destroyed){this.lastFocused.setFocusable(false);}node.setFocusable(true);this.lastFocused=node;}},_onNodeMouseEnter:function(){},_onNodeMouseLeave:function(){},_onItemChange:function(item){var _788=this.model,_789=_788.getIdentity(item),_78a=this._itemNodesMap[_789];if(_78a){var _78b=this.getLabel(item),_78c=this.getTooltip(item);_728.forEach(_78a,function(node){node.set({item:item,label:_78b,tooltip:_78c});node._updateItemClasses(item);});}},_onItemChildrenChange:function(_78d,_78e){var _78f=this.model,_790=_78f.getIdentity(_78d),_791=this._itemNodesMap[_790];if(_791){_728.forEach(_791,function(_792){_792.setChildItems(_78e);});}},_onItemDelete:function(item){var _793=this.model,_794=_793.getIdentity(item),_795=this._itemNodesMap[_794];if(_795){_728.forEach(_795,function(node){this.dndController.removeTreeNode(node);var _796=node.getParent();if(_796){_796.removeChild(node);}node.destroyRecursive();},this);delete this._itemNodesMap[_794];}},_initState:function(){this._openedNodes={};if(this.persist&&this.cookieName){var oreo=_72a(this.cookieName);if(oreo){_728.forEach(oreo.split(","),function(item){this._openedNodes[item]=true;},this);}}},_state:function(node,_797){if(!this.persist){return false;}var path=_728.map(node.getTreePath(),function(item){return this.model.getIdentity(item);},this).join("/");if(arguments.length===1){return this._openedNodes[path];}else{if(_797){this._openedNodes[path]=true;}else{delete this._openedNodes[path];}var ary=[];for(var id in this._openedNodes){ary.push(id);}_72a(this.cookieName,ary.join(","),{expires:365});}},destroy:function(){if(this._curSearch){clearTimeout(this._curSearch.timer);delete this._curSearch;}if(this.rootNode){this.rootNode.destroyRecursive();}if(this.dndController&&!lang.isString(this.dndController)){this.dndController.destroy();}this.rootNode=null;this.inherited(arguments);},destroyRecursive:function(){this.destroy();},resize:function(_798){if(_798){_72f.setMarginBox(this.domNode,_798);}this._nodePixelIndent=_72f.position(this.tree.indentDetector).w;if(this.tree.rootNode){this.tree.rootNode.set("indent",this.showRoot?0:-1);}},_createTreeNode:function(args){return new _742(args);},_setTextDirAttr:function(_799){if(_799&&this.textDir!=_799){this._set("textDir",_799);this.rootNode.set("textDir",_799);}}});Tree._TreeNode=_742;return Tree;});},"epi/cms/component/command/ViewTrash":function(){define("epi/cms/component/command/ViewTrash",["dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/topic","epi/dependency","epi/shell/command/_Command","epi/i18n!epi/cms/nls/episerver.cms.command"],function(_79a,lang,_79b,_79c,_79d,_79e,_79f){return _79a([_79e],{label:_79f.viewtrash,category:"setting",_wasteBasketId:null,typeIdentifiers:null,postscript:function(){this.inherited(arguments);this.set("canExecute",false);this._wasteBasketId=_79d.resolve("epi.cms.Application").getWastebasketPage();var _7a0=_79d.resolve("epi.storeregistry").get("epi.cms.content.light");_79b.when(_7a0.get(this._wasteBasketId),lang.hitch(this,function(_7a1){this.set("canExecute",(_7a1.statusCode!="401"));}));},_execute:function(){_79c.publish("/epi/shell/context/request",{uri:"epi.cms.contentdata:///"+this._wasteBasketId},{sender:this,typeIdentifiers:this.typeIdentifiers});}});});},"epi/cms/legacy/EditPropertyWidget":function(){define("epi/cms/legacy/EditPropertyWidget",["epi","dojo","dijit","dojo/i18n","dojo/string","epi/cms/contentediting/RenderManager","epi/cms/legacy/LegacyDialogWrapper","epi/routes"],function(epi,dojo,_7a2,i18n,_7a3,_7a4,_7a5,_7a6){return dojo.declare("epi.cms.legacy.EditPropertyWidget",[_7a5],{editorFeatures:null,value:"",contentLink:null,contentTypeId:null,contentLanguage:null,propertyName:null,fullName:null,_reloadOnNextEdit:false,onChange:function(_7a7){},postMixInProperties:function(){this.features=dojo.mixin({width:400,height:30},this.editorFeatures);this.autoFit=true;this.connect(this,"onCallback","_onCallback");this.inherited(arguments);},startup:function(){this.inherited(arguments);var _7a8={moduleArea:"LegacyCMS",path:"edit/EditProperty.aspx",epslanguage:this.contentLanguage,propertyname:this.fullName};dojo.mixin(_7a8,this.contentLink?{id:this.contentLink}:{contentTypeId:this.contentTypeId});this.set("url",_7a6.getActionPath(_7a8));},_setUrlAttr:function(url){this._currentUrl=url;var _7a9=dojo.toJson(this.value);var _7aa=_7a3.substitute("<html><body><form method='post' action='${0}' ><input type='hidden' name='value' value='${1}' /></form></body></html>",[url,_7a9]);this.containerIframe.contentDocument.write(_7aa);this.containerIframe.contentDocument.forms[0].submit();},_onCallback:function(_7ab){var _7ac=_7ab.value;var _7ad=dojo.fromJson(_7ac);if(this._oldStringValue===undefined){this._oldStringValue=dojo.toJson(this.value);}if(_7ac!==this._oldStringValue){this._oldStringValue=dojo.toJson(_7ad);this.value=_7ad;this.onChange(_7ad);}else{this.onCancel();}},resize:function(){this.inherited(arguments);if(this._reloadOnNextEdit){this._reloadOnNextEdit=false;this._reloadUrl(true);}},_setValueAttr:function(_7ae){this._set("value",_7ae);if(this._started){this._reloadOnNextEdit=true;}}});});},"epi/cms/widget/ContentTypeGroup":function(){require({cache:{"url:epi/cms/widget/templates/ContentTypeGroup.html":"<div class=\"epi-listingContainer\" data-dojo-attach-point=\"focusNode\" tabIndex=\"${tabIndex}\">\r\n    <h2 data-dojo-attach-point=\"titleNode\" class=\"epi-ribbonHeader\"></h2>\r\n    <ul data-dojo-attach-point=\"containerNode\" class=\"epi-advancedListing\"></ul>\r\n</div>"}});define("epi/cms/widget/ContentTypeGroup",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/dom-style","dojo/text!./templates/ContentTypeGroup.html","dijit/_TemplatedMixin","dijit/layout/_LayoutWidget","epi/cms/widget/ContentType","dojo/keys","dijit/_KeyNavContainer"],function(_7af,lang,_7b0,_7b1,_7b2,_7b3,_7b4,_7b5,keys,_7b6){return _7af("epi.cms.widget.ContentTypeGroup",[_7b4,_7b3,_7b6],{title:"",contentTypes:null,templateString:_7b2,buildRendering:function(){this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this.render();this.connectKeyNavHandlers(this.isLeftToRight()?[keys.LEFT_ARROW,keys.UP_ARROW]:[keys.RIGHT_ARROW,keys.DOWN_ARROW],this.isLeftToRight()?[keys.RIGHT_ARROW,keys.DOWN_ARROW]:[keys.LEFT_ARROW,keys.UP_ARROW]);},render:function(){this.clear();_7b0.forEach(this.contentTypes,function(type){var _7b7=new _7b5({contentType:type});this.connect(_7b7,"onSelect",this.onSelect);this.addChild(_7b7);},this);},clear:function(){_7b0.forEach(this.getChildren(),function(_7b8){this.removeChild(_7b8);_7b8.destroyRecursive();},this);},_setTitleAttr:{node:"titleNode",type:"innerText"},_setContentTypesAttr:function(_7b9){this._set("contentTypes",_7b9);if(this._created){this.render();}},onSelect:function(){},setVisibility:function(_7ba){var _7bb=(_7ba?"block":"none");_7b1.set(this.domNode,"display",_7bb);}});});},"epi/cms/widget/TrashViewModelConfirmation":function(){define("epi/cms/widget/TrashViewModelConfirmation",["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/aspect","epi/dependency","epi/string","epi/shell/widget/dialog/Dialog","epi/shell/widget/dialog/Confirmation","epi/shell/widget/dialog/Alert","epi/cms/widget/ContentSelectorDialog","epi/cms/widget/FolderTreeStoreModel","epi/i18n!epi/cms/nls/episerver.cms.components.trash"],function(_7bc,_7bd,_7be,lang,_7bf,_7c0,_7c1,_7c2,_7c3,_7c4,_7c5,_7c6,_7c7){return function(_7c8){var _7c9=_7c0.resolve("epi.cms.Application");var _7ca=function(_7cb,_7cc,_7cd){var _7ce=new _7be();var _7cf=new _7c3({destroyOnHide:true,description:_7c1.toHTML(_7cc),title:_7c1.toHTML(_7cb),onAction:function(_7d0){_7d0?_7ce.resolve(_7cd):_7ce.cancel();}});_7cf.show();return _7ce;};var _7d1=function(_7d2,_7d3){var df=new _7be(),_7d4=_7c7.restore.dialog,_7d5=_7c9.getTypeUIDescriptors(),_7d6=_7d5?_7d5[_7d2.typeIdentifier]:null,_7d7=_7d6?_7d6.containerTypeIdentifier:null,_7d8=["epi.cms.block","epi.cms.folder"],_7d9=_7bc.indexOf(_7d8,_7d2.typeIdentifier)!==-1,_7da={canSelectOwnerContent:false,showButtons:false,root:_7d3,showRoot:!_7d9,typeIdentifiers:_7d7||_7d2.typeIdentifier,model:_7d9?new _7c6():null};if(_7d2.capabilities.isBlock){lang.mixin(_7da,{expandSubRoot:true});}var _7db=new _7c5(_7da);var _7dc=new _7c2({title:_7c1.toHTML(_7d4.title),description:_7c1.toHTML(_7d4.description),confirmActionText:_7c1.toHTML(_7c7.restore.label),content:_7db});_7db.on("change",function(_7dd){_7dc.onActionPropertyChanged({name:"ok"},"disabled",!_7dd);});_7dc.on("execute",function(){df.resolve(_7db.get("value"));});_7dc.on("onHide",function(){df.cancel();});_7dc.show();_7db.onChange(null);return df;};_7bf.around(_7c8,"restore",function(_7de){return function(_7df,_7e0){var _7e1;return _7be.when(_7c8.contentStore.query({id:_7df.contentLink}),lang.hitch(this,function(_7e2){var _7e3=null;var _7e4=null;if(!_7e2.isDeleted){_7e3=_7c1.toHTML(_7c7.restore.contentalreadyrestored);_7e4=function(){_7c8.updateFeeder(_7c8.get("currentFeeder"));};}if(_7e2.statusCode===401){_7e3=_7c1.toHTML(_7c7.restore.userdonothavepermission);}if(_7e3){var _7e5=new _7c4({description:_7e3,onAction:_7e4});_7e5.show();return false;}var _7e6=_7c8.get("currentFeeder");if(_7e2.parentLink!=_7e6.wasteBasketLink){return _7be.when(_7d1(_7e2,_7e6.restoreRoot),function(_7e7){return _7de.apply(_7c8,[_7e2,_7e7]);},function(){return false;});}else{return _7be.when(_7c8.getOldParent(_7e2.contentLink),function(_7e8){var _7e9=_7e8?_7e8.contentLink:null;if(_7e9){_7e1=_7ca(_7c7.restore.label,_7c7.restore.confirmquestion,_7e9);}else{_7e1=_7d1(_7e2,_7e6.restoreRoot);}_7be.when(_7e1,function(_7ea){return _7de.apply(_7c8,[_7e2,_7ea]);},function(){return false;});});}}),lang.hitch(this,function(_7eb){var _7ec=new _7c4({description:_7c1.toHTML(_7c7.restore.contentdeletedpermanently),onAction:function(){_7c8.updateFeeder(_7c8.get("currentFeeder"));}});_7ec.show();return false;}));};});return _7c8;};});},"epi/cms/widget/_HasChildDialogMixin":function(){define("epi/cms/widget/_HasChildDialogMixin",["dojo"],function(dojo){return dojo.declare("epi.cms.widget._HasChildDialogMixin",null,{isShowingChildDialog:false,_onBlur:function(){if(this.isShowingChildDialog){return;}this.inherited(arguments);},_onFocus:function(){if(this.isShowingChildDialog){return;}this.inherited(arguments);}});});},"url:dijit/templates/TreeNode.html":"<div class=\"dijitTreeNode\" role=\"presentation\"\n\t><div data-dojo-attach-point=\"rowNode\" class=\"dijitTreeRow\" role=\"presentation\" data-dojo-attach-event=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onclick:_onClick, ondblclick:_onDblClick\"\n\t\t><img src=\"${_blankGif}\" alt=\"\" data-dojo-attach-point=\"expandoNode\" class=\"dijitTreeExpando\" role=\"presentation\"\n\t\t/><span data-dojo-attach-point=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"\n\t\t></span\n\t\t><span data-dojo-attach-point=\"contentNode\"\n\t\t\tclass=\"dijitTreeContent\" role=\"presentation\">\n\t\t\t<img src=\"${_blankGif}\" alt=\"\" data-dojo-attach-point=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"\n\t\t\t/><span data-dojo-attach-point=\"labelNode\" class=\"dijitTreeLabel\" role=\"treeitem\" tabindex=\"-1\" aria-selected=\"false\" data-dojo-attach-event=\"onfocus:_onLabelFocus\"></span>\n\t\t</span\n\t></div>\n\t<div data-dojo-attach-point=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\n</div>\n","epi/cms/contentediting/command/_ChangeContentStatus":function(){define("epi/cms/contentediting/command/_ChangeContentStatus",["dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","epi/cms/contentediting/command/_ContentCommandBase","epi/cms/contentediting/ContentActionSupport","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons"],function(_7ed,lang,_7ee,_7ef,_7f0,_7f1){return _7ed("epi.cms.contentediting.command._ChangeContentStatus",[_7ef],{action:null,_execute:function(){var def=new _7ee(),_7f2=lang.hitch(this,function(_7f3){this._requestContextChange(_7f3.id,true);def.resolve(_7f3);}),_7f4=function(){def.cancel();};_7ee.when(this.model.changeContentStatus(this.action),_7f2,_7f4);return def;},_requestContextChange:function(id,_7f5){var _7f6={uri:"epi.cms.contentdata:///"+id};var _7f7={sender:this,trigger:"internal",forceContextChange:_7f5};dojo.publish("/epi/shell/context/request",[_7f6,_7f7]);}});});},"dijit/form/_AutoCompleterMixin":function(){define("dijit/form/_AutoCompleterMixin",["dojo/_base/connect","dojo/data/util/filter","dojo/_base/declare","dojo/_base/Deferred","dojo/dom-attr","dojo/_base/event","dojo/keys","dojo/_base/lang","dojo/query","dojo/regexp","dojo/_base/sniff","dojo/string","dojo/_base/window","./DataList","../registry","./_TextBoxMixin"],function(_7f8,_7f9,_7fa,_7fb,_7fc,_7fd,keys,lang,_7fe,_7ff,has,_800,win,_801,_802,_803){return _7fa("dijit.form._AutoCompleterMixin",null,{item:null,pageSize:Infinity,store:null,fetchProperties:{},query:{},autoComplete:true,highlightMatch:"first",searchDelay:100,searchAttr:"name",labelAttr:"",labelType:"text",queryExpr:"${0}*",ignoreCase:true,maxHeight:-1,_stopClickEvents:false,_getCaretPos:function(_804){var pos=0;if(typeof (_804.selectionStart)=="number"){pos=_804.selectionStart;}else{if(has("ie")){var tr=win.doc.selection.createRange().duplicate();var ntr=_804.createTextRange();tr.move("character",0);ntr.move("character",0);try{ntr.setEndPoint("EndToEnd",tr);pos=String(ntr.text).replace(/\r/g,"").length;}catch(e){}}}return pos;},_setCaretPos:function(_805,_806){_806=parseInt(_806);_803.selectInputText(_805,_806,_806);},_setDisabledAttr:function(_807){this.inherited(arguments);this.domNode.setAttribute("aria-disabled",_807);},_abortQuery:function(){if(this.searchTimer){clearTimeout(this.searchTimer);this.searchTimer=null;}if(this._fetchHandle){if(this._fetchHandle.cancel){this._cancelingQuery=true;this._fetchHandle.cancel();this._cancelingQuery=false;}this._fetchHandle=null;}},_onInput:function(evt){this.inherited(arguments);if(evt.charOrCode==229){this._onKey(evt);}},_onKey:function(evt){if(this.disabled||this.readOnly){return;}var key=evt.charOrCode;if(evt.altKey||((evt.ctrlKey||evt.metaKey)&&(key!="x"&&key!="v"))||key==keys.SHIFT){return;}var _808=false;var pw=this.dropDown;var _809=null;this._prev_key_backspace=false;this._abortQuery();this.inherited(arguments);if(this._opened){_809=pw.getHighlightedOption();}switch(key){case keys.PAGE_DOWN:case keys.DOWN_ARROW:case keys.PAGE_UP:case keys.UP_ARROW:if(this._opened){this._announceOption(_809);}_7fd.stop(evt);break;case keys.ENTER:if(_809){if(_809==pw.nextButton){this._nextSearch(1);_7fd.stop(evt);break;}else{if(_809==pw.previousButton){this._nextSearch(-1);_7fd.stop(evt);break;}}}else{this._setBlurValue();this._setCaretPos(this.focusNode,this.focusNode.value.length);}if(this._opened||this._fetchHandle){_7fd.stop(evt);}case keys.TAB:var _80a=this.get("displayedValue");if(pw&&(_80a==pw._messages["previousMessage"]||_80a==pw._messages["nextMessage"])){break;}if(_809){this._selectOption(_809);}case keys.ESCAPE:if(this._opened){this._lastQuery=null;this.closeDropDown();}break;case " ":if(_809){_7fd.stop(evt);this._selectOption(_809);this.closeDropDown();}else{_808=true;}break;case keys.DELETE:case keys.BACKSPACE:this._prev_key_backspace=true;_808=true;break;default:_808=typeof key=="string"||key==229;}if(_808){this.item=undefined;this.searchTimer=setTimeout(lang.hitch(this,"_startSearchFromInput"),1);}},_autoCompleteText:function(text){var fn=this.focusNode;_803.selectInputText(fn,fn.value.length);var _80b=this.ignoreCase?"toLowerCase":"substr";if(text[_80b](0).indexOf(this.focusNode.value[_80b](0))==0){var cpos=this.autoComplete?this._getCaretPos(fn):fn.value.length;if((cpos+1)>fn.value.length){fn.value=text;_803.selectInputText(fn,cpos);}}else{fn.value=text;_803.selectInputText(fn);}},_openResultList:function(_80c,_80d,_80e){this._fetchHandle=null;if(this.disabled||this.readOnly||(_80d[this.searchAttr]!==this._lastQuery)){return;}var _80f=this.dropDown.getHighlightedOption();this.dropDown.clearResultList();if(!_80c.length&&_80e.start==0){this.closeDropDown();return;}var _810=this.dropDown.createOptions(_80c,_80e,lang.hitch(this,"_getMenuLabelFromItem"));this._showResultList();if(_80e.direction){if(1==_80e.direction){this.dropDown.highlightFirstOption();}else{if(-1==_80e.direction){this.dropDown.highlightLastOption();}}if(_80f){this._announceOption(this.dropDown.getHighlightedOption());}}else{if(this.autoComplete&&!this._prev_key_backspace&&!/^[*]+$/.test(_80d[this.searchAttr].toString())){this._announceOption(_810[1]);}}},_showResultList:function(){this.closeDropDown(true);this.openDropDown();this.domNode.setAttribute("aria-expanded","true");},loadDropDown:function(){this._startSearchAll();},isLoaded:function(){return false;},closeDropDown:function(){this._abortQuery();if(this._opened){this.inherited(arguments);this.domNode.setAttribute("aria-expanded","false");this.focusNode.removeAttribute("aria-activedescendant");}},_setBlurValue:function(){var _811=this.get("displayedValue");var pw=this.dropDown;if(pw&&(_811==pw._messages["previousMessage"]||_811==pw._messages["nextMessage"])){this._setValueAttr(this._lastValueReported,true);}else{if(typeof this.item=="undefined"){this.item=null;this.set("displayedValue",_811);}else{if(this.value!=this._lastValueReported){this._handleOnChange(this.value,true);}this._refreshState();}}},_setItemAttr:function(item,_812,_813){var _814="";if(item){if(!_813){_813=this.store._oldAPI?this.store.getValue(item,this.searchAttr):item[this.searchAttr];}_814=this._getValueField()!=this.searchAttr?this.store.getIdentity(item):_813;}this.set("value",_814,_812,_813,item);},_announceOption:function(node){if(!node){return;}var _815;if(node==this.dropDown.nextButton||node==this.dropDown.previousButton){_815=node.innerHTML;this.item=undefined;this.value="";}else{_815=(this.store._oldAPI?this.store.getValue(node.item,this.searchAttr):node.item[this.searchAttr]).toString();this.set("item",node.item,false,_815);}this.focusNode.value=this.focusNode.value.substring(0,this._lastInput.length);this.focusNode.setAttribute("aria-activedescendant",_7fc.get(node,"id"));this._autoCompleteText(_815);},_selectOption:function(_816){this.closeDropDown();if(_816){this._announceOption(_816);}this._setCaretPos(this.focusNode,this.focusNode.value.length);this._handleOnChange(this.value,true);},_startSearchAll:function(){this._startSearch("");},_startSearchFromInput:function(){this._startSearch(this.focusNode.value.replace(/([\\\*\?])/g,"\\$1"));},_getQueryString:function(text){return _800.substitute(this.queryExpr,[text]);},_startSearch:function(key){if(!this.dropDown){var _817=this.id+"_popup",_818=lang.isString(this.dropDownClass)?lang.getObject(this.dropDownClass,false):this.dropDownClass;this.dropDown=new _818({onChange:lang.hitch(this,this._selectOption),id:_817,dir:this.dir,textDir:this.textDir});this.focusNode.removeAttribute("aria-activedescendant");this.textbox.setAttribute("aria-owns",_817);}this._lastInput=key;var _819=lang.clone(this.query);var _81a={start:0,count:this.pageSize,queryOptions:{ignoreCase:this.ignoreCase,deep:true}};lang.mixin(_81a,this.fetchProperties);var qs=this._getQueryString(key),q;if(this.store._oldAPI){q=qs;}else{q=_7f9.patternToRegExp(qs,this.ignoreCase);q.toString=function(){return qs;};}this._lastQuery=_819[this.searchAttr]=q;var _81b=this,_81c=function(){var _81d=_81b._fetchHandle=_81b.store.query(_819,_81a);_7fb.when(_81d,function(res){_81b._fetchHandle=null;res.total=_81d.total;_81b._openResultList(res,_819,_81a);},function(err){_81b._fetchHandle=null;if(!_81b._cancelingQuery){console.error(_81b.declaredClass+" "+err.toString());_81b.closeDropDown();}});};this.searchTimer=setTimeout(lang.hitch(this,function(_81e,_81f){this.searchTimer=null;_81c();this._nextSearch=this.dropDown.onPage=function(_820){_81a.start+=_81a.count*_820;_81a.direction=_820;_81c();_81f.focus();};},_819,this),this.searchDelay);},_getValueField:function(){return this.searchAttr;},constructor:function(){this.query={};this.fetchProperties={};},postMixInProperties:function(){if(!this.store){var _821=this.srcNodeRef;var list=this.list;if(list){this.store=_802.byId(list);}else{this.store=new _801({},_821);}if(!("value" in this.params)){var item=(this.item=this.store.fetchSelectedItem());if(item){var _822=this._getValueField();this.value=this.store._oldAPI?this.store.getValue(item,_822):item[_822];}}}this.inherited(arguments);},postCreate:function(){var _823=_7fe("label[for=\""+this.id+"\"]");if(_823.length){_823[0].id=(this.id+"_label");this.domNode.setAttribute("aria-labelledby",_823[0].id);}this.inherited(arguments);},_getMenuLabelFromItem:function(item){var _824=this.labelFunc(item,this.store),_825=this.labelType;if(this.highlightMatch!="none"&&this.labelType=="text"&&this._lastInput){_824=this.doHighlight(_824,this._escapeHtml(this._lastInput));_825="html";}return {html:_825=="html",label:_824};},doHighlight:function(_826,find){var _827=(this.ignoreCase?"i":"")+(this.highlightMatch=="all"?"g":""),i=this.queryExpr.indexOf("${0}");find=_7ff.escapeString(find);return this._escapeHtml(_826).replace(new RegExp((i==0?"^":"")+"("+find+")"+(i==(this.queryExpr.length-4)?"$":""),_827),"<span class=\"dijitComboBoxHighlightMatch\">$1</span>");},_escapeHtml:function(str){str=String(str).replace(/&/gm,"&amp;").replace(/</gm,"&lt;").replace(/>/gm,"&gt;").replace(/"/gm,"&quot;");return str;},reset:function(){this.item=null;this.inherited(arguments);},labelFunc:function(item,_828){return (_828._oldAPI?_828.getValue(item,this.labelAttr||this.searchAttr):item[this.labelAttr||this.searchAttr]).toString();},_setValueAttr:function(_829,_82a,_82b,item){this._set("item",item||null);if(!_829){_829="";}this.inherited(arguments);},_setTextDirAttr:function(_82c){this.inherited(arguments);if(this.dropDown){this.dropDown._set("textDir",_82c);}}});});},"epi/cms/legacy/LegacyDialogWrapper":function(){define("epi/cms/legacy/LegacyDialogWrapper",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/has","dojo/_base/sniff","dijit","dijit/a11y","dijit/focus","dijit/layout/_LayoutWidget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/_Contained","dijit/form/Button","epi/Url","epi/cms/legacy/_LegacyDialogObject","epi/cms/legacy/LegacyDialogPopup","epi/shell/widget/_ActionProviderWidget"],function(dojo,_82d,lang,has,_82e,_82f,a11y,_830,_831,_832,_833,_834,_835,Url,_836,_837,_838){return _82d("epi.cms.legacy.LegacyDialogWrapper",[_831,_832,_833,_838,_834],{_currentUrl:null,dialogArguments:null,callbackArguments:null,features:null,autoFit:false,showLoadingOverlay:false,_isIframeInitialLoad:true,_iframeFocusRegistration:null,templateString:"        <div style=\"position: relative;\" tabindex=\"0\">            <iframe data-dojo-attach-point=\"containerIframe\" tabindex=\"-1\" frameborder=0 width=\"${features.width}\" height=\"${features.height}\" style=\"border: none; position: absolute, top:0, left: 0;\" src=\"about:blank\" ></iframe>            <div data-dojo-attach-point=\"loadingOverlay\" style=\"position: absolute; top: 0; left: 0; width: ${features.width}px; height: ${features.height}px;\" class=\"epiLoadingOverlay\"></div>        </div>",constructor:function(_839,_83a){this.editorparams=_839||{};this.metadata=_83a||{};this._isIframeInitialLoad=true;},postMixInProperties:function(){this.inherited(arguments);this.features=dojo.mixin({width:320,height:240},this.features);this.buttonsMap=this.buttonsMap||[];},postCreate:function(){this.inherited(arguments);if(!this.showLoadingOverlay){dojo.style(this.loadingOverlay,{display:"none"});}this._legacyDialog=this._createLegacyDialogObject(dojo.hitch(this,function(){this.onCallback.apply(this,arguments);}),this.callbackArguments,this.dialogArguments,window);},startup:function(){this.inherited(arguments);if(this.containerIframe.attachEvent){this.containerIframe.attachEvent("onload",dojo.hitch(this,this._onIframeLoad));}else{this.connect(this.containerIframe,"onload",dojo.hitch(this,this._onIframeLoad));}this.connect(window,"onresize",dojo.hitch(this,function(){if(!this.autoFit){return;}this._calculateAndSetActualSize();}));},resize:function(){this.inherited(arguments);if(this._started){this._calculateAndSetActualSize();}},_setUrlAttr:function(_83b){var url=_83b||"about:blank";this._currentUrl=url;dojo.attr(this.containerIframe,"src",url);},onCallback:function(_83c){},onLoad:function(){},onCancel:function(){},onFocus:function(){this.inherited(arguments);this._focusIframeContent();},getLegacyDialog:function(){return this._legacyDialog;},_focusIframeContent:function(){var _83d=this.containerIframe.contentWindow;var doc=_83d&&_83d.document;var _83e=(doc&&a11y.getFirstInTabbingOrder(doc))||this.containerIframe;if(has("ie")!==9){_82f.focus(_83e);}},_onIframeLoad:function(){dojo.subscribe("/IsInLegacyWrapper/NeedToBeCloseOnLoad",dojo.hitch(this,function(_83f){this.onCancel();}));var _840=this.containerIframe.contentWindow;this._iframeFocusRegistration=_830.registerIframe(this.containerIframe);this._focusIframeContent();this._overrideLegacyDialogUtilities();if(_840.EPi&&_840.EPi.AddWindowLoadListener){_840.EPi.AddWindowLoadListener(dojo.hitch(this,this._mapDialogButtons));}else{this._mapDialogButtons();}this._setTitle();this._hideLoadingOverlay();this._calculateAndSetActualSize();if(this._isIframeInitialLoad){this.onResize();}if(this.onLoad){this.onLoad.apply(this,arguments);}this._isIframeInitialLoad=false;},_hideLoadingOverlay:function(){var _841=this.containerIframe.contentWindow;dojo.style(this.loadingOverlay,{display:"none"});if(_841.EPi&&_841.EPi.AddWindowLoadListener){_841.EPi.AddEventListener(_841,"beforeunload",dojo.hitch(this,function(){if(this.showLoadingOverlay===true){dojo.style(this.loadingOverlay,{display:"block"});}}));}},_setTitle:function(){var _842=this.containerIframe.contentWindow;var _843=dojo.query("title",_842.document);if(_843&&_843.length>0){this.title=dojo.string.trim(_843[0].innerHTML);}},_calculateAndSetActualSize:function(){var _844=this.containerIframe.contentWindow;var pos=dojo.position(this.containerIframe);var _845=null;try{_845=_844.document.body.parentNode;}catch(e){_845=null;}if(!_845){return;}var _846={w:Math.max(pos.w,_845.scrollWidth),h:Math.max(pos.h,_845.scrollHeight)};var _847={w:window.top.innerWidth||window.top.document.documentElement.clientWidth,h:window.top.innerHeight||window.top.document.documentElement.clientHeight};var _848=Math.abs(_845.scrollWidth-_845.clientWidth);_848=_848!==0?30:0;var _849={w:Math.min(_846.w+_848,_847.w-25),h:Math.min(_846.h,_847.h-125)};this._adjustSize(_849);},_adjustSize:function(size){if(this.autoFit){dojo.style(this.containerIframe,"width",size.w+"px");dojo.style(this.containerIframe,"height",size.h+"px");}var _84a=this.containerIframe.contentWindow;var _84b=_84a.document.body;dojo.style(_84b,"height","auto");},_mapDialogButtons:function(){var _84c=this.containerIframe.contentWindow;var _84d=dojo.query("[data-epi-dialog-button]",_84c.document);this.removeActions(this.getActions());dojo.forEach(_84d,dojo.hitch(this,function(_84e){var _84f=dojo.attr(_84e,"data-epi-dialog-button");var _850;switch(_84f){case "functioner":return;case "container":var _851=dojo.query("[data-epi-dialog-button=\"functioner\"]",_84e);_850=_851.length>0?_851[0]:null;break;default:_850=_84e;break;}var _852=_850.tagName=="INPUT"?_850.value:_850.innerHTML;var _853=_850.tagName=="INPUT"?dojo.attr(_850,"title"):_850.innerHTML;var _854={name:_850.id,label:_852,disabled:_850.disabled,title:_853,action:function(){_850.click();}};this.addActions(_854);dojo.style(_84e,"display","none");}));if(this._buttonChangedHandle){dojo.disconnect(this._buttonChangedHandle);}this._buttonChangedHandle=this.connect(this._legacyDialog,"ButtonChanged",function(_855){this.setActionProperty(_855.id,"disabled",_855.disabled);this.setActionProperty(_855.id,"visible",_855.style.display!="none");this.setActionProperty(_855.id,"label",_855.value||_855.innerHTML);});},_overrideLegacyDialogUtilities:function(){var _856=this.containerIframe.contentWindow;if(!_856.EPi){_856.EPi={};}_856.EPi.CreateDialog=lang.hitch(this,this._createLegacyDialogFnc);_856.EPi.GetDialog=lang.hitch(this,function(win){if(win){return win.EPi.GetDialog();}return this._legacyDialog;});},_createLegacyDialogFnc:function(url,_857,_858,_859,_85a,_85b){var _85c=new _837({url:url,dialogArguments:_859,callbackArguments:_858,features:_85a,autoFit:this.autoFit});_85c.on("Callback",lang.hitch(this,function(){if(_857){_857.apply(this,arguments);}}));_85c.show();return _85c.legacyDialogObject;},_createLegacyDialogObject:function(_85d,_85e,_85f,_860){var obj=new _836({callbackMethod:_85d,callbackArguments:_85e,dialogArguments:_85f,_opener:_860?_860.top:window.top});try{obj._dialog=this.containerIframe.contentWindow;}catch(e){obj._dialog=null;}return obj;},_reloadUrl:function(_861){this._isIframeInitialLoad=_861;if(this._isIframeInitialLoad){this._resetIframeContainerSize();}var url=new Url(this._currentUrl);dojo.mixin(url.query,{"epi.preventCache":new Date().valueOf()});this.set("url",url.toString());},_resetIframeContainerSize:function(){dojo.style(this.containerIframe,"width",this.features.width+"px");dojo.style(this.containerIframe,"height",this.features.height+"px");},cleanup:function(){if(this._legacyDialog&&!this._legacyDialog.IsCleaned()){this._legacyDialog.Cleanup();}},destroy:function(){this.cleanup();if(this._iframeFocusRegistration){this._iframeFocusRegistration.remove();this._iframeFocusRegistration=null;}this.inherited(arguments);}});});},"epi/cms/contentediting/command/CreateDraft":function(){define(["dojo/_base/declare","epi/cms/contentediting/command/_ContentCommandBase","epi/cms/contentediting/ContentActionSupport","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons"],function(_862,_863,_864,_865){return _862("epi.cms.contentediting.command.CreateDraft",[_863],{name:"createdraft",label:_865.createdraft.label,tooltip:_865.createdraft.title,iconClass:"epi-iconPage",contentActionSupport:null,postscript:function(){this.inherited(arguments);this.contentActionSupport=this.contentActionSupport||_864;},_execute:function(){this.model.createDraft();},_onModelChange:function(){this.inherited(arguments);var _866=this.model.contentData,_867=_866.status,_868=_864.versionStatus,_869=this.contentActionSupport.isActionAvailable(_866,_864.action.Create,_864.providerCapabilities.Edit),_86a=_869&&(((_867==_868.Published||_867==_868.PreviouslyPublished)&&!_866.isCommonDraft)||_867==_868.DelayedPublish);this.set("canExecute",_86a);this.set("isAvailable",_86a);}});});},"epi/cms/widget/XFormEditor":function(){define(["dojo/_base/declare","dojo/_base/event","dojo/_base/lang","dojo/_base/Deferred","dojo/dom-class","dojo/dom-style","dojo/dom-construct","dojo/query","dojo/html","dijit/focus","dijit/form/Button","epi/shell/widget/dialog/Dialog","epi/dependency","epi/cms/legacy/LegacyFormEditor","epi/cms/_ContentContextMixin","epi/cms/legacy/LegacyDialogPopup","epi/routes","epi/cms/widget/XFormPropertyWidget","epi/i18n!epi/cms/nls/episerver.cms.legacy.legacyformeditor","epi/i18n!epi/cms/nls/episerver.cms.widget.xformeditor"],function(_86b,_86c,lang,_86d,_86e,_86f,_870,_871,html,_872,_873,_874,_875,_876,_877,_878,_879,_87a,res,_87b){return _86b("epi.cms.widget.XFormEditor",[_876,_877],{localization:lang.mixin(res,_87b),destroyOnHide:true,editorWidgetClass:_87a,store:null,templateString:"            <div class=\"dijit dijitReset dijitInline dijitLeft epi-xFormEditor\" id=\"widget_${id}\" >                <div data-dojo-attach-point=\"output\" data-dojo-type=\"dijit.form.TextBox\" value=\"${localization.helptext}\"></div>                <div data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"openButton\" data-dojo-attach-event=\"onClick: openEditor\" data-dojo-props=\"label:'${localization.buttonlabel}'\"></div>                <a href=\"#\" data-dojo-attach-point=\"viewDataLnk\" data-dojo-attach-event=\"click: _openViewDataDialog\" title=\"${localization.viewdata.tooltip}\" class=\"disabled\">${localization.viewdata.text}</a>            </div>",postMixInProperties:function(){this.inherited(arguments);var _87c=_875.resolve("epi.storeregistry");this.store=this.store||_87c.get("epi.cms.xform");},openEditor:function(){this.inherited(arguments);this.onFocus();},_createDialog:function(){lang.mixin(this.params,{"contentLink":this.contentLink?this.contentLink:this.currentContext.id});this.inherited(arguments);},_openViewDataDialog:function(evt){_86c.stop(evt);if(_86e.contains(this.viewDataLnk,"disabled")){return;}this._showFormDataDialog("Edit/XFormViewData.aspx",this.contentLink,this.value);},_onCancel:function(){this.inherited(arguments);this.setDisplayValue(this.value);},_onDialogCancel:function(){this.inherited(arguments);this.setDisplayValue(this.value);},_showFormDataDialog:function(path,_87d,_87e){var _87f=_879.getActionPath({id:_87d,path:path,moduleArea:"LegacyCMS",IsInLegacyWrapper:true,formid:_87e}),_880=new _878({url:_87f,dialogArguments:window.document,showCancelButton:true,features:{width:750,height:300},autoFit:true,showLoadingOverlay:false});this.connect(_880,"onLoad",function(_881){if(!_881){return;}var h1=_871("h1[class=\"EP-prefix\"]",_881.containerIframe.contentDocument.body);_870.create("span",{innerHTML:this.localization.viewdata.forms+" >"},h1.parent()[0],"first");var _882=_871("select[id$=\"SelectForm\"]",_881.containerIframe.contentDocument.body);if(_882){_86f.set(_882.parent()[0],"display","none");}var _883=_871("input[type=\"checkbox\"][id$=\"ShowResultFromAllPages\"]",_881.containerIframe.contentDocument.body);if(_883){_86f.set(_883.parent()[0],"display","none");}});_880.show();},setDisplayValue:function(_884){if(!_884){this.output.set("value",this.localization.helptext);_86e.add(this.viewDataLnk,"disabled");return;}_86d.when(this.store.query({id:_884}),lang.hitch(this,function(_885){if(_885&&_885.name){this.output.set("value",_885.name);this.contentLink&&_86e.remove(this.viewDataLnk,"disabled");}else{this.set("value",null);}this.onBlur();}));}});});},"epi/cms/layers/cms-widgets":function(){define("epi/cms/layers/cms-widgets",["epi/cms/_ContentContextMixin","epi/cms/Application","epi/cms/CMSModule","epi/cms/component/CreateContent","epi/cms/component/FileManagement","epi/cms/component/GlobalToolbar","epi/cms/component/PageTreeComponent","epi/cms/component/SiteTree","epi/cms/component/PageTree","epi/cms/component/RecentlyChanged","epi/cms/component/SharedBlocks","epi/cms/component/Tasks","epi/cms/component/Trash","epi/cms/component/Versions","epi/cms/contentediting/_Renderer","epi/cms/contentediting/ContentDetails","epi/cms/contentediting/ContainerLayoutTab","epi/cms/contentediting/DialogEditorWrapper","epi/cms/contentediting/PublishActionMenu","epi/cms/contentediting/EditActionPanel","epi/cms/contentediting/EditingBase","epi/cms/contentediting/EditToolbar","epi/cms/contentediting/OnPageEditing","epi/cms/contentediting/FormEditing","epi/cms/contentediting/PageDataController","epi/cms/contentediting/PropertyRenderer","epi/cms/contentediting/NotificationBar","epi/cms/contentediting/FloatingEditorWrapper","epi/cms/contentediting/FlyoutEditorWrapper","epi/cms/contentediting/InlineEditorWrapper","epi/cms/contentediting/SettingsPanel","epi/cms/contentediting/ValidationTextboxWithWarning","epi/cms/contentediting/editors/ContentAreaEditor","epi/cms/contentediting/editors/PreviewableTextEditor","epi/cms/contentediting/editors/PreviewableDateTimeEditor","epi/cms/contentediting/editors/SelectionEditor","epi/cms/contentediting/editors/ShortcutEditor","epi/cms/conversion/PropertyDateConverter","epi/cms/conversion/PropertyContentAreaConverter","epi/cms/core/ContentReference","epi/cms/legacy/LegacyDialogPopup","epi/cms/legacy/LegacyFormEditor","epi/cms/widget/ContentSelector","epi/cms/widget/CategorySelector","epi/cms/widget/_GridWidgetBase","epi/cms/widget/NotificationStatusBar","epi/cms/widget/NotificationStatusZone","epi/cms/widget/overlay/Block","epi/cms/widget/overlay/BlockArea","epi/cms/widget/overlay/overlayFactory","epi/cms/widget/ReadOnlyDateTimeEditor","epi/cms/widget/TooltipDialog","epi/cms/widget/TinyMCEEditor","epi/cms/widget/XFormEditor"],1);},"epi/cms/component/RecentlyChanged":function(){define("epi/cms/component/RecentlyChanged",["dojo","dojo/_base/lang","epi","epi/cms/contentediting/ContentActionSupport","epi/cms/core/ContentReference","epi/cms/widget/_GridWidgetBase","epi/dependency","epi/i18n!epi/cms/nls/episerver.cms.components.recentlychanged","epi/shell/command/_WidgetCommandProviderMixin","epi/shell/command/OptionCommand","epi/shell/command/ToggleCommand","epi/shell/widget/layout/ComponentContainer","epi/shell/widget/dialog/Alert","epi/shell/widget/_FocusableMixin"],function(dojo,lang,epi,_886,_887,_888,_889,_88a,_88b,_88c,_88d,_88e,_88f,_890){return dojo.declare("epi.cms.component.RecentlyChanged",[_888,_88b,_890],{_componentsController:null,onlyShowMyChanges:false,showItem:10,postMixInProperties:function(){this.storeKeyName="epi.cms.content.search";this._componentsController=_889.resolve("epi.shell.controller.Components");this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);var _891=lang.mixin({columns:{name:{label:epi.resources.header.name,className:"epi-width50",renderCell:lang.hitch(this,this._renderContentItem)},status:{label:epi.resources.header.status,renderCell:function(item,_892,node,_893){node.innerHTML=_886.getVersionStatus(_892);},className:"epi-width15"},changed:{label:epi.resources.header.saved,formatter:this._localizeDate,className:"epi-width15"},changedBy:{label:epi.resources.header.by,formatter:this._createUserFriendlyUsername,className:"epi-width10"}},store:this.store,selectionMode:"single"},this.defaultGridMixin);this.grid=new this._gridClass(_891,this.domNode);},startup:function(){if(this._started){return;}this.inherited(arguments);var _894=new _88d({label:_88a.showmychanges,category:"setting",model:this,property:"onlyShowMyChanges"});this.add("commands",_894);this.fetchData();},_setOnlyShowMyChangesAttr:function(_895){this._set("onlyShowMyChanges",_895);if(this._started){this._saveSettingComponent("onlyShowMyChanges",_895);}},fetchData:function(){this.grid.set("queryOptions",{ignore:["query"],sort:[{attribute:"name",descending:true}]});var _896={query:"recentlychanged",onlyShowMyChanges:this.onlyShowMyChanges};this.grid.set("query",_896);},_saveSettingComponent:function(type,_897){var item=this._componentsController.getComponentDefinition(this.id);var _898=this.getParent();while(_898){if(_898.isInstanceOf(_88e)){break;}_898=_898.getParent();}if(item){item.settings.onlyShowMyChanges=_897;this._componentsController.saveComponent(_898,item,function(){},function(){var _899=new _88f({description:_88a.errormessage});_899.show();});this.fetchData();}},onContextChanged:function(){this.grid.clearSelection();var _89a=new _887(this.currentContext.id).createVersionUnspecificReference().toString();var row=this.grid.row(_89a);if(row){this.grid.select(row);}}});});},"epi/cms/widget/ContentTreeStoreModel":function(){define("epi/cms/widget/ContentTreeStoreModel",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/Deferred","dojo/_base/connect","dojo/aspect","epi/cms/contentediting/ContentActionSupport","epi/dependency","epi/shell/_StatefulGetterSetterMixin","epi/shell/_HierarchicalModelMixin"],function(_89b,_89c,lang,_89d,_89e,_89f,_8a0,_8a1,_8a2,_8a3){return _89b("epi.cms.widget.ContentTreeStoreModel",[_8a2,_8a3],{store:null,application:null,root:null,stopAtSubRoot:true,notAllowToDelete:null,notAllowToCopy:null,typeIdentifiers:null,showAllLanguages:false,_observers:null,_defaultDataStoreName:"epi.cms.content.light",additionalQueryOptions:{},postscript:function(args){this.inherited(arguments);lang.mixin(this,args);this._observers={};this.store=this.store||_8a1.resolve("epi.storeregistry").get(this._defaultDataStoreName);this.application=this.application||_8a1.resolve("epi.cms.Application");this._queryOptions=lang.mixin({ignore:["query","allLanguages"],comparers:{"typeIdentifiers":lang.hitch(this,function(_8a4,_8a5){return _89c.some(_8a4,lang.hitch(this,function(item){return item===_8a5.typeIdentifier||this.application.isBaseTypeIdentifier(_8a5.typeIdentifier,item);}));}),"referenceId":function(_8a6,_8a7){return _8a6===_8a7.parentLink;}}},this.additionalQueryOptions);var _8a8=_89e.subscribe("/epi/cms/contentdata/updated",this,function(_8a9){this.store.refresh(_8a9.contentLink).then(lang.hitch(this,function(){if(_8a9.recursive){this.onItemChildrenReload(_8a9);}}));});var _8aa=_89e.subscribe("/epi/cms/contentdata/childrenchanged",lang.hitch(this,this._childrenChanged));var _8ab=_89e.subscribe("/epi/cms/contentdata/restored",this,function(_8ac){this._childrenChanged(_8ac);});var _8ad=_89f.after(this.store,"onItemChanged",lang.hitch(this,function(id,item){this.onChange(item);}),true);this._handles=[_8a8,_8aa,_8ab,_8ad];},destroy:function(){for(var id in this._observers){this._observers[id].cancel();delete this._observers[id];}if(this._handles){_89c.forEach(this._handles,function(_8ae){_8ae.remove();});}},_setShowAllLanguagesAttr:function(_8af){this._set("showAllLanguages",_8af);this.onItemChildrenReload(this.root);},getRoot:function(_8b0,_8b1){if(lang.isArray(this.root)){_8b0({});}else{_89d.when(this.store.get(this.root),_8b0,_8b1);}},mayHaveChildren:function(item){return item.hasChildren;},getChildren:function(_8b2,_8b3){var id=this.getIdentity(_8b2),_8b4=this._createQuery({referenceId:id,query:"getchildren"}),_8b5=this.store.query(_8b4,this._queryOptions);var _8b6=lang.hitch(this,function(item,_8b7,_8b8){if(_8b7===_8b8){this.onChange(item);}_89d.when(this.store.query(_8b4,this._queryOptions),lang.hitch(this,function(_8b9){this.onChildrenChange(_8b2,_8b9);}));});var _8ba=this._observers[id];if(_8ba){_8ba.cancel();delete this._observers[id];}this._observers[id]=_8b5.observe(_8b6,true);_89d.when(_8b5,_8b3);},_createQuery:function(_8bb,_8bc){var _8bd=this.typeIdentifiers&&(lang.isArray(this.typeIdentifiers)?this.typeIdentifiers:this.typeIdentifiers.split(","));var _8be=this.showAllLanguages?{allLanguages:true}:{},_8bf=_8bc?{}:{typeIdentifiers:_8bd};var _8c0=lang.mixin(_8bb,_8bf,_8be);return _8c0;},move:function(_8c1,_8c2){if(!_8c2.contentLink){_8c2=this.store.get(_8c2);}return _89d.when(_8c2,lang.hitch(this,function(_8c3){return _89d.when(this.store.get(_8c1.parentLink),lang.hitch(this,function(_8c4){return this.pasteItem(_8c1,_8c4,_8c3,false);}));}));},copy:function(_8c5,_8c6){return _89d.when(this.store.get(_8c5.parentLink),lang.hitch(this,function(_8c7){return this.pasteItem(_8c5,_8c7,_8c6,true);}));},pasteItem:function(_8c8,_8c9,_8ca,copy,_8cb){var id=this.getIdentity(_8c8);var _8cc=copy?this.store.copy:this.store.move,_8cd={targetId:this.getIdentity(_8ca),sortIndex:_8cb};return _8cc.call(this.store,id,_8cd).then(lang.hitch(this,function(_8ce){if(_8ce.isSuccess||_8ce.isPartialSuccess){var _8cf=true;if(!copy&&(this.getIdentity(_8c9)!==this.getIdentity(_8ca))){_8cf=this._childrenChanged(_8c9);}var _8d0=_89d.when(_8cf,lang.hitch(this,function(){if(_8ca&&_8ca.isWastebasket){this.onDelete(_8c8,true);}this._updateItemChanged(_8ca.contentLink);this.store.refresh(_8c8.contentLink);}));}return _8ce;}));},_updateItemChanged:function(_8d1){_89d.when(this.store.refresh(_8d1),lang.hitch(this,function(_8d2){this._childrenChanged(_8d2);}));},_childrenChanged:function(_8d3){var dfd=new _89d();this.getChildren(_8d3,lang.hitch(this,function(_8d4){this.onChildrenChange(_8d3,_8d4);dfd.resolve(_8d4);}));return dfd;},isAncestor:function(_8d5,_8d6){if(_8d5.contentLink==_8d6.contentLink){return true;}if(!_8d6.parentLink){return false;}return _89d.when(this.store.get(_8d6.parentLink),lang.hitch(this,function(_8d7){return this.isAncestor(_8d5,_8d7);}));},getIdentity:function(item){if(lang.isObject(item)){return this.store.getIdentity(item);}return item;},getLabel:function(item){return item.name;},canCopy:function(item){var _8d8=item.contentLink,_8d9=_8d8===this.root||(_89c.indexOf(this.notAllowToCopy,_8d8)>=0);return !_8d9&&_8a0.hasAccess(item.accessMask,_8a0.accessLevel.Read)&&_8a0.hasProviderCapability(item.providerCapabilityMask,_8a0.providerCapabilities.Copy);},canCut:function(item){var _8da=item.contentLink,_8db=_8da===this.root||(_89c.indexOf(this.notAllowToDelete,_8da)>=0);return !_8db&&_8a0.isActionAvailable(item,_8a0.action.Delete,_8a0.providerCapabilities.Move,true);},canDelete:function(item){var _8dc=item.contentLink,_8dd=_8dc===this.root||(_89c.indexOf(this.notAllowToDelete,_8dc)>=0);return !_8dd&&_8a0.isActionAvailable(item,_8a0.action.Delete,_8a0.providerCapabilities.Delete,true);},canPaste:function(item,_8de,_8df){var _8e0=_8df&&_8de.isWastebasket;return !_8de.isDeleted&&!_8e0&&_8a0.isActionAvailable(_8de,_8a0.action.Create,_8a0.providerCapabilities.Create);},canPasteItem:function(_8e1,_8e2,_8e3,copy,_8e4){var _8e5=copy||this.canDelete(_8e1);return _8e5&&this.canPaste(_8e1,_8e3,copy);},onItemChildrenReload:function(_8e6){},onChange:function(){},onChildrenChange:function(){},onDelete:function(){}});});},"epi/cms/contentediting/command/BlockMoveDown":function(){define("epi/cms/contentediting/command/BlockMoveDown",["dojo/_base/declare","epi","epi/shell/command/_Command"],function(_8e7,epi,_8e8){return _8e7("epi.cms.contentediting.command.BlockMoveDown",[_8e8],{name:"movedown",label:epi.resources.action.movedown,tooltip:epi.resources.action.movedown,iconClass:"epi-iconDown",category:"menuWithSeparator",postscript:function(){this.inherited(arguments);},_execute:function(){this.model.moveDown();return this.inherited(arguments);},_onModelChange:function(){this.set("canExecute",this.model&&!this.model.get("isBottom"));}});});},"epi/cms/contentediting/command/ManageExpiration":function(){define("epi/cms/contentediting/command/ManageExpiration",["dojo/_base/connect","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","epi","epi/cms/contentediting/ExpirationDialog","epi/cms/contentediting/viewmodel/ExpirationDialogViewModel","epi/dependency","epi/i18n!epi/cms/nls/episerver.cms.widget.expirationeditor","epi/i18n!epi/cms/nls/shell.common.buttons","epi/shell/command/_Command","epi/shell/widget/dialog/Dialog"],function(_8e9,_8ea,_8eb,lang,epi,_8ec,_8ed,_8ee,_8ef,_8f0,_8f1,_8f2){return _8ea([_8f1],{label:_8ef.dialogtitle,tooltip:_8ef.dialogtitle,viewModel:null,cssClass:"epi-chromelessButton epi-visibleLink",constructor:function(){this._metadataManager=_8ee.resolve("epi.shell.MetadataManager");},_execute:function(){if(!this._metadata){return;}var _8f3=this.get("viewModel");var _8f4=new _8ec({metadata:this._metadata,value:_8f3.get("value"),model:_8f3});var _8f5=new _8f2({destroyOnHide:true,defaultActionsVisible:false,confirmActionText:_8f0.save,content:_8f4,title:_8ef.dialogtitle});_8f5.connect(_8f5,"onExecute",lang.hitch(this,function(){this._onSave(_8f5);}));_8f5.connect(_8f5,"onCancel",lang.hitch(this,function(){this._onCancel(_8f5);}));_8f5.show();},_onModelChange:function(){var _8f6=this.model.contentData.properties,_8f7=_8f6.iversionable_expire;this.set("viewModel",new _8ed({contentLink:this.model.contentLink,contentName:this.model.contentData.name,value:_8f7,minimumExpireDate:_8f6.iversionable_startpublish}));var _8f8=this.get("model");_8eb.when(_8f8.getPropertyMetaData("iversionable_expire"),lang.hitch(this,function(_8f9){this._metadata=_8f9;}));this.set("canExecute",this.model&&this.model.canChangeContent());},_onSave:function(_8fa){var _8fb=_8fa.content.model,_8fc=_8fb.get("intermediateValue");_8fb.set("value",_8fc);var _8fd=this.get("model");if(!_8fd.contentData.capabilities.isPage){_8fd.publishProperty("iversionable_expire",_8fc);return;}var _8fe=_8fd.contentData.properties.iversionable_expire;var now=new Date();var _8ff=_8fc.stopPublish?new Date(_8fc.stopPublish):null;var _900=_8fe.stopPublish?new Date(_8fe.stopPublish):null;if((_8ff&&_8ff-now<0&&(!_900||_900-now>0))||((!_8ff||_8ff-now>0)&&_900&&_900-now<0)){var _901=_8fd.contentModel.watch("iversionable_expire",lang.hitch(this,function(){_901.unwatch();_8e9.publish("/epi/cms/action/pageexpirationchange",[_8fd.contentData.contentLink]);}));}_8fd.publishProperty("iversionable_expire",_8fc);},_onCancel:function(_902){var _903=_902.content.model;_903.set("intermediateValue",_903.get("value"));}});});},"epi/cms/contentediting/ExpirationDialog":function(){require({cache:{"url:epi/cms/contentediting/templates/ExpirationDialog.html":"<div class=\"epi-formContainer\">\r\n    <div data-dojo-type=\"epi.cms.widget.Breadcrumb\" data-dojo-attach-point=\"breadcrumb\" data-dojo-props=\"showCurrentNode: false\"></div>\r\n    <h1 data-dojo-attach-point=\"contentNameNode\" class=\"epi-breadCrumbsCurrentItem dijitInline dojoxEllipsis\"></h1>\r\n    <div data-dojo-attach-point=\"stateNode\" class=\"epi-notificationBar epi-notificationBarItem\">\r\n        <div class=\"epi-notificationBarText\" data-dojo-attach-point=\"infoTextNode\"></div>\r\n        <div class=\"epi-notificationBarButtonContainer\">\r\n            <button data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"removeButton\" data-dojo-attach-event=\"onClick: _onRemoveButtonClick\">${res.removebutton}</button>\r\n        </div>\r\n    </div>\r\n    <div data-dojo-type=\"dijit.form.Form\" class=\"epi-formArea\" data-dojo-attach-point=\"form\"></div>\r\n</div>"}});define("epi/cms/contentediting/ExpirationDialog",["dojo/_base/declare","dojo/_base/lang","dojo/dom-style","dijit/_CssStateMixin","epi/cms/widget/Breadcrumb","epi/shell/widget/dialog/_DialogContentMixin","epi/shell/widget/FormContainer","epi/shell/widget/_ModelBindingMixin","epi/shell/widget/_ActionProviderWidget","dojo/text!./templates/ExpirationDialog.html","epi/i18n!epi/cms/nls/shell.common.buttons","epi/i18n!epi/cms/nls/episerver.cms.widget.expirationeditor"],function(_904,lang,_905,_906,_907,_908,_909,_90a,_90b,_90c,_90d,res){return _904("epi.cms.contentediting.ExpirationDialog",[_909,_90b,_908,_906,_90a],{templateString:_90c,res:res,contentLink:null,contentName:null,baseClass:"epi-statusIndicator",modelBindingMap:{"contentLink":["contentLink"],"contentName":["contentName"],"infoText":["infoText"],"state":["state"],"enableSaveButton":["enableSaveButton"],"enableArchiveLink":["enableArchiveLink"],"showRemoveButton":["showRemoveButton"]},_archiveLinkSelector:null,_setContentLinkAttr:function(_90e){this.breadcrumb.set("contentLink",_90e);},_setContentNameAttr:{node:"contentNameNode",type:"innerHTML"},_setInfoTextAttr:{node:"infoTextNode",type:"innerHTML"},_setEnableSaveButtonAttr:function(_90f){if(this._actions&&this._actions.length){this.setActionProperty("save","disabled",!_90f);}},_setEnableArchiveLinkAttr:function(_910){if(this._archiveLinkSelector&&!this._archiveLinkSelector._keepReadOnly){this._archiveLinkSelector.set("readOnly",!_910);}},_setShowRemoveButtonAttr:function(_911){_905.set(this.removeButton.domNode,"display",_911?"":"none");},_onRemoveButtonClick:function(){var _912={stopPublish:null,archiveLink:null};this.set("value",_912);this.onChange(_912);},onFieldCreated:function(_913,_914){if(_913==="stopPublish"){_914.set("minimumValue",this.model.get("minimumExpireDate"));_914.set("minimumValueMessage",this.model.get("minimumExpireDateMessage"));}else{if(_913==="archiveLink"){this._archiveLinkSelector=_914;if(this._archiveLinkSelector.readOnly){this._archiveLinkSelector._keepReadOnly=true;}else{this._archiveLinkSelector.set("readOnly",!this.model.get("enableArchiveLink"));}this._archiveLinkSelector.set("contentLink",this.model.get("contentLink"));this._archiveLinkSelector.set("canSelectOwnerContent",false);}}},onChange:function(_915){this.inherited(arguments);this.model.set("intermediateValue",_915);},getActions:function(){this._actions=[{name:"save",label:_90d.save,settings:{type:"button",disabled:true},action:lang.hitch(this,function(){if(this.validate()){this.executeDialog();}})},{name:"cancel",label:_90d.cancel,settings:{type:"button"},action:lang.hitch(this,function(){this.cancelDialog();})}];return this._actions;}});});},"epi/cms/contentediting/RenderManager":function(){define("epi/cms/contentediting/RenderManager",["dojo","dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/_base/json","dojo/_base/array","epi","epi/dependency","epi/string","epi/datetime","dojox/encoding/digests/SHA1","dojo/Stateful","epi/cms/contentediting/PropertyRenderer"],function(dojo,_916,lang,_917,json,_918,epi,_919,_91a,_91b,SHA1,_91c,_91d){return _916("epi.cms.contentediting.RenderManager",[_91c],{_cache:null,_queue:null,defaultRenderer:null,_rendererPool:{},rendering:false,processQueueOnRenderValue:true,numberOfItemsInQueue:0,numberOfItemsRendering:0,concurrentProcessedItems:2,processInterval:200,_processIntervalId:0,_itemsBeingRendered:null,viewSettingsManager:null,_viewSettingsToCopy:["visitorgroup"],constructor:function(_91e){this._cache={};this._queue=[];this._itemsBeingRendered={};lang.mixin(this,_91e);this.defaultRenderer=this.defaultRenderer||new _91d();},postscript:function(){this.viewSettingsManager=this.viewSettingsManager||_919.resolve("epi.viewsettingsmanager");},destroy:function(){this._stopRenderingInterval();this._isDestroyed=true;for(var i in this._cache){delete this._cache[i];}for(var j in this._itemsBeingRendered){delete this._itemsBeingRendered[j];}this._cache=null;this._itemsBeingRendered=null;this._queue=null;this.inherited(arguments);},_getRenderer:function(_91f){var def=new _917();if(_91f){if(this._rendererPool[_91f]){return this._rendererPool[_91f];}else{var _920=_91a.slashName(_91f);require([_920],function(_921){def.resolve(new _921());});}}else{return this.defaultRenderer;}return def;},renderValue:function(_922,_923,_924,_925,_926){var def;if(this._isSuspending){def=new _917();def.cancel();return def;}_924=_91b.transformDate(_924);_925=_925||{};_925.propertyRenderSettings=_925.propertyRenderSettings||"";var _927=lang.clone(_925);_918.forEach(this.viewSettingsManager.getRenderingViewSettings(),lang.hitch(this,function(_928){var _929=this.viewSettingsManager.getSettingProperty(_928.key);if(_929){this.updateRenderSettings(_927,_929,_928.key,_928.isTagItem);}}));var _92a=this._get(_923,_927,_924);if(_92a){def=new _917();def.resolve(_92a);}else{if(_927&&_927.isFullReload){def=new _917();def.resolve({doReload:true});}else{def=new _917();_917.when(this._getRenderer(_926),lang.hitch(this,function(_92b){if(!_92b){_92b=this.defaultRenderer;}if(this.processQueueOnRenderValue&&!this._isSuspending){this._startRenderingInterval();}_917.when(this._queueItem(_92b,_922,_923,_927,_924),function(_92c){def.resolve(_92c);});}));}}return def;},updateRenderSettings:function(_92d,_92e,key,_92f){var _930=[],_931=[],_932="",_933=(_92f?"Tag":key),_934=!_92f,data=null;if(_92f){_92d.propertyRenderSettings=_92d.propertyRenderSettings||"";data=(_92d.propertyRenderSettings?dojo.fromJson(_92d.propertyRenderSettings):{});}else{data=(_92d?_92d:{});}if(!data[_933]||_934){_932=_92e;}else{_930=data[_933].split(",");_918.forEach(_930,function(item,idx){item=lang.trim(item);if(item.toLowerCase()!=_92e.toLowerCase()){_931.push(item);}});_931.push(_92e);_932=_931.join(", ");}data[_933]=_932;if(_92f){_92d.propertyRenderSettings=dojo.toJson(data);}},processQueue:function(){if(this._isSuspending){return;}if(this._queue.length===0){this._stopRenderingInterval();return;}if(this.numberOfItemsRendering>=this.concurrentProcessedItems){return;}var _935=this._nextItemToProcessIndex();while(_935>=0&&this.numberOfItemsRendering<this.concurrentProcessedItems){this._processItemInQueue(_935);_935=this._nextItemToProcessIndex();}},suspend:function(){if(this._isSuspending){return;}this._isSuspending=true;this._stopRenderingInterval();},clear:function(){this.set("numberOfItemsRendering",0);for(var key in this._itemsBeingRendered){this._itemsBeingRendered[key].deferred.cancel();delete this._itemsBeingRendered[key];}this._itemsBeingRendered={};this.set("numberOfItemsInQueue",0);for(var i=this._queue.length-1;i>=0;i--){delete this._queue[i];}this._queue=[];},resume:function(){if(!this._isSuspending){return;}this._isSuspending=false;this._startRenderingInterval();},_nextItemToProcessIndex:function(){var _936=-1;var i=0;while(i<this._queue.length&&_936==-1){var item=this._queue[i];var key=this._getRenderHash(item.propertyName,item.renderSettings);if(!(key in this._itemsBeingRendered)){_936=i;}i++;}return _936;},_processItemInQueue:function(_937){var item=this._queue.splice(_937,1)[0];this.set("numberOfItemsRendering",this.numberOfItemsRendering+1);this.set("numberOfItemsInQueue",this._queue.length);var key=this._getRenderHash(item.propertyName,item.renderSettings);this._itemsBeingRendered[key]=item;this.set("rendering",true);var _938=lang.hitch(this,function(_939){if(this._isDestroyed){item.deferred.cancel();return;}if(_939&&_939.content){this._put(item.propertyName,item.renderSettings,item.value,{doReload:false,content:_939.content});}delete this._itemsBeingRendered[key];this.set("numberOfItemsRendering",this.numberOfItemsRendering-1);this.set("rendering",false);item.deferred.resolve(_939);});var _93a=lang.hitch(this,function(err){if(this._isDestroyed){item.deferred.cancel();return;}delete this._itemsBeingRendered[key];this.set("numberOfItemsRendering",this.numberOfItemsRendering-1);this.set("rendering",false);item.deferred.reject(err);});_917.when(item.renderer.render(item.contentLink,item.propertyName,item.value,item.renderSettings),_938,_93a);},cacheRender:function(_93b,_93c,_93d,_93e){data={content:_93e,doReload:false};this._put(_93b,_93c,_93d,data);},_queueItem:function(_93f,_940,_941,_942,_943){var key=this._getRenderHash(_941,_942);var _944;var _945=this._itemsBeingRendered[key];if(_945&&!_945.deferred.fired&&_945.value===_943){_944=_945.deferred;}else{var _946=this._queueIndex(_93f,_940,_941,_942,_943);var _947=_943!=null?_943:"";if(_946<0){_944=new _917();this._queue.push({contentLink:_940,renderer:_93f,propertyName:_941,renderSettings:_942,renderSettingsString:json.toJson(_942),value:_947,deferred:_944});this.set("numberOfItemsInQueue",this._queue.length);}else{var item=this._queue[_946];item.contentLink=_940;item.renderer=_93f;item.value=_947;_944=item.deferred;}}return _944;},_startRenderingInterval:function(){if(!this._processIntervalId){this.processQueue();this._processIntervalId=setInterval(lang.hitch(this,function(){this.processQueue();}),this.processInterval);}},_stopRenderingInterval:function(){if(this._processIntervalId){clearInterval(this._processIntervalId);this._processIntervalId=0;}this.set("rendering",false);},_getRenderHash:function(_948,_949){return SHA1(json.toJson({p:_948,r:_949}));},_queueIndex:function(_94a,_94b,_94c,_94d,_94e){var _94f=-1;var _950=json.toJson(_94d);_918.some(this._queue,function(item,i){if((item.propertyName===_94c)&&(item.renderSettingsString==_950)){_94f=i;return true;}});return _94f;},_put:function(_951,_952,_953,data){if(!_952.cacheResults){return;}var _954=this._getCacheHash(_951,_952,_953);this._cache[_954]={data:data};},_get:function(_955,_956,_957){var _958=this._getCacheHash(_955,_956,_957);var _959=this._cache[_958];return (_959?_959.data:undefined);},_getCacheHash:function(_95a,_95b,_95c){return SHA1(json.toJson({p:_95a,r:_95b,v:_95c}));}});});},"epi/cms/widget/SearchResultList":function(){define("epi/cms/widget/SearchResultList",["dojo/_base/declare","dojo/_base/lang","dojo/Evented","dojo/dom-construct","dojo/dom-style","dojox/widget/Standby","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/form/_ListMouseMixin","dijit/form/_ComboBoxMenuMixin","epi/cms/widget/_ContentListKeyMixin","epi/cms/widget/_ContentListMouseMixin","epi/shell/dgrid/Formatter","dgrid/Grid","dgrid/Selection","dgrid/Keyboard","epi/i18n!epi/cms/nls/episerver.cms.widget.contentlist","dojo/text!./templates/SearchResultList.html"],function(_95d,lang,_95e,_95f,_960,_961,_962,_963,_964,_965,_966,_967,_968,Grid,_969,_96a,_96b,_96c){return _95d("epi.cms.widget.SearchResultList",[_962,_963,_95e,_964,_965,_966,_967],{templateString:_96c,res:_96b,_standby:null,_messages:{nextMessage:"",previousMessage:""},postCreate:function(){this.inherited(arguments);var _96d=_95d([Grid,_969,_96a,_968]);this.grid=new _96d({columns:[{field:"title",ellipsisNoTooltip:true}],selectionMode:"single",cellNavigation:false});this.grid.set("showHeader",false);_95f.place(this.grid.domNode,this.gridContainerNode);this.grid.on(".dgrid-row:click",lang.hitch(this,function(_96e){var row=this.grid.row(_96e);if(row){this._onSelect(row.data);}}));this._standby=new _961({target:this.domNode}).placeAt(document.body);this.containerNode=this._getGridContainer();},startup:function(){this.inherited(arguments);this._standby.startup();},uninitialize:function(){this._standby.destroyRecursive();this._standby=null;this.inherited(arguments);},showStandby:function(show){if(!this._standby){return;}if(show){if(!this._standby.isVisible()){this._standby.show();}}else{this._standby.hide();}},showEmptyMessage:function(show){_960.set(this.emptyMessage,"display",show?"block":"none");},showGrid:function(show){_960.set(this.grid.domNode,"display",show?"block":"none");},_onSelect:function(_96f){this.emit("select",_96f);},_getGridContainer:function(){return this.grid.contentNode;},createOptions:function(_970,_971,_972){this.grid.renderArray(_970);return this.containerNode.childNodes;},clearResultList:function(){this.grid.refresh();},getHighlightedOption:function(){return null;}});});},"dgrid/Keyboard":function(){define("dgrid/Keyboard",["dojo/_base/declare","dojo/aspect","dojo/on","./List","dojo/_base/lang","dojo/has","put-selector/put","dojo/_base/Deferred","dojo/_base/sniff"],function(_973,_974,on,List,lang,has,put,_975){var _976={checkbox:1,radio:1,button:1},_977=/\bdgrid-cell\b/,_978=/\bdgrid-row\b/;has.add("dom-contains",function(){return !!document.createElement("a").contains;});function _979(_97a,node){if(has("dom-contains")){return _97a.contains(node);}else{return _97a.compareDocumentPosition(node)&8;}};return _973([List],{pageSkip:10,tabIndex:0,postCreate:function(){this.inherited(arguments);var grid=this;function _97b(_97c){var _97d=_97c.target;return _97d.type&&(!_976[_97d.type]||_97c.keyCode==32);};function _97e(_97f){function _980(_981,_982,_983){var cell=grid[grid.cellNavigation?"cell":"row"](_981);if(cell){_981=cell.element;if(_981){if(!_982.bubbles){_982.bubbles=true;}put(_984,"!dgrid-focus[!tabIndex]");if(_984){if(has("ie")<8){_984.style.position="";}_982.cell=_984;on.emit(_981,"dgrid-cellfocusout",_982);}_984=_981;_982.cell=_981;if(!_983){if(has("ie")<8){_981.style.position="relative";}_981.tabIndex=grid.tabIndex;_981.focus();}put(_981,".dgrid-focus");on.emit(_984,"dgrid-cellfocusin",lang.mixin({parentType:_982.type},_982));}}};var _985=grid.cellNavigation?_977:_978,_984=_97f,next;while((next=_984.firstChild)&&next.tagName){_984=next;}if(_97f===grid.contentNode){_974.after(grid,"renderArray",function(ret){return _975.when(ret,function(ret){if(_985.test(_984.className)&&_979(_97f,_984)){return ret;}for(var i=0,_986=_97f.getElementsByTagName("*"),_987;(_987=_986[i]);++i){if(_985.test(_987.className)){_984=_987;break;}}_984.tabIndex=grid.tabIndex;return ret;});});}else{if(_985.test(_984.className)){_984.tabIndex=grid.tabIndex;}}on(_97f,"mousedown",function(_988){if(!_97b(_988)){_980(_988.target,_988);}});on(_97f,"keydown",function(_989){if(_989.metaKey||_989.altKey){return;}var _98a=_989.target;var _98b=_989.keyCode;if(_97b(_989)){return;}var move={32:0,33:-grid.pageSkip,34:grid.pageSkip,37:-1,38:-1,39:1,40:1,35:10000,36:-10000}[_98b];if(isNaN(move)){return;}var _98c,_98d,cell=grid.cell(_984);var _98e;if(_98b==37||_98b==39){if(!grid.cellNavigation){return;}_98e="right";}else{_98e="down";_98d=cell&&cell.column&&cell.column.id;cell=grid.row(_984);}if(move){cell=cell&&grid[_98e](cell,move,true);}var _98f=cell&&cell.element;if(_98f){if(_98d){_98f=grid.cell(_98f,_98d).element;}if(grid.cellNavigation){var _990=_98f.getElementsByTagName("input");var _991;for(var i=0;i<_990.length;i++){var _992=_990[i];if((_992.tabIndex!=-1||"lastValue" in _992)&&!_992.disabled){if(has("ie")<8){_992.style.position="relative";}_992.focus();if(has("ie")<8){_992.style.position="";}_991=true;break;}}}_980(_98f,_989,_991);}_989.preventDefault();});};if(grid.tabableHeader){_97e(grid.headerNode);}_97e(grid.contentNode);}});});},"epi/cms/widget/_CategoryTreeNode":function(){require({cache:{"url:epi/cms/widget/templates/_CategoryTreeNode.html":"<div class=\"dijitTreeNode epi-categoryTreeNode\" role=\"presentation\">\r\n    <a href=\"#\" tabIndex=\"-1\" data-dojo-attach-point=\"rowNode\" class=\"dijitTreeRow\" role=\"presentation\" data-dojo-attach-event=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onclick:_onClick, ondblclick:_onDblClick\">\r\n        <span data-dojo-attach-point=\"contentNode\" class=\"dijitTreeContent\" role=\"presentation\">\r\n            <span data-dojo-attach-point=\"expandoNode\" class=\"dijitTreeExpando\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"labelNode\" class=\"dijitTreeLabel epi-categoryTreeLabel\" role=\"treeitem\"\r\n                tabindex=\"-1\" aria-selected=\"false\" data-dojo-attach-event=\"onfocus:_onLabelFocus, onclick:_onLabelClick, keyup:_onLabelKeyUp\">\r\n            </span>\r\n        </span>\r\n    </a>\r\n    <div data-dojo-attach-point=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\r\n    <a href=\"#\" tabIndex=\"-1\" style=\"display: block;\" data-dojo-attach-point=\"rowSeparator\" class=\"rowSeparatorAfter\" role=\"presentation\"></a>\r\n</div>"}});define("epi/cms/widget/_CategoryTreeNode",["epi","dojo","dijit/Tree","dijit/form/CheckBox","dijit/_TemplatedMixin","dojo/text!./templates/_CategoryTreeNode.html"],function(epi,dojo,Tree,_993,_994,_995){return dojo.declare("epi.cms.widget._CategoryTreeNode",[Tree._TreeNode,_994],{templateString:_995,_checkbox:null,_selectedChildrenCount:0,constructor:function(){this._createCheckbox(arguments[0].item);},_createCheckbox:function(item){if(!item.selectable){return;}this._checkbox=new dijit.form.CheckBox({name:"checkboxCategory",value:item.id,tabIndex:-1,onChange:dojo.hitch(this,function(_996){this.onCheckBoxChange(_996,item);}),checked:false});},onCheckBoxChange:function(_997,item){},_onLabelClick:function(){if(!this._checkbox){return;}this._checkbox.setChecked(!this._checkbox.checked);},_onLabelKeyUp:function(evt){if(evt.keyCode==dojo.keys.SPACE||evt.keyCode==dojo.keys.ENTER){this._onLabelClick();}},setCheckAttribute:function(_998){if(!this._checkbox){return;}this._checkbox.set("checked",_998);},postCreate:function(){this.inherited(arguments);if(this._checkbox){var _999=dojo.create("span",{"class":"epi-checkboxNode dijitTreeExpando"});dojo.place(this._checkbox.domNode,_999);dojo.place(_999,this.expandoNode,"after");}},getSelectedChildrenCount:function(){return this._selectedChildrenCount;},setSelectedChildrenCount:function(_99a){this._selectedChildrenCount=_99a;this.updateLabel();},updateLabel:function(){var _99b=this.tree.model.getLabel(this.item);if(this._selectedChildrenCount!==0&&!this.isExpanded){this.labelNode.innerHTML=_99b+"("+this._selectedChildrenCount+")";}else{this.labelNode.innerHTML=_99b;}}});});},"epi/cms/component/command/ChangeContext":function(){define("epi/cms/component/command/ChangeContext",["dojo/_base/declare","dojo/topic","epi/cms/contentediting/ContentActionSupport","epi/shell/command/_Command","epi/i18n!epi/cms/nls/episerver.shared.action"],function(_99c,_99d,_99e,_99f,_9a0){return _99c([_99f],{contentActionSupport:null,forceContextChange:false,postscript:function(){this.inherited(arguments);this.contentActionSupport=this.contentActionSupport||_99e;},_execute:function(){_99d.publish("/epi/shell/context/request",{uri:this.model.uri},{sender:null,forceContextChange:this.forceContextChange});},_onModelChange:function(){var _9a1=this.model&&this.model.contentLink;this.set("canExecute",!!_9a1);if(_9a1&&this.model.accessMask){if(this.contentActionSupport.hasAccess(this.model.accessMask,this.contentActionSupport.accessLevel[this.contentActionSupport.action.Edit])){this.set("label",_9a0.edit);this.set("iconClass","epi-iconPen");}else{this.set("label",_9a0.view);this.set("iconClass","epi-iconSearch");}}}});});},"epi/cms/widget/BlockListViewModel":function(){define("epi/cms/widget/BlockListViewModel",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/_base/array","dojo/Stateful","epi/shell/_StatefulGetterSetterMixin","epi/cms/contentediting/ContentActionSupport","epi/cms/widget/ContentTreeStoreModel"],function(_9a2,_9a3,lang,_9a4,_9a5,_9a6,_9a7,_9a8){return _9a2("epi.cms.widget.BlockListViewModel",_9a8,{typeIdentifiers:["epi.cms.block"],additionalQueryOptions:{sort:[{attribute:"name",descending:false}]},contentData:null,fetchData:function(){if(!this.contentData||this.contentData.isDeleted){return;}var _9a9=new _9a3();dojo.when(this.store.query(this._createQuery({referenceId:this.contentData.contentLink,query:"getchildren"}),this._queryOptions),dojo.hitch(this,function(data){_9a4.forEach(data,function(item,idx){data[idx]=dojo.mixin({id:item.contentLink},item);});_9a9.resolve(data);}));return _9a9;},canCopy:function(item){return _9a7.hasAccess(item.accessMask,_9a7.accessLevel.Read);},canDelete:function(item){return _9a7.hasAccess(item.accessMask,_9a7.accessLevel.Delete);},canPaste:function(){return false;},isAncestor:function(_9aa,_9ab){return false;}});});},"epi/cms/contentediting/command/_LegacyDialogCommandBase":function(){define(["dojo/_base/declare","dojo/_base/lang","epi/cms/core/ContentReference","epi/cms/legacy/LegacyDialogPopup","epi/routes","epi/shell/command/_Command"],function(_9ac,lang,_9ad,_9ae,_9af,_9b0){return _9ac([_9b0],{dialogPath:null,raiseCloseEvent:null,_execute:function(){var _9b1=this.model.contentData.contentLink;var _9b2=new _9ad(_9b1),_9b3=_9af.getActionPath({id:_9b2,path:this.dialogPath,moduleArea:"LegacyCMS",IsInLegacyWrapper:true}),_9b4=new _9ae({url:_9b3,dialogArguments:window.document,autoFit:true,showCancelButton:true,onClose:lang.hitch(this,function(){if(this.raiseCloseEvent){dojo.publish("/epi/cms/contentdata/updated",{contentLink:_9b2,recursive:true});}})});_9b4.show();}});});},"epi/cms/Application":function(){define("epi/cms/Application",["dojo/_base/declare"],function(_9b5){return _9b5("epi.cms.Application",[],{_settings:null,constructor:function(_9b6){this._settings=_9b6;this._startPage=_9b6.startPage;this._rootPage=_9b6.rootPage;this._wastebasketPage=_9b6.wastebasketPage;this._siteBlockFolder=_9b6.siteBlockFolder;this._globalBlockFolder=_9b6.globalBlockFolder;this._rootCategory=_9b6.rootCategory;this._userName=_9b6.userName;this._useLegacyEditMode=_9b6.useLegacyEditMode;this._typeUIDescriptors=_9b6.typeUIDescriptors;},currentContentLanguage:function(){return this._settings.currentContentLanguage;},getStartPage:function(){return this._startPage;},getRootPage:function(){return this._rootPage;},getWastebasketPage:function(){return this._wastebasketPage;},getSiteBlockFolder:function(){return this._siteBlockFolder;},getGlobalBlockFolder:function(){return this._globalBlockFolder;},getRootCategory:function(){return this._rootCategory;},getUserName:function(){return this._userName;},isLegacyEditMode:function(){return this._useLegacyEditMode;},getDisplayResolutions:function(){return this._settings.displayResolutions;},getTypeUIDescriptors:function(){return this._typeUIDescriptors;},isBaseTypeIdentifier:function(_9b7,_9b8){var type=_9b7;while(descriptor=this._typeUIDescriptors[type]){type=descriptor.baseTypeIdentifier;if(type===_9b8){return true;}}return false;}});});},"epi/cms/contentediting/command/builder/MenuWithSeparatorBuilder":function(){define("epi/cms/contentediting/command/builder/MenuWithSeparatorBuilder",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/on","dijit/MenuSeparator","epi/shell/command/builder/MenuBuilder"],function(_9b9,_9ba,lang,on,_9bb,_9bc){return _9ba([_9bc],{_addToContainer:function(_9bd,_9be){var _9bf=new _9bb();_9be.addChild(_9bd);_9be.addChild(_9bf);}});});},"epi/shell/widget/TextWithActionLinks":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/_base/lang","dojo/Evented","dojo/on","dojo/query","dijit/_WidgetBase","dijit/_TemplatedMixin","dijit/focus"],function(_9c0,_9c1,_9c2,lang,_9c3,on,_9c4,_9c5,_9c6,_9c7){return _9c1("epi.shell.widget.TextWithActionLinks",[_9c5,_9c6,_9c3],{tagName:"span",templateString:"<{0}>{1}</{0}>",contentString:"",namedActions:null,_eventHandlers:null,postMixInProperties:function(){this.inherited(arguments);this._eventHandlers=[];var _9c8={};var _9c9=this.contentString;if(this.namedActions){for(var _9ca in this.namedActions){_9c8[_9ca]="<a class=\"epi-visibleLink\" href=\"#\" data-dojo-attach-point=\"action"+_9ca+"\">"+this.namedActions[_9ca]+"</a>";}_9c9=lang.replace(_9c9,_9c8);}this.templateString=lang.replace(this.templateString,[this.tagName,_9c9]);},postCreate:function(){this.inherited(arguments);if(this.namedActions){for(var _9cb in this.namedActions){var link=this["action"+_9cb];if(link){var _9cc=on(link,"click",(function(_9cd,_9ce){return function(evt){_9c2.stop(evt);_9cd.emit("onActionClick",_9ce);};})(this,_9cb));this._eventHandlers.push(_9cc);}}}},destroy:function(){_9c0.forEach(this._eventHandlers,function(_9cf){_9cf.remove();},this);this._eventHandlers=null;this.inherited(arguments);},focus:function(){var _9d0=_9c4("a",this.domNode);if(_9d0.length>0){_9c7.focus(_9d0[0]);}}});});},"epi/cms/command/NewContent":function(){define("epi/cms/command/NewContent",["dojo/_base/declare","dojo/topic","epi/dependency","epi/cms/contentediting/ContentActionSupport","epi/shell/command/_Command"],function(_9d1,_9d2,_9d3,_9d4,_9d5){return _9d1([_9d5],{contentType:null,resources:null,contextStore:null,contentActionSupport:null,postscript:function(){this.inherited(arguments);this.contentActionSupport=this.contentActionSupport||_9d4;if(!this.contextStore){var _9d6=_9d3.resolve("epi.storeregistry");this.contextStore=_9d6.get("epi.shell.context");}},_execute:function(){_9d2.publish("/epi/shell/action/changeview","epi/cms/component/CreateContent",null,{requestedTypes:[this.contentType],type:this.contentType,parent:this.model,res:this.resources});},_onModelChange:function(){if(this.model==null){this.set("canExecute",false);return;}dojo.when(this.contextStore.get("?uri=epi.cms.contentdata:///"+this.model.contentLink),dojo.hitch(this,function(_9d7){if(!_9d7){return;}var _9d8=this.model;var _9d9=_9d7.languageContext;var _9da=!_9d9||(_9d9.hasTranslationAccess&&_9d9.isPreferredLanguageAvailable);var _9db=_9d8&&!(_9d8.isWastebasket||_9d8.isDeleted)&&_9da&&this.contentActionSupport.isActionAvailable(_9d8,_9d4.action.Create,_9d4.providerCapabilities.Create,true);this.set("canExecute",_9db);}));}});});},"epi/cms/component/PageTreeComponent":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom-geometry","dijit/layout/_LayoutWidget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","epi/dependency","epi/cms/component/PageTree","epi/cms/widget/SearchBox"],function(_9dc,_9dd,lang,_9de,_9df,_9e0,_9e1,_9e2,_9e3,_9e4){return _9dd("epi.cms.component.PageTreeComponent",[_9df,_9e0,_9e1],{templateString:"<div>                            <div data-dojo-type=\"epi.cms.widget.SearchBox\" data-dojo-attach-point=\"search\" class=\"epi-gadgetInnerToolbar\"></div>                            <div data-dojo-type=\"dijit.layout._LayoutWidget\" data-dojo-attach-point=\"navigation\" style=\"overflow:auto;\"></div>                        </div>",_application:null,_tree:null,postCreate:function(){this.inherited(arguments);this.search.set("area","cms/pages");this._application=this._application||_9e2.resolve("epi.cms.Application");var tree=new _9e3();tree.placeAt(this.navigation);this._setSearchRoots(tree.model);},layout:function(){var cb=this._contentBox,sb=_9de.getMarginBox(this.search.domNode);this.navigation.resize({w:cb.w,h:cb.h-sb.h});},_setSearchRoots:function(_9e5){_9e5.getChildren(this._application.getRootPage(),lang.hitch(this,function(_9e6){var _9e7=[];_9dc.forEach(_9e6,function(_9e8){_9e7.push(_9e8.contentLink);},this);this.search.set("searchRoots",_9e7.join(","));}));}});});},"dojo/io/script":function(){define(["../main"],function(dojo){dojo.getObject("io",true,dojo);var _9e9=dojo.isIE?"onreadystatechange":"load",_9ea=/complete|loaded/;dojo.io.script={get:function(args){var dfd=this._makeScriptDeferred(args);var _9eb=dfd.ioArgs;dojo._ioAddQueryToUrl(_9eb);dojo._ioNotifyStart(dfd);if(this._canAttach(_9eb)){var node=this.attach(_9eb.id,_9eb.url,args.frameDoc);if(!_9eb.jsonp&&!_9eb.args.checkString){var _9ec=dojo.connect(node,_9e9,function(evt){if(evt.type=="load"||_9ea.test(node.readyState)){dojo.disconnect(_9ec);_9eb.scriptLoaded=evt;}});}}dojo._ioWatch(dfd,this._validCheck,this._ioCheck,this._resHandle);return dfd;},attach:function(id,url,_9ed){var doc=(_9ed||dojo.doc);var _9ee=doc.createElement("script");_9ee.type="text/javascript";_9ee.src=url;_9ee.id=id;_9ee.async=true;_9ee.charset="utf-8";return doc.getElementsByTagName("head")[0].appendChild(_9ee);},remove:function(id,_9ef){dojo.destroy(dojo.byId(id,_9ef));if(this["jsonp_"+id]){delete this["jsonp_"+id];}},_makeScriptDeferred:function(args){var dfd=dojo._ioSetArgs(args,this._deferredCancel,this._deferredOk,this._deferredError);var _9f0=dfd.ioArgs;_9f0.id=dojo._scopeName+"IoScript"+(this._counter++);_9f0.canDelete=false;_9f0.jsonp=args.callbackParamName||args.jsonp;if(_9f0.jsonp){_9f0.query=_9f0.query||"";if(_9f0.query.length>0){_9f0.query+="&";}_9f0.query+=_9f0.jsonp+"="+(args.frameDoc?"parent.":"")+dojo._scopeName+".io.script.jsonp_"+_9f0.id+"._jsonpCallback";_9f0.frameDoc=args.frameDoc;_9f0.canDelete=true;dfd._jsonpCallback=this._jsonpCallback;this["jsonp_"+_9f0.id]=dfd;}return dfd;},_deferredCancel:function(dfd){dfd.canceled=true;if(dfd.ioArgs.canDelete){dojo.io.script._addDeadScript(dfd.ioArgs);}},_deferredOk:function(dfd){var _9f1=dfd.ioArgs;if(_9f1.canDelete){dojo.io.script._addDeadScript(_9f1);}return _9f1.json||_9f1.scriptLoaded||_9f1;},_deferredError:function(_9f2,dfd){if(dfd.ioArgs.canDelete){if(_9f2.dojoType=="timeout"){dojo.io.script.remove(dfd.ioArgs.id,dfd.ioArgs.frameDoc);}else{dojo.io.script._addDeadScript(dfd.ioArgs);}}return _9f2;},_deadScripts:[],_counter:1,_addDeadScript:function(_9f3){dojo.io.script._deadScripts.push({id:_9f3.id,frameDoc:_9f3.frameDoc});_9f3.frameDoc=null;},_validCheck:function(dfd){var _9f4=dojo.io.script;var _9f5=_9f4._deadScripts;if(_9f5&&_9f5.length>0){for(var i=0;i<_9f5.length;i++){_9f4.remove(_9f5[i].id,_9f5[i].frameDoc);_9f5[i].frameDoc=null;}dojo.io.script._deadScripts=[];}return true;},_ioCheck:function(dfd){var _9f6=dfd.ioArgs;if(_9f6.json||(_9f6.scriptLoaded&&!_9f6.args.checkString)){return true;}var _9f7=_9f6.args.checkString;return _9f7&&eval("typeof("+_9f7+") != 'undefined'");},_resHandle:function(dfd){if(dojo.io.script._ioCheck(dfd)){dfd.callback(dfd);}else{dfd.errback(new Error("inconceivable dojo.io.script._resHandle error"));}},_canAttach:function(_9f8){return true;},_jsonpCallback:function(json){this.ioArgs.json=json;}};return dojo.io.script;});},"epi/cms/widget/ChannelSelector":function(){define("epi/cms/widget/ChannelSelector",["dojo","dojo/_base/lang","dojo/_base/array","dojo/_base/Deferred","epi","epi/dependency","epi/cms/widget/_ItemSelectorBase","epi/cms/widget/_DropDownWidgetItemMixin","epi/i18n!epi/cms/nls/episerver.cms.widget.channelselector"],function(dojo,lang,_9f9,_9fa,epi,_9fb,_9fc,_9fd,res){return dojo.declare("epi.cms.widget.ChannelSelector",[_9fc,_9fd],{defaultItem:{name:res.defaultitem,resolutionName:res.defaultitem},_isFinished:null,_channelHashMap:{},postMixInProperties:function(){this.inherited(arguments);var _9fe=_9fb.resolve("epi.storeregistry");this._store=_9fe.get("epi.cms.displaychannels");},postCreate:function(){this._isFinished=new _9fa();this.inherited(arguments);this.set("header",res.header);dojo.when(this._store.query({query:"getallregistered"}),lang.hitch(this,function(_9ff){this._createHashMap(_9ff);this.checkedItem=(this.checkedItem?this._channelHashMap[this.checkedItem]:this.defaultItem.name);_9ff.unshift(this.defaultItem);this.set("items",_9ff);this._isFinished.resolve({status:true});}));},isSetupFinished:function(){return this._isFinished;},_createHashMap:function(_a00){_9f9.forEach(_a00,lang.hitch(this,function(item){this._channelHashMap[item.channelName]=item.name;}));}});});},"epi/cms/command/TranslateContent":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","epi/dependency","./_TranslateContent"],function(_a01,lang,_a02,_a03,_a04){return _a01([_a04],{contextStore:null,postscript:function(){this.inherited(arguments);if(!this.contextStore){var _a05=_a03.resolve("epi.storeregistry");this.contextStore=_a05.get("epi.shell.context");}},_execute:function(){this._executeCommand(this.model);},_onModelChange:function(){if(this.model==null){this.set("canExecute",false);this.set("isAvailable",false);return;}_a02.when(this.contextStore.get("?uri=epi.cms.contentdata:///"+this.model.contentLink),lang.hitch(this,function(_a06){this._canExecute(this.model,_a06.capabilities,_a06.languageContext);}));}});});},"epi/cms/contentediting/_EditorWrapperBase":function(){define("epi/cms/contentediting/_EditorWrapperBase",["epi","dojo","dojo/_base/lang","dijit","dijit/_Widget"],function(epi,dojo,lang,_a07,_a08){return dojo.declare("epi.cms.contentediting._EditorWrapperBase",[_a08],{wrapperType:"",editorWidgetType:null,editorParams:null,autoSave:true,editing:false,disabled:false,blockDisplayNode:null,editorWidget:null,isModified:false,_resetValue:null,_lastSyncedValue:null,_createdEditor:false,propertyName:"",propertyDisplayName:"",iframeWithOverlay:null,overlayItem:null,contentModel:null,onStartEdit:function(_a09,data){},onValueChange:function(_a0a,val){},onDoubleValueChange:function(_a0b,_a0c,_a0d,_a0e){},onCancel:function(_a0f){},onStopEdit:function(_a10,_a11,_a12){},postCreate:function(){this.inherited(arguments);this.contentModel.watch(this.propertyName,dojo.hitch(this,"contentModelChanged"));},destroy:function(){if(this._createdEditor&&this.editorWidget){this.editorWidget.destroyRecursive();this.editorWidget=null;}this.inherited(arguments);},contentModelChanged:function(name,_a13,_a14){if(!this.editing){this.set("value",_a14);}},startEdit:function(_a15){this._startEdit(_a15);},_startEdit:function(_a16){lang.mixin(this.editorParams,_a16);this.set("editing",true);this.set("isModified",false);this._resetValue=this.value;this._lastSyncedValue=this._resetValue=this.getEditorValue();this.isValid();setTimeout(dojo.hitch(this,function(){this.onStartEdit(this,this.editorParams);}),0);},_stopEdit:function(_a17){this.set("editing",false);this._removeEditingFeatures();setTimeout(dojo.hitch(this,function(){this.onStopEdit(this,this.getEditorValue(),this._resetValue,_a17);}),0);},cancel:function(){if(this.isModified){this.save(this._resetValue);}this.set("editing",false);this._removeEditingFeatures();setTimeout(dojo.hitch(this,function(){this.onCancel(this);}),0);},save:function(val){this.isModified=true;this._lastSyncedValue=val;setTimeout(dojo.hitch(this,function(){this.onValueChange(this,val);}),0);},doubleSave:function(val,_a18,_a19){this.isModified=true;this._lastSyncedValue=val;setTimeout(dojo.hitch(this,function(){this.onDoubleValueChange(this,val,_a18,_a19);}),0);},hasBeenEdited:function(){return this.editing&&(!epi.areEqual(this.getEditorValue(),this._resetValue));},hasPendingChanges:function(){return this.editing&&(!epi.areEqual(this.getEditorValue(),this._lastSyncedValue));},tryToStopEditing:function(_a1a){if(this.editing){if(this.isValid()){if(this.hasBeenEdited()){if(this.hasPendingChanges()){this.save(this.getEditorValue());}this._stopEdit(_a1a);}else{this.cancel(_a1a);}}else{this._onTryToStopWithInvalidValue();}}},_removeEditingFeatures:function(){},_onTryToStopWithInvalidValue:function(){},_onEditorKeyPress:function(e){if(this.autoSave&&this.editing){if(e.altKey||e.ctrlKey){return;}if(e.charOrCode==dojo.keys.ESCAPE){dojo.stopEvent(e);this.cancel();}else{if(e.charOrCode==dojo.keys.ENTER&&e.target.tagName=="INPUT"){dojo.stopEvent(e);this.tryToStopEditing(false);}}}},_onChange:function(val){if(this.autoSave&&this.editing&&this.isValid()){this.save(val);}},_onDoubleChange:function(val,_a1b,_a1c){if(this.autoSave&&this.editing&&this.isValid()){this.doubleSave(val,_a1b,_a1c);}},_onIntermediateChange:function(val){if(this.editing&&this.isValid()){this.save(val);}},getEditorWidget:function(){return this.editorWidget;},getEditorValue:function(){var ew=this.editorWidget;if(ew){return ew.get("value");}return null;},setEditorValue:function(val){var ew=this.editorWidget;if(ew&&val!==ew.get("value")){ew.set("value",val);}},_setValueAttr:function(_a1d){var ew=this.editorWidget;this.setEditorValue(_a1d);this._set("value",this.getEditorValue()||_a1d);},isValid:function(){return (this.editorWidget&&this.editorWidget.isValid?this.editorWidget.isValid():true);},focus:function(){this.editorWidget.focus();setTimeout(dojo.hitch(this,function(){if(this.editorWidget.focusNode&&this.editorWidget.focusNode.tagName=="INPUT"){_a07.selectInputText(this.editorWidget.focusNode);}}),0);}});});},"url:epi/cms/widget/templates/Block.html":"<div class=\"dojoDndItem epi-overlay-block\">\r\n    <div data-dojo-attach-point=\"containerDomNode\"></div>\r\n    <button data-dojo-attach-point=\"settingsButton\" data-dojo-type=\"dijit.form.DropDownButton\" \r\n        data-dojo-props=\"showLabel:false, title:'${res.settingstooltip}', iconClass:'epi-iconContextMenu', 'class':'epi-chromelessButton epi-overlayControls epi-settingsButton epi-mediumButton'\">\r\n        <div data-dojo-attach-point=\"contextMenu\" data-dojo-type=\"epi.cms.widget.BlockContextMenu\"></div>\r\n    </button>\r\n</div>","dgrid/Grid":function(){define("dgrid/Grid",["dojo/_base/kernel","dojo/_base/declare","dojo/on","dojo/has","put-selector/put","./List","dojo/_base/sniff"],function(_a1e,_a1f,_a20,has,put,List){var _a21=has("ie")<8&&!has("quirks");var _a22=/[^\._a-zA-Z0-9-]/g;function _a23(_a24,_a25){if(_a25&&_a25.nodeType){_a24.appendChild(_a25);}};var Grid=_a1f([List],{columns:null,cellNavigation:true,tabableHeader:true,showHeader:true,column:function(_a26){if(typeof _a26=="string"){return this.columns[_a26];}else{return this.cell(_a26).column;}},listType:"grid",cell:function(_a27,_a28){if(_a27.row&&_a27.row instanceof this._Row){return _a27;}if(_a27.target&&_a27.target.nodeType){_a27=_a27.target;}var _a29;if(_a27.nodeType){var _a2a;do{if(this._rowIdToObject[_a27.id]){break;}var _a2b=_a27.columnId;if(_a2b){_a28=_a2b;_a29=_a27;break;}_a27=_a27.parentNode;}while(_a27&&_a27!=this.domNode);}if(!_a29&&_a28){var row=this.row(_a27),_a2c=row.element;if(_a2c){var _a2d=_a2c.getElementsByTagName("td");for(var i=0;i<_a2d.length;i++){if(_a2d[i].columnId==_a28){_a29=_a2d[i];break;}}}}if(_a27!=null){return {row:row||this.row(_a27),column:_a28&&this.column(_a28),element:_a29};}},_columnsCss:function(rule){rule.fullSelector=function(){return this.parent.fullSelector()+" .dgrid-cell";};for(var i=0;i<rule.children.length;i++){var _a2e=rule.children[i];_a2e.field=_a2e.className=_a2e.selector.substring(1);}return rule.children;},createRowCells:function(tag,each,_a2f){var row=put("table.dgrid-row-table[role=presentation]"),_a30=this.cellNavigation,_a31=(has("ie")<9||has("quirks"))?put(row,"tbody"):row,tr,si,sl,i,l,_a32,_a33,id,_a34,cell,_a35,_a36,_a37;_a2f=_a2f||this.subRows;for(si=0,sl=_a2f.length;si<sl;si++){_a32=_a2f[si];tr=(sl==1&&!has("ie"))?_a31:put(_a31,"tr");for(i=0,l=_a32.length;i<l;i++){_a33=_a32[i];id=_a33.id;_a34=_a33.className||(_a33.field&&"field-"+_a33.field);cell=put(tag+(".dgrid-cell.dgrid-cell-padding.dgrid-column-"+id+(_a34?"."+_a34:"")).replace(_a22,"-"));cell.columnId=id;if(_a21){_a35=put(cell,"!dgrid-cell-padding div.dgrid-cell-padding");cell.contents=_a35;}else{_a35=cell;}_a36=_a33.colSpan;if(_a36){cell.colSpan=_a36;}_a37=_a33.rowSpan;if(_a37){cell.rowSpan=_a37;}each(_a35,_a33);tr.appendChild(cell);}}return row;},left:function(cell,_a38){return this.cell(this._move(cell,-(_a38||1),"dgrid-cell"));},right:function(cell,_a39){return this.cell(this._move(cell,_a39||1,"dgrid-cell"));},renderRow:function(_a3a,_a3b){var row=this.createRowCells("td",function(td,_a3c){var data=_a3a;if(_a3c.get){data=_a3c.get(_a3a);}else{if("field" in _a3c&&_a3c.field!="_item"){data=data[_a3c.field];}}if(_a3c.formatter){td.innerHTML=_a3c.formatter(data);}else{if(_a3c.renderCell){_a23(td,_a3c.renderCell(_a3a,data,td,_a3b));}else{if(data!=null){td.appendChild(document.createTextNode(data));}}}},_a3b&&_a3b.subRows);return put("div[role=gridcell]>",row);},renderHeader:function(){var grid=this,_a3d=this.columns,_a3e=this.headerNode,i=_a3e.childNodes.length;while(i--){put(_a3e.childNodes[i],"!");}var row=this.createRowCells("th[role=columnheader]",function(th,_a3f){var _a40=_a3f.headerNode=th;if(_a21){th=th.parentNode;}var _a41=_a3f.field;if(_a41){th.field=_a41;}if(_a3f.renderHeaderCell){_a23(_a40,_a3f.renderHeaderCell(_a40));}else{if(_a3f.label||_a3f.field){_a40.appendChild(document.createTextNode(_a3f.label||_a3f.field));}}if(_a3f.sortable!==false&&_a41&&_a41!="_item"){th.sortable=true;th.className+=" dgrid-sortable";}});this._rowIdToObject[row.id=this.id+"-header"]=this.columns;_a3e.appendChild(row);_a20(row,"click,keydown",function(_a42){if(_a42.type=="click"||_a42.keyCode==32){var _a43=_a42.target,_a44,_a45,_a46,sort;do{if(_a43.sortable){grid._sortNode=_a43;_a44=_a43.field||_a43.columnId;_a45=(sort=grid._sort[0])&&sort.attribute==_a44&&!sort.descending;return grid.set("sort",_a44,_a45);}}while((_a43=_a43.parentNode)&&_a43!=_a3e);}});},resize:function(){var _a47=this.headerNode.firstChild,_a48=this.contentNode,_a49;this.inherited(arguments);if(!has("ie")||(has("ie")>7&&!has("quirks"))){_a48.style.width="";if(_a48&&_a47){if((_a49=_a47.offsetWidth)!=_a48.offsetWidth){_a48.style.width=_a49+"px";}}}},destroy:function(){this._destroyColumns();this.inherited(arguments);},_setSort:function(_a4a,_a4b){this.inherited(arguments);if(this._lastSortedArrow){put(this._lastSortedArrow,"<!dgrid-sort-up!dgrid-sort-down");put(this._lastSortedArrow,"!");delete this._lastSortedArrow;}if(!this._sort[0]){return;}var prop=this._sort[0].attribute,desc=this._sort[0].descending,_a4c=this._sortNode,_a4d,_a4e,i;delete this._sortNode;if(!_a4c){_a4d=this.columns;for(i in _a4d){_a4e=_a4d[i];if(_a4e.field==prop){_a4c=_a4e.headerNode;break;}}}if(_a4c){_a4c=_a4c.contents||_a4c;this._lastSortedArrow=put(_a4c.firstChild,"-div.dgrid-sort-arrow.ui-icon[role=presentation]");this._lastSortedArrow.innerHTML="&nbsp;";put(_a4c,desc?".dgrid-sort-down":".dgrid-sort-up");this.resize();}},styleColumn:function(_a4f,css){return this.addCssRule("#"+this.domNode.id+" .dgrid-column-"+_a4f,css);},_configColumns:function(_a50,_a51){var _a52=[],_a53=_a51 instanceof Array,_a54,_a55;for(_a54 in _a51){_a55=_a51[_a54];if(typeof _a55=="string"){_a51[_a54]=_a55={label:_a55};}if(!_a53&&!_a55.field){_a55.field=_a54;}_a54=_a55.id=_a55.id||(isNaN(_a54)?_a54:(_a50+_a54));if(_a50){this.columns[_a54]=_a55;}if(this._configColumn){this._configColumn(_a55,_a54,_a51,_a50);}_a55.grid=this;if(typeof _a55.init==="function"){_a55.init();}_a52.push(_a55);}return _a53?_a51:_a52;},_destroyColumns:function(){var _a56=this.subRows.length,i,j,_a57;this.cleanup();for(i=0;i<_a56;i++){for(j=0,len=this.subRows[i].length;j<len;j++){_a57=this.subRows[i][j];if(typeof _a57.destroy==="function"){_a57.destroy();}}}},configStructure:function(){var _a58=this.subRows;if(_a58){this.columns={};for(var i=0;i<_a58.length;i++){_a58[i]=this._configColumns(i+"-",_a58[i]);}}else{this.subRows=[this._configColumns("",this.columns)];}},_setColumns:function(_a59){this._destroyColumns();this.subRows=null;this.columns=_a59;this._updateColumns();},_setSubRows:function(_a5a){this._destroyColumns();this.subRows=_a5a;this._updateColumns();},setColumns:function(_a5b){_a1e.deprecated("setColumns(...)","use set(\"columns\", ...) instead","dgrid 1.0");this.set("columns",_a5b);},setSubRows:function(_a5c){_a1e.deprecated("setSubRows(...)","use set(\"subRows\", ...) instead","dgrid 1.0");this.set("subRows",_a5c);},_updateColumns:function(){this.configStructure();this.renderHeader();this.refresh();this._lastCollection&&this.renderArray(this._lastCollection);this.resize();}});Grid.appendIfNode=_a23;Grid.defaultRenderCell=function(_a5d,data,td,_a5e){if(data!=null){td.appendChild(document.createTextNode(data));}};return Grid;});},"epi/shell/widget/SuggestionBox":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-attr","dijit/_HasDropDown","dijit/form/_ComboBoxMenu","dijit/form/_AutoCompleterMixin","epi/shell/widget/SearchBox"],function(_a5f,lang,_a60,_a61,_a62,_a63,_a64){return _a5f("epi.shell.widget.SuggestionBox",[_a64,_a61,_a63],{dropDownClass:_a62,buildRendering:function(){this.inherited(arguments);_a60.set(this.textbox,"autocomplete","off");_a60.set(this.textbox,"aria-haspopup","true");},postCreate:function(){this.inherited(arguments);this.connect(this.clearButton,"onclick",lang.hitch(this,function(){this.closeDropDown();}));}});});},"dojo/colors":function(){define(["./_base/kernel","./_base/lang","./_base/Color","./_base/array"],function(dojo,lang,_a65,_a66){var _a67=lang.getObject("dojo.colors",true);var _a68=function(m1,m2,h){if(h<0){++h;}if(h>1){--h;}var h6=6*h;if(h6<1){return m1+(m2-m1)*h6;}if(2*h<1){return m2;}if(3*h<2){return m1+(m2-m1)*(2/3-h)*6;}return m1;};dojo.colorFromRgb=_a65.fromRgb=function(_a69,obj){var m=_a69.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(m){var c=m[2].split(/\s*,\s*/),l=c.length,t=m[1],a;if((t=="rgb"&&l==3)||(t=="rgba"&&l==4)){var r=c[0];if(r.charAt(r.length-1)=="%"){a=_a66.map(c,function(x){return parseFloat(x)*2.56;});if(l==4){a[3]=c[3];}return _a65.fromArray(a,obj);}return _a65.fromArray(c,obj);}if((t=="hsl"&&l==3)||(t=="hsla"&&l==4)){var H=((parseFloat(c[0])%360)+360)%360/360,S=parseFloat(c[1])/100,L=parseFloat(c[2])/100,m2=L<=0.5?L*(S+1):L+S-L*S,m1=2*L-m2;a=[_a68(m1,m2,H+1/3)*256,_a68(m1,m2,H)*256,_a68(m1,m2,H-1/3)*256,1];if(l==4){a[3]=c[3];}return _a65.fromArray(a,obj);}}return null;};var _a6a=function(c,low,high){c=Number(c);return isNaN(c)?high:c<low?low:c>high?high:c;};_a65.prototype.sanitize=function(){var t=this;t.r=Math.round(_a6a(t.r,0,255));t.g=Math.round(_a6a(t.g,0,255));t.b=Math.round(_a6a(t.b,0,255));t.a=_a6a(t.a,0,1);return this;};_a67.makeGrey=_a65.makeGrey=function(g,a){return _a65.fromArray([g,g,g,a]);};lang.mixin(_a65.named,{"aliceblue":[240,248,255],"antiquewhite":[250,235,215],"aquamarine":[127,255,212],"azure":[240,255,255],"beige":[245,245,220],"bisque":[255,228,196],"blanchedalmond":[255,235,205],"blueviolet":[138,43,226],"brown":[165,42,42],"burlywood":[222,184,135],"cadetblue":[95,158,160],"chartreuse":[127,255,0],"chocolate":[210,105,30],"coral":[255,127,80],"cornflowerblue":[100,149,237],"cornsilk":[255,248,220],"crimson":[220,20,60],"cyan":[0,255,255],"darkblue":[0,0,139],"darkcyan":[0,139,139],"darkgoldenrod":[184,134,11],"darkgray":[169,169,169],"darkgreen":[0,100,0],"darkgrey":[169,169,169],"darkkhaki":[189,183,107],"darkmagenta":[139,0,139],"darkolivegreen":[85,107,47],"darkorange":[255,140,0],"darkorchid":[153,50,204],"darkred":[139,0,0],"darksalmon":[233,150,122],"darkseagreen":[143,188,143],"darkslateblue":[72,61,139],"darkslategray":[47,79,79],"darkslategrey":[47,79,79],"darkturquoise":[0,206,209],"darkviolet":[148,0,211],"deeppink":[255,20,147],"deepskyblue":[0,191,255],"dimgray":[105,105,105],"dimgrey":[105,105,105],"dodgerblue":[30,144,255],"firebrick":[178,34,34],"floralwhite":[255,250,240],"forestgreen":[34,139,34],"gainsboro":[220,220,220],"ghostwhite":[248,248,255],"gold":[255,215,0],"goldenrod":[218,165,32],"greenyellow":[173,255,47],"grey":[128,128,128],"honeydew":[240,255,240],"hotpink":[255,105,180],"indianred":[205,92,92],"indigo":[75,0,130],"ivory":[255,255,240],"khaki":[240,230,140],"lavender":[230,230,250],"lavenderblush":[255,240,245],"lawngreen":[124,252,0],"lemonchiffon":[255,250,205],"lightblue":[173,216,230],"lightcoral":[240,128,128],"lightcyan":[224,255,255],"lightgoldenrodyellow":[250,250,210],"lightgray":[211,211,211],"lightgreen":[144,238,144],"lightgrey":[211,211,211],"lightpink":[255,182,193],"lightsalmon":[255,160,122],"lightseagreen":[32,178,170],"lightskyblue":[135,206,250],"lightslategray":[119,136,153],"lightslategrey":[119,136,153],"lightsteelblue":[176,196,222],"lightyellow":[255,255,224],"limegreen":[50,205,50],"linen":[250,240,230],"magenta":[255,0,255],"mediumaquamarine":[102,205,170],"mediumblue":[0,0,205],"mediumorchid":[186,85,211],"mediumpurple":[147,112,219],"mediumseagreen":[60,179,113],"mediumslateblue":[123,104,238],"mediumspringgreen":[0,250,154],"mediumturquoise":[72,209,204],"mediumvioletred":[199,21,133],"midnightblue":[25,25,112],"mintcream":[245,255,250],"mistyrose":[255,228,225],"moccasin":[255,228,181],"navajowhite":[255,222,173],"oldlace":[253,245,230],"olivedrab":[107,142,35],"orange":[255,165,0],"orangered":[255,69,0],"orchid":[218,112,214],"palegoldenrod":[238,232,170],"palegreen":[152,251,152],"paleturquoise":[175,238,238],"palevioletred":[219,112,147],"papayawhip":[255,239,213],"peachpuff":[255,218,185],"peru":[205,133,63],"pink":[255,192,203],"plum":[221,160,221],"powderblue":[176,224,230],"rosybrown":[188,143,143],"royalblue":[65,105,225],"saddlebrown":[139,69,19],"salmon":[250,128,114],"sandybrown":[244,164,96],"seagreen":[46,139,87],"seashell":[255,245,238],"sienna":[160,82,45],"skyblue":[135,206,235],"slateblue":[106,90,205],"slategray":[112,128,144],"slategrey":[112,128,144],"snow":[255,250,250],"springgreen":[0,255,127],"steelblue":[70,130,180],"tan":[210,180,140],"thistle":[216,191,216],"tomato":[255,99,71],"turquoise":[64,224,208],"violet":[238,130,238],"wheat":[245,222,179],"whitesmoke":[245,245,245],"yellowgreen":[154,205,50]});return _a65;});},"epi/shell/_HierarchicalModelMixin":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred"],function(_a6b,lang,_a6c){return _a6b([],{parentProperty:"parentLink",store:null,stopAtSubRoot:false,constructor:function(_a6d){_a6b.safeMixin(this,_a6d);},getParentIdentity:function(item){return lang.getObject(this.parentProperty,false,item);},getAncestors:function(item,_a6e){if(!this.store){_a6e([]);return;}var obj=typeof item==="object"?item:this.store.get(item);_a6c.when(obj,lang.hitch(this,function(_a6f){_a6c.when(this._getAncestors([_a6f]),_a6e);}));},_getAncestors:function(_a70){if(this.stopAtSubRoot&&this.root&&this.getIdentity&&this.getIdentity(_a70[0])==this.root){return _a70.slice(0,-1);}var _a71=this.getParentIdentity(_a70[0]);if(!_a71){return _a70.slice(0,-1);}return _a6c.when(this.store.get(_a71),lang.hitch(this,function(_a72){if(_a72){_a70.unshift(_a72);return this._getAncestors(_a70);}return _a70.slice(0,-1);}));}});});},"epi/cms/contentediting/ContentDetails":function(){define(["dojo","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/url","dojo/_base/window","dojo/dom-style","dojo/dom-construct","dojo/on","dojo/topic","dijit/_TemplatedMixin","dijit/_WidgetBase","dijit/_WidgetsInTemplateMixin","epi","epi/shell/widget/_ModelBindingMixin","epi/shell/command/builder/MenuBuilder","epi/shell/command/builder/MenuAssembler","epi/i18n!epi/cms/nls/episerver.cms.contentediting.contentdetails","dojo/text!./templates/ContentDetails.html"],function(dojo,_a73,_a74,lang,url,win,_a75,_a76,on,_a77,_a78,_a79,_a7a,epi,_a7b,_a7c,_a7d,res,_a7e){return _a74("epi.cms.contentediting.ContentDetails",[_a79,_a78,_a7a,_a7b],{templateString:_a7e,_setContentTypeNameAttr:{node:"typeNode",type:"innerHTML"},_setContentIdAttr:{node:"idNode",type:"innerHTML"},_setExistingLanguagesAttr:function(_a7f){this.languagesNode.innerHTML="";_a73.forEach(_a7f,lang.hitch(this,function(item,idx){var elm,_a80=idx===_a7f.length-1;if(item.isCurrentLanguage){elm=_a76.create("span",{innerHTML:item.text});}else{var url=new dojo._Url(window.top.location.href);elm=_a76.create("a",{innerHTML:item.text,href:[url.scheme,"://",url.authority,url.path,"?language=",item.text,"#context=epi.cms.contentdata:///",item.contentLink].join(""),"class":"epi-visibleLink"});}_a76.place(elm,this.languagesNode);if(!_a80){_a76.place(win.doc.createTextNode(", "),this.languagesNode);}}));},_setVisibleToAttr:function(_a81){this.visibleToNode.innerHTML=_a81?res.visibleto.everyone:res.visibleto.restricted;},_setManageAccessRightsVisibleAttr:function(_a82){_a75.set(this.manageAccessRightsButton.domNode,"display",_a82?"":"none");},resources:null,modelBindingMap:{"contentTypeName":["contentTypeName"],"contentId":["contentId"],"existingLanguages":["existingLanguages"],"visibleToEveryOne":["visibleTo"]},_menuAssembler:null,postMixInProperties:function(){this.inherited(arguments);this.resources=dojo.mixin({},epi.resources.action,res);},postCreate:function(){this.inherited(arguments);var _a83=new _a7c();this._menuAssembler=new _a7d({configuration:[{builder:_a83,target:this.additionalActionsMenu}],commandSource:this.model});},_setModelAttr:function(){this.inherited(arguments);if(this._menuAssembler){this._menuAssembler.set("commandSource",this.model);}this.set("manageAccessRightsVisible",this.model&&this.model.accessRightsCommand&&this.model.accessRightsCommand.canExecute);},_onManageAccessRightsClick:function(){if(this.model&&this.model.accessRightsCommand){this.model.accessRightsCommand.execute();}}});});},"epi/shell/widget/Tree":function(){define(["dojo","dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dijit/Tree"],function(dojo,_a84,lang,_a85,Tree){return _a84("epi.shell.widget.Tree",Tree,{postCreate:function(){this.inherited(arguments);this.connect(this.model,"onItemChildrenReload","_onChildrenReload");},_onChildrenReload:function(_a86){var _a87=this.model,_a88=_a87.getIdentity(_a86),_a89=this._itemNodesMap[_a88];if(_a89){if(_a85.some(_a89,function(node){return node.state==="LOADED";})){this.model.getChildren(_a86,lang.hitch(this,function(_a8a){_a85.forEach(_a89,function(_a8b){_a8b.setChildItems(_a8a);});_a85.forEach(_a8a,function(_a8c){this.model.onChange(_a8c);this._onChildrenReload(_a8c);},this);}));}else{_a85.forEach(_a89,function(node){if(this.model.mayHaveChildren(node.item)){node.makeExpandable();}},this);}}}});});},"epi/cms/contentediting/ContentActionSupport":function(){define("epi/cms/contentediting/ContentActionSupport",["epi/i18n!epi/cms/nls/episerver.cms.versionstatus"],function(res){var _a8d=[];if(res){_a8d=[res.notcreated,res.rejected,res.checkedout,res.checkedin,res.published,res.previouslypublished,res.delayedpublish,res.expired];}var _a8e={versionStatus:{NotCreated:0,Rejected:1,CheckedOut:2,CheckedIn:3,Published:4,PreviouslyPublished:5,DelayedPublish:6,Expired:7},versionLocalizations:_a8d,getVersionStatus:function(_a8f){return this.versionLocalizations[_a8f];},action:{Create:"Create",Edit:"Edit",Delete:"Delete",CheckIn:"CheckIn",Save:"Save",Reject:"Reject",Publish:"Publish",Administer:"Administer"},accessLevel:{NoAccess:0,Read:1,Create:2,Edit:4,CheckIn:4,Delete:8,Publish:16,Administer:32,FullAccess:63},saveAction:{None:0,Save:1,CheckIn:2,Publish:3,Reject:4,ForceNewVersion:128,ForceCurrentVersion:256,SkipValidation:512,DelayedPublish:1024},sortOrder:{None:0,CreatedDescending:1,CreatedAscending:2,Alphabetical:3,Index:4,ChangedDescending:5,Rank:6,PublishedAscending:7,PublishedDescending:8},providerCapabilities:{None:0,Create:1,Edit:2,Delete:4,Move:8,Copy:16,MultiLanguage:32,Security:64,Search:128,PageFolder:256},isActionAvailable:function(_a90,_a91,_a92,_a93){if(!_a90){return false;}if(!_a93&&_a90.capabilities&&_a90.capabilities.language&&_a90.missingLanguageBranch&&_a90.missingLanguageBranch.isTranslationNeeded){return false;}var _a94=_a8e.hasAccess(_a90.accessMask,_a8e.accessLevel[_a91])&&_a8e.canPerformAction(_a90,_a91);if(_a92){_a94=_a94&&_a8e.hasProviderCapability(_a90.providerCapabilityMask,_a92);}return _a94;},canPerformAction:function(_a95,_a96){if(_a95.status===_a8e.versionStatus.DelayedPublish&&(_a96===_a8e.action.Edit||_a96===_a8e.action.Publish)){return false;}if(_a96===_a8e.action.Publish){return !(_a95.status===_a8e.versionStatus.Published||_a95.status===_a8e.versionStatus.Expired);}if(_a96===_a8e.action.CheckIn){return _a95.status===_a8e.versionStatus.CheckedOut||_a95.status===_a8e.versionStatus.Rejected;}if(_a96===_a8e.action.Edit){var _a97=(_a95.status===_a8e.versionStatus.Published&&!_a95.isCommonDraft)||(_a95.status===_a8e.versionStatus.Expired&&!_a95.isCommonDraft)||_a95.status===_a8e.versionStatus.PreviouslyPublished||_a95.status===_a8e.versionStatus.CheckedIn||_a95.status===_a8e.versionStatus.DelayedPublish;return !(_a97||_a95.isDeleted||_a95.isWastebasket);}return true;},hasAccess:function(_a98,_a99){return (_a98&_a99)==_a99;},getPermissionMap:function(_a9a){var map={};for(var al in _a8e.accessLevel){map[al]=_a8e.hasAccess(_a9a,_a8e.accessLevel[al]);}return map;},hasProviderCapability:function(_a9b,_a9c){return (_a9b&_a9c)==_a9c;}};return _a8e;});},"epi/shell/dnd/_MarkerSource":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/dnd/Manager","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style"],function(_a9d,_a9e,_a9f,_aa0,_aa1,_aa2,_aa3){return _a9e(null,{_markerNode:null,markerTemplateString:"<div class=\"dojoDndItem-marker\"><div class=\"epi-dndDropMarker\"></div></div>",markerDelay:150,markOnlyAllowedDropLocations:false,_calculatedCurrent:false,destroy:function(){this.inherited(arguments);this.targetAnchorSibling=null;if(this._markerNode){_aa1.destroy(this._markerNode);this._markerNode=null;}},setHorizontal:function(_aa4){_aa0.toggle(this.node,"dojoDndHorizontal",_aa4);this.horizontal=_aa4;},onMouseOver:function(e){this.inherited(arguments);this._calculatedCurrent=false;},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}dojo.dnd.Source.superclass.onMouseMove.call(this,e);var m=_a9f.manager();if(!this.isDragging){if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)){var _aa5=this.getSelectedNodes();if(_aa5.length){m.startDrag(this,_aa5,this.copyState(dojo.isCopyKey(e),true));}}}if(this.isDragging){var _aa6=false;if(this.current&&!this._calculatedCurrent){if(!this.targetBox||this.targetAnchor!=this.current){this.targetBox=_aa2.position(this.current,true);}if(this.horizontal){_aa6=(e.pageX-this.targetBox.x)<(this.targetBox.w/2);}else{_aa6=(e.pageY-this.targetBox.y)<(this.targetBox.h/2);}}else{_aa6=this._calculateCurrent({x:e.pageX,y:e.pageY});}if(this.current!=this.targetAnchor||_aa6!=this.before){this._markTargetAnchor(_aa6);m.canDrop(!this.current||m.source!=this||!this.markOnlyAllowedDropLocations||!(this.current.id in this.selection));}}},_calculateCurrent:function(_aa7){var _aa8=[],_aa9,_aaa;function _aab(_aac,_aad){function _aae(_aaf){return _aaf*_aaf;};return Math.sqrt(_aae(_aac.x-_aad.x)+_aae(_aac.y-_aad.y));};this.getAllNodes().forEach(function(node){var pos=_aa2.position(node);pos.x2=pos.x+pos.w;pos.xCentered=pos.x+pos.w/2;pos.y2=pos.y+pos.h;pos.yCentered=pos.y+pos.h/2;if(this.horizontal){_aa8.push({node:node,before:true,x:pos.x,y:pos.yCentered},{node:node,before:false,x:pos.x2,y:pos.yCentered});}else{_aa8.push({node:node,before:true,x:pos.xCentered,y:pos.y},{node:node,before:false,x:pos.xCentered,y:pos.y2});}},this);_a9d.forEach(_aa8,function(_ab0){_ab0.distance=_aab(_aa7,_ab0);if(!_aa9||_ab0.distance<_aaa){_aa9=_ab0;_aaa=_ab0.distance;}},this);if(_aa9){this.current=_aa9.node;this._calculatedCurrent=true;return _aa9.before;}return false;},_markTargetAnchor:function(_ab1){var _ab2=true,_ab3=true;if(this.current===this.targetAnchor&&this.before===_ab1){return;}if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}if(this.targetAnchorSibling){this._removeItemClass(this.targetAnchorSibling,!this.before?"Before":"After");}this.targetAnchor=this.current;this.targetBox=null;this.before=_ab1;if(this.targetAnchor){this.targetAnchorSibling=_ab1?this.targetAnchor.previousSibling:this.targetAnchor.nextSibling;if(!(this.targetAnchorSibling&&this.targetAnchorSibling.nodeType===1&&_aa0.contains(this.targetAnchorSibling,"dojoDndItem"))){this.targetAnchorSibling=null;}if(this.markOnlyAllowedDropLocations){_ab2=!(this.targetAnchor.id in this.selection);_ab3=!this.targetAnchorSibling||!(this.targetAnchorSibling.id in this.selection);}if(_ab2&&_ab3){this._addItemClass(this.targetAnchor,this.before?"Before":"After");}if(this.targetAnchorSibling&&_ab2&&_ab3){this._addItemClass(this.targetAnchorSibling,!this.before?"Before":"After");}this._positionMarker(_ab2&&_ab3);}else{this._positionMarker(false);}},_unmarkTargetAnchor:function(){if(this.targetAnchor){this._removeItemClass(this.targetAnchor,this.before?"Before":"After");}if(this.targetAnchorSibling){this._removeItemClass(this.targetAnchorSibling,!this.before?"Before":"After");}this._positionMarker(false);this.targetAnchor=this.targetAnchorSibling=this.targetBox=null;this.before=true;},_positionMarker:function(_ab4){var _ab5=this._markerNode,_ab6,_ab7,_ab8,_ab9,top,left,_aba,gap=-1;if(_ab4){_ab6=_aa2.position(this.targetAnchor,false);_ab7=this.targetAnchorSibling?_aa2.position(this.targetAnchorSibling,false):{h:0,w:0};_ab8=_aa2.position(this.node,false);if(this.horizontal){if(this.before){left=_ab6.x-_ab8.x;if(this.targetAnchorSibling){gap=(_ab6.x-_ab7.x-_ab7.w)/2;}if(gap>=0){left-=gap;}}else{left=_ab6.x+_ab6.w-_ab8.x;if(this.targetAnchorSibling){gap=(_ab7.x-_ab6.x-_ab6.w)/2;}if(gap>=0){left+=gap;}}_aba=gap>=0?Math.max(_ab6.h,_ab7.h):_ab6.h;_ab9={display:"block",top:_ab6.y-_ab8.y+"px",left:left+"px",height:_aba+"px"};}else{if(this.before){top=_ab6.y-_ab8.y;if(this.targetAnchorSibling){gap=(_ab6.y-_ab7.y-_ab7.h)/2;}if(gap>=0){top-=gap;}}else{top=_ab6.y+_ab6.h-_ab8.y;if(this.targetAnchorSibling){gap=(_ab7.x-_ab6.x-_ab6.w)/2;}if(gap>=0){top-=gap;}}width=gap>=0?Math.max(_ab6.w,_ab7.w):_ab6.w;_ab9={display:"block",top:top+"px",width:width+"px"};}}else{_ab9={display:"none"};}if(!_ab5){_ab5=this._markerNode=_aa1.place(this.markerTemplateString,this.node);_aa3.set(_ab5,_ab9);}else{setTimeout(function(){_aa3.set(_ab5,_ab9);},this.markerDelay);}}});});},"epi/shell/SearchManager":function(){define(["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/array","dojo/_base/lang","dojo/DeferredList","epi/dependency"],function(_abb,_abc,_abd,lang,_abe,_abf){return _abb("epi.shell.SearchManager",null,{_providersStore:null,_resultsStore:null,constructor:function(){this._setupStores();},getProviderQuery:function(area){var _ac0=new _abc();_abc.when(this.getProviders(area),dojo.hitch(this,function(_ac1){if(_ac1&&_ac1.length>0){_ac0.resolve(this._getQuery(_ac1[0],{}));}else{_ac0.resolve();}}));return _ac0;},getProviders:function(area){var _ac2=new _abc();_abc.when(this._providersStore.query({searchArea:area}),function(_ac3){if(_ac3&&_ac3.length>0){_ac2.resolve(_ac3);}else{_ac2.resolve();}});return _ac2;},getStore:function(){return this._resultsStore;},search:function(area,_ac4){var _ac5=new _abc();_abc.when(this.getProviders(area),lang.hitch(this,function(_ac6){if(_ac6&&_ac6.length>0){var _ac7=[];_abd.forEach(_ac6,function(_ac8,_ac9){_ac7.push(this._getData(_ac8,_ac4));},this);var _aca=new _abe(_ac7),data=[];_aca.then(function(_acb){_abd.forEach(_acb,function(item){if(lang.isArray(item[1])){data=data.concat(item[1]);}});_ac5.resolve(data);});}}));return _ac5;},_setupStores:function(){var _acc=_abf.resolve("epi.storeregistry");this._providersStore=_acc.get("epi.shell.searchproviders");this._resultsStore=_acc.get("epi.shell.searchresults");},_getQuery:function(_acd,_ace){var _acf={providerId:_acd.id};lang.mixin(_acf,_ace||{});return _acf;},_getData:function(_ad0,_ad1){var _ad2=new _abc();_abc.when(this._resultsStore.query(this._getQuery(_ad0,_ad1)),function(_ad3){if(_ad3&&_ad3.length>0){_ad2.resolve(_ad3);}else{_ad2.resolve();}});return _ad2;}});});},"epi/cms/widget/_GridWidgetBase":function(){define("epi/cms/widget/_GridWidgetBase",["dojo","dojo/_base/lang","dojo/aspect","dojo/dom-construct","dgrid/Keyboard","dgrid/OnDemandGrid","dgrid/Selection","dijit","dijit/_WidgetBase","dijit/layout/_LayoutWidget","epi","epi/datetime","epi/UriParser","epi/username","epi/cms/_ContentContextMixin","epi/cms/core/ContentReference","epi/cms/dgrid/DnD","epi/dependency","epi/shell/dgrid/util/misc","epi/shell/widget/dialog/Alert"],function(dojo,lang,_ad4,_ad5,_ad6,_ad7,_ad8,_ad9,_ada,_adb,epi,_adc,_add,_ade,_adf,_ae0,DnD,_ae1,_ae2,_ae3){return dojo.declare("epi.cms.widget._GridWidgetBase",[_ada,_adb,_adf],{_gridClass:dojo.declare([_ad7,_ad8,DnD,_ad6]),storeKeyName:null,grid:null,store:null,ignoreVersionWhenComparingLinks:true,defaultGridMixin:null,_typeDescriptor:null,postMixInProperties:function(){this.inherited(arguments);this.defaultGridMixin={selectionMode:"single",selectionEvents:"click,dgrid-cellfocusin",dndParams:{creator:lang.hitch(this,this._dndNodeCreator),copyOnly:true,selfAccept:false,accept:[]}};var _ae4=_ae1.resolve("epi.cms.Application");this._typeDescriptor=_ae4.getTypeUIDescriptors();if(!this.store&&this.storeKeyName){var _ae5=_ae1.resolve("epi.storeregistry");this.store=_ae5.get(this.storeKeyName);}},startup:function(){this.inherited(arguments);this.grid.on("dgrid-select",dojo.hitch(this,this._onSelect));this.grid.on("dgrid-error",dojo.hitch(this,this._onError));_ad4.after(this.grid,"insertRow",dojo.hitch(this,this._selectActiveItem));},_onSelect:function(e){var row=e.rows[0],uri=row.data.uri,_ae6={uri:uri};if(this._isSameAsCurrentContext(uri)){return;}this._requestNewContext(_ae6,{sender:this});},_requestNewContext:function(_ae7,_ae8){dojo.publish("/epi/shell/context/request",[_ae7,_ae8]);},_isSameAsCurrentContext:function(uri){if(this.currentContext){return this._compareUris(uri,this.currentContext.uri);}else{return false;}},_compareUris:function(obj1,obj2){var uri1=new _add(obj1);var uri2=new _add(obj2);if(this.ignoreVersionWhenComparingLinks&&uri1.getType()==="epi.cms.contentdata"&&uri2.getType()==="epi.cms.contentdata"&&_ae0.compareIgnoreVersion(uri1.getId(),uri2.getId())){return true;}else{if(obj1===obj2){return true;}}return false;},_onError:function(_ae9){var _aea=this.grid.errorMessage;if(_ae9.status&&_ae9.status===403){_aea=epi.resources.messages.nopermissiontoviewdata;}this._showErrorMessage(_aea);},restore:function(){this.resize();},_selectActiveItem:function(node){var _aeb=this.currentContext,row=this.grid.row(node);if(!row){return node;}rowUri=row.data.uri;if(_aeb&&this._compareUris(rowUri,_aeb.uri)){this.grid.select(row,null);}return node;},contextChanged:function(_aec,_aed){this.inherited(arguments);if(_aec.type!=="epi.cms.contentdata"){return;}if(!_aed||_aed.sender!=this){this.onContextChanged();}},onContextChanged:function(){this.fetchData();},fetchData:function(){},_showErrorMessage:function(_aee){this.grid.cleanup();this.grid.contentNode.innerHTML=_aee;},contextChangeFailed:function(_aef,_af0,_af1){this.inherited(arguments);if(_af1&&_af1.sender===this){this._selectActiveItem();}},_localizeDate:function(_af2){return _adc.toUserFriendlyHtml(_af2);},_createUserFriendlyUsername:function(name){return _ade.toUserFriendlyHtml(name);},_renderContentItem:function(_af3,data,td,_af4){var _af5="epi-iconObjectPage";if(_af3.typeIdentifier){var _af6=this._typeDescriptor[_af3.typeIdentifier];if(_af6&&_af6.iconClass){_af5=_af6.iconClass;}}_ad5.place(_ae2.icon(_af5+" epi-objectIcon",_ae2.ellipsis(_ae2.htmlEncode(data))),td);},_dndNodeCreator:function(item,hint){var _af7;if(item.typeIdentifier){var _af8=this._typeDescriptor[item.typeIdentifier];if(_af8&&_af8.dndTypes){_af7=_af8.dndTypes;}}if(!_af7&&this.dndTypes){_af7=this.dndTypes;}node=_ad5.create("div").appendChild(document.createTextNode(item.name));return {"node":node,"type":_af7,"data":item};}});});},"dgrid/util/misc":function(){define("dgrid/util/misc",[],function(){var util={defaultDelay:15,throttle:function(cb,_af9,_afa){var ran=false;_afa=_afa||util.defaultDelay;return function(){if(ran){return;}ran=true;cb.apply(_af9,arguments);setTimeout(function(){ran=false;},_afa);};},throttleDelayed:function(cb,_afb,_afc){var ran=false;_afc=_afc||util.defaultDelay;return function(){if(ran){return;}ran=true;var a=arguments;setTimeout(function(){cb.apply(_afb,a);ran=false;},_afc);};},debounce:function(cb,_afd,_afe){var _aff;_afe=_afe||util.defaultDelay;return function(){if(_aff){clearTimeout(_aff);_aff=null;}var a=arguments;_aff=setTimeout(function(){cb.apply(_afd,a);},_afe);};}};return util;});},"epi/cms/contentediting/command/LanguageSettings":function(){define("epi/cms/contentediting/command/LanguageSettings",["dojo/_base/declare","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/command/_LegacyDialogCommandBase","epi/i18n!epi/cms/nls/episerver.cms.contentediting.contentdetails.command.languagesettings"],function(_b00,_b01,_b02,_b03){return _b00([_b02],{name:"LanguageSettings",label:_b03.label,tooltip:_b03.tooltip,dialogPath:"Edit/LanguageSettings.aspx",raiseCloseEvent:true,postscript:function(){this.inherited(arguments);this.set("canExecute",true);this.set("isAvailable",true);},_onModelChange:function(){var _b04=this.model.contentData,_b05=_b01.hasAccess(_b04.accessMask,_b01.accessLevel.Administer),_b06=this.model.canChangeContent();this.set("canExecute",_b04.capabilities.languageSettings&&_b05&&_b06);}});});},"url:epi/cms/component/templates/GlobalToolbar.html":"<div class=\"dijit epi-globalToolbar\" role=\"toolbar\" tabIndex=\"${tabIndex}\" data-dojo-attach-point=\"containerNode\">\r\n    <div class=\"epi-toolbarGroupContainer\">\r\n        <div data-dojo-attach-point=\"leadingContainerNode\" class=\"epi-toolbarLeading epi-toolbarGroup\"></div>\r\n        <div data-dojo-attach-point=\"centerContainerNode\" class=\"epi-toolbarCenter epi-toolbarGroup\"></div>\r\n        <div data-dojo-attach-point=\"trailingContainerNode\" class=\"epi-toolbarTrailing epi-toolbarGroup\"></div>\r\n    </div>\r\n</div>","epi/cms/widget/command/NewFolder":function(){define("epi/cms/widget/command/NewFolder",["dojo/_base/declare","epi/i18n!epi/cms/nls/episerver.cms.components.sharedblockscomponent","epi/i18n!epi/cms/nls/episerver.cms.components.createfolder","epi/shell/command/_Command","epi/shell/command/_SelectionCommandMixin","epi/cms/contentediting/ContentActionSupport"],function(_b07,_b08,_b09,_b0a,_b0b,_b0c){return _b07([_b0a,_b0b],{label:_b08.contextmenu.newfolder,iconClass:"epi-iconFolder",contentActionSupport:null,postscript:function(){this.inherited(arguments);this.contentActionSupport=this.contentActionSupport||_b0c;},_execute:function(){var _b0d=this._getTarget();this.model.add({parentLink:this.model.getIdentity(_b0d),name:_b09.defaultname,contentTypeId:_b0d.contentTypeID});},_onModelChange:function(){var _b0e=this._getTarget();var _b0f=this.model&&_b0e&&this.contentActionSupport.isActionAvailable(_b0e,_b0c.action.Create,true,true);this.set("canExecute",!!_b0f);},_getTarget:function(){var _b10=this.selection&&this.selection.data,_b11=_b10&&_b10.length==1&&_b10[0];return (_b11!=null)&&(_b11.type=="epi.cms.contentdata")?_b11.data:null;}});});},"epi/cms/component/Tasks":function(){require({cache:{"url:epi/cms/component/templates/Tasks.html":"<div>\r\n    <div class=\"epi-gadgetInnerToolbar\" data-dojo-attach-point=\"toolbar\">\r\n        <div data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"reloadButton\" data-dojo-attach-event=\"onClick: _reloadQuery\"\r\n            class=\"epi-chromelessButton epi-iconReload dijitInline dijitReset\">\r\n        </div>\r\n    </div>\r\n    <div data-dojo-type=\"epi.cms.component.ContentQueryGrid\" data-dojo-attach-point=\"contentQuery\">\r\n    </div>\r\n</div>\r\n"}});define("epi/cms/component/Tasks",["dojo","dojo/_base/declare","dojo/_base/array","dojo/dom-construct","dojo/dom-geometry","dijit/form/Select","dijit/_TemplatedMixin","dijit/_Container","dijit/layout/_LayoutWidget","dijit/_WidgetsInTemplateMixin","epi","epi/dependency","epi/cms/component/ContextHistory","epi/cms/component/ContentQueryGrid","dojo/text!./templates/Tasks.html","epi/i18n!epi/cms/nls/episerver.cms.components.tasks"],function(dojo,_b12,_b13,_b14,_b15,_b16,_b17,_b18,_b19,_b1a,epi,_b1b,_b1c,_b1d,_b1e,_b1f){return _b12("epi.cms.component.Tasks",[_b18,_b19,_b17,_b1a],{templateString:_b1e,resources:_b1f,querySelection:null,_selectionChangedEventHandler:null,postCreate:function(){this.inherited(arguments);var _b20=_b13.map(this.queries,function(item){return {label:item.displayName,value:item.name};},this);this.querySelection=new _b16({name:"QuerySelection",options:_b20});_b14.place(this.querySelection.domNode,this.reloadButton.domNode,"before");this._reloadQuery();this._selectionChangedEventHandler=this.querySelection.on("change",dojo.hitch(this,this._reloadQuery));},resize:function(_b21){this.inherited(arguments);this.contentQuery.resize(this._caculateContentQuerySize(_b21));},_caculateContentQuerySize:function(_b22){var _b23=_b15.getMarginBox(this.toolbar);return {w:_b22.w,h:_b22.h-_b23.h};},_reloadQuery:function(){var _b24=this.querySelection.get("value");_b13.some(this.queries,function(item,_b25){if(item.name==_b24){this.contentQuery.set("ignoreVersionWhenComparingLinks",!item.versionSpecific);return true;}},this);this.contentQuery.set("queryName",_b24);},uninitialize:function(){this._selectionChangedEventHandler.remove();}});});},"epi/cms/contentediting/command/Withdraw":function(){define(["dojo/_base/declare","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/command/_ChangeContentStatus","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons"],function(_b26,_b27,_b28,_b29){return _b26("epi.cms.contentediting.command.Withdraw",[_b28],{name:"withdraw",label:_b29.withdraw.label,tooltip:_b29.withdraw.title,iconClass:"epi-iconPen",action:_b27.action.Save,contentActionSupport:null,postscript:function(){this.inherited(arguments);this.contentActionSupport=this.contentActionSupport||_b27;},_execute:function(){return this.inherited(arguments);},_onModelChange:function(){this.inherited(arguments);var _b2a=this.model.contentData,_b2b=_b2a.status,_b2c=_b27.versionStatus,_b2d=this.contentActionSupport.isActionAvailable(_b2a,_b27.action.Create)&&!this.contentActionSupport.isActionAvailable(_b2a,_b27.action.Publish),_b2e=_b2d&&(_b2b==_b2c.CheckedIn);this.set("canExecute",_b2e);this.set("isAvailable",_b2e);}});});},"dojo/NodeList-manipulate":function(){define(["./query","./_base/lang","./_base/array","./dom-construct","./NodeList-dom"],function(_b2f,lang,_b30,_b31){var _b32=_b2f.NodeList;function _b33(node){var text="",ch=node.childNodes;for(var i=0,n;n=ch[i];i++){if(n.nodeType!=8){if(n.nodeType==1){text+=_b33(n);}else{text+=n.nodeValue;}}}return text;};function _b34(node){while(node.childNodes[0]&&node.childNodes[0].nodeType==1){node=node.childNodes[0];}return node;};function _b35(html,_b36){if(typeof html=="string"){html=_b31.toDom(html,(_b36&&_b36.ownerDocument));if(html.nodeType==11){html=html.childNodes[0];}}else{if(html.nodeType==1&&html.parentNode){html=html.cloneNode(false);}}return html;};lang.extend(_b32,{_placeMultiple:function(_b37,_b38){var nl2=typeof _b37=="string"||_b37.nodeType?_b2f(_b37):_b37;var _b39=[];for(var i=0;i<nl2.length;i++){var _b3a=nl2[i];var _b3b=this.length;for(var j=_b3b-1,item;item=this[j];j--){if(i>0){item=this._cloneNode(item);_b39.unshift(item);}if(j==_b3b-1){_b31.place(item,_b3a,_b38);}else{_b3a.parentNode.insertBefore(item,_b3a);}_b3a=item;}}if(_b39.length){_b39.unshift(0);_b39.unshift(this.length-1);Array.prototype.splice.apply(this,_b39);}return this;},innerHTML:function(_b3c){if(arguments.length){return this.addContent(_b3c,"only");}else{return this[0].innerHTML;}},text:function(_b3d){if(arguments.length){for(var i=0,node;node=this[i];i++){if(node.nodeType==1){_b31.empty(node);node.appendChild(node.ownerDocument.createTextNode(_b3d));}}return this;}else{var _b3e="";for(i=0;node=this[i];i++){_b3e+=_b33(node);}return _b3e;}},val:function(_b3f){if(arguments.length){var _b40=lang.isArray(_b3f);for(var _b41=0,node;node=this[_b41];_b41++){var name=node.nodeName.toUpperCase();var type=node.type;var _b42=_b40?_b3f[_b41]:_b3f;if(name=="SELECT"){var opts=node.options;for(var i=0;i<opts.length;i++){var opt=opts[i];if(node.multiple){opt.selected=(_b30.indexOf(_b3f,opt.value)!=-1);}else{opt.selected=(opt.value==_b42);}}}else{if(type=="checkbox"||type=="radio"){node.checked=(node.value==_b42);}else{node.value=_b42;}}}return this;}else{node=this[0];if(!node||node.nodeType!=1){return undefined;}_b3f=node.value||"";if(node.nodeName.toUpperCase()=="SELECT"&&node.multiple){_b3f=[];opts=node.options;for(i=0;i<opts.length;i++){opt=opts[i];if(opt.selected){_b3f.push(opt.value);}}if(!_b3f.length){_b3f=null;}}return _b3f;}},append:function(_b43){return this.addContent(_b43,"last");},appendTo:function(_b44){return this._placeMultiple(_b44,"last");},prepend:function(_b45){return this.addContent(_b45,"first");},prependTo:function(_b46){return this._placeMultiple(_b46,"first");},after:function(_b47){return this.addContent(_b47,"after");},insertAfter:function(_b48){return this._placeMultiple(_b48,"after");},before:function(_b49){return this.addContent(_b49,"before");},insertBefore:function(_b4a){return this._placeMultiple(_b4a,"before");},remove:_b32.prototype.orphan,wrap:function(html){if(this[0]){html=_b35(html,this[0]);for(var i=0,node;node=this[i];i++){var _b4b=this._cloneNode(html);if(node.parentNode){node.parentNode.replaceChild(_b4b,node);}var _b4c=_b34(_b4b);_b4c.appendChild(node);}}return this;},wrapAll:function(html){if(this[0]){html=_b35(html,this[0]);this[0].parentNode.replaceChild(html,this[0]);var _b4d=_b34(html);for(var i=0,node;node=this[i];i++){_b4d.appendChild(node);}}return this;},wrapInner:function(html){if(this[0]){html=_b35(html,this[0]);for(var i=0;i<this.length;i++){var _b4e=this._cloneNode(html);this._wrap(lang._toArray(this[i].childNodes),null,this._NodeListCtor).wrapAll(_b4e);}}return this;},replaceWith:function(_b4f){_b4f=this._normalize(_b4f,this[0]);for(var i=0,node;node=this[i];i++){this._place(_b4f,node,"before",i>0);node.parentNode.removeChild(node);}return this;},replaceAll:function(_b50){var nl=_b2f(_b50);var _b51=this._normalize(this,this[0]);for(var i=0,node;node=nl[i];i++){this._place(_b51,node,"before",i>0);node.parentNode.removeChild(node);}return this;},clone:function(){var ary=[];for(var i=0;i<this.length;i++){ary.push(this._cloneNode(this[i]));}return this._wrap(ary,this,this._NodeListCtor);}});if(!_b32.prototype.html){_b32.prototype.html=_b32.prototype.innerHTML;}return _b32;});},"epi/cms/store/PageVersionQueryEngine":function(){define(["dojo/_base/array","epi/cms/core/ContentReference"],function(_b52,_b53){return function(_b54,_b55){switch(typeof _b54){case "object":case "undefined":var _b56=_b54;_b54=function(_b57){for(var key in _b56){var _b58,_b59=_b56[key],_b5a=_b59.toString();if(_b5a.indexOf("_")>=0){_b58=new _b53(_b5a);_b59=RegExp("^"+_b58.id+"_.*$");}if(_b59&&_b59.test){if(!_b59.test(_b57[key])){return false;}}else{if(_b59!=_b57[key]){return false;}}}return true;};break;case "string":if(!this[_b54]){throw new Error("No filter function "+_b54+" was found in store");}_b54=this[_b54];break;case "function":break;default:throw new Error("Can not query with a "+typeof _b54);}function _b5b(_b5c){var _b5d=_b52.filter(_b5c,_b54);if(_b55&&_b55.sort){_b5d.sort(function(a,b){for(var sort,i=0;sort=_b55.sort[i];i++){var _b5e=a[sort.attribute];var _b5f=b[sort.attribute];if(_b5e!=_b5f){return sort.descending==(_b5e>_b5f)?-1:1;}}return 0;});}if(_b55&&(_b55.start||_b55.count)){var _b60=_b5d.length;_b5d=_b5d.slice(_b55.start||0,(_b55.start||0)+(_b55.count||Infinity));_b5d.total=_b60;}return _b5d;};_b5b.matches=_b54;return _b5b;};});},"epi/cms/command/ReloadContent":function(){define("epi/cms/command/ReloadContent",["dojo/_base/declare","dojo/_base/array","dojo/_base/connect","dojo/_base/Deferred","dojo/topic","epi/cms/core/ContentReference","epi/dependency","epi/UriParser","epi/shell/_HierarchicalModelMixin","epi/shell/command/_Command"],function(_b61,_b62,_b63,_b64,_b65,_b66,_b67,_b68,_b69,_b6a){return _b61([_b6a,_b69],{forceReloadCurrentContent:false,constructor:function(){var _b6b=_b67.resolve("epi.storeregistry");this.store=_b6b.get("epi.cms.content.light");this._application=_b67.resolve("epi.cms.Application");this._hashWrapper=_b67.resolve("epi.shell.HashWrapper");this.set("canExecute",this.forceReloadCurrentContent);},_execute:function(){var self=this,_b6c,uri=new _b68(self._hashWrapper.getHash().context),_b6d=new _b66(uri.getId()),_b6e=_b6d.id,_b6f=self._application.getStartPage();if(self.forceReloadCurrentContent===true){_b6c=_b6e;}else{if(_b6d.providerName.length===0){if(_b6e==self.model.contentData.contentLink){_b6c=_b6f;}else{var _b70=self.model.get("pageReferences").concat(self.model.get("blockReferences"));_b62.some(_b70,function(ref,_b71){if(_b6e==ref.ownerID){_b6c=ref.ownerID;return true;}});if(!_b6c){self.getAncestors(_b6e,function(_b72){_b62.some(_b72,function(_b73,_b74){if(self.model.contentData.contentLink==_b73.contentLink){_b6c=_b6f;return true;}});});}}}else{if(_b6d.toString()==self.model.contentData.contentLink){_b6c=_b6f;}}}if(_b6c){var _b75={uri:"epi.cms.contentdata:///"+_b6c},_b76=_b6c==_b6f,_b77=_b76?{sender:this,forceContextChange:true}:{sender:this,forceContextChange:true,trigger:"internal"};_b65.publish("/epi/shell/context/request",_b75,_b77);}},_onModelChange:function(){var _b78=(this.model!=null)||this.forceReloadCurrentContent;this.set("canExecute",!!_b78);}});});},"epi/cms/component/command/SetCommonDraft":function(){define("epi/cms/component/command/SetCommonDraft",["dojo/_base/declare","epi/cms/contentediting/ContentActionSupport","epi/dependency","epi/i18n!epi/cms/nls/episerver.cms.components.versions","epi/shell/command/_Command"],function(_b79,_b7a,_b7b,_b7c,_b7d){return _b79([_b7d],{label:_b7c.setcommondraftitemtitle,iconClass:"epi-iconPrimary",category:"context",constructor:function(){var _b7e=_b7b.resolve("epi.storeregistry");this.store=_b7e.get("epi.cms.contentversion");},_execute:function(){var self=this;return this.store.patch({isCommonDraft:true,contentLink:this.model.contentLink},{id:this.model.contentLink}).then(function(item){return self.store.patchCache(item);});},_onModelChange:function(){var _b7f=this.model,_b80=_b7a.versionStatus,_b81=_b7f&&!_b7f.isCommonDraft&&(_b7f.status==_b80.CheckedOut||_b7f.status==_b80.Rejected);this.set("canExecute",_b81);}});});},"url:epi/cms/component/templates/FileManagement.html":"<div style=\"position: relative;\">\r\n    <iframe frameborder=\"0\" data-dojo-attach-point=\"containerIframe\" style=\"display: block; width: 100%; height: 100%\"></iframe>\r\n    <div data-dojo-attach-point=\"dndItemOverlay\" style=\"display: none; overflow:hidden; position: absolute; background: rgba(0, 0, 0, 0.01);\"></div>\r\n    <div data-dojo-attach-point=\"dndIFrameOverlay\" style=\"display: none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.01);\"></div>\r\n</div>","dojox/form/uploader/plugins/Flash":function(){define("dojox/form/uploader/plugins/Flash",["dojo/dom-form","dojo/dom-style","dojo/dom-construct","dojo/dom-attr","dojo/_base/declare","dojo/_base/config","dojo/_base/connect","dojo/_base/lang","dojo/_base/array","dojox/form/uploader/plugins/HTML5","dojox/embed/Flash"],function(_b82,_b83,_b84,_b85,_b86,_b87,_b88,lang,_b89,_b8a,_b8b){var _b8c=_b86("dojox.form.uploader.plugins.Flash",[],{swfPath:_b87.uploaderPath||require.toUrl("dojox/form/resources/uploader.swf"),skipServerCheck:true,serverTimeout:2000,isDebug:false,devMode:false,deferredUploading:0,force:"",postMixInProperties:function(){if(!this.supports("multiple")){this.uploadType="flash";this._files=[];this._fileMap={};this._createInput=this._createFlashUploader;this.getFileList=this.getFlashFileList;this.reset=this.flashReset;this.upload=this.uploadFlash;this.fieldname="flashUploadFiles";}this.inherited(arguments);},onReady:function(_b8d){},onLoad:function(_b8e){},onFileChange:function(_b8f){},onFileProgress:function(_b90){},getFlashFileList:function(){return this._files;},flashReset:function(){this.flashMovie.reset();this._files=[];},uploadFlash:function(_b91){this.onBegin(this.getFileList());this.flashMovie.doUpload(_b91);},_change:function(_b92){this._files=this._files.concat(_b92);_b89.forEach(_b92,function(f){f.bytesLoaded=0;f.bytesTotal=f.size;this._fileMap[f.name+"_"+f.size]=f;},this);this.onChange(this._files);this.onFileChange(_b92);},_complete:function(_b93){var o=this._getCustomEvent();o.type="load";this.onComplete(_b93);},_progress:function(f){this._fileMap[f.name+"_"+f.bytesTotal].bytesLoaded=f.bytesLoaded;var o=this._getCustomEvent();this.onFileProgress(f);this.onProgress(o);},_error:function(err){this.onError(err);},_onFlashBlur:function(_b94){},_getCustomEvent:function(){var o={bytesLoaded:0,bytesTotal:0,type:"progress",timeStamp:new Date().getTime()};for(var nm in this._fileMap){o.bytesTotal+=this._fileMap[nm].bytesTotal;o.bytesLoaded+=this._fileMap[nm].bytesLoaded;}o.decimal=o.bytesLoaded/o.bytesTotal;o.percent=Math.ceil((o.bytesLoaded/o.bytesTotal)*100)+"%";return o;},_connectFlash:function(){this._subs=[];this._cons=[];var _b95=lang.hitch(this,function(s,_b96){this._subs.push(_b88.subscribe(this.id+s,this,_b96));});_b95("/filesSelected","_change");_b95("/filesUploaded","_complete");_b95("/filesProgress","_progress");_b95("/filesError","_error");_b95("/filesCanceled","onCancel");_b95("/stageBlur","_onFlashBlur");this.connect(this.domNode,"focus",function(){this.flashMovie.focus();this.flashMovie.doFocus();});if(this.tabIndex>=0){_b85.set(this.domNode,"tabIndex",this.tabIndex);}},_createFlashUploader:function(){var url=this.getUrl();if(url){if(url.toLowerCase().indexOf("http")<0&&url.indexOf("/")!=0){var loc=window.location.href.split("/");loc.pop();loc=loc.join("/")+"/";url=loc+url;}}else{}this.inputNode=_b84.create("div",{className:"dojoxFlashNode"},this.domNode,"first");_b83.set(this.inputNode,{position:"absolute",top:"-2px",width:this.btnSize.w+"px",height:this.btnSize.h+"px",opacity:0});var w=this.btnSize.w;var h=this.btnSize.h;var args={expressInstall:true,path:(this.swfPath.uri||this.swfPath)+"?cb_"+(new Date().getTime()),width:w,height:h,allowScriptAccess:"always",allowNetworking:"all",vars:{uploadDataFieldName:this.flashFieldName||this.name+"Flash",uploadUrl:url,uploadOnSelect:this.uploadOnSelect,deferredUploading:this.deferredUploading||0,selectMultipleFiles:this.multiple,id:this.id,isDebug:this.isDebug,noReturnCheck:this.skipServerCheck,serverTimeout:this.serverTimeout},params:{scale:"noscale",wmode:"transparent",wmode:"opaque",allowScriptAccess:"always",allowNetworking:"all"}};this.flashObject=new _b8b(args,this.inputNode);this.flashObject.onError=lang.hitch(function(msg){console.error("Flash Error: "+msg);});this.flashObject.onReady=lang.hitch(this,function(){this.onReady(this);});this.flashObject.onLoad=lang.hitch(this,function(mov){this.flashMovie=mov;this.flashReady=true;this.onLoad(this);});this._connectFlash();}});dojox.form.addUploaderPlugin(_b8c);return _b8c;});},"epi/dnd/Source":function(){define(["dojo"],function(dojo){return dojo.declare("epi.dnd.Source",null,{avatarId:"epi_dnd_avatar",_startDragPos:null,_onDragHandle:null,_onDragEndHandle:null,buildAvatar:function(node){return dojo.clone(node);},buildDragImage:function(evt,node){},addDraggableNode:function(node,_b97,data){node.draggable=true;dojo.connect(node,"ondragstart",dojo.hitch(this,function(evt){var _b98={type:_b97,data:data};evt.dataTransfer.setData("Text",dojo.toJson(_b98));this.buildDragImage(evt,node);dojo.publish("/EPi/DnD/DragStart",[{type:_b97}]);if(dojo.isIE<=9){this._createAvatar(node);}return true;}));dojo.connect(node,"ondragend",dojo.hitch(this,function(evt){dojo.publish("/EPi/DnD/DragEnd",[{type:_b97}]);}));},_createAvatar:function(node){var pos=this._startDragPos=dojo.position(node);var size=dojo.contentBox(node);var _b99=this.buildAvatar(node);_b99.id=this.avatarId;dojo.place(_b99,dojo.body());dojo.style(_b99,"position","absolute");dojo.style(_b99,"display","block");dojo.style(_b99,"filter","alpha(opacity = 50)");dojo.style(_b99,"width",size.w+"px");dojo.style(_b99,"height",size.h+"px");dojo.style(_b99,"left",pos.x+"px");dojo.style(_b99,"top",pos.y+"px");dojo.style(_b99,"zIndex",1200);this._onDragHandle=dojo.connect(dojo.body(),"ondrag",dojo.hitch(this,this._moveAvatar));this._onDragEndHandle=dojo.connect(dojo.body(),"ondragend",dojo.hitch(this,this._destroyAvatar));},_moveAvatar:function(evt){var _b9a=dojo.byId(this.avatarId);if(!_b9a){return;}var pos={x:evt.clientX,y:evt.clientY};dojo.style(_b9a,"left",pos.x+"px");dojo.style(_b9a,"top",(pos.y+1)+"px");},_destroyAvatar:function(evt){var _b9b=dojo.byId(this.avatarId);if(!_b9b){return;}dojo.destroy(_b9b);dojo.disconnect(this._onDragHandle);dojo.disconnect(this._onDragEndHandle);}});});},"url:epi/cms/widget/templates/ContentReferences.html":"<div class=\"epi-contentReferences\">\r\n    <div class=\"epi-dialog-captionPanel\" data-dojo-attach-point=\"captionPanelNode\">\r\n        <div class=\"epi-floatRight\" data-dojo-type=\"dijit.Toolbar\" dojo-data-attach-point=\"contentReferenceToolbar\">\r\n            <button data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"saveListButton\" data-dojo-attach-event=\"onClick:_refreshList\"\r\n                    data-dojo-props=\"iconClass:'epi-iconReload', 'class':'epi-chromelessButton'\">${res.buttons.refresh}</button>\r\n        </div>\r\n        <h1>\r\n            <span class='dijitInline dijitIcon epi-iconObjectSharedBlock'>&nbsp;</span><span class='dijitInline dojoxEllipsis' data-dojo-attach-point=\"contentReferencesWidgetTitleNode\"></span>\r\n        </h1>\r\n    </div>\r\n    <div class=\"epi-verticalScroller\">\r\n        <div data-dojo-attach-point=\"pageGridContainer\">\r\n            <h2 data-dojo-attach-point=\"pageTitleNode\"></h2>\r\n            <div data-dojo-attach-point=\"pageGrid\" ></div>\r\n        </div>\r\n        <div data-dojo-attach-point=\"blockGridContainer\">\r\n            <h2 data-dojo-attach-point=\"blockTitleNode\"></h2>\r\n            <div data-dojo-attach-point=\"blockGrid\"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n","epi/cms/command/CutContent":function(){define("epi/cms/command/CutContent",["dojo/_base/declare","epi","epi/shell/command/_Command","epi/shell/command/_ClipboardCommandMixin","epi/shell/command/_SelectionCommandMixin"],function(_b9c,epi,_b9d,_b9e,_b9f){return _b9c([_b9d,_b9e,_b9f],{label:epi.resources.action.cut,iconClass:"epi-iconCut",_execute:function(){this.clipboard.set("copy",false);this.clipboard.set("data",this.selection.data.concat());},_onModelChange:function(){var _ba0=this.model,_ba1=this.selection.data,_ba2=false;if(_ba0&&_ba1.length==1){var _ba3=_ba1[0];_ba2=_ba3.type=="epi.cms.contentdata"&&_ba0.canCut(_ba3.data);}this.set("canExecute",_ba2);}});});},"url:epi/cms/widget/templates/NotificationStatusBar.html":"<div>\r\n    <div class=\"epi-dijitTooltipTitleBar\">\r\n        <span class=\"epi-dijitTooltipTitle\">${res.title}</span>\r\n        <span class=\"epi-closeButton dijitDialogCloseIcon\" data-dojo-attach-point=\"closeIcon\" title=\"${res.title}\" role=\"button\"></span>\r\n    </div>\r\n    <div class=\"epi-dijitTooltipContent\" data-dojo-attach-point=\"zoneLayoutNode\">\r\n        <div data-dojo-attach-point=\"zoneContainer\">\r\n            <div data-dojo-type=\"epi.cms.widget.NotificationStatusZone\" data-dojo-attach-point=\"errorZone\" data-dojo-props=\"title: '${res.errortitle}', type: 'error'\"></div>\r\n            <div data-dojo-type=\"epi.cms.widget.NotificationStatusZone\" data-dojo-attach-point=\"warningZone\" data-dojo-props=\"title: '${res.warningtitle}', type: 'warning'\"></div>\r\n            <div data-dojo-type=\"epi.cms.widget.NotificationStatusZone\" data-dojo-attach-point=\"infoZone\"  data-dojo-props=\"title: '${res.notetitle}', type: 'note'\"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n","epi/cms/widget/_DropDownWidgetItemMixin":function(){define("epi/cms/widget/_DropDownWidgetItemMixin",["dojo/dom-construct"],function(_ba4){return dojo.declare("epi.cms.widget._DropDownWidgetItemMixin",null,{buildRendering:function(){this.inherited(arguments);this.domNode=this._wrapItem(this);},_wrapItem:function(item){var tr=_ba4.create("tr");var td=_ba4.create("th",null,tr);item.placeAt(td,"first");return tr;}});});},"epi/cms/contentediting/command/Reject":function(){define("epi/cms/contentediting/command/Reject",["dojo/_base/declare","epi/shell/command/_Command","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/command/_ChangeContentStatus","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons"],function(_ba5,_ba6,_ba7,_ba8,_ba9){return _ba5("epi.cms.contentediting.command.Reject",[_ba8],{name:"reject",label:_ba9.reject.label,tooltip:_ba9.reject.title,iconClass:"epi-iconStop",action:_ba7.action.Reject,_execute:function(){return this.inherited(arguments);},_onModelChange:function(){this.inherited(arguments);var _baa=this.model.contentData,_bab=_baa.status,_bac=_ba7.versionStatus,_bad=(_bab==_bac.CheckedIn)&&this.model.canChangeContent(_ba7.action.Publish);this.set("canExecute",_bad);this.set("isAvailable",_bad);}});});},"epi/cms/widget/CategoryTreeStoreModel":function(){define("epi/cms/widget/CategoryTreeStoreModel",["dojo","epi/dependency","epi/routes"],function(dojo,_bae,_baf){return dojo.declare("epi.cms.widget.CategoryTreeStoreModel",null,{store:null,rootCategory:undefined,constructor:function(args){dojo.mixin(this,args);if(!this.rootCategory){var _bb0=_bae.resolve("epi.cms.Application");this.rootCategory=_bb0.getRootCategory();}if(!this.store){var _bb1=_bae.resolve("epi.storeregistry");this.store=_bb1.get("epi.cms.category");}},getRoot:function(_bb2){dojo.when(this.store.get(this.rootCategory),_bb2);},mayHaveChildren:function(item){return item.hasChildren;},getChildren:function(_bb3,_bb4){var id=this.getIdentity(_bb3),_bb5=this.store.query({id:id,query:"getchildren"});_bb5.then(function(_bb6){_bb3.children=_bb6;_bb4(_bb6);});},getIdentity:function(item){return this.store.getIdentity(item);},getLabel:function(item){return item.description;}});});},"epi/cms/contentediting/EditorFactory":function(){define("epi/cms/contentediting/EditorFactory",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","epi/string"],function(_bb7,_bb8,lang,_bb9){return _bb7("epi.cms.contentediting.EditorFactory",null,{defaultWrapperType:"floating",_registeredEditorWrappers:null,onEditorCreated:function(_bba){},onEditorResolved:function(data,_bbb){},constructor:function(){this._registeredEditorWrappers={};},registerEditorWrapper:function(_bbc,_bbd,_bbe){this._registeredEditorWrappers[_bbc]={wrapperClassType:_bbd,initializer:_bbe};},_getWrapperAndEditor:function(_bbf){var type=_bbf.type;var name=_bbf.name;var _bc0=_bbf.wrapperType;var _bc1=_bbf.editorParams||{};var _bc2=_bbf.editorWidgetType;if(!_bc0){if(_bbf.metadata.customEditorSettings&&_bbf.metadata.customEditorSettings.uiWrapperType){_bc0=_bbf.metadata.customEditorSettings.uiWrapperType;}else{_bc0=this.defaultWrapperType;}}if(!_bc2){if(_bbf.metadata.customEditorSettings&&_bbf.metadata.customEditorSettings.uiType){_bc2=_bbf.metadata.customEditorSettings.uiType;}else{if(_bbf.metadata.uiType){_bc2=_bbf.metadata.uiType;}else{_bc2="epi.shell.widget.FormContainer";lang.mixin(_bc1,{metadata:_bbf.metadata,onFieldCreated:function(_bc3,_bc4){}});}}}if(!_bc2){throw ("Could not resolve editor widget for property: "+_bbf.name);}if(_bbf.metadata.customEditorSettings&&_bbf.metadata.customEditorSettings.uiParams){lang.mixin(_bc1,_bbf.metadata.customEditorSettings.uiParams);}var _bc5=this._registeredEditorWrappers[_bc0];if(!_bc5){throw ("No suitable editor wrapper found for type: "+_bc0);}var data={wrapperInitializer:_bc5.initializer,wrapperType:_bc5.wrapperClassType,editorWidgetType:_bc2,editorParams:_bc1};this.onEditorResolved(data,_bbf);if(_bc0){return data;}throw ("No suitable editor found");},createEditor:function(_bc6,node,_bc7,_bc8){var def=new _bb8();var _bc9=this._getWrapperAndEditor(_bc6);var _bca=_bb9.slashName(_bc9.wrapperType);var _bcb=_bb9.slashName(_bc9.editorWidgetType);require([_bca,_bcb],lang.hitch(this,function(_bcc){var _bcd=_bc8||{};if(_bc6.metadata){lang.mixin(_bcd,_bc6.metadata.settings);lang.mixin(_bcd,_bc9.editorParams);_bcd.selections=_bc6.metadata.selections;}var _bce={wrapperType:_bc9.wrapperType,editorWidgetType:_bc9.editorWidgetType,editorParams:_bcd,blockDisplayNode:node,overlayItem:_bcd.overlayItem,property:_bc6,propertyName:_bc6.name,propertyDisplayName:_bc6.metadata.displayName,value:_bc7,contentModel:_bc6.contentModel};var _bcf=new _bcc(_bce);var _bd0=_bc9.wrapperInitializer;if(_bd0){lang.mixin(_bce.editorParams,{parent:_bcf});_bd0(_bcf,_bce);}this.onEditorCreated(_bcf.getEditorWidget());def.resolve(_bcf);}));return def;}});});},"url:epi/cms/contentediting/editors/templates/ContentAreaEditor.html":"<div class=\"dijitInline\" data-dojo-attach-point=\"stateNode\">\r\n    <div data-dojo-attach-point=\"itemContainer\" class=\"epi-content-area-itemcontainer\"></div>\r\n    <div data-dojo-attach-point=\"actionsContainer\" class=\"epi-content-area-actionscontainer\"></div>            \r\n</div>","dijit/form/Select":function(){require({cache:{"url:dijit/form/templates/Select.html":"<table class=\"dijit dijitReset dijitInline dijitLeft\"\n\tdata-dojo-attach-point=\"_buttonNode,tableNode,focusNode\" cellspacing='0' cellpadding='0'\n\trole=\"combobox\" aria-haspopup=\"true\"\n\t><tbody role=\"presentation\"><tr role=\"presentation\"\n\t\t><td class=\"dijitReset dijitStretch dijitButtonContents dijitButtonNode\" role=\"presentation\"\n\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"  data-dojo-attach-point=\"containerNode,_popupStateNode\"></span\n\t\t\t><input type=\"hidden\" ${!nameAttrSetting} data-dojo-attach-point=\"valueNode\" value=\"${value}\" aria-hidden=\"true\"\n\t\t/></td><td class=\"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton\"\n\t\t\t\tdata-dojo-attach-point=\"titleNode\" role=\"presentation\"\n\t\t\t><div class=\"dijitReset dijitArrowButtonInner\" role=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitArrowButtonChar\" role=\"presentation\">&#9660;</div\n\t\t></td\n\t></tr></tbody\n></table>\n"}});define("dijit/form/Select",["dojo/_base/array","dojo/_base/declare","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/_base/event","dojo/i18n","dojo/_base/lang","./_FormSelectWidget","../_HasDropDown","../Menu","../MenuItem","../MenuSeparator","../Tooltip","dojo/text!./templates/Select.html","dojo/i18n!./nls/validate"],function(_bd1,_bd2,_bd3,_bd4,_bd5,_bd6,_bd7,i18n,lang,_bd8,_bd9,Menu,_bda,_bdb,_bdc,_bdd){var _bde=_bd2("dijit.form._SelectMenu",Menu,{buildRendering:function(){this.inherited(arguments);var o=(this.menuTableNode=this.domNode);var n=(this.domNode=_bd5.create("div",{style:{overflowX:"hidden",overflowY:"scroll"}}));if(o.parentNode){o.parentNode.replaceChild(n,o);}_bd4.remove(o,"dijitMenuTable");n.className=o.className+" dijitSelectMenu";o.className="dijitReset dijitMenuTable";o.setAttribute("role","listbox");n.setAttribute("role","presentation");n.appendChild(o);},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onmousemove",_bd7.stop);},resize:function(mb){if(mb){_bd6.setMarginBox(this.domNode,mb);if("w" in mb){this.menuTableNode.style.width="100%";}}}});var _bdf=_bd2("dijit.form.Select",[_bd8,_bd9],{baseClass:"dijitSelect",templateString:_bdd,required:false,state:"",message:"",tooltipPosition:[],emptyLabel:"&#160;",_isLoaded:false,_childrenLoaded:false,_fillContent:function(){this.inherited(arguments);if(this.options.length&&!this.value&&this.srcNodeRef){var si=this.srcNodeRef.selectedIndex||0;this.value=this.options[si>=0?si:0].value;}this.dropDown=new _bde({id:this.id+"_menu"});_bd4.add(this.dropDown.domNode,this.baseClass+"Menu");},_getMenuItemForOption:function(_be0){if(!_be0.value&&!_be0.label){return new _bdb();}else{var _be1=lang.hitch(this,"_setValueAttr",_be0);var item=new _bda({option:_be0,label:_be0.label||this.emptyLabel,onClick:_be1,disabled:_be0.disabled||false});item.focusNode.setAttribute("role","listitem");return item;}},_addOptionItem:function(_be2){if(this.dropDown){this.dropDown.addChild(this._getMenuItemForOption(_be2));}},_getChildren:function(){if(!this.dropDown){return [];}return this.dropDown.getChildren();},_loadChildren:function(_be3){if(_be3===true){if(this.dropDown){delete this.dropDown.focusedChild;}if(this.options.length){this.inherited(arguments);}else{_bd1.forEach(this._getChildren(),function(_be4){_be4.destroyRecursive();});var item=new _bda({label:"&#160;"});this.dropDown.addChild(item);}}else{this._updateSelection();}this._isLoaded=false;this._childrenLoaded=true;if(!this._loadingStore){this._setValueAttr(this.value);}},_setValueAttr:function(_be5){this.inherited(arguments);_bd3.set(this.valueNode,"value",this.get("value"));this.validate(this.focused);},_setDisabledAttr:function(_be6){this.inherited(arguments);this.validate(this.focused);},_setRequiredAttr:function(_be7){this._set("required",_be7);this.focusNode.setAttribute("aria-required",_be7);this.validate(this.focused);},_setDisplay:function(_be8){var lbl=_be8||this.emptyLabel;this.containerNode.innerHTML="<span class=\"dijitReset dijitInline "+this.baseClass+"Label\">"+lbl+"</span>";this.focusNode.setAttribute("aria-valuetext",lbl);},validate:function(_be9){var _bea=this.disabled||this.isValid(_be9);this._set("state",_bea?"":"Incomplete");this.focusNode.setAttribute("aria-invalid",_bea?"false":"true");var _beb=_bea?"":this._missingMsg;if(_beb&&this.focused&&this._hasBeenBlurred){_bdc.show(_beb,this.domNode,this.tooltipPosition,!this.isLeftToRight());}else{_bdc.hide(this.domNode);}this._set("message",_beb);return _bea;},isValid:function(){return (!this.required||this.value===0||!(/^\s*$/.test(this.value||"")));},reset:function(){this.inherited(arguments);_bdc.hide(this.domNode);this.validate(this.focused);},postMixInProperties:function(){this.inherited(arguments);this._missingMsg=i18n.getLocalization("dijit.form","validate",this.lang).missingMessage;},postCreate:function(){this.inherited(arguments);this.connect(this.domNode,"onmousemove",_bd7.stop);},_setStyleAttr:function(_bec){this.inherited(arguments);_bd4.toggle(this.domNode,this.baseClass+"FixedWidth",!!this.domNode.style.width);},isLoaded:function(){return this._isLoaded;},loadDropDown:function(_bed){this._loadChildren(true);this._isLoaded=true;_bed();},closeDropDown:function(){this.inherited(arguments);if(this.dropDown&&this.dropDown.menuTableNode){this.dropDown.menuTableNode.style.width="";}},uninitialize:function(_bee){if(this.dropDown&&!this.dropDown._destroyed){this.dropDown.destroyRecursive(_bee);delete this.dropDown;}this.inherited(arguments);},_onFocus:function(){this.validate(true);this.inherited(arguments);},_onBlur:function(){_bdc.hide(this.domNode);this.inherited(arguments);}});_bdf._Menu=_bde;return _bdf;});},"epi/shell/command/ToggleCommand":function(){define(["dojo/_base/declare","epi/shell/command/_Command"],function(_bef,_bf0){return _bef([_bf0],{property:null,active:false,_execute:function(){var name=this.property,_bf1=!this.active;this.model.set(name,_bf1);this.set("active",_bf1);},_onModelChange:function(){var _bf2=this.model,_bf3=_bf2&&_bf2[this.property],_bf4=typeof _bf3=="boolean";this.set("canExecute",_bf4);this.set("active",_bf4&&_bf3);}});});},"url:dijit/form/templates/Select.html":"<table class=\"dijit dijitReset dijitInline dijitLeft\"\n\tdata-dojo-attach-point=\"_buttonNode,tableNode,focusNode\" cellspacing='0' cellpadding='0'\n\trole=\"combobox\" aria-haspopup=\"true\"\n\t><tbody role=\"presentation\"><tr role=\"presentation\"\n\t\t><td class=\"dijitReset dijitStretch dijitButtonContents dijitButtonNode\" role=\"presentation\"\n\t\t\t><span class=\"dijitReset dijitInline dijitButtonText\"  data-dojo-attach-point=\"containerNode,_popupStateNode\"></span\n\t\t\t><input type=\"hidden\" ${!nameAttrSetting} data-dojo-attach-point=\"valueNode\" value=\"${value}\" aria-hidden=\"true\"\n\t\t/></td><td class=\"dijitReset dijitRight dijitButtonNode dijitArrowButton dijitDownArrowButton\"\n\t\t\t\tdata-dojo-attach-point=\"titleNode\" role=\"presentation\"\n\t\t\t><div class=\"dijitReset dijitArrowButtonInner\" role=\"presentation\"></div\n\t\t\t><div class=\"dijitReset dijitArrowButtonChar\" role=\"presentation\">&#9660;</div\n\t\t></td\n\t></tr></tbody\n></table>\n","url:epi/cms/widget/templates/TrashItemList.html":"<div>\r\n    <div class=\"epi-trashHeader clearfix\">\r\n        <div class=\"epi-gadgetInnerToolbar\" data-dojo-attach-point=\"searchBoxContainer\">\r\n            <div data-dojo-type=\"epi.shell.widget.SearchBox\" data-dojo-attach-point=\"searchBox\"></div>\r\n        </div>\r\n        <span class=\"epi-removedByContainer\">\r\n            <label for=\"removedBy_${id}\">${resources.removedby}</label>\r\n            <select data-dojo-type=\"dijit.form.Select\" data-dojo-attach-point=\"removedBy\" id=\"removedBy_${id}\" data-dojo-attach-event='onChange: _onDeletedByChange'>\r\n                <option value=\"\">${resources.any}</option>\r\n            </select>\r\n        </span>\r\n    </div>\r\n    <div data-dojo-attach-point=\"gridContainerNode\"></div>\r\n</div>","epi/cms/contentediting/command/DynamicProperties":function(){define("epi/cms/contentediting/command/DynamicProperties",["dojo/_base/declare","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/command/_LegacyDialogCommandBase","epi/i18n!epi/cms/nls/episerver.cms.contentediting.contentdetails.command.dynamicproperties"],function(_bf5,_bf6,_bf7,_bf8){return _bf5([_bf7],{name:"DynamicProperties",label:_bf8.label,tooltip:_bf8.tooltip,dialogPath:"Edit/EditDynProp.aspx",raiseCloseEvent:false,postscript:function(){this.inherited(arguments);this.set("canExecute",true);this.set("isAvailable",true);},_onModelChange:function(){var _bf9=this.model.contentData,_bfa=_bf6.hasAccess(_bf9.accessMask,_bf6.accessLevel.Administer),_bfb=this.model.canChangeContent();this.set("canExecute",_bf9.capabilities.dynamicProperties&&_bfa&&_bfb);}});});},"dgrid/OnDemandGrid":function(){define("dgrid/OnDemandGrid",["dojo/_base/declare","./Grid","./OnDemandList"],function(_bfc,Grid,_bfd){return _bfc([Grid,_bfd],{});});},"epi/shell/widget/dialog/_DialogContentMixin":function(){define(["dojo/_base/declare"],function(_bfe){return dojo.declare(null,{executeDialog:function(){},cancelDialog:function(){}});});},"epi/cms/contentediting/MappingManager":function(){define("epi/cms/contentediting/MappingManager",["dojo","dojo/_base/lang","dojo/_base/array","dojo/_base/json","dojo/_base/connect","dojo/dom-attr","dojox/encoding/digests/SHA1"],function(dojo,lang,_bff,json,_c00,_c01,SHA1){return dojo.declare("epi.cms.contentediting.MappingManager",[],{BODY_NODE_HASH:"#BODY#",_mappings:null,domUtils:null,attrNames:["data-epi-property-name","data-epi-property-display-names","data-epi-property-customsettings-customtag","data-epi-use-mvc","data-epi-disabled","data-epi-useoverlay","data-epi-overlay-z-index","data-epi-property-type","data-epi-property-edittype","data-epi-property-editorsetting","data-epi-property-editor","data-epi-property-render"],constructor:function(){this._mappings=[];this.domUtils=_c01;},clear:function(){var old=this._mappings;this._mappings=[];_bff.forEach(old,function(_c02){_bff.forEach(["updateController","wrapper","overlayItem"],function(prop){if(_c02[prop]){if(lang.isFunction(_c02[prop].destroyRecursive)){_c02[prop].destroyRecursive();}else{_c02[prop].destroy();}}});for(var prop in _c02){delete _c02[prop];}},this);},_calculateNodeHash:function(node){if(node.tagName==="BODY"){return this.BODY_NODE_HASH;}var _c03=dojo.map(this.attrNames,dojo.hitch(this,function(n){return this.domUtils.get(node,n)||"";}));return SHA1(json.toJson(_c03));},update:function(_c04,_c05){lang.mixin(_c04,_c05);if(_c05.node){_c04.nodeHash=this._calculateNodeHash(_c05.node);}},add:function(item){if(item.node){item.nodeHash=this._calculateNodeHash(item.node);}if(item.blockPropertyInfo&&!item.propertyName){item.propertyName=item.blockPropertyInfo.name;}this._mappings.push(item);},_tryRemapNode:function(item,_c06,_c07){if(item.nodeHash===this.BODY_NODE_HASH){item.node=_c07;item.updateController.displayNode=_c07;return {success:true};}if(this._calculateNodeHash(_c06.node)===item.nodeHash){item.node=_c06.node;item.updateController.displayNode=_c06.node;item.updateController.checkEmptyHtml();if(item.overlayItem){item.overlayItem.set("disabled",false);item.overlayItem.set("sourceItemNode",_c06.node);item.overlayItem.refresh();}return {success:true,mappedNode:_c06};}return {success:false};},remap:function(_c08,_c09){var _c0a=[];_bff.forEach(_c08,function(_c0b){_c0a.push(_c0b);});_bff.forEach(this._mappings,dojo.hitch(this,function(item){if(!item.updateController){return;}var _c0c=null;var _c0d=_bff.some(_c0a,dojo.hitch(this,function(_c0e){var _c0f=this._tryRemapNode(item,_c0e,_c09);_c0c=_c0c||_c0f.mappedNode;return _c0f.success;}));if(_c0d){if(_c0c){_c0a.splice(_bff.indexOf(_c0a,_c0c),1);}}else{item.updateController.destroy();delete item.updateController;if(item.overlayItem){item.overlayItem.destroyRecursive();delete item.overlayItem;}delete item.node;delete item.nodeHash;}}));return _c0a;},findOne:function(_c10,_c11){var _c12;_bff.some(this._mappings,function(m){if(m[_c10]===_c11){_c12=m;return true;}});return _c12;},find:function(){var _c13;if(arguments[0]===undefined){return this._mappings;}else{if(lang.isFunction(arguments[0])){_c13=arguments[0];}else{var _c14=arguments[0],_c15=arguments[1];_c13=function(m){return m[_c14]===_c15;};}}return _bff.filter(this._mappings,_c13);}});});},"epi/cms/contentediting/EditingBase":function(){define("epi/cms/contentediting/EditingBase",["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/event","dojo/_base/json","dojo/_base/lang","dojo/date/stamp","dojo/dom-attr","dojo/on","dojo/query","dojo/topic","dijit/_Widget","epi/dependency","epi/datetime","epi/string","epi/Url","epi/cms/contentediting/_View","epi/cms/contentediting/AutoSaveButton","epi/cms/contentediting/MappingManager","epi/cms/contentediting/RenderManager","epi/cms/contentediting/UpdateController","epi/cms/widget/overlay/overlayFactory","epi/i18n!epi/cms/nls/episerver.cms.contentediting"],function(_c16,_c17,_c18,_c19,json,lang,date,_c1a,on,_c1b,_c1c,_c1d,_c1e,_c1f,_c20,Url,_c21,_c22,_c23,_c24,_c25,_c26,res){return _c17("epi.cms.contentediting.EditingBase",[_c21],{toolbar:null,editorFactory:null,syncInterval:10000,activePropertyOnStartup:null,_renderManager:null,_mappingManager:null,_activeEditor:null,_autoSaveButton:null,_reloadRequiredProperty:null,_eventHandlers:null,constructor:function(){this.defaultQueryParameters={epieditmode:true,epiworkspaceactive:false};},postMixInProperties:function(){this.inherited(arguments);this.editorFactory=this.editorFactory||_c1e.resolve("epi.cms.contentediting.EditorFactory");this._mappingManager=new _c23();this._eventHandlers=[];},postCreate:function(){this.inherited(arguments);if(this.syncInterval>0){this._syncIntervalId=window.setInterval(lang.hitch(this,"_save"),this.syncInterval);}this.subscribe("/epi/cms/action/save",this._save);this.subscribe("/epi/cms/action/undo",this._undo);this.subscribe("/epi/cms/action/redo",this._redo);this.subscribe("/epi/cms/action/disableundoredoactions",this._toggleUndoRedoActions);},startup:function(){this.overlay.set("enabled",true);},destroy:function(){this._unwatchViewModelHandles();if(this._renderManager){this._renderManager.destroy();}if(this._autoSaveButton){this._autoSaveButton.destroyRecursive();}this._mappingManager.clear();if(this.toolbar){this.toolbar=null;}if(this._syncIntervalId){clearInterval(this._syncIntervalId);}this._disconnectEventHandlers();this.inherited(arguments);},_setCommandEnabled:function(_c27,_c28){if(this.toolbar){this.toolbar.setItemProperty(_c27,"disabled",!_c28);}},onContentLinkSyncChange:function(){this.inherited(arguments);this._setButtonState();},_setViewModelAttr:function(_c29){if(_c29===this.viewModel){return;}this.inherited(arguments);this._disconnectEventHandlers();this._connectEventHandler(this.viewModel,"onContentChange",lang.hitch(this,function(){if(this._activeEditor!=null){this._activeEditor.tryToStopEditing();}}));this._connectEventHandler(this.viewModel,"onSetActiveProperty",this.onSetActiveProperty);},onSetActiveProperty:function(_c2a){var _c2b=this._mappingManager.findOne("propertyName",_c2a);if(_c2b){if(_c2b.wrapper){_c2b.wrapper.startEdit();}else{if(_c2b.overlayItem){this._onOverlayItemClick(_c2b.overlayItem);}}}},onPreviewReady:function(_c2c,doc){if(_c2c!=this.viewModel){this.set("viewModel",_c2c);this.setupEditMode(doc);}else{if(_c2c){this.remapEditMode(doc);}}},_setButtonState:function(){this._setCommandEnabled("reverttopublished",this.viewModel&&!this.viewModel.contentData.isPendingPublish);},_setNoPreviewAttr:function(_c2d){this._set("noPreview",_c2d);if(_c2d){this._renderManager.suspend();}else{this.set("reloadRequired",true);this._renderManager.resume();}},setupEditMode:function(doc){this.viewModel.getContentModelAndMetadata().then(lang.hitch(this,function(){this._mappingManager.clear();this._renderManager=new _c24();if(this.toolbar&&!this._autoSaveButton){this._autoSaveButton=new _c22({button:this.toolbar._getWidget("save"),model:this.viewModel});}else{this._autoSaveButton.set("model",this.viewModel);}var _c2e=lang.hitch(this,function(){this._toggleUndoRedoActions(this.viewModel.hasUndoSteps,this.viewModel.hasRedoSteps);});this.viewModel.resetNotifications();this._unwatchViewModelHandles();this._viewModelHandles=[this.viewModel.watch("hasUndoSteps",_c2e),this.viewModel.watch("hasRedoSteps",_c2e)];_c2e();this.onReadySetupEditMode(doc);this._setButtonState();this.onPrepareOverlayComplete();}));},remapEditMode:function(doc){this.viewModel.getMetadataThenUpdateModel().then(lang.hitch(this,function(){this._renderManager.resume();if(doc){setTimeout(lang.hitch(this,function(){this._remapUpdateControllers(doc);this.onPrepareOverlayComplete();this._toggleUndoRedoActions(this.viewModel.hasUndoSteps,this.viewModel.hasRedoSteps);this._autoSaveButton.set("model",this.viewModel);}),1);}}));},_unwatchViewModelHandles:function(){if(this._viewModelHandles){_c16.forEach(this._viewModelHandles,function(_c2f){_c2f.unwatch();});this._viewModelHandles=null;}},onReadySetupEditMode:function(doc){if(doc){this._createUpdateControllers(doc);}},onSetupEditModeComplete:function(){if(this.activePropertyOnStartup){this.onSetActiveProperty(this.activePropertyOnStartup);this.activePropertyOnStartup=null;}},_connectEventHandler:function(obj,_c30,_c31){this._eventHandlers.push(this.connect(obj,_c30,_c31));},_disconnectEventHandlers:function(){_c16.forEach(this._eventHandlers,this.disconnect);this._eventHandlers=[];},_getPropertyNodes:function(doc){var _c32=_c1b("[data-epi-property-name]",doc);var _c33=_c1b("[data-epi-property-name] [data-epi-property-name]",doc);return _c16.filter(_c32,function(node){return _c33.indexOf(node)===-1;});},_getEditableNodes:function(doc){var _c34=this._getPropertyNodes(doc);var _c35=[];_c16.forEach(_c34,function(node){var _c36=_c20.pascalToCamel(_c1a.get(node,"data-epi-property-name"));var _c37=this.viewModel.getPropertyMetaData(_c36);if(!_c37){return;}var _c38=_c20.pascalToCamel(_c37.name);var _c39=_c1a.get(node,"data-epi-property-display-name");if(_c39){_c37=lang.delegate(_c37,{displayName:_c39});}if(_c37!=null&&_c37.showForEdit){var _c3a={cacheResults:true,rerenderOnCancel:false,propertyRenderSettings:_c1a.get(node,"data-epi-property-rendersettings")||undefined,useMvc:_c1a.has(node,"data-epi-use-mvc")?_c1a.get(node,"data-epi-use-mvc").toLowerCase()==="true":false};_c3a=lang.mixin(_c3a,_c37.additionalValues.renderSettings);var _c3b=_c1a.has(node,"data-epi-property-editorsettings")?json.fromJson(_c1a.get(node,"data-epi-property-editorsettings")):null;var _c3c=_c1a.has(node,"data-epi-property-overlaysettings")?json.fromJson(_c1a.get(node,"data-epi-property-overlaysettings")):null;_c3c=lang.mixin(_c3c,_c37.overlaySettings);_c35.push({node:node,disabled:(_c1a.get(node,"data-epi-disabled")=="true"),useOverlay:(_c1a.get(node,"data-epi-useoverlay")=="true"),overlayZIndex:parseInt(_c1a.get(node,"data-epi-overlay-z-index"),10)||0,property:{name:_c38,contentLink:this.viewModel.contentLink,contentModel:this.viewModel.contentModel,type:_c1a.get(node,"data-epi-property-type"),wrapperType:_c1a.get(node,"data-epi-property-edittype"),editorParams:_c3b,overlayParams:_c3c,editorWidgetType:_c1a.get(node,"data-epi-property-editor"),renderSettings:_c3a,rendererClass:(_c1a.get(node,"data-epi-property-render")==="client")?"epi.cms.contentediting.ClientRenderer":_c37.customEditorSettings.rendererClass,metadata:_c37,propertyNodeName:_c36}});}},this);_c35.sort(function(a,b){if(a.overlayZIndex<b.overlayZIndex){return -1;}else{if(a.overlayZIndex>b.overlayZIndex){return 1;}else{return 0;}}});return _c35;},_createUpdateControllers:function(doc){var _c3d=this._createFullPageUpdateController(doc);if(_c3d){this._connectUpdateControllerAndOverlayEvents(_c3d,null);this._mappingManager.add({node:doc.body,updateController:_c3d});}var _c3e=this._getEditableNodes(doc);_c16.forEach(_c3e,function(_c3f){var _c40=_c3f.property;var _c41=_c3f.node.innerHTML;var _c42=this._createNodeUpdateController(_c3f);_c18.when(this._createNodeOverlay(_c3f),lang.hitch(this,function(_c43){this._connectUpdateControllerAndOverlayEvents(_c42,_c43);this._mappingManager.add({blockPropertyInfo:_c40,node:_c3f.node,updateController:_c42,overlayItem:_c43});}));this._renderManager.cacheRender(_c40.name,_c40.renderSettings,this.viewModel.getProperty(_c40.name),_c41);},this);},_createNodeOverlay:function(_c44){var _c45=new _c18();_c18.when(_c26.create(_c44),lang.hitch(this,function(_c46){this.overlay.addChild(_c46);_c45.resolve(_c46);}));return _c45;},_createNodeUpdateController:function(_c47){var _c48=_c47.property;var _c49=_c48.metadata;var _c4a=new _c25({displayName:_c49.displayName,renderManager:this._renderManager,contentModel:_c48.contentModel,contentLink:_c48.contentLink,modelPropertyName:_c48.name,nodePropertyName:_c48.propertyNodeName,renderSettings:_c48.renderSettings,rendererClass:_c48.rendererClass,displayNode:_c47.node});return _c4a;},_createFullPageUpdateController:function(doc){var _c4b=[];var _c4c=_c1b("input[data-epi-full-refresh-property-names][type='hidden']",doc);_c16.forEach(_c4c,function(tag){_c16.forEach(_c1a.get(tag,"data-epi-full-refresh-property-names").split(","),function(_c4d){if(!_c16.some(_c4b,function(p){return p===_c4d;})){_c4b.push(_c20.pascalToCamel(_c4d));}});});if(!_c4b.length){return null;}var _c4e=new _c25({displayName:"",renderManager:this._renderManager,contentModel:this.viewModel.contentModel,modelPropertyName:_c4b,renderSettings:{isFullReload:true},displayNode:doc.body});return _c4e;},_remapUpdateControllers:function(doc){var _c4f=this._getEditableNodes(doc);var _c50=this._mappingManager.remap(_c4f,doc.body);_c16.forEach(_c50,function(_c51){var _c52=_c51.property;var _c53=this._createNodeUpdateController(_c51);var _c54=this._mappingManager.find(function(m){return (m.updateController===undefined||m.updateController===null)&&(m.propertyName.indexOf(_c52.name)===0);});_c18.when(this._createNodeOverlay(_c51),lang.hitch(this,function(_c55){this._connectUpdateControllerAndOverlayEvents(_c53,_c55);if(_c54&&_c54.length){this._mappingManager.update(_c54[0],{updateController:_c53,overlayItem:_c55,node:_c51.node});}else{this._mappingManager.add({blockPropertyInfo:_c52,node:_c51.node,updateController:_c53,overlayItem:_c55});}}));this._renderManager.cacheRender(_c52.name,_c52.renderSettings,this.viewModel.getProperty(_c52.name),_c51.node.innerHTML);},this);},_connectUpdateControllerAndOverlayEvents:function(_c56,_c57){if(_c56){this.connect(_c56,"onReloadRequired",this._onBlockReloadRequired);this.connect(_c56,"onRender",this._onBlockRender);}if(_c57){this.connect(_c57,"onClick",this._onOverlayItemClick);this.connect(_c57,"onValueChange",lang.hitch(this,"_onOverlayValueChange",_c57));}},_getEditor:function(_c58){var _c59=this._mappingManager.findOne("overlayItem",_c58);return (_c59.wrapper&&_c59.wrapper.editorWidget)?_c59.wrapper.editorWidget:null;},_onOverlayItemClick:function(_c5a,e){if(e){_c19.stop(e);}var _c5b=this._mappingManager.findOne("overlayItem",_c5a);var _c5c=_c5b.blockPropertyInfo;var val=this.viewModel.getProperty(_c5b.propertyName);var _c5d=lang.clone(val,true);var _c5e;var _c5f=lang.hitch(this,function(_c60){_c5b.wrapper=_c60;_c1c.publish("/epi/layout/pinnable/propertyEditor/show",null);_c16.forEach(this._mappingManager.find(),function(m){if(m.overlayItem){m.overlayItem.set("active",false);}});_c5b.overlayItem.set("active",true);var _c61={value:_c5d,parent:_c60};_c60.startEdit(_c61);this._activeEditor=_c60;});if(_c5b.wrapper){_c5e=_c5b.wrapper;_c5e.set("blockDisplayNode",_c5b.node);_c5e.set("value",_c5d);_c5f(_c5e);}else{_c18.when(this._createEditorWrapperForBlock(_c5c,_c5a,_c5b.node,_c5d),lang.hitch(this,function(_c62){_c5f(_c62);}));}},_createEditorWrapperForBlock:function(_c63,_c64,_c65,_c66){var def=new _c18(),_c67={overlayItem:_c64};_c18.when(this.editorFactory.createEditor(_c63,_c65,_c66,_c67),lang.hitch(this,function(_c68){this.connect(_c68,"onValueChange","_onWrapperValueChange");this.connect(_c68,"onCancel","_onWrapperCancel");this.connect(_c68,"onStopEdit","_onWrapperStopEdit");def.resolve(_c68);}),def.reject);return def;},_onBlockReloadRequired:function(_c69){var rm=this._renderManager;setTimeout(function(){rm.suspend();rm.clear();},1);this._reloadRequiredProperty=_c69.modelPropertyName;this._reloadPropertyPreview();},_onBlockRender:function(_c6a){var _c6b=this._mappingManager.findOne("updateController",_c6a);if(_c6b&&_c6b.overlayItem){_c6b.overlayItem.refresh();}},_saveEditorChanges:function(_c6c,data){var _c6d=this._getEditor(_c6c);if(_c6d&&_c6d.saveChanges){_c6d.saveChanges(_c6d,data);}},_onOverlayValueChange:function(_c6e,data){this._saveEditorChanges(_c6e,data.value);if(data instanceof Array){this.viewModel.commitProperties(data);}else{this.viewModel.commitProperty(data.propertyName,data.value);}this._save();},_onOverlayItemDrop:function(_c6f,_c70){var _c71=this._mappingManager.findOne("overlayItem",_c6f);var _c72=_c71.propertyName;var item=_c70;_c18.when(item.data,lang.hitch(this,function(_c73){if(!epi.areEqual(this.viewModel.getProperty(_c72),_c73)){this.viewModel.commitProperty(_c72,_c73);this._save();}else{_c6f.refresh();}}));},_onDoubleValueChange:function(_c74,_c75,_c76,_c77){var _c78=this._mappingManager.findOne("wrapper",_c74);var _c79=this._mappingManager.findOne("wrapper",_c76);var _c7a=[{propertyName:_c79.propertyName,value:_c77},{propertyName:_c78.propertyName,value:_c75}];this.viewModel.commitProperties(_c7a);this._save();},_onWrapperValueChange:function(_c7b,_c7c){var _c7d=this._mappingManager.findOne("wrapper",_c7b);var _c7e=_c7d.propertyName;if(_c7d.overlayItem){_c7d.overlayItem.set("updated",true);}this.viewModel.setProperty(_c7e,_c7c);},_onWrapperStopEdit:function(_c7f,_c80,_c81,_c82){var _c83=this._mappingManager.findOne("wrapper",_c7f);var _c84=_c83.propertyName;this.viewModel.commitProperty(_c84,_c80,_c81);this._save();if(_c83.overlayItem){_c83.overlayItem.set("active",false);}this._activeEditor=null;},_onWrapperCancel:function(_c85,_c86){var _c87=this._mappingManager.findOne("wrapper",_c85);var _c88=_c87.updateController;if(_c88&&_c88.renderSettings&&_c88.renderSettings.rerenderOnCancel){_c88.render();}if(_c85.get("isModified")){this._save();}if(_c87.overlayItem){_c87.overlayItem.set("active",false);}this._activeEditor=null;},_undo:function(){setTimeout(lang.hitch(this,function(){this.viewModel.undo();}),0);},_redo:function(){setTimeout(lang.hitch(this,function(){this.viewModel.redo();}),0);},_toggleUndoRedoActions:function(_c89,_c8a){this._setCommandEnabled("undo",!!_c89);this._setCommandEnabled("redo",!!_c8a);},_save:function(){if(!this.viewModel||!this.viewModel.hasPendingChanges){return;}_c18.when(this.viewModel.save(),lang.hitch(this,this._reloadPropertyPreview));},_reloadPropertyPreview:function(){if(!this.viewModel.isSaved){this._save();return;}var _c8b=this._activeEditor&&(this._activeEditor.propertyName===this._reloadRequiredProperty);if(this._reloadRequiredProperty&&!_c8b){this._toggleUndoRedoActions(false,false);this.onReloadRequired();this._reloadRequiredProperty=null;}}});});},"epi/cms/widget/TinyMCEEditor":function(){require({cache:{"url:epi/cms/widget/templates/TinyMCEEditor.html":"<div id=\"widget_${id}\" style=\"position: relative; display: inline-block;\">\r\n    <div style=\"display: inline-block\" data-dojo-attach-point=\"stateNode, tooltipNode\">\r\n        <textarea data-dojo-attach-point=\"editorFrame\" id=\"${id}_editorFrame\" style=\"border: none;\"></textarea>\r\n    </div>\r\n    <div data-dojo-attach-point=\"dndOverlay\" style=\"background: rgba(0, 0, 0, 0.01); position: absolute; left: 0; top: 0; right: 0; bottom: 0; display: none\"></div>\r\n</div>\r\n"}});define("epi/cms/widget/TinyMCEEditor",["dojo/_base/config","dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/dom-style","dojo/dom-class","dojo/io/script","dijit/_Widget","dijit/_TemplatedMixin","dijit/_CssStateMixin","dijit/Tooltip","epi/shell/dnd/Target","epi/shell/layout/_LayoutWidget","epi/cms/widget/_HasChildDialogMixin","epi/cms/widget/_UserResizable","epi/shell/widget/_ValueRequiredMixin","epi/cms/widget/_DndStateMixin","dojo/text!./templates/TinyMCEEditor.html","epi/i18n!epi/cms/nls/tinymce"],function(_c8c,_c8d,lang,_c8e,_c8f,_c90,_c91,_c92,_c93,_c94,_c95,_c96,_c97,_c98,_c99,_c9a,_c9b,_c9c,_c9d){return _c8d("epi.cms.widget.TinyMCEEditor",[_c97,_c93,_c98,_c99,_c94,_c9a,_c9b],{baseClass:"epiTinyMCEEditor",width:null,height:null,value:null,intermediateChanges:true,templateString:_c9c,settings:null,routes:epi.routes,_registerIframeHandle:null,_mousedownResizeHandle:null,dirtyCheckInterval:10000,autoResizable:false,isResized:false,tinymceRendered:null,dropTarget:null,readOnly:false,_dirtyCheckTimeout:null,constructor:function(_c9e){lang.mixin(this,_c9e);this.tinymceRendered=new _c8e();},postMixInProperties:function(){if(this.autoResizable){this.height=0;}},postCreate:function(){if(!window.tinymce){var _c9f=this.routes.getActionPath({moduleArea:"Util",path:_c8c.isDebug?"Editor/tinymce/tiny_mce_src.js":"Editor/tinymce/tiny_mce.js"});dojo.io.script.get({url:_c9f,load:lang.hitch(this,function(){tinymce.addI18n({en:_c9d});setTimeout(lang.hitch(this,this._initTinyMCE),1);}),error:function(){}});}else{setTimeout(lang.hitch(this,this._initTinyMCE),1);}this.dropTarget=new _c96(this.dndOverlay,{accept:["fileurl","link"],createItemOnDrop:false,readOnly:this.readOnly});this.connect(this.dropTarget,"onDropData","_onDropData");this.connect(this.dndOverlay,"onmousemove","_onOverlayMouseMove");this.inherited(arguments);},destroy:function(){dijit.unregisterIframe(this._registerIframeHandle);this.disconnect(this._mousedownResizeHandle);this._cancelDirtyCheckInterval();this.inherited(arguments);},canAccept:function(){return !_c90.contains(this.dndOverlay,"dojoDndTargetDisabled");},_onDndStart:function(){_c8f.set(this.dndOverlay,"display","block");this.inherited(arguments);},_onDndCancel:function(){_c8f.set(this.dndOverlay,"display","none");this.inherited(arguments);},_onDndDrop:function(){_c8f.set(this.dndOverlay,"display","none");this.inherited(arguments);},_onOverlayMouseMove:function(evt){this._dragPosition={x:evt.pageX,y:evt.pageY};},_onDropData:function(_ca0,_ca1,_ca2,copy){var _ca3=_ca0?(_ca0.length?_ca0[0]:_ca0):null;if(!_ca3){return;}if(this.parent&&!this.parent.editing){var _ca4=this.parent.watch("editing",lang.hitch(this,function(){if(this.parent.editing){_ca4.unwatch();this._dropDataProcessor(_ca3);}}));this.onFocus();return;}this._dropDataProcessor(_ca3);},_dropDataProcessor:function(_ca5){_c8e.when(_ca5.data,lang.hitch(this,function(data){var type=_ca5.type;var html;var ed=this.getEditor();if(type.indexOf("link")!=-1){if(!ed.selection.isCollapsed()){ed.focus();ed.execCommand("CreateLink",false,data.url);return;}else{html="<a href=\""+data.url+"\">"+data.text+"</a>";}}else{if(type.indexOf("fileurl")!=-1){var _ca6=/^\S+\.*(jpg|jpeg|jpe|ico|gif|bmp|png)$/;if(data.toLowerCase().match(_ca6,"i")){html="<img src=\""+data+"\" alt=\"\" />";}else{var text=data;var _ca7=data.lastIndexOf("/");if(_ca7>-1){text=decodeURI(data.substring(_ca7+1,data.length));}html="<a target=\"_blank\" href=\""+data+"\">"+text+"</a>";}}}if(html){var s=ed.selection;ed.focus();s.setContent(html);ed.undoManager.add();this._onChange(ed.getContent());}}));_c8f.set(this.dndOverlay,"display","none");},focus:function(){this._set("state","Focused");var ed=this.getEditor();if(ed!=null){this._focused=true;ed._gainedFocus=true;_c8e.when(this.tinymceRendered,lang.hitch(this,function(){tinymce.execCommand("mceFocus",false,this.editorFrame.id);}));}},validate:function(){return this.inherited(arguments);},getEditor:function(){return (typeof tinymce!=="undefined"&&tinymce!=null?tinymce.get(this.editorFrame.id):null);},resizeEditor:function(){var ed=this.getEditor();var _ca8=0;var _ca9=(tinymce.isIE?document.body.clientHeight:window.innerHeight)-200;var _caa=(tinymce.isIE?document.body.clientWidth:window.innerWidth)-200;var d=ed.getDoc(),b=d.body,DOM=tinymce.DOM,_cab=this.height,_cac=this.width,_cad,_cae;_cad=b.scrollHeight;_cae=b.scrollWidth;if(_cad>_ca8){_cab=_cad;}if(_cad>_ca9){_cab=_ca9;}if(_cae>_caa){_cac=_caa;}DOM.setStyle(ed.contentWindow.frameElement,"height",_cab+80+"px");if(ed.getBody().scrollWidth!=ed.getBody().offsetWidth){var _caf=20;if(_cab==_ca9){_caf=30;}DOM.setStyle(ed.contentWindow.frameElement,"width",ed.getBody().scrollWidth+_caf+"px");}this.isResized=true;},_setValueAttr:function(_cb0){var _cb1=(_cb0===null||_cb0===undefined);this._emptyRawValue=_cb1;this._rawValue=_cb0;this.value=_cb0;if(_cb1){this.value="";}var _cb2=function(t){var _cb3=t.getEditor();if(_cb3!=null){_cb3.setContent(t.value);}this._started&&setTimeout(lang.hitch(t,t.validate),0);};_c8e.when(this.tinymceRendered,lang.hitch(this,function(){_cb2(this);}));},_getValueAttr:function(){if(this._emptyRawValue){return this._rawValue;}else{return this.value;}},_initTinyMCE:function(){this.settings=lang.mixin(this.settings,{mode:"exact",width:this.width,height:this.height,setup:lang.hitch(this,this._setupEditorEventHandling),relative_urls:false,elements:this.editorFrame.id,readonly:this.readOnly});this.editorFrame.value=this.value||"";if(typeof tinymce!=="undefined"){tinymce.dom.Event.domLoaded=true;tinymce.init(this.settings);this._startDirtyCheckInterval();}else{console.error("Couldn't initialize the editor");}},_onPostRender:function(ed){if(this.tinymceRendered.fired!==0){this.tinymceRendered.resolve();this._registerIframeHandle=dijit.registerIframe(ed.contentWindow.frameElement);this._handlePopupMenu(ed);this._handlePopupWindow(ed);this._handleResize(ed);}},_handlePopupWindow:function(ed){ed.windowManager.onOpen.add(lang.hitch(this,function(){this.isShowingChildDialog=true;}));ed.windowManager.onClose.add(lang.hitch(this,function(){this.focus();this.isShowingChildDialog=false;}));},_handlePopupMenu:function(ed){var _cb4;for(var i in ed.controlManager.controls){_cb4=ed.controlManager.controls[i];if(_cb4.onRenderMenu){_cb4.onRenderMenu.add(lang.hitch(this,function(_cb5,menu){menu.onShowMenu.add(lang.hitch(this,function(){this.isShowingChildDialog=true;}));menu.onHideMenu.add(lang.hitch(this,function(){this.isShowingChildDialog=false;}));}));}}},_handleResize:function(ed){var _cb6=dojo.byId(ed.id+"_resize");this._mousedownResizeHandle=this.connect(_cb6,"onmousedown",function(){this.onResizeStart();var _cb7,_cb8;var _cb9=lang.hitch(this,function(){this.onResizeStop();this.onLayoutChanged();this.disconnect(_cb7);this.disconnect(_cb8);});_cb7=this.connect(dojo.doc,"onmouseup",_cb9);_cb8=this.connect(ed.getDoc(),"onmouseup",_cb9);});},_setupEditorEventHandling:function(ed){ed.onPreInit.add(lang.hitch(this,function(){this.connect(ed.getBody(),"ondrop",function(evt){ed.undoManager.typing=true;setTimeout(function(){ed.undoManager.typing=false;ed.undoManager.add();},500);});}));ed.onInit.add(function(){ed.undoManager.add();});ed.onSetContent.add(lang.hitch(this,function(ed,e){this.onSetContent(ed);}));ed.onPostRender.add(lang.hitch(this,function(ed,e){this._onPostRender(ed);}));ed.onKeyUp.add(lang.hitch(this,function(ed,e){this.onKeyUp();}));ed.onChange.add(lang.hitch(this,function(ed,e){this._onChange(ed.getContent());}));ed.onRemove.add(lang.hitch(this,function(ed){this.onEditorRemoved(ed);}));ed.onRedo.add(lang.hitch(this,function(ed,_cba){this.onRedo(ed,_cba);}));ed.onUndo.add(lang.hitch(this,function(ed,_cbb){this.onUndo(ed,_cbb);}));ed.onBeforeExecCommand.add(lang.hitch(this,function(ed,cmd,ui,val,a){if(cmd==="mceFullScreen"){this.isShowingChildDialog=!this.isShowingChildDialog;}}));},onSetContent:function(ed){if(this.isResized){this._hasPendingChanges=this.value!=ed.getContent()||this._hasPendingChanges;}if(this.autoResizable&&!this.isResized){setTimeout(lang.hitch(this,function(){this.resizeEditor();}),200);}else{if(!this.isResized){this.isResized=true;}}this.onLayoutChanged();},onEditorRemoved:function(ed){},onKeyUp:function(){if(this._checkTimeout){clearTimeout(this._checkTimeout);}var ed=this.getEditor();if(ed){this._hasPendingChanges=ed.undoManager.typing;}this._checkTimeout=setTimeout(lang.hitch(this,this._dirtyCheck),2000);},_onChange:function(val){this.value=val;this._emptyRawValue=false;if(this.validate()){this._hasPendingChanges=false;this.onChange(this.value);}},onChange:function(val){},_onBlur:function(){this._focused=false;if(this.get("state")==="Focused"){this._set("state","");}this.displayMessage(null);var ed=this.getEditor();if(ed&&ed.undoManager&&ed.undoManager.typing){ed.undoManager.typing=0;ed.undoManager.add();}if(this._hasPendingChanges){var val=ed.getContent();if(!this.intermediateChanges){this._onChange(val);}else{this.value=val;this._emptyRawValue=false;}}this.inherited(arguments);},_cancelDirtyCheckInterval:function(){if(this._dirtyCheckTimeout){clearTimeout(this._dirtyCheckTimeout);this._dirtyCheckTimeout=null;}},_startDirtyCheckInterval:function(){if(this._destroyed||!this.intermediateChanges){return;}this._cancelDirtyCheckInterval();this._dirtyCheck();this._dirtyCheckTimeout=setTimeout(lang.hitch(this,this._startDirtyCheckInterval),this.dirtyCheckInterval);},_dirtyCheck:function(){var ed=this.getEditor();if(ed){if(this._hasPendingChanges){this._onChange(ed.getContent());}}},onRedo:function(ed,_cbc){this._hasPendingChanges=true;},onUndo:function(ed,_cbd){this._hasPendingChanges=true;}});});},"epi/shell/command/_SelectionCommandMixin":function(){define(["dojo/_base/declare","dojo/_base/lang"],function(_cbe,lang){return _cbe(null,{selection:null,postscript:function(){this.inherited(arguments);this.selection.watch("data",lang.hitch(this,this._onModelChange));}});});},"epi/cms/widget/viewmodel/ContentStatusViewModel":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/Stateful","epi/dependency","epi/shell/_StatefulGetterSetterMixin","epi/cms/contentediting/ContentActionSupport","epi/i18n!epi/cms/nls/episerver.cms.contentediting.versionstatus"],function(_cbf,_cc0,_cc1,lang,_cc2,_cc3,_cc4,_cc5,_cc6){return _cc0([_cc2,_cc4],{store:null,statusIcon:null,statusMessage:null,postscript:function(){this.inherited(arguments);this._setupDefaultSettings();},_setContentLinkAttr:function(_cc7){if(!_cc7||_cc7===""){return;}_cc1.when(this.store.get(_cc7),lang.hitch(this,function(_cc8){if(_cc8&&_cc8.status!==undefined){this.set("isDeleted",_cc8.isDeleted);this.set("isTranslationNeeded",_cc8.missingLanguageBranch&&_cc8.missingLanguageBranch.isTranslationNeeded);this.set("contentStatus",_cc8.status);}}));},_setContentStatusAttr:function(_cc9){this._set("contentStatus",_cc9);this.set("statusMessage",this.getStatusMessage(_cc9));this.set("statusIcon",this.getStatusIcon(_cc9));},_setUpdateStatusMessageArrayAttr:function(_cca,_ccb){this._updateArrayByIndex("statusMessageArray",_cca,_ccb);},_setUpdateStatusIconArrayAttr:function(_ccc,_ccd){this._updateArrayByIndex("statusIconArray",_ccc,_ccd);},getStatusMessage:function(_cce){if(this.isDeleted){return _cc6.versionnotfound;}if(this.isTranslationNeeded){return _cc6.translationrequired;}return this.get("statusMessageArray")[_cce];},getStatusIcon:function(_ccf){return this.get("statusIconArray")[_ccf];},validateStatus:function(_cd0){if(this.isDeleted||this.isTranslationNeeded){return true;}var _cd1=this.get("noShowCodeArray");if(!_cd1||!lang.isArray(_cd1)||_cd1.length===0){return true;}if(_cd0==null){return false;}return !_cbf.some(_cd1,function(_cd2){return _cd0===_cd2;});},_updateArrayByIndex:function(_cd3,_cd4,_cd5){var _cd6=this.get(_cd3);_cbf.forEach(_cd4,function(_cd7,_cd8){_cd6[_cd7]=_cd5[_cd8];this._set(_cd3,_cd6);},this);},_setupDefaultSettings:function(){this.store=this.store||_cc3.resolve("epi.storeregistry").get("epi.cms.content.light");var _cd9=[_cc5.versionStatus.Published],_cda=[["epi-statusIndicatorIcon","epi-statusIndicator0"],["epi-statusIndicatorIcon","epi-statusIndicator1"],["epi-statusIndicatorIcon","epi-statusIndicator2"],["epi-statusIndicatorIcon","epi-statusIndicator3"],["epi-statusIndicatorIcon","epi-statusIndicator4"],["epi-statusIndicatorIcon","epi-statusIndicator5"],["epi-statusIndicatorIcon","epi-statusIndicator6"],["epi-statusIndicatorIcon","epi-statusIndicator7"]],_cdb=[_cc6.notcreated,_cc6.rejected,_cc6.checkedout,_cc6.checkedin,_cc6.published,_cc6.previouslypublished,_cc6.delayedpublish,_cc6.expired];this._set("noShowCodeArray",_cd9);this._set("statusIconArray",_cda);this._set("statusMessageArray",_cdb);}});});},"dojox/embed/Flash":function(){define("dojox/embed/Flash",["dojo"],function(dojo){dojo.getObject("embed",true,dojox);var _cdc,_cdd;var _cde=9;var _cdf="dojox-embed-flash-",_ce0=0;var _ce1={expressInstall:false,width:320,height:240,swLiveConnect:"true",allowScriptAccess:"sameDomain",allowNetworking:"all",style:null,redirect:null};function prep(_ce2){_ce2=dojo.delegate(_ce1,_ce2);if(!("path" in _ce2)){console.error("dojox.embed.Flash(ctor):: no path reference to a Flash movie was provided.");return null;}if(!("id" in _ce2)){_ce2.id=(_cdf+_ce0++);}return _ce2;};if(dojo.isIE){_cdc=function(_ce3){_ce3=prep(_ce3);if(!_ce3){return null;}var p;var path=_ce3.path;if(_ce3.vars){var a=[];for(p in _ce3.vars){a.push(p+"="+_ce3.vars[p]);}_ce3.params.FlashVars=a.join("&");delete _ce3.vars;}var s="<object id=\""+_ce3.id+"\" "+"classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" "+"width=\""+_ce3.width+"\" "+"height=\""+_ce3.height+"\""+((_ce3.style)?" style=\""+_ce3.style+"\"":"")+">"+"<param name=\"movie\" value=\""+path+"\" />";if(_ce3.params){for(p in _ce3.params){s+="<param name=\""+p+"\" value=\""+_ce3.params[p]+"\" />";}}s+="</object>";return {id:_ce3.id,markup:s};};_cdd=(function(){var _ce4=10,_ce5=null;while(!_ce5&&_ce4>7){try{_ce5=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+_ce4--);}catch(e){}}if(_ce5){var v=_ce5.GetVariable("$version").split(" ")[1].split(",");return {major:(v[0]!=null)?parseInt(v[0]):0,minor:(v[1]!=null)?parseInt(v[1]):0,rev:(v[2]!=null)?parseInt(v[2]):0};}return {major:0,minor:0,rev:0};})();dojo.addOnUnload(function(){var _ce6=function(){};var objs=dojo.query("object").reverse().style("display","none").forEach(function(i){for(var p in i){if((p!="FlashVars")&&dojo.isFunction(i[p])){try{i[p]=_ce6;}catch(e){}}}});});}else{_cdc=function(_ce7){_ce7=prep(_ce7);if(!_ce7){return null;}var p;var path=_ce7.path;if(_ce7.vars){var a=[];for(p in _ce7.vars){a.push(p+"="+_ce7.vars[p]);}_ce7.params.flashVars=a.join("&");delete _ce7.vars;}var s="<embed type=\"application/x-shockwave-flash\" "+"src=\""+path+"\" "+"id=\""+_ce7.id+"\" "+"width=\""+_ce7.width+"\" "+"height=\""+_ce7.height+"\""+((_ce7.style)?" style=\""+_ce7.style+"\" ":"")+"pluginspage=\""+window.location.protocol+"//www.adobe.com/go/getflashplayer\" ";if(_ce7.params){for(p in _ce7.params){s+=" "+p+"=\""+_ce7.params[p]+"\"";}}s+=" />";return {id:_ce7.id,markup:s};};_cdd=(function(){var _ce8=navigator.plugins["Shockwave Flash"];if(_ce8&&_ce8.description){var v=_ce8.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split(".");return {major:(v[0]!=null)?parseInt(v[0]):0,minor:(v[1]!=null)?parseInt(v[1]):0,rev:(v[2]!=null)?parseInt(v[2]):0};}return {major:0,minor:0,rev:0};})();}dojox.embed.Flash=function(_ce9,node){if(location.href.toLowerCase().indexOf("file://")>-1){throw new Error("dojox.embed.Flash can't be run directly from a file. To instatiate the required SWF correctly it must be run from a server, like localHost.");}this.available=dojox.embed.Flash.available;this.minimumVersion=_ce9.minimumVersion||_cde;this.id=null;this.movie=null;this.domNode=null;if(node){node=dojo.byId(node);}setTimeout(dojo.hitch(this,function(){if(_ce9.expressInstall||this.available&&this.available>=this.minimumVersion){if(_ce9&&node){this.init(_ce9,node);}else{this.onError("embed.Flash was not provided with the proper arguments.");}}else{if(!this.available){this.onError("Flash is not installed.");}else{this.onError("Flash version detected: "+this.available+" is out of date. Minimum required: "+this.minimumVersion);}}}),100);};dojo.extend(dojox.embed.Flash,{onReady:function(_cea){},onLoad:function(_ceb){},onError:function(msg){},_onload:function(){clearInterval(this._poller);delete this._poller;delete this._pollCount;delete this._pollMax;this.onLoad(this.movie);},init:function(_cec,node){this.destroy();node=dojo.byId(node||this.domNode);if(!node){throw new Error("dojox.embed.Flash: no domNode reference has been passed.");}var p=0,_ced=false;this._poller=null;this._pollCount=0;this._pollMax=15;this.pollTime=100;if(dojox.embed.Flash.initialized){this.id=dojox.embed.Flash.place(_cec,node);this.domNode=node;setTimeout(dojo.hitch(this,function(){this.movie=this.byId(this.id,_cec.doc);this.onReady(this.movie);this._poller=setInterval(dojo.hitch(this,function(){try{p=this.movie.PercentLoaded();}catch(e){}if(p==100){this._onload();}else{if(p==0&&this._pollCount++>this._pollMax){clearInterval(this._poller);throw new Error("Building SWF failed.");}}}),this.pollTime);}),1);}},_destroy:function(){try{this.domNode.removeChild(this.movie);}catch(e){}this.id=this.movie=this.domNode=null;},destroy:function(){if(!this.movie){return;}var test=dojo.delegate({id:true,movie:true,domNode:true,onReady:true,onLoad:true});for(var p in this){if(!test[p]){delete this[p];}}if(this._poller){dojo.connect(this,"onLoad",this,"_destroy");}else{this._destroy();}},byId:function(_cee,doc){doc=doc||document;if(doc.embeds[_cee]){return doc.embeds[_cee];}if(doc[_cee]){return doc[_cee];}if(window[_cee]){return window[_cee];}if(document[_cee]){return document[_cee];}return null;}});dojo.mixin(dojox.embed.Flash,{minSupported:8,available:_cdd.major,supported:(_cdd.major>=_cdd.required),minimumRequired:_cdd.required,version:_cdd,initialized:false,onInitialize:function(){dojox.embed.Flash.initialized=true;},__ie_markup__:function(_cef){return _cdc(_cef);},proxy:function(obj,_cf0){dojo.forEach((dojo.isArray(_cf0)?_cf0:[_cf0]),function(item){this[item]=dojo.hitch(this,function(){return (function(){return eval(this.movie.CallFunction("<invoke name=\""+item+"\" returntype=\"javascript\">"+"<arguments>"+dojo.map(arguments,function(item){return __flash__toXML(item);}).join("")+"</arguments>"+"</invoke>"));}).apply(this,arguments||[]);});},obj);}});dojox.embed.Flash.place=function(_cf1,node){var o=_cdc(_cf1);node=dojo.byId(node);if(!node){node=dojo.doc.createElement("div");node.id=o.id+"-container";dojo.body().appendChild(node);}if(o){node.innerHTML=o.markup;return o.id;}return null;};dojox.embed.Flash.onInitialize();return dojox.embed.Flash;});},"epi/cms/contentediting/viewsettings/ChannelViewSetting":function(){define(["dojo/_base/declare","dojo/_base/lang","epi/cms/contentediting/_ViewSetting"],function(_cf2,lang,_cf3){return _cf2([_cf3],{key:"epichannel",usedForRendering:true,isTagItem:true,beforePreviewLoad:function(_cf4,_cf5){this.inherited(arguments);var _cf6=_cf5?this._getPreviewChannel():null;lang.mixin(_cf4,{epichannel:_cf6});},_getPreviewChannel:function(){return this.value;}});});},"url:epi/cms/widget/templates/BlockArea.html":"<div data-dojo-attach-point=\"item\" class=\"epi-overlay-item\">\r\n    <div class=\"epi-overlay-item-container\">\r\n        <span class=\"epi-overlay-item-info\">${displayName}</span>\r\n        <div class=\"epi-overlay-bracket\"></div>\r\n    </div>\r\n    <div data-dojo-attach-point=\"containerNode\" class=\"epi-overlay-blockarea-container\"></div>\r\n    <div data-dojo-attach-point=\"actionsNode\" class=\"epi-overlay-blockarea-actionscontainer\">\r\n        <div data-dojo-attach-point=\"actionsNodeControls\" class=\"epi-overlay-blockarea-actions\">\r\n        </div>\r\n    </div>\r\n</div>","epi/cms/contentediting/InlineEditorWrapper":function(){define("epi/cms/contentediting/InlineEditorWrapper",["epi","dojo","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom-style","dijit","epi/cms/contentediting/_EditorWrapperBase"],function(epi,dojo,_cf7,_cf8,lang,_cf9,_cfa,_cfb){return _cf8("epi.cms.contentediting.InlineEditorWrapper",[_cfb],{width:"100%",_createEditor:function(){this._createdEditor=true;var _cfc=this._computeStyling();dojo["require"](this.editorWidgetType);var cls=dojo.getObject(this.editorWidgetType);var _cfd=lang.delegate(this.editorParams,{style:_cfc});this.editorWidget=new cls(_cfd);this.editorWidget.set("value",this.value);dojo.place(this.editorWidget.domNode,this.overlayItem.domNode);var ew=this.editorWidget;this.connect(ew,"onClick",function(e){dojo.stopEvent(e);});if(this.autoSave){this.connect(ew,"onBlur","_onBlur");this.connect(ew,"onChange","_onEditorChange");this.connect(ew,"onKeyPress","_onEditorKeyPress");}else{if("intermediateChanges" in ew){ew.set("intermediateChanges",true);this.connect(ew,"onChange","_onIntermediateChange");}}},_computeStyling:function(){var _cfe=this.blockDisplayNode,_cff=_cf9.getComputedStyle(this.blockDisplayNode),_d00="line-height:"+_cff.lineHeight+";",_d01=_cf9.getComputedStyle(this.domNode);_cf7.forEach(["Weight","Family","Size","Style"],function(prop){var _d02=_cff["font"+prop],_d03=_d01["font"+prop];if(_d03!=_d02){_d00+="font-"+prop+":"+_cff["font"+prop]+";";}},this);var _d04=this.width;if(_d04=="100%"){_d00+="width:100%;";}else{_d00+="width:"+(_d04+(Number(_d04)==_d04?"px":""))+";";}_d00+="position: absolute; left: -2px; top: -2px;";return _d00;},_onEditorChange:function(val){if(this.hasBeenEdited()){this._onChange(val);}},startEdit:function(){if(this.editorWidget){dojo.style(this.editorWidget.domNode,{visibility:"visible"});}else{this._createEditor();}this._blockDisplayNodeOpacity=_cf9.get(this.blockDisplayNode,"opacity");_cf9.set(this.blockDisplayNode,"opacity","0.5");this.inherited(arguments);if(dojo.isIE){_cfa.focus(_cfa.getFocus());}setTimeout(dojo.hitch(this,function(){this.focus();}),0);},_onIntermediateChange:function(val){},_onBlur:function(){this.tryToStopEditing(true);},_removeEditingFeatures:function(){_cf9.set(this.blockDisplayNode,"opacity",this._blockDisplayNodeOpacity);dojo.style(this.editorWidget.domNode,{visibility:"hidden"});},_onTryToStopWithInvalidValue:function(){this.inherited(arguments);this.focus();}});});},"dijit/ProgressBar":function(){require({cache:{"url:dijit/templates/ProgressBar.html":"<div class=\"dijitProgressBar dijitProgressBarEmpty\" role=\"progressbar\"\n\t><div  data-dojo-attach-point=\"internalProgress\" class=\"dijitProgressBarFull\"\n\t\t><div class=\"dijitProgressBarTile\" role=\"presentation\"></div\n\t\t><span style=\"visibility:hidden\">&#160;</span\n\t></div\n\t><div data-dojo-attach-point=\"labelNode\" class=\"dijitProgressBarLabel\" id=\"${id}_label\"></div\n\t><img data-dojo-attach-point=\"indeterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\" alt=\"\"\n/></div>\n"}});define("dijit/ProgressBar",["require","dojo/_base/declare","dojo/dom-class","dojo/_base/lang","dojo/number","./_Widget","./_TemplatedMixin","dojo/text!./templates/ProgressBar.html"],function(_d05,_d06,_d07,lang,_d08,_d09,_d0a,_d0b){return _d06("dijit.ProgressBar",[_d09,_d0a],{progress:"0",value:"",maximum:100,places:0,indeterminate:false,label:"",name:"",templateString:_d0b,_indeterminateHighContrastImagePath:_d05.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);if(!("value" in this.params)){this.value=this.indeterminate?Infinity:this.progress;}},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());this.update();},update:function(_d0c){lang.mixin(this,_d0c||{});var tip=this.internalProgress,ap=this.domNode;var _d0d=1;if(this.indeterminate){ap.removeAttribute("aria-valuenow");ap.removeAttribute("aria-valuemin");ap.removeAttribute("aria-valuemax");}else{if(String(this.progress).indexOf("%")!=-1){_d0d=Math.min(parseFloat(this.progress)/100,1);this.progress=_d0d*this.maximum;}else{this.progress=Math.min(this.progress,this.maximum);_d0d=this.maximum?this.progress/this.maximum:0;}ap.setAttribute("aria-describedby",this.labelNode.id);ap.setAttribute("aria-valuenow",this.progress);ap.setAttribute("aria-valuemin",0);ap.setAttribute("aria-valuemax",this.maximum);}this.labelNode.innerHTML=this.report(_d0d);_d07.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);tip.style.width=(_d0d*100)+"%";this.onChange();},_setValueAttr:function(v){this._set("value",v);if(v==Infinity){this.update({indeterminate:true});}else{this.update({indeterminate:false,progress:v});}},_setLabelAttr:function(_d0e){this._set("label",_d0e);this.update();},_setIndeterminateAttr:function(_d0f){this.indeterminate=_d0f;this.update();},report:function(_d10){return this.label?this.label:(this.indeterminate?"&#160;":_d08.format(_d10,{type:"percent",places:this.places,locale:this.lang}));},onChange:function(){}});});},"epi/cms/contentediting/LanguageNotification":function(){define("epi/cms/contentediting/LanguageNotification",["dojo/_base/declare","dojo/_base/lang","dojo/Stateful","epi/shell/_ContextMixin","epi/cms/contentediting/command/Editing"],function(_d11,lang,_d12,_d13,_d14){return _d11([_d12,_d13],{contentData:null,notification:null,commands:[_d14.translate],set:function(name,_d15){if(name==="contentData"&&_d15){dojo.when(this.getCurrentContext(),lang.hitch(this,function(_d16){this._setNotification(_d16);}));}this.inherited(arguments);},_setNotification:function(_d17){if(!_d17.languageContext){return;}if(!_d17.languageContext.warning){this.set("notification",null);return;}if(_d17.languageContext.isTranslationNeeded){this.commands=[_d14.translate];}else{this.commands=[];}this.set("notification",{content:_d17.languageContext.warning,commands:this.commands});},contextUpdated:function(ctx,_d18){this._setNotification(ctx);}});});},"epi/cms/widget/command/RestoreContent":function(){define(["dojo/_base/declare","epi/shell/command/_Command"],function(_d19,_d1a){return _d19([_d1a],{content:null,_execute:function(){if(this.canExecute&&this.content){this.model.restore(this.content);}},_onModelChange:function(){var _d1b=!!this.model;this.set("canExecute",_d1b);}});});},"url:epi/cms/component/templates/SharedBlocks.html":"<div>\r\n    <div class=\"epi-gadgetInnerToolbar\" data-dojo-attach-point=\"searchBoxContainer\">\r\n        <div data-dojo-type=\"epi.cms.widget.SearchBox\" data-dojo-attach-point=\"searchBox\" ></div>\r\n    </div>\r\n    <div data-dojo-attach-point=\"container\" data-dojo-type=\"dijit.layout.BorderContainer\" class=\"epi-sharedBlockContainer\">\r\n        <div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-props=\"splitter:false, region:'center'\" class=\"epi-widgetResizeContent epi-secondaryGadgetContainer epi-gadgetTopContainer\" data-dojo-attach-point=\"folderContainerNode\">\r\n            <div data-dojo-attach-point=\"folderList\" data-dojo-type=\"epi.cms.widget.FolderList\"></div>\r\n        </div>\r\n        <div data-dojo-type=\"dijit.layout.ContentPane\" class=\"epi-blockContainer\" data-dojo-props=\"region:'bottom', splitter:true\">\r\n            <div data-dojo-attach-point=\"blockList\" data-dojo-type=\"epi.cms.widget.BlockList\" ></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n","epi/cms/contentediting/commandproviders/PublishMenuGlobal":function(){define(["dojo","dojo/_base/declare","epi/shell/command/withConfirmation","epi/shell/command/_CommandProviderMixin","epi/cms/contentediting/command/ForPublishMenu","epi/cms/contentediting/command/RevertToPublished","epi/cms/contentediting/command/Reject","epi/cms/contentediting/command/SendForReview","epi/cms/contentediting/command/Publish","epi/cms/contentediting/command/Translate","epi/cms/contentediting/command/CreateDraft","epi/cms/contentediting/command/EditCommonDraft","epi/cms/contentediting/command/Withdraw","epi/cms/contentediting/command/ScheduleForPublish","epi/cms/contentediting/command/CancelAndEdit","epi/i18n!epi/cms/nls/episerver.cms.contentediting.editactionpanel.publishactionmenu"],function(dojo,_d1c,_d1d,_d1e,_d1f,_d20,_d21,_d22,_d23,_d24,_d25,_d26,_d27,_d28,_d29,res){return _d1c([_d1e],{constructor:function(){this.inherited(arguments);this.add("commands",_d1f(new _d23(),{resetLabelAfterExecution:false,isMain:true,priority:9000,mainButtonClass:"Sweet",keepMenuOpen:true,successStatus:res.successfullypublished}));this.add("commands",_d1f(new _d24(),{isMain:true,priority:10000,mainButtonClass:"Salt"}));this.add("commands",_d1f(new _d28()));this.add("commands",_d1f(new _d29()));this.add("commands",_d1f(new _d22(),{isMain:true,priority:8000,mainButtonClass:"Sweet",keepMenuOpen:true}));this.add("commands",_d1f(new _d21(),{resetLabelAfterExecution:false,keepMenuOpen:true}));this.add("commands",_d1f(new _d27(),{resetLabelAfterExecution:false,keepMenuOpen:true}));this.add("commands",_d1f(new _d26()));this.add("commands",_d1f(new _d25()));this.add("commands",_d1f(_d1d(new _d20(),null,{title:res.reverttopublishconfirmation.dialogtitle,heading:res.reverttopublishconfirmation.confirmquestion,description:res.reverttopublishconfirmation.description})));}});});},"epi/cms/widget/EmptyTrashMenu":function(){define("epi/cms/widget/EmptyTrashMenu",["dojo/_base/declare","dijit/layout/_LayoutWidget","epi/shell/command/builder/ButtonBuilder","epi/shell/command/builder/DropDownButtonBuilder","epi/shell/command/builder/MenuAssembler","epi/i18n!epi/cms/nls/episerver.cms.components.trash"],function(_d2a,_d2b,_d2c,_d2d,_d2e,_d2f){return _d2a("epi.cms.widget.EmptyTrashMenu",[_d2b],{resources:_d2f,_setCommandsAttr:function(_d30){this._set("commands",_d30);this._bindEmptyTrashMenu(_d30);},_bindEmptyTrashMenu:function(_d31){this.destroyDescendants();if(!_d31||_d31.length<1){return;}var _d32=_d31.length>1;var _d33=null;if(_d32){_d33=new _d2d({settings:{label:_d2f.emptytrash.title,dropDownPosition:["below-alt"]}});}else{_d33=new _d2c({settings:{label:_d2f.emptytrash.title}});this.commands[0].label=_d2f.emptytrash.title;}new _d2e({configuration:[{builder:_d33,target:this}],commandSource:this}).build();},getCommands:function(){return this.get("commands");}});});},"url:epi/shell/widget/overlay/templates/OverlayItemInfo.html":"<span class=\"epi-overlay-content-invisible\">\r\n    <span data-dojo-attach-point=\"highlightArea\" class=\"epi-overlay-content-highlight-area\"></span>\r\n</span>","epi/cms/contentediting/ContentEditingValidator":function(){define("epi/cms/contentediting/ContentEditingValidator",["dojo","dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/_base/connect","dojo/store/Memory","dojo/Stateful","epi/dependency"],function(dojo,_d34,_d35,_d36,lang,_d37,_d38,_d39,_d3a){return _d35("epi.cms.contentediting.ContentEditingValidator",[_d39],{contextTypeName:"",contextId:null,messageService:null,_isBlocking:false,isValid:true,hasErrors:false,_storeId:0,_store:null,severity:{"none":0,"info":1,"warn":2,"error":3},validationSource:{"server":1,"client":2},_errorLevels:{},constructor:function(_d3b){_d35.safeMixin(this,_d3b);},postscript:function(){this.inherited(arguments);for(var p in this.severity){var _d3c=this.severity[p];this._errorLevels[_d3c]=p;}this.messageService=this.messageService||_d3a.resolve("epi.shell.MessageService");this._store=new _d38({idAttribute:"id",data:[]});},setContextId:function(_d3d){var _d3e=this.contextId;this.contextId=_d3d;var _d3f=this.messageService.query({contextTypeName:this.contextTypeName,contextId:_d3e});_d3f.forEach(lang.hitch(this,function(item){item.contextId=this.contextId;this.messageService.put(item);}));},clearPropertyErrors:function(_d40,_d41){if(!_d40){return;}this._clearErrors(_d40,_d41);},setPropertyErrors:function(_d42,_d43,_d44){if(!_d42){return;}this._setErrors(_d43,_d42,_d44);},clearGlobalErrors:function(_d45){this._clearErrors(null,_d45);},clearErrorsBySource:function(_d46){this._clearErrors(undefined,_d46);},setGlobalErrors:function(_d47,_d48){this._setErrors(_d47,null,_d48);},_clearErrors:function(_d49,_d4a){var _d4b;if(_d49){_d4b={"propertyName":_d49};}else{if(_d49===null){_d4b={"global":true};}else{_d4b={};}}if(_d4a!==undefined){_d4b.source=_d4a;}var _d4c=this._store.query(_d4b);_d4c.forEach(lang.hitch(this,function(item){this.messageService.remove({id:item.messageId});this._store.remove(item.id);}));this._updateFlags();},_setErrors:function(_d4d,_d4e,_d4f){this._clearErrors(_d4e,_d4f);_d34.forEach(_d4d,function(item){this._putStoreItem(item,_d4e,_d4f);},this);this._updateFlags();},_putStoreItem:function(item,_d50,_d51){var _d52="";if(this._errorLevels[item.severity]){_d52=this._errorLevels[item.severity];}var _d53=this.messageService.put(_d52,item.errorMessage,this.contextTypeName,this.contextId);var _d54={"id":this._storeId++,"item":item,"severity":item.severity,"messageId":_d53};if(_d50){_d54.propertyName=_d50;}else{_d54.global=true;}if(_d51!==undefined){_d54.source=_d51;}return this._store.put(_d54);},_updateFlags:function(){var _d55=this._store.query({"severity":this.severity.error});var _d56=this._store.query({"severity":this.severity.warn});var _d57=_d55.length===0&&_d56.length===0;var _d58=_d55.length>0;this.set("isValid",_d57);this.set("hasErrors",_d58);},validate:function(){var _d59=this.severity.error,_d5a=this.severity.warn,_d5b=new _d36();_d36.when(this._validate(_d59),function(_d5c){if(_d5c){_d37.publish("/epi/cms/action/showerror");}_d5b.resolve(_d5c);},function(){_d37.publish("/epi/cms/action/showerror");_d5b.cancel();});return _d5b;},_validate:function(_d5d){var _d5e=new _d36();if(!this._isBlocking){_d36.when(this._store.query({"severity":_d5d}),lang.hitch(this,function(_d5f){var _d60=_d34.filter(_d5f,function(item){return item.source==this.validationSource.client;},this);var _d61=_d60.length>0;var _d62=_d5f.length>_d60.length;if(_d61){_d5e.cancel();}else{_d5e.resolve(_d62);}}));}return _d5e;}});});},"url:epi/cms/contentediting/templates/NotificationBar.html":"<div class=\"epi-notificationBar\">\r\n    <div data-dojo-attach-point=\"containerNode\"></div>\r\n</div>","epi/cms/component/SiteTreeModel":function(){define("epi/cms/component/SiteTreeModel",["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/_base/connect","dojo/cookie","epi/shell/_StatefulGetterSetterMixin"],function(_d63,_d64,_d65,lang,_d66,_d67,_d68){return _d64([_d68],{query:null,showAllLanguages:false,constructor:function(_d69){this._store=_d69;this.query={};_d66.subscribe("/epi/cms/contentdata/updated",lang.hitch(this,function(){_d65.when(this.getCurrentSite(),lang.hitch(this,function(_d6a){this.onItemChildrenReload({siteUrl:_d6a.currentSite});}));}));},getRoot:function(_d6b,_d6c){_d6b({});},getIdentity:function(item){var id=this._store.getIdentity(item);if(!id&&!item.isLanguageNode){id="root";}return id;},onItemChildrenReload:function(_d6d){},mayHaveChildren:function(item){if(!item.isLanguageNode){return true;}return false;},getLabel:function(item){return item.name;},getChildren:function(_d6e,_d6f){_d65.when(this._store.query(lang.mixin({siteUrl:_d6e.url},this.query)),_d6f);},_setQuery:function(q){this.query=q;this.onItemChildrenReload({});},_setShowAllLanguagesAttr:function(_d70){this._set("showAllLanguages",_d70);this._setQuery({allLanguages:_d70});},getCurrentSite:function(){var def=new _d65();var _d71=_d67("editlanguagebranch");if(_d71){_d65.when(this._store.get(),lang.hitch(this,function(_d72){var _d73=null;var _d74=document.location.href.toLowerCase();_d63.some(_d72,function(site){var _d75=_d74.lastIndexOf(site.editUrl.toLowerCase(),0)===0;if(_d75){_d73={currentSite:site.url,currentEditLanguageId:site.url+_d71};return true;}});if(_d73){def.resolve(_d73);}else{def.cancel();}}),function(){def.reject(null);});}else{def.reject(null);}return def;},getAllLanguagesForSite:function(_d76){var def=new _d65();_d65.when(this._store.query({siteUrl:_d76,allLanguages:true}),function(_d77){def.resolve(_d77);});return def;},getAllLanguagesForCurrentSite:function(){var def=new _d65();_d65.when(this.getCurrentSite(),lang.hitch(this,function(_d78){this.getAllLanguagesForSite(_d78.currentSite).then(function(_d79){def.resolve(_d79);});}),function(_d7a){def.reject(_d7a);});return def;}});});},"epi/cms/widget/NotificationStatusZone":function(){define("epi/cms/widget/NotificationStatusZone",["dojo","dojo/_base/declare","dijit/_Widget","dijit/_TemplatedMixin"],function(dojo,_d7b,_d7c,_d7d){return _d7b("epi.cms.widget.NotificationStatusZone",[_d7c,_d7d],{templateString:"            <div>                <div class=\"epi-dijitTooltipNotificationBlock epi-dijitTooltipBlock${TypeName}\" data-dojo-attach-point=\"Zone\">                    <span class=\"epi-notificationTypeTitle\"><span class=\"dijitIcon dijitInline epi-dijitTooltip${TypeName}Icon\"></span>${title}</span>                    <ul data-dojo-attach-point=\"contentContainer\"></ul>                </div>            </div>",title:"",type:"",TypeName:"",_hiddenCssClass:"epi-dijitTooltipBlockHidden",postMixInProperties:function(){this.TypeName=this.type.charAt(0).toUpperCase()+this.type.slice(1);},empty:function(){dojo.empty(this.contentContainer);},addRow:function(_d7e,_d7f){dojo.place(_d7e,this.contentContainer,_d7f);},show:function(){dojo.removeClass(this.Zone,this._hiddenCssClass);},hide:function(){dojo.addClass(this.Zone,this._hiddenCssClass);}});});},"epi/cms/contentediting/editors/_PreviewableEditor":function(){require({cache:{"url:epi/cms/contentediting/editors/templates/_PreviewableEditor.html":"<div class=\"dijitReset dijitInline epi-previewableTextBox-wrapper\">\r\n    <span data-dojo-attach-point=\"labelNode\" class=\"epi-previewableTextBox-text dojoxEllipsis dijitInline\"></span>\r\n    <a href=\"#\" data-dojo-attach-point=\"changeNode, focusNode\" class=\"epi-functionLink\">${changeLabel}</a>\r\n</div>\r\n"}});define("epi/cms/contentediting/editors/_PreviewableEditor",["dojo/_base/array","dojo/_base/event","dojo/_base/declare","dojo/_base/lang","dojo/on","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dijit","dijit/_CssStateMixin","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/form/ValidationTextBox","epi","dojo/text!./templates/_PreviewableEditor.html"],function(_d80,_d81,_d82,lang,on,_d83,_d84,_d85,_d86,_d87,_d88,_d89,_d8a,_d8b,epi,_d8c){return _d82("epi.cms.contentediting.editors._PreviewableEditor",[_d88,_d87,_d89,_d8a],{value:null,changeLabel:epi.resources.action.change,templateString:_d8c,control:null,controlParams:[],state:"",_setLabelValueAttr:{node:"labelNode",type:"innerHTML"},_setIsEmptyAttr:function(_d8d){this._set("isEmpty",_d8d);if(_d8d){_d83.add(this.domNode,"epi-state-empty");}else{_d83.remove(this.domNode,"epi-state-empty");}},_setValueAttr:function(_d8e){this._set("value",_d8e);this.control.set("value",_d8e);this.set("labelValue",_d8e);this.set("isEmpty",!_d8e);},onChange:function(val){},buildRendering:function(){this.inherited(arguments);if(!this.control){this.control=new _d8b();}this.control.placeAt(this.domNode,"first");},postCreate:function(){this.inherited(arguments);this._setDisplay(false);this._connects.push(on(this.labelNode,"click",lang.hitch(this,"_onChangeNodeClick")));this._connects.push(on(this.changeNode,"click",lang.hitch(this,"_onChangeNodeClick")));this._connects.push(on(this.control,"Change",lang.hitch(this,"_onControlChange")));this._connects.push(on(this.control,"onBlur",lang.hitch(this,"_onControlBlur")));this.control.watch("state",lang.hitch(this,function(name,old,_d8f){this.set("state",_d8f);}));this.control.validate();this.set("state",this.control.state);_d80.forEach(this.controlParams,function(_d90){this.control.set(_d90,this.get(_d90));},this);},destroyRecursive:function(){if(this.control){this.control.destroyRecursive();}delete this.control;this.inherited(arguments);},onBlur:function(){this._setDisplay(false);},_setDisplay:function(_d91){if(!_d91&&!this.validate()){return;}this.showControl=_d91;_d85.set(this.labelNode,"display",_d91?"none":"");_d85.set(this.control.domNode,"display",_d91?"":"none");if(!this.readOnly){_d85.set(this.changeNode,"display",_d91?"none":"");}},focus:function(){if(this.showControl){this.control.focus();}else{this.changeNode.focus();}},_onControlChange:function(_d92){this._set("value",_d92);this.set("labelValue",_d92);this.set("isEmpty",!_d92);this.onChange(_d92);},_onControlBlur:function(){this._setDisplay(false);},_onChangeNodeClick:function(e){_d81.stop(e);this._setDisplay(true&&!this.readOnly);_d86.selectInputText(this.control.focusNode);},_setReadOnlyAttr:function(_d93){this._set("readOnly",_d93);_d85.set(this.changeNode,"display",this.readOnly?"none":"");this.readOnly&&this._setDisplay(false);},validate:function(){return this.control.validate();},isValid:function(){return this.control.isValid();},getErrorMessage:function(){var _d94=this.get("state")!=="Error";return _d94?"":this.control.invalidMessage;}});});},"epi/cms/widget/ContentTree":function(){define("epi/cms/widget/ContentTree",["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/DeferredList","dojo/keys","dojo/dom-style","dojo/has","epi/dependency","epi/shell/widget/Tree","epi/shell/dnd/tree/dndSource","epi/cms/core/ContentReference","epi/cms/widget/ContentTreeStoreModel","epi/cms/widget/ContentTreeModelConfirmation","epi/cms/widget/_ContentTreeNode"],function(_d95,_d96,_d97,lang,_d98,Keys,_d99,has,_d9a,Tree,_d9b,_d9c,_d9d,_d9e,_d9f){return _d96("epi.cms.widget.ContentTree",[Tree],{root:null,nodeConstructor:null,typeIdentifiers:null,allowManipulation:true,_typeDescriptor:null,_missingSelection:null,postMixInProperties:function(){this.inherited(arguments);if(!this.model){this.model=new _d9d({root:this.root,typeIdentifiers:this.typeIdentifiers});this.persist=false;}if(this.allowManipulation){this.dndController=_d9b;}this.nodeConstructor=this.nodeConstructor||_d9f;var _da0=_d9a.resolve("epi.cms.Application");if(_da0){this._typeDescriptor=_da0.getTypeUIDescriptors();}},buildRendering:function(){this.model=_d9e(this.model);this.inherited(arguments);},_setAllowManipulationAttr:function(_da1){this._set("allowManipulation",_da1);if(_da1){this.dndController=_d9b;}},_onItemDelete:function(item,_da2){function _da3(node,_da4){_d95.forEach(node.getChildren(),function(_da5){_da4.push(_da5.item);_da3(_da5,_da4);});return _da4;};if(_da2){var _da6=this._itemNodesMap[this.model.getIdentity(item)],self=this;if(_da6){_d95.forEach(_da6,function(_da7){var _da8=_da3(_da7,[]).reverse();_d95.forEach(_da8,function(_da9){self._onItemDelete(_da9);});});}}this.inherited(arguments);},_setRootAttr:function(_daa){this._set("root",_daa);if(this.model&&!lang.isArray(_daa)){this.model.root=_daa;}},_setTypeIdentifiersAttr:function(_dab){this._set("typeIdentifiers",_dab);if(this.model){this.model.typeIdentifiers=_dab;}},buildNodeFromTemplate:function(args){return new this.nodeConstructor(args);},_createTreeNode:function(args){var _dac=lang.mixin({},args,{dndData:args.item});var _dad=this.buildNodeFromTemplate(_dac);return _dad;},getIconClass:function(item,_dae){var _daf="epi-iconObjectPage";if(this._typeDescriptor&&item.typeIdentifier){var _db0=this._typeDescriptor[item.typeIdentifier];if(_db0&&_db0.iconClass){_daf=_db0.iconClass;}}var _db1=item.typeIdentifier==="epi.cms.folder";if(_dae&&!item.isSubRoot&&_db1){_daf=_daf+"Open";}return _daf;},focus:function(){var node=this.get("selectedNode");if(node){this.focusNode(node);}else{if(this.rootNode){this.focusNode(this.rootNode);}}},_onItemChildrenChange:function(_db2,_db3){this.inherited(arguments);if(this._missingSelection){var _db4=this.model.getIdentity(this._missingSelection),_db5=this.model;if(_d95.some(_db3,function(_db6){return _db5.getIdentity(_db6)===_db4;})){this.selectContent(this._missingSelection);}}},selectContent:function(_db7,_db8){var _db9=new _d97();if(_db7){this.model.getAncestors(_db7,lang.hitch(this,function(_dba){var _dbb;var path=_d95.map(_dba,function(p){return this.model.getIdentity(p);},this);_dbb=this.model.getIdentity(_db7);var _dbc=new _d9c(_dbb);path.push(_dbc.createVersionUnspecificReference().toString());this._missingSelection=_db7;this.set("paths",[path]).then(lang.hitch(this,function(_dbd){var _dbe=_dbd&&_dbd[0]&&_dbd[0][0];if(_dbe){this._missingSelection=null;var _dbf=_dbd[0][1];if(!this.get("selectedNode")){this._set("selectedNode",_dbf);}if(_db8===true){this.focusNode(_dbf);}_db9.resolve(_dbf);}else{_db9.resolve(null);}}));}));}else{this.set("paths",[]);_db9.resolve(null);}return _db9;},resize:function(_dc0){this.inherited(arguments);if(has("ie")>8){var _dc1=_d99.get(this.domNode,"display");_d99.set(this.domNode,"display","none");_d99.set(this.domNode,"display",_dc1);}},_onKeyPress:function(e){this.inherited(arguments);if(!this.allowManipulation){return;}if(dojo.isCopyKey(e)){switch(e.charOrCode){case "c":case "C":this._onCopyOrCut(true);break;case "x":case "X":this._onCopyOrCut(false);break;case "v":case "V":this._onPaste();break;default:break;}}if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey){return;}if(e.charOrCode==Keys.DELETE){this._onDelete();}},_onCopyOrCut:function(copy){},_onPaste:function(){},_onDelete:function(){}});});},"epi/cms/widget/viewmodel/TrashViewModel":function(){define("epi/cms/widget/viewmodel/TrashViewModel",["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/topic","dojo/Stateful","epi/shell/_StatefulGetterSetterMixin","epi/dependency","epi/i18n!epi/cms/nls/episerver.cms.components.trash"],function(_dc2,_dc3,_dc4,lang,_dc5,_dc6,_dc7,_dc8,_dc9){return _dc3([_dc6,_dc7],{resources:null,trashes:null,currentFeeder:null,queryOptions:null,isEmptyTrash:false,storeRegistry:null,contentStore:null,trashStore:null,showAllLanguages:true,postscript:function(){this.inherited(arguments);this.resources=this.resources||_dc9;this.storeRegistry=_dc8.resolve("epi.storeregistry");this.contentStore=this.contentStore||this._getStore();this.trashStore=this.trashStore||this.storeRegistry.get("epi.cms.wastebasket");if(!this.trashes){this._createTrashes();}},_getStore:function(){var _dca=this.storeRegistry.get("epi.cms.content.light"),_dcb=this;var _dcc=lang.delegate(_dca,{getChildren:function(_dcd,_dce){var _dcf=_dcb.get("currentFeeder"),_dd0=_dcb._createQueryOptions(_dcf);lang.mixin(_dd0.query,{referenceId:_dcd.contentLink});return this.query(_dd0.query,_dd0.options);},mayHaveChildren:function(_dd1){return _dd1.hasChildren;}});return _dcc;},_createFeederFromTrash:function(_dd2){var _dd3=_dc8.resolve("epi.cms.contentediting.systemtrash");if(_dd2.isDefaultProvider&&_dd3){var _dd4=[],_dd5,item;for(_dd5 in _dd3){item=_dd3[_dd5];_dd4=_dd4.concat([lang.mixin(lang.clone(_dd2),lang.clone(item),{name:this.resources[_dd5],isRequireLoad:true})]);}return _dd4;}else{return [lang.mixin(lang.clone(_dd2),{contentSearchAreas:["CMS/Pages","CMS/Blocks"],isRequireLoad:true})];}},_createTrashes:function(){_dc4.when(this.trashStore.query(),lang.hitch(this,function(_dd6){var _dd7=lang.clone(_dd6);_dc2.forEach(_dd7,function(_dd8){_dd8.feeders=this._createFeederFromTrash(_dd8);if(_dd8.isDefaultProvider){_dd8.name=this.resources.defaulttrash;}},this);this.set("trashes",_dd7);}));},_setCurrentFeederAttr:function(_dd9){this._set("currentFeeder",_dd9);if(_dd9.isRequireLoad){this.updateFeeder(_dd9);_dd9.isRequireLoad=false;}},updateFeeder:function(_dda){if(_dda&&_dda.active){this.set("queryOptions",this._createQueryOptions(_dda));}else{this.set("queryOptions",null);}},_createQueryOptions:function(_ddb){var _ddc={referenceId:_ddb.wasteBasketLink,query:"getchildren"};var _ddd={ignore:["query"]};if(this.showAllLanguages){lang.mixin(_ddc,{allLanguages:this.showAllLanguages});_ddd.ignore.push("allLanguages");}if(_ddb.typeIdentifiers){lang.mixin(_ddc,{typeIdentifiers:_ddb.typeIdentifiers});lang.mixin(_ddd,{comparers:this._createComparer()});}if(_ddb.deletedBy){lang.mixin(_ddc,{deletedBy:_ddb.deletedBy});}if(_ddb.isSearchable){lang.mixin(_ddc,{isSearchable:_ddb.isSearchable});_ddd.ignore.push("isSearchable");}if(_ddb.contentSearchAreas){lang.mixin(_ddc,{contentSearchAreas:_ddb.contentSearchAreas});_ddd.ignore.push("contentSearchAreas");}if(_ddb.queryText){lang.mixin(_ddc,{query:"searchcontent"});lang.mixin(_ddc,{matchProvider:true});lang.mixin(_ddc,{queryText:_ddb.queryText});}return {query:_ddc,options:_ddd};},_createComparer:function(){var _dde={};_dde["typeIdentifiers"]=function(_ddf,_de0){return _dc2.some(_ddf,function(_de1){return _de1===_de0.typeIdentifier;});};_dde["queryText"]=function(_de2,_de3){return _de3.name.toLowerCase().indexOf(_de2.toLowerCase())!=-1;};_dde["referenceId"]=function(_de4,_de5){return _de4===_de5.parentLink;};return _dde;},emptyTrash:function(_de6){if(_de6){_dc4.when(this.trashStore.executeMethod("Empty",_de6),lang.hitch(this,function(_de7){var _de8=_dc2.filter(this.get("trashes"),function(_de9){return _de9&&_de9.wasteBasketLink===_de6;});_dc2.forEach(_de8,function(_dea){_dea.deletedByUsers=[];_dc2.forEach(_dea.feeders,function(_deb){_deb.isRequireLoad=true;_deb.deletedByUsers=[];});});if(_de7.isSuccess){this.isEmptyTrash=true;}if(this.currentFeeder.wasteBasketLink===_de6){this.set("currentFeeder",this.currentFeeder);}this.set("actionResponse",{message:_dc9.emptytrash.accessdenied,isSuccess:_de7?_de7.isSuccess:false});}));}},restore:function(_dec,_ded){if(_dec&&_dec.contentLink&&_dec.isDeleted&&_ded){_dc4.when(this.contentStore.move(_dec.contentLink,{targetId:_ded}),lang.hitch(this,function(_dee){if(_dee){this.contentStore.refresh(_dec.contentLink);this.contentStore.refresh(_dec.parentLink).then(lang.hitch(this,function(){this.updateFeeder(this.get("currentFeeder"));}));var _def=this.contentStore.get(_ded);if(_def&&!_def.hasChildren){this.contentStore.refresh(_ded).then(function(_df0){_dc5.publish("/epi/cms/contentdata/restored",_df0);});}}this.set("actionResponse",{message:_dee.message?_dee.message:_dc9.restore.error,isSuccess:_dee?_dee.isSuccess:false});}));}},getOldParent:function(_df1){var df=new _dc4();_dc4.when(this.contentStore.query({referenceId:_df1,query:"getrestorepoint",allLanguages:true}),function(_df2){var _df3=_df2&&lang.isArray(_df2)&&_df2.length>0?_df2[0]:null;df.resolve(_df3);});return df;}});});},"epi/cms/component/SiteTreeNode":function(){define("epi/cms/component/SiteTreeNode",["dojo","dijit/Tree","dojo/dom-class","epi/dependency"],function(dojo,Tree,_df4,_df5){return dojo.declare("epi.cms.component.SiteTreeNode",[Tree._TreeNode],{_updateItemClasses:function(item){this.inherited(arguments);if(item.isLanguageNode&&!item.isAvailable){_df4.add(this.domNode,"epi-st-disabledRow");}if(!item.isLanguageNode){_df4.add(this.iconNode,"epi-iconObjectStart");}}});});},"epi/cms/contentediting/EditActionPanel":function(){require({cache:{"url:epi/cms/contentediting/templates/EditActionPanel.html":"<div style=\"display: inline-block\">\r\n    <div class=\"dijitInline dijitReset\" data-dojo-attach-point=\"stateNode\">\r\n        <span data-dojo-attach-point=\"statusNonEditableIcon\" class=\"dijitInline dijitReset dijitIcon\">&nbsp;</span>\r\n        <span class=\"epi-statusContainer dijitInline dijitReset\">\r\n            <span data-dojo-attach-point=\"statusTextIcon\" class=\"dijitInline dijitReset dijitIcon\"></span>\r\n            <span data-dojo-attach-point=\"statusTextNode\"></span>\r\n        </span><span class=\"epi-statusArrow dijitInline dijitReset\"></span><!-- These need to be on the same line because of stupid. -->\r\n    </div>\r\n\r\n\r\n\r\n    <div data-dojo-attach-point=\"dropDownButton\" data-dojo-type=\"dijit.form.DropDownButton\"\r\n        data-dojo-props=\"label: '${commonRes.action.publish}', 'class': 'epi-mediumButton epi-boldButton'\">\r\n        <div data-dojo-attach-point=\"dropDownMenu\" data-dojo-type=\"epi.cms.contentediting.PublishActionMenu\"></div>\r\n    </div>\r\n</div>"}});define("epi/cms/contentediting/EditActionPanel",["dojo/_base/declare","dojo/_base/lang","dojo/dom-style","dojo/dom-class","dijit/_CssStateMixin","dijit/_TemplatedMixin","dijit/_Widget","dijit/_WidgetsInTemplateMixin","dijit/form/DropDownButton","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/PublishActionMenu","epi/shell/widget/_ModelBindingMixin","epi/i18n!epi/cms/nls/episerver.cms.contentediting.editactionpanel","dojo/text!./templates/EditActionPanel.html"],function(_df6,lang,_df7,_df8,_df9,_dfa,_dfb,_dfc,_dfd,_dfe,_dff,_e00,res,_e01){return _df6("epi.cms.contentediting.EditActionPanel",[_dfb,_dfa,_dfc,_df9,_e00],{templateString:_e01,commonRes:epi.resources,baseClass:"epi-statusIndicator",modelBindingMap:{"state":["state"],"statusText":["statusText"],"visible":["visible"],"buttonText":["buttonText"],"nonEditableIndicator":["nonEditableIndicator"],"statusIcon":["statusIcon"],"publishMenuViewModel":["publishMenuViewModel"],"additionalClass":["additionalClass"]},_setStatusTextAttr:{node:"statusTextNode",type:"innerHTML"},_setButtonTextAttr:function(val){this.dropDownButton.set("label",val);},_setVisibleAttr:function(val){_df7.set(this.domNode,"visibility",val?"visible":"hidden");},_setNonEditableIndicatorAttr:function(val){if(val){_df8.add(this.statusNonEditableIcon,"epi-iconPenDisabled");}else{_df8.remove(this.statusNonEditableIcon,"epi-iconPenDisabled");}},_setStatusIconAttr:function(val){_df7.set(this.statusTextIcon,"class","dijitInline dijitReset dijitIcon "+val);},_setAdditionalClassAttr:function(val){var _e02=this.get("additionalClass");if(_e02){_df8.remove(this.stateNode,_e02);}this._set("additionalClass",val);_df8.add(this.stateNode,val);},_setPublishMenuViewModelAttr:function(val){this.dropDownMenu.set("model",val);},postCreate:function(){this.inherited(arguments);this.dropDownButton.dropDownPosition=["below-alt"];}});});},"epi/shell/dgrid/util/misc":function(){define(["dojo/_base/declare","dojo/_base/lang","dojox/html/entities","dojox/html/ellipsis","dojo/text!dojox/html/resources/ellipsis.css"],function(_e03,lang,_e04,_e05,_e06){return {htmlEncode:function(text){return _e04.encode(text);},ellipsis:function(text){return lang.replace("<div class=\"dojoxEllipsis\" title=\"{0}\">{0}</div>",[text]);},ellipsisNoTooltip:function(text){return lang.replace("<div class=\"dojoxEllipsis\">{0}</div>",[text]);},icon:function(icon,text){return lang.replace("<span class=\"dijitInline dijitIcon {0}\"></span>{1}",[icon,text]);}};});},"epi/cms/legacy/LegacyFormEditor":function(){define("epi/cms/legacy/LegacyFormEditor",["dojo/_base/declare","dojo/_base/lang","dijit/focus","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/form/Button","epi/dependency","epi/shell/widget/dialog/Dialog","epi/cms/widget/_HasChildDialogMixin","epi/shell/widget/_ValueRequiredMixin","epi/cms/legacy/EditPropertyWidget","epi/i18n!epi/cms/nls/episerver.cms.legacy.legacyformeditor"],function(_e07,lang,_e08,_e09,_e0a,_e0b,_e0c,_e0d,_e0e,_e0f,_e10,_e11,res){return _e07("epi.cms.legacy.LegacyFormEditor",[_e09,_e0a,_e0b,_e0f,_e10],{localization:res,destroyOnHide:false,editorWidgetClass:_e11,templateString:"            <div class=\"dijit dijitReset dijitInline dijitLeft epi-legacyFormEditor\" id=\"widget_${id}\" >                <div data-dojo-attach-point=\"output\" data-dojo-type=\"dijit.form.TextBox\"></div>                <div data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"openButton\" data-dojo-attach-event=\"onClick: openEditor\" data-dojo-props=\"label:'${localization.buttonlabel}'\"></div>            </div>",editorWidget:null,value:null,multiple:false,contentLink:null,contentTypeId:null,contentLanguage:null,propertyName:null,_dialog:null,onChange:function(){},postCreate:function(){this.inherited(arguments);lang.mixin(this.params,{contentLink:this.contentLink});},buildRendering:function(){this.inherited(arguments);this.output.set("disabled",true);},destroy:function(){if(this._dialog){this._dialog.destroyRecursive();}this.inherited(arguments);},_setReadOnlyAttr:function(_e12){this._set("readOnly",_e12);this.openButton.set("disabled",_e12);},_setValueAttr:function(_e13){this._set("value",_e13);this.setDisplayValue(_e13);},_getValueAttr:function(_e14){if(this.editorWidget){this._set("value",this.editorWidget.get("value",_e14));}return this.value;},_onChange:function(){var _e15=this.editorWidget.get("value");this.onChange(_e15);if(this._dialog&&this._dialog.open){this._dialog.hide();}this.setDisplayValue(_e15);},_onCancel:function(){this._dialog.hide();},_onDialogHide:function(){this.isShowingChildDialog=false;},openEditor:function(){this.isShowingChildDialog=true;if(!this._dialog||this.destroyOnHide){this._createDialog();}this.editorWidget.set("value",this.value);this._dialog.show();},_createDialog:function(){var _e16=this.editorWidgetClass;this.editorWidget=new _e16(this.params);this._dialog=new _e0e({destroyOnHide:this.destroyOnHide,content:this.editorWidget,title:this.editorWidget.title||this.label,defaultActionsVisible:false,dialogClass:"",contentClass:"epi-dialog-fullWidth"});this.connect(this.editorWidget,"onResize",dojo.hitch(this,function(){this._dialog.layout();}));this.connect(this.editorWidget,"onChange","_onChange");this.connect(this.editorWidget,"onCancel","_onCancel");this.connect(this._dialog,"onHide","_onDialogHide");},setDisplayValue:function(_e17){this.output.set("value",this.localization.helptext);}});});},"url:epi/cms/widget/templates/BlockContextMenu.html":"<div data-dojo-type=\"dijit.Menu\" class=\"epi-blockContextMenu\">\r\n    <!--\r\n    <div class=\"epi-publishInfoPane\">\r\n        <div><strong data-dojo-attach-point=\"blockName\"></strong></div>\r\n        <div data-dojo-attach-point=\"referenceText\"></div>\r\n        <div data-dojo-attach-point=\"publishInfoText\"></div>\r\n    </div>\r\n    -->\r\n\r\n    <div data-dojo-type=\"dijit.MenuItem\" data-dojo-attach-point=\"editMenuItem\" data-dojo-attach-event=\"onClick: _onEdit\" iconClass=\"epi-iconPen\">${actionResources.edit}</div>\r\n    <div data-dojo-type=\"dijit.MenuSeparator\"></div>\r\n    <div data-dojo-type=\"dijit.MenuItem\" data-dojo-attach-point=\"moveUpMenuItem\" data-dojo-attach-event=\"onClick: _onMoveUp\" iconClass=\"epi-iconUp\">${actionResources.moveup}</div>\r\n    <div data-dojo-type=\"dijit.MenuItem\" data-dojo-attach-point=\"moveDownMenuItem\" data-dojo-attach-event=\"onClick: _onMoveDown\" iconClass=\"epi-iconDown\">${actionResources.movedown}</div>\r\n    <div data-dojo-type=\"dijit.MenuSeparator\"></div>\r\n    <div data-dojo-type=\"dijit.MenuItem\" data-dojo-attach-point=\"removeMenuItem\" data-dojo-attach-event=\"onClick: _onRemove\" iconClass=\"epi-iconTrash\">${actionResources.remove}</div>\r\n</div>","epi/cms/contentediting/PageShortcutTypeSupport":function(){define("epi/cms/contentediting/PageShortcutTypeSupport",[],function(){var _e18={pageShortcutTypes:{Normal:0,Shortcut:1,External:2,Inactive:3,FetchData:4}};return _e18;});},"epi/cms/contentediting/commandproviders/PublishMenu":function(){define("epi/cms/contentediting/commandproviders/PublishMenu",["dojo","dojo/_base/declare","epi/shell/command/_CommandProviderMixin","epi/cms/contentediting/command/ForPublishMenu","epi/cms/contentediting/command/IgnoreInUseNotification"],function(dojo,_e19,_e1a,_e1b,_e1c){return _e19([_e1a],{constructor:function(){this.inherited(arguments);this.add("commands",_e1b(new _e1c(),{priority:10000}));}});});},"url:dijit/templates/ProgressBar.html":"<div class=\"dijitProgressBar dijitProgressBarEmpty\" role=\"progressbar\"\n\t><div  data-dojo-attach-point=\"internalProgress\" class=\"dijitProgressBarFull\"\n\t\t><div class=\"dijitProgressBarTile\" role=\"presentation\"></div\n\t\t><span style=\"visibility:hidden\">&#160;</span\n\t></div\n\t><div data-dojo-attach-point=\"labelNode\" class=\"dijitProgressBarLabel\" id=\"${id}_label\"></div\n\t><img data-dojo-attach-point=\"indeterminateHighContrastImage\" class=\"dijitProgressBarIndeterminateHighContrastImage\" alt=\"\"\n/></div>\n","url:dojox/html/resources/ellipsis.css":".dojoxEllipsis,.dojoxEllipsisShown {white-space: nowrap; width: 100%; overflow: hidden; text-overflow: ellipsis; -o-text-overflow: ellipsis; -webkit-text-overflow: ellipsis;}.dojoxEllipsis window {width:100%; -moz-user-focus:normal; -moz-user-select:text;}.dojoxEllipsis description{-moz-user-focus:normal; -moz-user-select:text;}.dojoxEllipsisIFrame{white-space: normal; border: none; width: 100%; display: block; height: 1px; margin-top: -1px; clear: both;}.dojoxEllipsisContainer{width: 100%;}.dojoxEllipsisShown:after{content: \"\\2026\"}","epi/cms/contentediting/command/RevertToPublished":function(){define("epi/cms/contentediting/command/RevertToPublished",["dojo/_base/declare","dojo/_base/lang","epi/cms/contentediting/command/_ContentCommandBase","epi/cms/contentediting/ContentActionSupport","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons"],function(_e1d,lang,_e1e,_e1f,_e20){return _e1d("epi.cms.contentediting.command.RevertToPublished",[_e1e],{name:"reverttopublished",tooltip:_e20.reverttopublished.title,label:_e20.reverttopublished.label,iconClass:"epi-iconRevert",_hasPendingChangeWatch:null,_execute:function(){this.model.revertToPublished();},_onModelChange:function(){this.inherited(arguments);var _e21=this.model.contentData,_e22=_e21.status,_e23=_e1f.versionStatus;var _e24=(_e22===_e23.CheckedOut)||(_e22===_e23.Rejected)||((_e22===_e23.Published||_e22===_e23.Expired)&&_e21.isCommonDraft);this.set("isAvailable",_e24);if(this._hasPendingChangeWatch){this._hasPendingChangeWatch.unwatch();}this._hasPendingChangeWatch=this.model.watch("hasPendingChanges",lang.hitch(this,function(name,_e25,_e26){var _e27=this._getCanExecute(_e21,_e23);this.set("canExecute",!_e26&&_e27);}));this.set("canExecute",_e24&&this._getCanExecute(_e21,_e23));},_getCanExecute:function(_e28,_e29){return _e28.publishedBy!==null&&_e28.publishedBy!==undefined&&_e28.status!==_e29.Published&&_e28.status!==_e29.Expired&&this.model.canChangeContent();}});});},"epi/cms/widget/CategoryTree":function(){define("epi/cms/widget/CategoryTree",["epi","dojo","dijit/Tree","epi/cms/widget/_CategoryTreeNode","epi/cms/widget/CategoryTreeStoreModel","epi/dnd/Source"],function(epi,dojo,Tree,_e2a,_e2b,_e2c){return dojo.declare("epi.cms.widget.CategoryTree",[Tree,_e2c],{showRoot:false,postMixInProperties:function(){this.inherited(arguments);if(!this.model){this.model=new _e2b();this.persist=false;}},startup:function(){this.inherited(arguments);this.dndController.singular=true;},buildNodeFromTemplate:function(args){return new _e2a(args);},_createTreeNode:function(args){var _e2d=this.buildNodeFromTemplate(args);this.connect(_e2d,"onCheckBoxChange",dojo.hitch(this,function(_e2e,item){this.onTreeNodeCheckBoxChange(_e2e,item);}));this.onTreeNodeCreated(_e2d,args.item);return _e2d;},onTreeNodeCreated:function(_e2f,item){},onTreeNodeCheckBoxChange:function(_e30,item){},getTreeNodeById:function(_e31){var _e32=this.tree.getNodesByItem(_e31.toString());if(!_e32){return null;}return _e32[0];}});});},"epi/cms/contentediting/ViewSettingsNotification":function(){define("epi/cms/contentediting/ViewSettingsNotification",["dojo/_base/declare","dojo/Stateful","epi/i18n!epi/cms/nls/episerver.cms.contentediting.viewsettingsnotification"],function(_e33,_e34,_e35){return _e33("epi.cms.contentediting.ViewSettingsNotification",[_e34],{model:null,res:_e35,set:function(name,_e36){this.inherited(arguments);if(name!=="model"||!_e36){return;}if(!_e36.viewModel.canChangeContent()&&_e36.viewSetting.get("enabled")&&_e36.viewSetting.hasVisitorGroup()){this._showNotificationMessage();}else{this._hideNotificationMessage();}},_showNotificationMessage:function(){this.set("notification",{content:this.res.visitorgroups.noaccessright});},_hideNotificationMessage:function(){this.set("notification",null);}});});},"epi/cms/contentediting/editors/ContentAreaEditor":function(){require({cache:{"url:epi/cms/contentediting/editors/templates/ContentAreaEditor.html":"<div class=\"dijitInline\" data-dojo-attach-point=\"stateNode\">\r\n    <div data-dojo-attach-point=\"itemContainer\" class=\"epi-content-area-itemcontainer\"></div>\r\n    <div data-dojo-attach-point=\"actionsContainer\" class=\"epi-content-area-actionscontainer\"></div>            \r\n</div>"}});define("epi/cms/contentediting/editors/ContentAreaEditor",["dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/event","dojo/_base/lang","dojo/dnd/Manager","dojo/dom-construct","dojo/dom-class","dojo/dom-style","dojo/NodeList-dom","dojo/NodeList-traverse","dojo/NodeList-manipulate","dojo/on","dojo/query","dojo/topic","dojox/html/entities","dijit/registry","dijit/_Widget","dijit/_TemplatedMixin","dijit/_CssStateMixin","dijit/_Container","dijit/focus","epi/shell/dnd/Source","epi/shell/widget/TextWithActionLinks","epi/cms/contentediting/editors/ContentAreaEditorViewModel","epi/cms/contentediting/editors/ContentBlockEditor","epi/cms/widget/ContextMenu","epi/shell/widget/_ValueRequiredMixin","epi/cms/widget/overlay/Block","epi/cms/widget/command/CreateNewBlockSelector","dojo/text!./templates/ContentAreaEditor.html","epi/i18n!epi/cms/nls/episerver.cms.components.sharedblockscomponent","epi/i18n!epi/cms/nls/episerver.cms.contentediting.editors.contentarea","epi/i18n!epi/cms/nls/episerver.cms.widget.overlay.blockarea"],function(_e37,_e38,_e39,_e3a,_e3b,lang,_e3c,_e3d,_e3e,_e3f,_e40,_e41,_e42,on,_e43,_e44,_e45,_e46,_e47,_e48,_e49,_e4a,_e4b,_e4c,_e4d,_e4e,_e4f,_e50,_e51,_e52,_e53,_e54,_e55,_e56,_e57){return _e39("epi.cms.contentediting.editors.ContentAreaEditor",[_e47,_e48,_e4a,_e49,_e51],{baseClass:"epi-content-area-editor",res:lang.mixin(_e56,_e55),templateString:_e54,value:null,multiple:true,parent:null,overlayItem:null,model:null,_selectedEditor:null,intermediateChanges:true,editMode:"onpageedit",updateUI:false,_subscribeHandlers:null,dndTypes:["epi.cms.content.light"],_setReadOnlyAttr:function(_e58){this._set("readOnly",_e58);_e3f.set(this.actionsContainer,"display",_e58?"none":"");if(this._source){this._source.isSource=!this.readOnly;}if(this._selectedEditor&&this.readOnly){this._selectedEditor.model.set("selected",false);}},_checkAcceptance:function(_e59,_e5a){return this.readOnly?false:this._source.defaultCheckAcceptance(_e59,_e5a);},focus:function(){var _e5b=this._getChildEditors();if(_e5b.length===0){this.textWithLinks.focus();}else{var _e5c=_e5b[0];_e4b.focus(_e5c);}},_onChange:function(_e5d){if(this.validate()){this.onChange(_e5d);}},onChange:function(_e5e){},onBlur:function(){},onDoubleChange:function(_e5f,_e60,_e61){},startEdit:function(_e62,_e63){this.set(_e63);if(this._started){this.refresh();if(_e63.overlayItem){var _e64=_e63.overlayItem.get("selectedBlockIndex");if(_e64>=0){var _e65=_e46.getEnclosingWidget(this._getChildEditors()[_e64]);this.selectEditor(_e65);}}return;}this._renderEditors();},postCreate:function(){this.inherited(arguments);this.set("emptyMessage",_e56.emptymessage);this.model=new _e4e();this._subscribeHandlers=[];this._source=new _e4c(this.stateNode,{accept:this.dndTypes,creator:lang.hitch(this,this._createDndSourceItem),alwaysCopy:false,isSource:!this.readOnly,singular:true,parent:this.itemContainer});this._source.defaultCheckAcceptance=this._source.checkAcceptance;this._source.checkAcceptance=lang.hitch(this,this._checkAcceptance);if(this.parent){this.connect(this.parent,"onStartEdit","startEdit");}this._subscribeHandlers.push(_e38.subscribe("/dnd/start",this.itemContainer,lang.hitch(this,"_startDrag")));this._subscribeHandlers.push(_e38.subscribe("/dnd/cancel",this.itemContainer,lang.hitch(this,function(){this._updateDnDSourceUI(false);})));this._subscribeHandlers.push(_e38.subscribe("/dnd/drop",this.itemContainer,lang.hitch(this,"_onDrop")));this._subscribeHandlers.push(_e38.subscribe("/dnd/drop/before",this.itemContainer,lang.hitch(this,"_onDropping")));this.connect(this.model,"onChildrenChange","_onChildrenChange");this._watchHandle=this.watch("value",this.refresh);this.contextMenu=new _e50();this.contextMenu.addProvider(this.model);this.connect(this.contextMenu,"onOpen","_contextMenuOnOpen");},buildRendering:function(){this.inherited(arguments);var _e66=new _e4d({contentString:_e57.emptyactions.template,namedActions:_e57.emptyactions.actions});this.textWithLinks=_e66;this._connects.push(on(_e66,"onActionClick",lang.hitch(this,function(_e67){if(_e67==="createnewblock"){var _e68=new _e53();_e68.set("model",{save:lang.hitch(this,function(_e69){var _e6a=lang.clone(this.get("value"),true)||[];_e6a.push(_e69);this.set("value",_e6a);this._onChange(_e6a);this.onBlur();})});_e68.execute();}else{_e44.publish("/epi/layout/pinnable/"+_e67+"/toggle",true);}})));_e66.placeAt(this.actionsContainer);},_setValueAttr:function(_e6b){this._set("value",_e6b||[]);},_startDrag:function(_e6c,_e6d,copy){var _e6e=_e46.getEnclosingWidget(_e6d[0]);this.selectEditor(_e6e);if(_e6e.isInstanceOf(_e52)&&this.parent["cancel"]){this.parent.set("isModified",false);this.parent.cancel();}this._updateDnDSourceUI(true);var _e6f=_e46.getEnclosingWidget(_e6c.node);if(_e6f==this){this._updateIndicator(_e6e);}else{this._resetIndicator();}},_onChildrenChange:function(){if(this._started){this.set("value",this.model.getValue());this.refresh();if(this.updateUI){this.updateUI=false;return;}this._commitValue();}},_ellipsisContentText:function(_e70){var _e71="...",_e72=30;var _e73=_e70;if(_e73.length<=_e72){return _e73;}return _e73.substring(0,_e72-_e71.length)+_e71;},_createDndSourceItem:function(item,hint){var _e74,data,_e75;if(hint=="avatar"){var node=_e3d.create("div",{innerHTML:_e45.encode(this._ellipsisContentText(item.name))});return {"node":node,"data":item,"type":this.dndTypes};}if(item.getNormalizedData){_e74=item.getNormalizedData().data;}else{_e74=item;}data={contentLink:_e74.contentLink,name:_e74.name,index:item.index};_e75=new _e4f({modelData:data,contextMenu:this.contextMenu});this.model.add(_e75.model);this.model.resetItemIndex();if(item.selected===true){this.selectEditor(_e75);}this.connect(_e75,"onClick","_onItemOnClick");return {"node":_e75.domNode,"data":data,"type":this.dndTypes};},_contextMenuOnOpen:function(){this.model.updateCommandModel(this.model);this.onFocus();},_renderEditors:function(){this.model.clear();if(this.get("value")){_e37.forEach(this.get("value"),function(item,_e76){if(item.name===null||item.name===""){return;}var _e77={contentLink:item.contentLink,name:item.name||""};if(this.model.selectedItem&&this.model.selectedItem.index==_e76){lang.mixin(_e77,{selected:true,index:_e76});}this._source.insertNodes(false,[_e77]);},this);this.model.resetItemIndex();}this._updateDnDSourceUI(false);},onDropping:function(){},_updateDnDSourceUI:function(show){if(this.itemContainer){var _e78=this._getChildEditors().length===0;_e3e.toggle(this.itemContainer,"epi-content-area-empty-dnd-source",show&&_e78);}},_onDropping:function(_e79,_e7a,copy){if(this.id===_e3c.manager().target.id){this.onDropping();}},_onBlur:function(e){this.validate();if(e&&e.preventDefault){_e3b.stop(e);}},_getChildEditors:function(){return _e43(".dojoDndItem",this.itemContainer);},_onDrop:function(_e7b,_e7c,copy,_e7d){var _e7e=_e46.getEnclosingWidget(_e7b.node),_e7f=_e46.getEnclosingWidget(_e7d.node);this._updateDnDSourceUI(false);if(_e7e!=this&&_e7f!=this){return;}var _e80=_e46.getEnclosingWidget(_e7c[0]);if(!_e80.isInstanceOf(_e4f)){this._updateItemModelIndexByDom();this.saveChanges(this,this._buildContentAreaData());return;}if(_e7e==this&&_e7f==this){_e37.forEach(this._getChildEditors(),function(dom,_e81){var _e82=_e46.getEnclosingWidget(dom);this.model.move(_e82.model,_e81);},this);this.saveChanges(this,this._buildContentAreaData());return;}if(_e7e!=this&&_e7f==this){_e7f._updateItemModelIndexByDom();_e7e.updateUI=true;_e7e.model.remove(_e80.model);_e7e.model.resetItemIndex();_e7e.set("value",_e7e._buildContentAreaData());this.saveChanges(_e7f,_e7f._buildContentAreaData(),{source:_e7e.parent});return;}},saveChanges:function(_e83,data,_e84){if(!_e83||!_e83.model||!data){return;}if(_e83.model.resetItemIndex){_e83.model.resetItemIndex();}_e83.set("value",data);if(_e83._commitValue){_e83._commitValue(_e84);}},_updateItemModelIndexByDom:function(){_e37.forEach(this._getChildEditors(),function(dom,_e85){var _e86=_e46.getEnclosingWidget(dom);this.model.move(_e86.model,_e85);},this);},_buildContentAreaData:function(){return this.model.getValue();},_commitValue:function(_e87){switch(this.editMode){case "formedit":if(_e87&&_e87.source&&_e87.source.editorWidget&&this._doubleSave(_e87.source.editorWidget)){return;}this._singleSave();this.onBlur();break;case "createcontent":this._onChange();break;default:this._singleSave();break;}},_doubleSave:function(_e88){if(_e88["validate"]&&_e88.validate()){this.onDoubleChange(this.get("value"),_e88.parent,_e88.parent.getEditorValue());this.onFocus();return true;}return false;},_singleSave:function(){if(this.parent&&this.parent.hasPendingChanges()){this._onChange(this.get("value"));}},refresh:function(){this._getChildEditors().orphan();this._renderEditors();this.validate();},_onItemOnClick:function(_e89){this.selectEditor(_e89);},selectEditor:function(_e8a){if(_e8a==null||!_e8a.isInstanceOf(_e4f)||this.readOnly){return;}if(this._selectedEditor){this._selectedEditor.model.set("selected",false);}this._selectedEditor=_e8a;this._selectedEditor.model.set("selected",true);this.model.setSelectedItem(_e8a.model);},_updateIndicator:function(_e8b){if(!_e8b&&!_e8b.isInstanceOf(_e4f)){return;}var _e8c=this.model.getNext(_e8b.model),_e8d=this.model.getPrev(_e8b.model);_e37.forEach(this._getChildEditors(),function(dom,_e8e){var _e8f=_e46.getEnclosingWidget(dom);_e3e.toggle(dom,"epi-dndDisableTopIndicator",_e8c&&_e8f&&_e8f.model==_e8c);_e3e.toggle(dom,"epi-dndDisableBottomIndicator",_e8d&&_e8f&&_e8f.model==_e8d);_e3e.remove(dom,"epi-dndDisableIndicator");});_e3e.add(_e8b.domNode,"epi-dndDisableIndicator");},_resetIndicator:function(){_e37.forEach(this._getChildEditors(),function(dom,_e90){_e3e.remove(dom,"epi-dndDisableTopIndicator");_e3e.remove(dom,"epi-dndDisableBottomIndicator");_e3e.remove(dom,"epi-dndDisableIndicator");});},destroy:function(){if(this._subscribeHandlers){_e37.forEach(this._subscribeHandlers,function(_e91){_e38.unsubscribe(_e91);});delete this._subscribeHandlers;}this._watchHandle&&this._watchHandle.unwatch();if(this.contextMenu){this.contextMenu.destroyRecursive();delete this.contextMenu;}if(this.textWithLinks){this.textWithLinks.destroyRecursive();this.textWithLinks=null;}this.inherited(arguments);},isValid:function(){var _e92=this._getChildEditors();return (!this.required||(_e92&&_e92.length>0));}});});},"epi/cms/widget/ContentReferences":function(){require({cache:{"url:epi/cms/widget/templates/ContentReferences.html":"<div class=\"epi-contentReferences\">\r\n    <div class=\"epi-dialog-captionPanel\" data-dojo-attach-point=\"captionPanelNode\">\r\n        <div class=\"epi-floatRight\" data-dojo-type=\"dijit.Toolbar\" dojo-data-attach-point=\"contentReferenceToolbar\">\r\n            <button data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"saveListButton\" data-dojo-attach-event=\"onClick:_refreshList\"\r\n                    data-dojo-props=\"iconClass:'epi-iconReload', 'class':'epi-chromelessButton'\">${res.buttons.refresh}</button>\r\n        </div>\r\n        <h1>\r\n            <span class='dijitInline dijitIcon epi-iconObjectSharedBlock'>&nbsp;</span><span class='dijitInline dojoxEllipsis' data-dojo-attach-point=\"contentReferencesWidgetTitleNode\"></span>\r\n        </h1>\r\n    </div>\r\n    <div class=\"epi-verticalScroller\">\r\n        <div data-dojo-attach-point=\"pageGridContainer\">\r\n            <h2 data-dojo-attach-point=\"pageTitleNode\"></h2>\r\n            <div data-dojo-attach-point=\"pageGrid\" ></div>\r\n        </div>\r\n        <div data-dojo-attach-point=\"blockGridContainer\">\r\n            <h2 data-dojo-attach-point=\"blockTitleNode\"></h2>\r\n            <div data-dojo-attach-point=\"blockGrid\"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n"}});define("epi/cms/widget/ContentReferences",["dojo/_base/event","dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/dom-style","dojo/dom-class","dojo/string","dojo/store/Memory","dojo/topic","dojo/dom-attr","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/form/Button","dijit/Toolbar","dojox/html","dojox/html/entities","dgrid/OnDemandGrid","dgrid/Selection","dgrid/Keyboard","epi","epi/string","epi/shell/widget/_ModelBindingMixin","epi/shell/dgrid/Formatter","epi/Url","dojo/text!./templates/ContentReferences.html","epi/i18n!epi/cms/nls/episerver.cms.widget.contentreferences","epi/i18n!epi/cms/nls/episerver.cms.confirmation.references"],function(_e93,_e94,lang,_e95,_e96,_e97,_e98,_e99,_e9a,_e9b,_e9c,_e9d,_e9e,_e9f,_ea0,html,_ea1,_ea2,_ea3,_ea4,epi,_ea5,_ea6,_ea7,Url,_ea8,res,_ea9){var _eaa=_e94([_ea2,_ea3,_ea4,_ea7]);return _e94("epi.cms.widget.ContentReferences",[_e9c,_e9d,_e9e,_ea6],{res:res,dialogResources:null,templateString:_ea8,dialog:null,modelBindingMap:{"numberOfReferences":["numberOfReferences"],"pageReferences":["pageReferences"],"blockReferences":["blockReferences"],"isLoading":["isLoading"],"showToolbar":["showToolbar"]},_setContentReferencesWidgetTitleAttr:function(_eab){html.set(this.contentReferencesWidgetTitleNode,_ea1.encode(_eab));_e9b.set(this.contentReferencesWidgetTitleNode,"title",_eab);},_setPageTitleAttr:{node:"pageTitleNode",type:"innerHTML"},_setBlockTitleAttr:{node:"blockTitleNode",type:"innerHTML"},_setNumberOfReferencesAttr:function(_eac){if(this.model.mode==="confirm"){this.dialog.set("description",_ea5.toHTML(_eac.total>0?this.dialogResources.referenceswarning:this.dialogResources.noreferencesnote));}if(_eac.total>0){this.set("contentReferencesWidgetTitle",lang.replace((_eac.total>1?res.usages:res.usage),[this.model.contentData.name,_eac.total]));this.set("pageTitle",lang.replace((_eac.page>1?res.pages:res.page),[_eac.page]));this.set("blockTitle",lang.replace((_eac.block>1?res.blocks:res.block),[_eac.block]));this.dialog.resize({w:700});this.dialog.layout();}},_setPageReferencesAttr:function(_ead){if(!this.model.isLoading){_e96.set(this.pageGridContainer,"display",_ead.length>0?"":"none");}var _eae=new _e99({data:_ead,idProperty:"ownerContentLink"});this.pageGrid.set("store",_eae);},_setBlockReferencesAttr:function(_eaf){if(!this.model.isLoading){_e96.set(this.blockGridContainer,"display",_eaf.length>0?"":"none");}var _eb0=new _e99({data:_eaf,idProperty:"ownerContentLink"});this.blockGrid.set("store",_eb0);},_setShowToolbarAttr:function(_eb1){_e96.set(this.captionPanelNode,"display",_eb1?"":"none");},_setIsLoadingAttr:function(_eb2){if(_eb2){this.set("contentReferencesWidgetTitle",this.model.contentData?this.model.contentData.name:"");this.set("pageTitle",res.page.substring(0,res.page.indexOf("({0})")));this.set("blockTitle",res.block.substring(0,res.block.indexOf("({0})")));this.model.set("pageReferences",{});this.model.set("blockReferences",{});}},postMixInProperties:function(){this.inherited(arguments);this._setupDialog();},buildRendering:function(){this.inherited(arguments);this.pageGrid=this._setupGrid(this.pageGrid,"epi-iconPage",true);this.blockGrid=this._setupGrid(this.blockGrid,"epi-iconObjectSharedBlock",false);},uninitialize:function(){this.pageGrid.destroy();this.blockGrid.destroy();},_setupGrid:function(node,_eb3,_eb4){var grid,_eb5={columns:{ownerName:{field:"ownerName",ellipsisNoTooltip:true,icon:_eb3,get:function(_eb6){return _ea1.encode(_eb6.ownerName);},className:"epi-width35"},path:{field:_eb4?"ownerPublicUrl":"ownerTreePath",htmlEncode:true,ellipsis:true,className:"epi-width50"},edit:{field:"edit",renderCell:function(item,_eb7,node,_eb8){var data={"url":new Url(window.location.href).path+"#context=epi.cms.contentdata:///"+item.ownerContentLink,"title":_eb4?res.editpagetitle:res.editblocktitle,"edit":epi.resources.action.edit};node.innerHTML=lang.replace("<a class=\"epi-floatRight\" href=\"{url}\" title=\"{title}\" target=\"_blank\" tabindex=\"-1\">{edit}</a>",data);}}},showHeader:false,selectionMode:"single",cellNavigation:false,noDataMessage:res.loading};grid=new _eaa(_eb5,node);grid.on(".dgrid-cell a:click",lang.hitch(this,function(e){if(!e.ctrlKey){this._contextRequest(grid,e);}}));grid.on(".dgrid-row:keydown",lang.hitch(this,function(e){if(e.keyCode==dojo.keys.ENTER&&!e.shiftKey&&!e.altKey&&!e.ctrlKey){this._contextRequest(grid,e);}}));grid.on("focusin",lang.hitch(this,function(e){this._selectRow(grid,e);}));grid.on("focusout",function(e){grid.clearSelection();});return grid;},_setupDialog:function(){this.dialogResources=_ea9[this.model.get("contentDataType")];if(this.model.get("mode")==="confirm"){this.dialog.set("title",this.dialogResources.title);this.dialog.set("description",_ea5.toHTML(this.dialogResources.question));var _eb9=this.model.numberOfReferences.total===0?epi.resources.action.ok:epi.resources.action.moveanyway;this.dialog.set("confirmActionText",_eb9);this.dialog.set("cancelActionText",epi.resources.action.cancel);this.dialog.set("setFocusOnConfirmButton",this.model.numberOfReferences.total===0);}else{this.dialog.set("title",this.res.title);}},_refreshList:function(){_e95.when(this.model.update(),lang.hitch(this,function(){_e96.set(this.pageGridContainer,"display",this.model.pageReferences&&this.model.pageReferences.length>0?"":"none");_e96.set(this.blockGridContainer,"display",this.model.blockReferences&&this.model.blockReferences.length>0?"":"none");}));},_contextRequest:function(grid,e){var row=grid.row(e),_eba={uri:"epi.cms.contentdata:///"+row.data.ownerContentLink};_e93.stop(e);_e9a.publish("/epi/shell/context/request",_eba,{sender:this});this.dialog.onCancel();},_selectRow:function(grid,e){grid.clearSelection();var row=grid.row(e);if(row){grid.select(row);}}});});},"epi/cms/widget/overlay/overlayFactory":function(){define("epi/cms/widget/overlay/overlayFactory",["dojo/_base/lang","dojo/_base/Deferred","epi/string"],function(lang,_ebb,_ebc){return {defaultType:"epi/cms/widget/overlay/Property",create:function(_ebd){var _ebe=new _ebb();var _ebf=_ebd.property,_ec0=_ebc.slashName(_ebd.property.metadata.customEditorSettings.overlayType||this.defaultType);require([_ec0],lang.hitch(this,function(_ec1){var _ec2=lang.mixin({name:_ebf.name,contentModel:_ebf.contentModel,displayName:_ebf.metadata.displayName,disabled:_ebd.disabled,sourceItemNode:_ebd.node,dropTargetType:_ebd.property.metadata.additionalValues.dropTargetType,dropTargetChildProperty:_ebd.property.metadata.additionalValues.dropTargetChildProperty},_ebf.overlayParams);var _ec3=new _ec1(_ec2);_ebe.resolve(_ec3);}));return _ebe;}};});},"epi/username":function(){define(["dojo","dojo/_base/declare","dojox/html/entities","epi","epi/dependency"],function(dojo,_ec4,_ec5,epi,_ec6){var _ec7={toUserFriendlyString:function(_ec8,_ec9,_eca,_ecb){if(!_ec9){_ec9=this._getCurrentUsername();}var _ecc=_ecb?"":epi.resources.text.installer,_ecd=_ec9.toLowerCase()===_ec8.toLowerCase()?epi.resources.text.you:_ec8||_ecc;if(_eca){_ecd=_ecd.charAt(0).toUpperCase()+_ecd.slice(1);}return _ecd;},toUserFriendlyHtml:function(_ece,_ecf,_ed0,_ed1){var _ed2=this.toUserFriendlyString(_ece,_ecf,_ed0,_ed1);if(_ed2===""){return _ed2;}return "<span class='epi-username'>"+_ec5.encode(_ed2)+"</span>";},_getCurrentUsername:function(){if(!this.currentUsername){var _ed3=_ec6.resolve("epi.shell.Profile");this.currentUsername=_ed3.userName;}return this.currentUsername;}};return _ec7;});},"dgrid/Tree":function(){define("dgrid/Tree",["dojo/_base/declare","dojo/_base/array","dojo/_base/Deferred","dojo/query","dojo/on","dojo/aspect","./Grid","dojo/has!touch?./util/touch","put-selector/put"],function(_ed4,_ed5,_ed6,_ed7,on,_ed8,Grid,_ed9,put){return function(_eda){var _edb=_eda.renderCell||Grid.defaultRenderCell;var _edc,_edd;_eda.shouldExpand=_eda.shouldExpand||function(row,_ede,_edf){return _edf;};_ed8.after(_eda,"init",function(){var grid=_eda.grid,_ee0=".dgrid-content .dgrid-column-"+_eda.id,_ee1,_ee2=[],tr,_ee3;if(!grid.store){throw new Error("dgrid tree column plugin requires a store to operate.");}if(!_eda.renderExpando){_eda.renderExpando=function(_ee4,_ee5,_ee6){var dir=this.grid.isRTL?"right":"left",cls=".dgrid-expando-icon";if(_ee5){cls+=".ui-icon.ui-icon-triangle-1-"+(_ee6?"se":"e");}return put("div"+cls+"[style=margin-"+dir+": "+(_ee4*(_eda.indentWidth||9))+"px; float: "+dir+"]");};}_ee2.push(grid.on(_eda.expandOn||".dgrid-expando-icon:click,"+_ee0+":dblclick,"+_ee0+":keydown",function(_ee7){if((_ee7.type!="keydown"||_ee7.keyCode==32)&&!(_ee7.type=="dblclick"&&_edd&&_edd.count>1&&grid.row(_ee7).id==_edd.id&&_ee7.target.className.indexOf("dgrid-expando-icon")>-1)){grid.expand(this);}if(_ee7.target.className.indexOf("dgrid-expando-icon")>-1){if(_edd&&_edd.id==grid.row(_ee7).id){_edd.count++;}else{_edd={id:grid.row(_ee7).id,count:1};}}}));if(_ed9){_ee2.push(grid.on(_ed9.selector(_ee0,_ed9.dbltap),function(){grid.expand(this);}));}if(!grid._expanded){grid._expanded={};}_ee2.push(_ed8.after(grid,"insertRow",function(_ee8){var row=this.row(_ee8),_ee9=_eda.shouldExpand(row,_edc,this._expanded[row.id]);if(_ee9){this.expand(_ee8,true,true);}return _ee8;}));_ee2.push(_ed8.before(grid,"removeRow",function(_eea,_eeb){var _eec=_eea.connected;if(_eec){_ed7(">.dgrid-row",_eec).forEach(function(_eed){grid.removeRow(_eed,true);});if(!_eeb){put(_eec,"!");}}}));grid._calcRowHeight=function(_eee){var _eef=_eee.connected;return _eee.offsetHeight+(_eef?_eef.offsetHeight:0);};grid.expand=function(_ef0,_ef1,_ef2){var row=_ef0.element?_ef0:grid.row(_ef0);_ef0=row.element;_ef0=_ef0.className.indexOf("dgrid-expando-icon")>-1?_ef0:_ed7(".dgrid-expando-icon",_ef0)[0];if(_ef0&&_ef0.mayHaveChildren){var _ef3=_ef1===undefined?!this._expanded[row.id]:_ef1;_ef0.className="dgrid-expando-icon ui-icon ui-icon-triangle-1-"+(_ef3?"se":"e");var _ef4=_ef0.preloadNode,_ef5=row.element,_ef6;if(!_ef4){_ef6=_ef5.connected=put("div.dgrid-tree-container");_ef4=_ef0.preloadNode=put(_ef5,"+",_ef6,"div.dgrid-preload");var _ef7=function(_ef8){return grid.store.getChildren(row.data,_ef8);};_ef7.level=_ef0.level;_ed6.when(grid.renderQuery?grid._trackError(function(){return grid.renderQuery(_ef7,_ef4);}):grid.renderArray(_ef7({}),_ef4),function(){if(grid._expanded[row.id]){var _ef9=_ef6.scrollHeight;_ef6.style.height=_ef9?_ef9+"px":"auto";}});var _efa=function(_efb){var _efc=this.style.height;if(_efc){this.style.display=_efc=="0px"?"none":"block";}if(_efb){put(this,".dgrid-tree-resetting");setTimeout(function(){put(_ef6,"!dgrid-tree-resetting");});_ee1=true;}else{if(!_ee1){_ee1=false;}}this.style.height="";};on(_ef6,"transitionend,webkitTransitionEnd,oTransitionEnd,MSTransitionEnd",_efa);if(!_ee1){setTimeout(function(){_efa.call(_ef6);},600);}}_ef6=_ef5.connected;_ef6.hidden=!_ef3;var _efd=_ef6.style,_efe;if(_ee1===false||_ef2){_efd.display=_ef3?"block":"none";_efd.height="";}else{if(_ef3){_efd.display="block";_efe=_ef6.scrollHeight;_efd.height="0px";}else{put(_ef6,".dgrid-tree-resetting");_efd.height=_ef6.scrollHeight+"px";}setTimeout(function(){put(_ef6,"!dgrid-tree-resetting");_efd.height=_ef3?(_efe?_efe+"px":"auto"):"0px";});}if(_ef3){this._expanded[row.id]=true;}else{delete this._expanded[row.id];}}};_ed8.after(_eda,"destroy",function(){_ed5.forEach(_ee2,function(l){l.remove();});delete grid.expand;});});_eda.renderCell=function(_eff,_f00,td,_f01){var grid=_eda.grid,_f02=Number(_f01&&_f01.query&&_f01.query.level)+1,_f03=!grid.store.mayHaveChildren||grid.store.mayHaveChildren(_eff),_f04,node;_f02=_edc=isNaN(_f02)?0:_f02;_f04=_eda.renderExpando(_f02,_f03,grid._expanded[grid.store.getIdentity(_eff)]);_f04.innerHTML="&nbsp;";_f04.level=_f02;_f04.mayHaveChildren=_f03;node=_edb.call(_eda,_eff,_f00,td,_f01);if(node&&node.nodeType){put(td,_f04);put(td,node);}else{td.insertBefore(_f04,td.firstChild);}};return _eda;};});},"dojox/encoding/digests/_base":function(){define("dojox/encoding/digests/_base",["dojo/_base/lang"],function(lang){var d=lang.getObject("dojox.encoding.digests",true);d.outputTypes={Base64:0,Hex:1,String:2,Raw:3};d.addWords=function(a,b){var l=(a&65535)+(b&65535);var m=(a>>16)+(b>>16)+(l>>16);return (m<<16)|(l&65535);};var _f05=8;var mask=(1<<_f05)-1;d.stringToWord=function(s){var wa=[];for(var i=0,l=s.length*_f05;i<l;i+=_f05){wa[i>>5]|=(s.charCodeAt(i/_f05)&mask)<<(i%32);}return wa;};d.wordToString=function(wa){var s=[];for(var i=0,l=wa.length*32;i<l;i+=_f05){s.push(String.fromCharCode((wa[i>>5]>>>(i%32))&mask));}return s.join("");};d.wordToHex=function(wa){var h="0123456789abcdef",s=[];for(var i=0,l=wa.length*4;i<l;i++){s.push(h.charAt((wa[i>>2]>>((i%4)*8+4))&15)+h.charAt((wa[i>>2]>>((i%4)*8))&15));}return s.join("");};d.wordToBase64=function(wa){var p="=",tab="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=[];for(var i=0,l=wa.length*4;i<l;i+=3){var t=(((wa[i>>2]>>8*(i%4))&255)<<16)|(((wa[i+1>>2]>>8*((i+1)%4))&255)<<8)|((wa[i+2>>2]>>8*((i+2)%4))&255);for(var j=0;j<4;j++){if(i*8+j*6>wa.length*32){s.push(p);}else{s.push(tab.charAt((t>>6*(3-j))&63));}}}return s.join("");};return d;});},"epi/cms/component/command/_GlobalToolbarCommandProvider":function(){define("epi/cms/component/command/_GlobalToolbarCommandProvider",["dojo/_base/declare","dojo/_base/lang","dijit/form/Button","epi/shell/command/_CommandProviderMixin"],function(_f06,lang,_f07,_f08){return _f06([_f08],{addToLeading:function(_f09,_f0a){this.addCommand(_f09,_f0a);},addToCenter:function(_f0b,_f0c){_f0c=lang.mixin({category:"center"},_f0c);this.addCommand(_f0b,_f0c);},addToTrailing:function(_f0d,_f0e){_f0e=lang.mixin({category:"trailing"},_f0e);this.addCommand(_f0d,_f0e);},addCommand:function(_f0f,_f10){_f10=lang.mixin({"class":"epi-mediumButton",iconClass:_f0f.iconClass,category:"leading",label:_f0f.label,tooltip:_f0f.tooltip,showLabel:false,widget:_f07,model:_f0f},_f10);_f0f=lang.delegate(_f0f,{settings:_f10});this.add("commands",_f0f);}});});},"url:epi/cms/widget/templates/ContentType.html":"<li class=\"clearfix\" data-dojo-attach-event=\"onkeypress:_onKeyPress, onmouseover:_onMouseOver, onmouseout:_onMouseOut\" data-dojo-attach-point=\"focusNode\">\r\n    <div class=\"epi-browserWindow\"><div class=\"epi-browserWindowContent\" data-dojo-attach-point=\"iconNode\">${emptyIconTemplate}</div></div>\r\n    <h3 data-dojo-attach-point=\"nameNode\"></h3>\r\n    <p data-dojo-attach-point=\"descriptionNode\"></p>\r\n</li>","xstyle/has-class":function(){define("xstyle/has-class",["dojo/has"],function(has){var _f11={};return function(){var test,args=arguments;for(var i=0;i<args.length;i++){var test=args[i];if(!_f11[test]){_f11[test]=true;var _f12=test.match(/^(no-)?(.+?)((-[\d\.]+)(-[\d\.]+)?)?$/),_f13=has(_f12[2]),_f14=-_f12[4];if((_f14>0?_f14<=_f13&&(-_f12[5]||_f14)>=_f13:!!_f13)==!_f12[1]){document.documentElement.className+=" has-"+test;}}}};});},"url:epi/cms/widget/templates/_ContentTreeNode.html":"<div class=\"dijitTreeNode\" role=\"presentation\">\r\n    <a href=\"#\" tabindex=\"-1\" data-dojo-attach-point=\"rowNode\" class=\"dijitTreeRow\" role=\"presentation\" data-dojo-attach-event=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onclick:_onClick, ondblclick:_onDblClick\">\r\n        <span data-dojo-attach-point=\"contentNode\" class=\"dijitTreeContent\" role=\"presentation\">\r\n            <span data-dojo-attach-point=\"expandoNode\" class=\"dijitTreeExpando\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"labelNode\" class=\"dijitTreeLabel\" role=\"treeitem\" tabindex=\"-1\" aria-selected=\"false\" data-dojo-attach-event=\"onfocus:_onLabelFocus\"></span>\r\n        </span>\r\n    </a>\r\n    <div data-dojo-attach-point=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\r\n</div>","epi/cms/contentediting/editors/PreviewableTextEditor":function(){define("epi/cms/contentediting/editors/PreviewableTextEditor",["dojo/_base/array","dojo/_base/declare","dojo/dom-construct","dijit/form/ValidationTextBox","epi/cms/contentediting/editors/_PreviewableEditor"],function(_f15,_f16,_f17,_f18,_f19){return _f16("epi.cms.contentediting.editors.PreviewableTextEditor",[_f19],{required:false,intermediateChanges:true,controlParams:["intermediateChanges","regExp","required","invalidMessage"]});});},"epi/cms/contentediting/ScheduledPublishSelector":function(){require({cache:{"url:epi/cms/contentediting/templates/ScheduledPublishSelector.html":"<div>\r\n    <div data-dojo-type=\"epi.cms.widget.Breadcrumb\" data-dojo-attach-point=\"breadcrumbNode\" data-dojo-props=\"showCurrentNode: false\"></div>\r\n    <h1 data-dojo-attach-point=\"contentNameNode\" class=\"epi-breadCrumbsCurrentItem dijitInline dojoxEllipsis\"></h1>\r\n    <div data-dojo-attach-point=\"publishChangesCaptionNode\"></div>\r\n    <div data-dojo-type=\"epi.shell.widget.DateTimeSelectorDropDown\" data-dojo-attach-point=\"dateTimeSelector\" data-dojo-props=\"required:true\"></div>\r\n</div>"}});define("epi/cms/contentediting/ScheduledPublishSelector",["dojo/_base/declare","dojo/_base/lang","dijit","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","epi/shell/widget/_ActionProviderWidget","epi/shell/widget/_ModelBindingMixin","epi/shell/widget/DateTimeSelectorDropDown","epi/shell/widget/dialog/_DialogContentMixin","epi/cms/widget/Breadcrumb","./ScheduledPublishSelectorViewModel","dojo/text!./templates/ScheduledPublishSelector.html","epi/i18n!epi/cms/nls/shell.common.buttons","epi/i18n!epi/cms/nls/episerver.cms.widget.scheduledpublishselector"],function(_f1a,lang,_f1b,_f1c,_f1d,_f1e,_f1f,_f20,_f21,_f22,_f23,_f24,_f25,_f26,_f27){return _f1a("epi.cms.contentediting.ScheduledPublishSelector",[_f1c,_f1d,_f1e,_f20,_f1f,_f22],{templateString:_f25,modelData:null,_setTitleAttr:{node:"contentNameNode",type:"innerHTML"},_setDateLabelAttr:{node:"publishChangesCaptionNode",type:"innerHTML"},_setDateValueAttr:function(date){this.dateTimeSelector.set("value",date);},_setBreadcrumbModelAttr:function(_f28){this.breadcrumbNode.set("contentLink",_f28);},_setScheduleButtonEnabledAttr:function(_f29){if(this._actions&&this._actions.length){this.setActionProperty("save","disabled",!_f29);}},modelBindingMap:{"title":["title"],"dateLabel":["dateLabel"],"dateValue":["dateValue"],"breadcrumbModel":["breadcrumbModel"],"scheduleButtonEnabled":["scheduleButtonEnabled"]},postMixInProperties:function(){this.inherited(arguments);this.model=this.model||new _f24(this.modelData);},postCreate:function(){this.inherited(arguments);this.connect(this.dateTimeSelector,"onChange","dateTimeSelectorChanged");},dateTimeSelectorChanged:function(_f2a){this.model.set("dateValue",_f2a);},getActions:function(){this._actions=[{name:"save",label:_f27.confirmtext,settings:{type:"button","class":"Salt",disabled:true},action:lang.hitch(this,function(){if(this.dateTimeSelector.validate()){this.executeDialog();}})},{name:"cancel",label:_f26.cancel,settings:{type:"button"},action:lang.hitch(this,function(){this.cancelDialog();})}];return this._actions;}});});},"epi/cms/widget/_ItemSelectorBase":function(){require({cache:{"url:epi/cms/widget/templates/_ItemSelector.html":"<div>\r\n    <div class=\"epi-tooltipDialogTop\">\r\n        <span data-dojo-attach-point=\"header\"></span>\r\n        <div data-dojo-attach-point=\"lastPublishedIcon\" class=\"dijitTooltipConnector\"></div>\r\n    </div>\r\n    \r\n    <div dojoType=\"dijit.Menu\" data-dojo-attach-point=\"menuNode\" contextMenuForWindow=\"false\" class=\"epi-DropDownMenu\"></div>\r\n</div>"}});define("epi/cms/widget/_ItemSelectorBase",["dojo","dojo/_base/lang","dojo/_base/array","dojo/_base/Deferred","dojox/html/entities","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/Menu","epi","epi/dependency","epi/shell/widget/RadioMenuItem","dojo/text!./templates/_ItemSelector.html"],function(dojo,lang,_f2b,_f2c,_f2d,_f2e,_f2f,_f30,Menu,epi,_f31,_f32,_f33){return dojo.declare("epi.cms.widget._ItemSelectorBase",[_f2e,_f2f,_f30],{templateString:_f33,baseClass:"epi-invertedTooltip",_store:null,currentSelectedItem:null,checkedItem:null,defaultItem:null,_items:[],isDefaultItemSelected:function(){return (this.currentSelectedItem&&this.currentSelectedItem.name==this.defaultItem.name);},postCreate:function(){this.inherited(arguments);dojo.connect(this.menuNode,"onItemHover",this,function(item){this.menuNode.focusChild(item);});},checkItem:function(item){_f2b.forEach(this.menuNode.getChildren(),lang.hitch(this,function(_f34){_f34.set("checked",false);var _f35=_f34.value;if(item!=null&&_f35.name==item.name){_f34.set("checked",true);this.currentSelectedItem=_f34.value;}}));},_setupUI:function(){var _f36=this.get("items");_f2b.forEach(_f36,lang.hitch(this,function(item){this.menuNode.addChild(this._createMenuItem(item));}));},_onItemSelected:function(item){this.currentSelectedItem=item.value;this.onItemSelected(item.value);},onItemSelected:function(item){},_createMenuItem:function(item){var _f37=new _f32({checked:(item.name==this.checkedItem),label:_f2d.encode(item.name),value:item,onClick:lang.hitch(this,function(){this._onItemSelected(_f37);})});if(_f37.checked){this.currentSelectedItem=_f37.value;}return _f37;},_setItemsAttr:function(_f38){this._set("_items",_f38);this._setupUI();},_getItemsAttr:function(){return this.get("_items");},_setHeaderAttr:{node:"header",type:"innerHTML"}});});},"url:epi/cms/widget/templates/CategorySelector.html":"<div class=\"dijitReset dijitInputField dijitInputContainer dijitInline epi-resourceInputContainer epi-categorySelector\" id=\"widget_${id}\">\r\n    <div data-dojo-attach-point=\"categoriesGroupContainer\" class=\"dijit dijitReset dijitInline dijitInlineTable dijitLeft dijitTextBox displayNode epi-categoriesGroup\">\r\n    </div> \r\n    <div data-dojo-type=\"dijit.form.Button\" data-dojo-attach-event=\"onClick: _onButtonClick\" data-dojo-attach-point=\"button\" class=\"epi-categoriesSelectorButton\" data-dojo-props=\"label:'+'\"></div>\r\n</div>","epi/cms/widget/TooltipDialog":function(){define("epi/cms/widget/TooltipDialog",["dojo","dojo/number","dijit","dijit/TooltipDialog","dijit/_Widget","dijit/_TemplatedMixin","dojo/text!./templates/TooltipDialog.html"],function(dojo,_f39,_f3a,_f3b,_f3c,_f3d,_f3e){return dojo.declare("epi.cms.widget.TooltipDialog",[_f3b],{templateString:_f3e,connectorMargin:25,_defaultConnectorMargin:25,hideOnBlur:false,_isFirstShow:false,_beforeCssClass:"epi-dijitTooltipBefore",_afterCssClass:"epi-dijitTooltipAfter",_pos:0,_defaultConnectorRight:0,_defaultConnectorLeft:0,_wrapperPosX:0,_availableSpace:0,_right:0,_left:0,onBlur:function(){this.inherited(arguments);if(this.hideOnBlur){this.hideTooltipDialog();}},postCreate:function(){this.inherited(arguments);if(!this.connectorMargin||!_f39.parse(this.connectorMargin)||this.connectorMargin===""||this.connectorMargin<this._defaultConnectorMargin){this.connectorMargin=this._defaultConnectorMargin;}},showTooltipDialog:function(_f3f,_f40){_f3a.popup.open({popup:this,around:_f3f,orient:_f40});if(this.hideOnBlur){this.focus();}},hideTooltipDialog:function(){_f3a.popup.close(this);},onOpen:function(pos){this._pos=pos;this.inherited(arguments);},_onShow:function(){this._setDefaultValues();this._updatePositions();this.inherited(arguments);},_setDefaultValues:function(){if(!this._isFirstShow){this._defaultConnectorRight=this._getConnectorSpace("right")||this._defaultConnectorMargin;this._defaultConnectorLeft=this._getConnectorSpace("left")||this._defaultConnectorMargin;this._isFirstShow=true;}this._wrapperPosX=_f39.parse(this._pos.x);this._availableSpace=dojo.body().clientWidth;if(this._pos.aroundCorner=="MR"||this._pos.aroundCorner=="ML"){var _f41=_f39.round((this._pos.h-this.connectorNode.clientHeight)/2);dojo.style(this.connectorNode,"top",this._getNumberInPx(_f41));}},_updatePositions:function(){switch(this._pos.aroundCorner){case "TR":case "BR":this._calculateConnectorMarginRight();this._calculateAvailableSpaceLeft();this._updateAlignedRightPositions();break;case "TL":case "BL":this._calculateConnectorMarginLeft();this._calculateAvailableSpaceRight();this._updateAlignedLeftPositions();break;case "MR":dojo.addClass(this.domNode,this._afterCssClass);break;case "ML":dojo.addClass(this.domNode,this._beforeCssClass);break;default:break;}},_updateAlignedRightPositions:function(){if(this._availableSpace>=this.connectorMargin){dojo.style(this.connectorNode,"right",this._getNumberInPx(this.connectorMargin));dojo.style(this._popupWrapper,"left",this._getNumberInPx(this._wrapperPosX+(this.connectorMargin-this._right)));}else{dojo.style(this.connectorNode,"right",this._getNumberInPx(this._defaultConnectorRight));dojo.style(this._popupWrapper,"left",this._getNumberInPx(this._wrapperPosX-(this._right-this._defaultConnectorRight)));}},_updateAlignedLeftPositions:function(){if(this._availableSpace>=this.connectorMargin){dojo.style(this.connectorNode,"left",this._getNumberInPx(this.connectorMargin));dojo.style(this._popupWrapper,"left",this._getNumberInPx(this._wrapperPosX+(this.connectorMargin-this._left)));}else{dojo.style(this.connectorNode,"left",this._getNumberInPx(this._defaultConnectorLeft));dojo.style(this._popupWrapper,"left",this._getNumberInPx(this._wrapperPosX-(this._left-this._defaultConnectorLeft)));}},_calculateAvailableSpaceRight:function(){this._wrapperPosX-=this._left+this._getCenterHorizontalAroundNode();this._availableSpace-=(this._wrapperPosX+this._pos.w);},_calculateAvailableSpaceLeft:function(){this._wrapperPosX+=this._right+this._getCenterHorizontalAroundNode();this._availableSpace-=(this._wrapperPosX+this._pos.w);},_calculateConnectorMarginRight:function(){this._right=this._getConnectorSpace("right");if(this._right<this.connectorMargin){this._right=this.connectorMargin;}},_calculateConnectorMarginLeft:function(){this._left=this._getConnectorSpace("left");if(this._left<this.connectorMargin){this._left=this.connectorMargin;}},_getConnectorSpace:function(_f42){if(!_f42){return 0;}if(_f42=="right"||_f42=="left"){var _f43=dojo.style(this.connectorNode,_f42);if(!_f43){return 0;}var _f44=/(px|em|%)/ig;return _f39.parse(_f43)||_f39.parse(_f43.replace(_f44,""));}return 0;},_getNumberInPx:function(_f45){return _f45+"px";},_getCenterHorizontalAroundNode:function(){return _f39.round((_f39.parse(this.connectorNode.clientWidth)-_f39.parse(this._pos.aroundNodePos.w))/2);}});});},"epi/cms/contentediting/_ViewSetting":function(){define("epi/cms/contentediting/_ViewSetting",["dojo/_base/declare"],function(_f46){return _f46("epi.cms.contentediting._ViewSetting",null,{key:null,value:null,beforePreviewLoad:function(_f47,_f48){},afterPreviewLoad:function(_f49,_f4a){}});});},"epi/cms/widget/ReadOnlyDateTimeEditor":function(){define(["dojo/_base/declare","dijit/_Widget","dijit/_TemplatedMixin","epi/datetime","dojo/text!./templates/ReadOnlyDateTimeEditor.html"],function(_f4b,_f4c,_f4d,_f4e,_f4f){return _f4b([_f4c,_f4d],{templateString:_f4f,value:null,_setValueAttr:function(_f50){this._set("value",_f50);if(_f50){this.valueNode.innerHTML=_f4e.toUserFriendlyHtml(_f50);}}});});},"xstyle/css":function(){define("xstyle/css",["require"],function(_f51){"use strict";var _f52=window.cssCache||(window.cssCache={});return {load:function(_f53,_f54,_f55,_f56){var url=_f54.toUrl(_f53);if(_f52[url]){return createStyleSheet(_f52[url]);}var _f57=document.documentElement;var _f58=_f57.insertBefore(document.createElement("div"),_f57.firstChild);_f58.id=_f54.toAbsMid(_f53).replace(/\//g,"-").replace(/\..*/,"")+"-loaded";var _f59=(_f58.currentStyle||getComputedStyle(_f58,null)).display;_f57.removeChild(_f58);if(_f59=="none"){return _f55();}_f51(["./load-css"],function(load){load(url,_f55);});},pluginBuilder:"xstyle/css-builder"};});},"epi/cms/widget/command/_CreateContentFromSelectorBase":function(){define("epi/cms/widget/command/_CreateContentFromSelectorBase",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/aspect","dojo/on","dojo/topic","epi/dependency","epi/shell/command/_Command","epi/shell/widget/dialog/Dialog","epi/cms/_ContentContextMixin","epi/cms/component/ContentFilter","epi/cms/widget/ContentSelectorDialog","epi/cms/contentediting/ContentActionSupport"],function(_f5a,_f5b,lang,_f5c,on,_f5d,_f5e,_f5f,_f60,_f61,_f62,_f63,_f64){return _f5a([_f5f,_f61],{res:null,contentType:null,canExecute:true,canSelectOwnerContent:false,showButtons:false,expandSubRoot:true,value:null,showRoot:false,typeIdentifiers:null,modelContent:null,destroyOnHide:true,confirmActionText:null,description:null,title:null,postscript:function(){this.inherited(arguments);this._initialize();},_execute:function(){_f5b.when(this.getCurrentContent(),lang.hitch(this,function(_f65){if(!_f65){return;}_f5b.when(this.contextStore.get("?uri=epi.cms.contentdata:///"+_f65.contentLink),lang.hitch(this,function(_f66){if(!_f66){return;}var _f67=_f66.languageContext;var _f68=!_f67||(_f67.hasTranslationAccess&&_f67.isPreferredLanguageAvailable);var _f69=!(_f65.isWastebasket||_f65.isDeleted)&&_f68&&_f64.isActionAvailable(_f65,_f64.action.Create,_f64.providerCapabilities.Create,true);if(_f65.typeIdentifier!==this.typeIdentifiers||!_f69){this._createDialog();this._setDialogButtonState(this.selector.get("value"));}else{this._switchView(_f65);}}));}));},_createDialog:function(){var _f6a={canSelectOwnerContent:this.canSelectOwnerContent,showButtons:this.showButtons,expandSubRoot:this.expandSubRoot,value:this.value,root:this.root,showRoot:this.showRoot,typeIdentifiers:this.typeIdentifiers,model:this.modelContent};this.selector=new _f63(_f6a);var _f6b={destroyOnHide:this.destroyOnHide,confirmActionText:this.confirmActionText,description:this.description,title:this.title,content:this.selector};this.dialog=new _f60(_f6b);on(this.selector,"change",lang.hitch(this,this._setDialogButtonState));_f5c.after(this.dialog,"hide",lang.hitch(this,function(_f6c){this.hideDeferred=_f6c;}));this.dialog.on("execute",lang.hitch(this,this._onContentSelected));this.dialog.show();},_initialize:function(){if(this._initialized){return;}var _f6d=_f5e.resolve("epi.cms.Application"),_f6e=_f5e.resolve("epi.storeregistry");this.contentStore=_f6e.get("epi.cms.content.light");this.contextStore=_f6e.get("epi.shell.context");this.application=_f6d;this._initialized=true;},_onContentSelected:function(){var _f6f=this.selector.get("value");_f5b.when(this.hideDeferred,lang.hitch(this,function(){_f5b.when(this.contentStore.get(_f6f),lang.hitch(this,function(_f70){this._switchView(_f70);}));}));},_switchView:function(_f71){_f5d.publish("/epi/shell/action/changeview","epi/cms/component/CreateContent",null,{requestedTypes:[this.contentType],res:this.res,type:this.contentType,parent:_f71});},_setDialogButtonState:function(_f72){_f5b.when(this.contentStore.get(_f72),lang.hitch(this,function(_f73){_f5b.when(this.contextStore.get("?uri=epi.cms.contentdata:///"+_f73.contentLink),lang.hitch(this,function(_f74){var _f75=_f74.languageContext;var _f76=!_f75||(_f75.hasTranslationAccess&&_f75.isPreferredLanguageAvailable);var _f77=_f76&&_f64.hasAccess(_f73.accessMask,_f64.accessLevel.Create);this.dialog.definitionConsumer.setItemProperty(this.dialog._okButtonName,"disabled",!_f77);}));}));}});});},"epi/cms/widget/FilesUploadDropZone":function(){require({cache:{"url:epi/cms/widget/templates/FilesUploadDropZone.html":"<div class=\"epi-filesUploadDropZone\">\r\n    <div>\r\n        <span data-dojo-attach-point=\"description\">${res.description}</span>\r\n    </div>\r\n</div>"}});define("epi/cms/widget/FilesUploadDropZone",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dijit/_Widget","dijit/_TemplatedMixin","epi/i18n!epi/cms/nls/episerver.cms.widget.uploadmultiplefiles.dropzone","dojo/text!./templates/FilesUploadDropZone.html"],function(_f78,lang,_f79,_f7a,_f7b,_f7c,_f7d){return _f78("epi.cms.widget.FilesUploadDropZone",[_f7a,_f7b],{res:_f7c,templateString:_f7d,dragStartCssClass:"epi-dragStart",dragOverCssClass:"epi-dragOver",outsideDomNode:null,postCreate:function(){this.inherited(arguments);if(this.outsideDomNode){this.connect(this.outsideDomNode,"dragover",lang.hitch(this,this._onDragOverOutside));this.connect(this.outsideDomNode,"dragleave",lang.hitch(this,this._onDragLeave));this.connect(this.outsideDomNode,"dragend",lang.hitch(this,this._onDragLeave));this.connect(this.outsideDomNode,"drop",lang.hitch(this,this._onDragLeave));}this.connect(this.domNode,"dragover",lang.hitch(this,this._onDragOver));this.connect(this.domNode,"dragleave",lang.hitch(this,this._onDragLeave));this.connect(this.domNode,"dragend",lang.hitch(this,this._onDragLeave));this.connect(this.domNode,"drop",lang.hitch(this,this._onDrop));},_onDragOverOutside:function(evt){evt.preventDefault();_f79.add(this.domNode,this.dragStartCssClass);},_onDragOver:function(evt){evt.preventDefault();_f79.remove(this.domNode,this.dragStartCssClass);_f79.add(this.domNode,this.dragOverCssClass);},_onDragLeave:function(evt){evt.preventDefault();this._removeAllCssClasses();},onDrop:function(evt,_f7e){},_onDrop:function(evt){evt.preventDefault();this._removeAllCssClasses();this.onDrop(evt,evt.dataTransfer.files);},_removeAllCssClasses:function(){_f79.remove(this.domNode,this.dragStartCssClass);_f79.remove(this.domNode,this.dragOverCssClass);}});});},"epi/cms/contentediting/command/_ContentCommandBase":function(){define("epi/cms/contentediting/command/_ContentCommandBase",["dojo/_base/declare","dojo/_base/lang","epi/shell/command/_Command"],function(_f7f,lang,_f80){return _f7f("epi.cms.contentediting.command._ContentCommandBase",[_f80],{_watchHandle:null,checkDeleted:true,_getCanExecuteAttr:function(){if(!this.model||!this.model.contentData){return false;}var _f81=this.model.contentData;return this.canExecute&&(!this.checkDeleted||(_f81&&!_f81.isDeleted));},_onModelChange:function(){this.inherited(arguments);if(this._watchHandle){this._watchHandle.unwatch();}var _f82;this._watchHandle=this.model.watch("isChangingContentStatus",lang.hitch(this,function(name,_f83,_f84){if(_f84){_f82=this.canExecute;this.set("canExecute",false);}else{this.set("canExecute",_f82);}}));}});});},"url:epi/cms/widget/templates/_FolderTreeNode.html":"<div class=\"dijitTreeNode epi-folderTreeNode\" role=\"presentation\">\r\n    <div tabindex=\"-1\" data-dojo-attach-point=\"rowNode\" class=\"dijitTreeRow\" role=\"presentation\" data-dojo-attach-event=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onclick:_onClick, ondblclick:_onDblClick\">\r\n        <span data-dojo-attach-point=\"contentNode\" class=\"dijitTreeContent\" role=\"presentation\">\r\n            <span data-dojo-attach-point=\"expandoNode\" class=\"dijitTreeExpando\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"></span>\r\n            \r\n            <span data-dojo-attach-point=\"labelNode\" class=\"dijitTreeLabel\" role=\"treeitem\"\r\n                tabindex=\"-1\" aria-selected=\"false\" data-dojo-attach-event=\"onfocus:_onLabelFocus\">\r\n            </span>\r\n        </span>\r\n        <span data-dojo-attach-point=\"extraIconsContainer\" class=\"epi-dijitExtraIconContainer\" role=\"presentation\">\r\n            <span data-dojo-attach-point=\"iconNodeMenu\" class=\"dijitTreeIcon\" role=\"presentation\" title=\"${_menuTooltip}\">&nbsp;</span>\r\n        </span>\r\n    </div>\r\n    <div data-dojo-attach-point=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\r\n</div>","url:epi/cms/widget/templates/FileList.html":"<div class=\"epi-multiFileUpload-list\">\r\n    <div data-dojo-type=\"dijit.ProgressBar\" data-dojo-attach-point=\"progressBar\" data-dojo-props=\"maximum:100\"></div>\r\n</div>","epi/shell/command/_ClipboardCommandMixin":function(){define(["dojo/_base/declare","dojo/_base/lang"],function(_f85,lang){return _f85(null,{clipboard:null,postscript:function(){this.inherited(arguments);this.clipboard.watch("data",lang.hitch(this,this._onModelChange));}});});},"epi/cms/component/command/ShowAllLanguages":function(){define(["dojo/_base/declare","dojo/_base/lang","epi/i18n!epi/cms/nls/episerver.cms.command","epi/shell/command/ToggleCommand"],function(_f86,lang,_f87,_f88){return _f86([_f88],{label:_f87.showalllanguages,property:"showAllLanguages",category:"setting",_watchHandle:null,_onModelChange:function(){var _f89=this.model;var _f8a=false;if(this._watchHandle){this._watchHandle.unwatch();}if(_f89){_f8a=_f89.get("isMultiLingual");this._watchHandle=_f89.watch("isMultiLingual",lang.hitch(this,function(name,_f8b,_f8c){this.set("canExecute",_f8c);}));}this.set("canExecute",_f8a);}});});},"epi/cms/widget/MultipleFileUpload":function(){require({cache:{"url:epi/cms/widget/templates/MultipleFileUpload.html":"<div class=\"epi-multiFileUpload\">\r\n    <form method=\"post\" action=\"\" enctype=\"multipart/form-data\">\r\n        <div data-dojo-attach-point=\"breadcrumbBar\" data-dojo-type=\"epi.cms.widget.Breadcrumb\"></div>\r\n        <div data-dojo-attach-point=\"uploadToolbar\" class=\"epi-toolbar-unwrapped\">\r\n            <span title=\"${res.uploadform.addfiles}\" >\r\n                <input type=\"file\" multiple=\"true\" uploadOnSelect=\"true\" data-dojo-type=\"dojox.form.Uploader\" data-dojo-attach-point=\"uploaderInput\" \r\n                    data-dojo-props=\"iconClass:'epi-iconPlus', showLabel: false\" />\r\n            </span>\r\n            <div data-dojo-attach-point=\"toolbarDisableLayer\"></div>\r\n        </div>\r\n        <div data-dojo-attach-point=\"fileList\" data-dojo-type=\"epi.cms.widget.FileList\"></div>\r\n    </form>\r\n</div>"}});define("epi/cms/widget/MultipleFileUpload",["dojo/_base/declare","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/dom-class","dojo/dom-geometry","dojo/dom-construct","dojo/dom-attr","dojo/dom-style","dojo/aspect","dojo/Evented","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/Toolbar","dojox/form/Uploader","dojox/form/uploader/plugins/Flash","epi/routes","epi/shell/widget/dialog/Confirmation","epi/cms/widget/FileList","epi/cms/widget/UploadUtil","epi/cms/widget/Breadcrumb","epi/cms/widget/viewmodel/FileListViewModel","dojo/text!./templates/MultipleFileUpload.html","epi/i18n!epi/cms/nls/episerver.cms.widget.uploadmultiplefiles"],function(_f8d,lang,_f8e,_f8f,_f90,_f91,_f92,_f93,_f94,_f95,_f96,_f97,_f98,_f99,_f9a,_f9b,_f9c,_f9d,_f9e,_f9f,_fa0,_fa1,_fa2,_fa3,_fa4){return _f8d("epi.cms.widget.MultipleFileUpload",[_f97,_f98,_f99,_f96],{res:_fa4,_isCompleted:true,_uploadStatus:[],templateString:_fa3,postCreate:function(){this.inherited(arguments);this._setupUploader();this._setupFileList();},upload:function(_fa5){this._resetUploader();if(!_fa5||_fa5.length===0){return;}this.uploaderInput._files=_fa5;this.uploaderInput.onChange([{uploadDirectory:this.get("uploadDirectory")}]);},close:function(){var _fa6=lang.hitch(this,function(_fa7){this.set("disableToolbar",false);this.emit("close",_fa7);});if(this._isCompleted||this.uploaderInput.getFileList().length<=0){_fa6(false);}else{var _fa8=new _f9e({title:_fa4.confirmdialog.title,description:_fa4.confirmdialog.description,onAction:lang.hitch(this,function(_fa9){if(_fa9){_fa6(true);}})});_fa8.show();}},_setupUploader:function(){this._setupUploaderDefault();this._setupUploaderHTML5Plugin();this._setupUploaderFlashPlugin();},_setupUploaderDefault:function(){this.uploaderInput.uploadUrl=_f9d.getActionPath({moduleArea:"CMS",controller:"FileUpload",action:"Upload"});_f95.before(this.uploaderInput,"onChange",lang.hitch(this,function(_faa){this._isCompleted=false;this.set("disableToolbar",true);return [[{uploadDirectory:this.get("uploadDirectory")}]];}));},_setupUploaderHTML5Plugin:function(){if(!_fa0.supportNativeDndFiles()){return;}this.uploaderInput.on("error",lang.hitch(this,function(err){if(err.statusCode===404){this.set("uploadStatus",_fa0.StatusScope.All,"",_fa4.uploadform.errormessage);this._onUploadComplete();}}));},_setupUploaderFlashPlugin:function(){if(_fa0.supportNativeDndFiles()){return;}this.uploaderInput.uploadOnSelect=false;this._setFlashUploaderSize();this._setFocusOnFlash();this.uploaderInput.on("error",lang.hitch(this,function(err){this.set("uploadStatus",_fa0.StatusScope.Single,err.target.name,_fa4.uploadform.errormessage);}));},_setFlashUploaderSize:function(){var _fab=null;var _fac=_f95.before(this.uploaderInput,"_createInput",function(){_fab=lang.clone(this.btnSize);this.btnSize.w+=10;this.btnSize.h+=10;_fac.remove();});var _fad=_f95.after(this.uploaderInput,"_createInput",function(){this.btnSize=_fab;_fad.remove();});},_setFocusOnFlash:function(){_f8f.forEach(["focus","load"],function(_fae){this.uploaderInput.on(_fae,lang.hitch(this,function(){setTimeout(lang.hitch(this,function(){var swf=this.uploaderInput.flashMovie;if(swf){swf.focus();}return;}),1);}));},this);},_setupFileList:function(){this._fileListModel=new _fa2();this.fileList.set("model",this._fileListModel);this.uploaderInput.on("change",lang.hitch(this,function(){this._clearUploadStatus();var _faf=this.uploaderInput.getFileList();if(_faf&&_faf.length>0){this._fileListModel.set("uploadFiles",_faf);}}));this.uploaderInput.on("begin",lang.hitch(this,function(_fb0){if(_fb0&&_fb0.length>0){this._fileListModel.set("showProgressBar",true);}}));this.uploaderInput.on("progress",lang.hitch(this,function(_fb1){this._fileListModel.set("progress",_fb1);}));this.connect(this.uploaderInput,"reset",lang.hitch(this,function(){this._fileListModel.clear();}));this.uploaderInput.onComplete=lang.hitch(this,this._onUploadComplete);},_setUploadStatusAttr:function(_fb2,_fb3,_fb4){this._uploadStatus=_fa0.addStatus(this._uploadStatus,_fb2,_fb3,_fb4);},_getUploadStatusAttr:function(){return this._uploadStatus;},_setBreadcrumbAttr:function(_fb5){this.breadcrumbBar._cleanUp();this.breadcrumbBar._availableWidth=_f91.getContentBox(this.breadcrumbBar.domNode).w;var _fb6=_fb5?_fb5.length:0;if(_fb6>0){for(var i=0;i<_fb6-1;i++){this.breadcrumbBar._createItem({name:_fb5[i]},true);}this.breadcrumbBar._createItem({name:_fb5[_fb6-1]},false);}},_setDisableToolbarAttr:function(_fb7){if(_fa0.supportNativeDndFiles()){this.uploaderInput.set("disabled",_fb7);if(!_fb7){this.uploaderInput.set("tabindex",0);}}else{_f90.toggle(this.toolbarDisableLayer,"epi-uploadToolbarOverlay",_fb7);_fa0.toggleVisibility(this.toolbarDisableLayer,_fb7);if(this.uploaderInput.flashMovie){_fb7===false?this.uploaderInput.flashMovie.focus():this.uploaderInput.flashMovie.blur();}if(_fb7===true&&!this._toolbarSize){this._toolbarSize=_f91.position(this.uploadToolbar);_f94.set(this.toolbarDisableLayer,{width:this._toolbarSize.w+"px",height:this._toolbarSize.h+"px"});}}},_clearUploadStatus:function(){this._uploadStatus=[];},_clearUploadFiles:function(){this.uploaderInput._files=[];},_resetUploader:function(){this._fileListModel.set("showProgressBar",false);var _fb8=lang.hitch(this,function(){this.uploaderInput.reset();});if(_fa0.supportNativeDndFiles()){_fb8();return;}if(this.uploaderInput.flashMovie&&this.uploaderInput.flashMovie["reset"]){_fb8();}},_onUploadComplete:function(evt){this._isCompleted=true;if(evt){if(lang.isArray(evt)){_f8f.forEach(evt,function(item){if(item.error!=="server timeout"){if(!_fa0.supportNativeDndFiles()&&item.additionalParams&&item.additionalParams.replaceChar){_fa0.setAltCommaChar(item.additionalParams.replaceChar);}this.set("uploadStatus",item.index?_fa0.StatusScope.Single:_fa0.StatusScope.All,(item.fileName||item.name),(item.errorMessage||item.error));}},this);}else{if((evt.isValid&&evt.isValid===false)&&(evt.saved&&evt.saved===false)){this.set("uploadStatus",_fa0.StatusScope.All,"",evt.error);}}}this._fileListModel.set("uploadStatus",this.get("uploadStatus"));this.set("disableToolbar",false);this._clearUploadFiles();this.emit("uploadComplete");}});});},"epi/shell/dgrid/TemplateColumn":function(){define(["dojo/_base/array"],function(_fb9){return function(_fba,_fbb){var _fbc=_fba.renderCell;_fba.formatters=_fbb=_fbb||_fba.formatters;if(_fba.formatters&&_fba.formatters.length>0){_fba.renderCell=function(_fbd,_fbe,cell,_fbf){_fb9.forEach(_fba.formatters,function(_fc0){if(_fc0){_fbe=_fc0(_fbe);}});cell.innerHTML=_fbe;};}return _fbc?_fbc.call(_fba,object,value,cell,options):_fba;};});},"epi/cms/contentediting/command/Editing":function(){define("epi/cms/contentediting/command/Editing",["dojo/_base/declare","dojo/_base/lang","dojo/Stateful","epi","epi/shell/_StatefulGetterSetterMixin","epi/cms/contentediting/command/RevertToPublished","epi/cms/contentediting/command/Reject","epi/cms/contentediting/command/SendForReview","epi/cms/contentediting/command/Publish","epi/cms/contentediting/command/Translate","epi/cms/contentediting/command/CreateDraft","epi/cms/contentediting/command/Withdraw","epi/cms/contentediting/command/ManageExpiration"],function(_fc1,lang,_fc2,epi,_fc3,_fc4,_fc5,_fc6,_fc7,_fc8,_fc9,_fca,_fcb){var _fcc=_fc1("epi.cms.contentediting.command.Editing",[_fc2,_fc3],{model:null,revertToPublished:null,reject:null,translate:null,createDraft:null,sendForReview:null,publish:null,withdraw:null,manageExpiration:null,constructor:function(_fcd){lang.mixin(this,_fcd);this.revertToPublished=new _fc4();this.reject=new _fc5();this.translate=new _fc8();this.createDraft=new _fc9();this.sendForReview=new _fc6();this.publish=new _fc7();this.withdraw=new _fca();this.manageExpiration=new _fcb();},_setModelAttr:function(_fce){this._set("model",_fce);this.revertToPublished.set("model",_fce);this.reject.set("model",_fce);this.translate.set("model",_fce);this.createDraft.set("model",_fce);this.sendForReview.set("model",_fce);this.publish.set("model",_fce);this.withdraw.set("model",_fce);this.manageExpiration.set("model",_fce);}});return new _fcc();});},"dgrid/Selection":function(){define("dgrid/Selection",["dojo/_base/kernel","dojo/_base/declare","dojo/_base/Deferred","dojo/on","dojo/has","dojo/aspect","./List","dojo/has!touch?./util/touch","put-selector/put","dojo/query"],function(_fcf,_fd0,_fd1,on,has,_fd2,List,_fd3,put){var _fd4=has("mac")?"metaKey":"ctrlKey";return _fd0([List],{selectionDelegate:".dgrid-row",selectionEvents:"mousedown,dgrid-cellfocusin",deselectOnRefresh:true,allowSelectAll:false,create:function(){this.selection={};return this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();},selection:{},selectionMode:"extended",_setSelectionMode:function(mode){if(mode==this.selectionMode){return;}this.clearSelection();this._lastSelected=null;this.selectionMode=mode;},setSelectionMode:function(mode){_fcf.deprecated("setSelectionMode(...)","use set(\"selectionMode\", ...) instead","dgrid 1.0");this.set("selectionMode",mode);},_handleSelect:function(_fd5,_fd6){if(this.selectionMode=="none"||(_fd5.type=="dgrid-cellfocusin"&&_fd5.parentType=="mousedown")){return;}var _fd7=_fd5.type=="mousedown"?_fd5[_fd4]:_fd5.ctrlKey;if(_fd5.type=="mousedown"||!_fd5.ctrlKey||_fd5.keyCode==32){var mode=this.selectionMode,row=_fd6,_fd8=this.row(row),_fd9=this._lastSelected;if(mode=="single"){if(_fd9==row){if(_fd7){this.select(row,null,null);}}else{this.clearSelection();this.select(row);}this._lastSelected=row;}else{var _fda;if((_fd5.button!=2&&mode=="extended"&&!_fd7)||(_fd5.button==2&&!(this.selection[_fd8.id]))){this.clearSelection(_fd8.id);}if(!_fd5.shiftKey){_fd9=_fda=_fd7?null:undefined;}this.select(row,_fd9,_fda);if(!_fd9){this._lastSelected=row;}}if(_fd5.type=="mousedown"&&(_fd5.shiftKey||_fd7)){_fd5.preventDefault();}}},_initSelectionEvents:function(){var grid=this,_fdb=this.selectionDelegate;on(this.domNode,"selectstart",function(_fdc){var tag=_fdc.target&&_fdc.target.tagName;if(tag!="INPUT"&&tag!="TEXTAREA"){_fdc.preventDefault();}});function _fdd(_fde){grid._handleSelect(_fde,this);};if(_fd3){on(this.contentNode,_fd3.selector(_fdb,_fd3.tap),function(evt){grid._handleSelect(evt,this);});}else{on(this.contentNode,on.selector(_fdb,this.selectionEvents),_fdd);}if(this.allowSelectAll){this.on("keydown",function(_fdf){if(_fdf[_fd4]&&_fdf.keyCode==65){_fdf.preventDefault();grid[grid.allSelected?"clearSelection":"selectAll"]();}});}_fd2.before(this,"removeRow",function(_fe0,_fe1){if(!_fe1){if(this.row(_fe0).id in this.selection){this.deselect(_fe0);}}});},allowSelect:function(row){return true;},_selectionEventQueue:function(_fe2,type){var grid=this,_fe3="dgrid-"+(_fe2?"select":"deselect"),rows=this[_fe3];if(rows){return rows;}setTimeout(this._fireSelectionEvent=function(){if(!rows){return;}var _fe4={bubbles:true,grid:grid};_fe4[type]=rows;on.emit(grid.contentNode,_fe3,_fe4);rows=null;delete grid[_fe3];},0);return (rows=this[_fe3]=[]);},select:function(row,_fe5,_fe6){if(_fe6===undefined){_fe6=true;}if(!row.element){row=this.row(row);}if(this.allowSelect(row)){var _fe7=this.selection;var _fe8=_fe7[row.id];if(_fe6===null){_fe6=!_fe8;}var _fe9=row.element;if(!_fe6&&!this.allSelected){delete this.selection[row.id];}else{_fe7[row.id]=_fe6;}if(_fe9){if(_fe6){put(_fe9,".dgrid-selected.ui-state-active");}else{put(_fe9,"!dgrid-selected!ui-state-active");}}if(_fe6!=_fe8&&_fe9){this._selectionEventQueue(_fe6,"rows").push(row);}if(_fe5){if(!_fe5.element){_fe5=this.row(_fe5);}var _fea=_fe5.element;var _feb=row.element;var _fec=(_fea&&(_fea.compareDocumentPosition?_fea.compareDocumentPosition(_feb)==2:_fea.sourceIndex>_feb.sourceIndex))?"down":"up";while(row.element!=_fea&&(row=this[_fec](row))){this.select(row);}}}},deselect:function(row,_fed){this.select(row,_fed,false);},clearSelection:function(_fee){this.allSelected=false;for(var id in this.selection){if(_fee!==id){this.deselect(id);}}},selectAll:function(){this.allSelected=true;this.selection={};for(var i in this._rowIdToObject){var row=this.row(this._rowIdToObject[i]);this.select(row.id);}},isSelected:function(_fef){if(!_fef){return false;}if(!_fef.element){_fef=this.row(_fef);}return !!this.selection[_fef.id];},refresh:function(){if(this.deselectOnRefresh){this.clearSelection();this._fireSelectionEvent&&this._fireSelectionEvent();}this._lastSelected=null;this.inherited(arguments);},renderArray:function(){var grid=this,rows=this.inherited(arguments);_fd1.when(rows,function(rows){var _ff0=grid.selection,i,row,_ff1;for(i=0;i<rows.length;i++){row=grid.row(rows[i]);_ff1=row.id in _ff0?_ff0[row.id]:grid.allSelected;if(_ff1){grid.select(row,null,_ff1);}}});return rows;}});});},"epi/cms/legacy/_LegacyDialogObject":function(){define("epi/cms/legacy/_LegacyDialogObject",["epi","dojo"],function(epi,dojo){return dojo.declare("epi.cms.legacy._LegacyDialogObject",null,{_dialog:null,constructor:function(_ff2){this.callbackMethod=_ff2.callbackMethod||null;this.callbackArguments=_ff2.callbackArguments||null;this.dialogArguments=_ff2.dialogArguments||null;this._opener=(_ff2.opener?_ff2.opener.top:window.top);while(this._opener.EPiOpenedDialog&&this._opener.EPiOpenedDialog._dialog){this._opener=this._opener.EPiOpenedDialog._dialog;}this._opener.EPiOpenedDialog=this;},Close:function(_ff3){if(typeof (this.callbackMethod)=="function"){(this.callbackMethod).call(this,_ff3,this.callbackArguments);}},ButtonChanged:function(_ff4){},Cleanup:function(){var _ff5;if(this._dialog!=null){}this._CleanDialog();if(this._opener){this._opener.EPiOpenedDialog=null;}delete this._opener;this.callbackMethod=null;this.callbackArguments=null;delete this.callbackMethod;delete this.callbackArguments;this._cleaned=true;},IsCleaned:function(){return this._cleaned;},_CleanDialog:function(){for(var prop in this){if(prop!="callbackMethod"&&prop!="callbackArguments"&&prop!="_opener"){this[prop]=null;delete this[prop];}}}});});},"dijit/tree/ForestStoreModel":function(){define("dijit/tree/ForestStoreModel",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/window","./TreeStoreModel"],function(_ff6,_ff7,lang,win,_ff8){return _ff7("dijit.tree.ForestStoreModel",_ff8,{rootId:"$root$",rootLabel:"ROOT",query:null,constructor:function(_ff9){this.root={store:this,root:true,id:_ff9.rootId,label:_ff9.rootLabel,children:_ff9.rootChildren};},mayHaveChildren:function(item){return item===this.root||this.inherited(arguments);},getChildren:function(_ffa,_ffb,_ffc){if(_ffa===this.root){if(this.root.children){_ffb(this.root.children);}else{this.store.fetch({query:this.query,onComplete:lang.hitch(this,function(_ffd){this.root.children=_ffd;_ffb(_ffd);}),onError:_ffc});}}else{this.inherited(arguments);}},isItem:function(_ffe){return (_ffe===this.root)?true:this.inherited(arguments);},fetchItemByIdentity:function(_fff){if(_fff.identity==this.root.id){var scope=_fff.scope?_fff.scope:win.global;if(_fff.onItem){_fff.onItem.call(scope,this.root);}}else{this.inherited(arguments);}},getIdentity:function(item){return (item===this.root)?this.root.id:this.inherited(arguments);},getLabel:function(item){return (item===this.root)?this.root.label:this.inherited(arguments);},newItem:function(args,_1000,_1001){if(_1000===this.root){this.onNewRootItem(args);return this.store.newItem(args);}else{return this.inherited(arguments);}},onNewRootItem:function(){},pasteItem:function(_1002,_1003,_1004,bCopy,_1005){if(_1003===this.root){if(!bCopy){this.onLeaveRoot(_1002);}}this.inherited(arguments,[_1002,_1003===this.root?null:_1003,_1004===this.root?null:_1004,bCopy,_1005]);if(_1004===this.root){this.onAddToRoot(_1002);}},onAddToRoot:function(item){},onLeaveRoot:function(item){},_requeryTop:function(){var _1006=this.root.children||[];this.store.fetch({query:this.query,onComplete:lang.hitch(this,function(_1007){this.root.children=_1007;if(_1006.length!=_1007.length||_ff6.some(_1006,function(item,idx){return _1007[idx]!=item;})){this.onChildrenChange(this.root,_1007);}})});},onNewItem:function(item,_1008){this._requeryTop();this.inherited(arguments);},onDeleteItem:function(item){if(_ff6.indexOf(this.root.children,item)!=-1){this._requeryTop();}this.inherited(arguments);},onSetItem:function(item,_1009,_100a,_100b){this._requeryTop();this.inherited(arguments);}});});},"epi/cms/contentediting/_Renderer":function(){define("epi/cms/contentediting/_Renderer",["epi","dojo"],function(epi,dojo){return dojo.declare("epi.cms.contentediting._Renderer",null,{constructor:function(_100c){dojo.mixin(this,_100c);},render:function(_100d,_100e,_100f,_1010){throw new Error("Abstract method _render must be overridden in a derived class");}});});},"epi/cms/widget/VisitorGroupsSelector":function(){define("epi/cms/widget/VisitorGroupsSelector",["dojo","dojo/_base/lang","dojo/_base/array","dojo/_base/Deferred","epi","epi/dependency","epi/cms/widget/_ItemSelectorBase","epi/cms/widget/_DropDownWidgetItemMixin","epi/i18n!epi/cms/nls/episerver.cms.widget.visitorgroupselector"],function(dojo,lang,array,_1011,epi,_1012,_1013,_1014,res){return dojo.declare("epi.cms.widget.VisitorGroupsSelector",[_1013,_1014],{defaultItem:{id:-1,name:res.defaultitem},_visitorGroupsHash:{},_isFinished:null,postMixInProperties:function(){this.inherited(arguments);var _1015=_1012.resolve("epi.storeregistry");this._store=_1015.get("epi.cms.visitorgroup");},postCreate:function(){this._isFinished=new _1011();this.inherited(arguments);this.set("header",res.header);dojo.when(this._store.query(),lang.hitch(this,function(_1016){this._createHashMap(_1016);this.checkedItem=(this.checkedItem?this._visitorGroupsHash[this.checkedItem]:this.defaultItem.name);_1016.unshift(this.defaultItem);this.set("items",_1016);this._isFinished.resolve({status:true});}));},isSetupFinished:function(){return this._isFinished;},_createHashMap:function(items){array.forEach(items,lang.hitch(this,function(item){this._visitorGroupsHash[item.id]=item.name;}));}});});},"epi/cms/widget/UploadUtil":function(){define("epi/cms/widget/UploadUtil",["dojo/_base/array","dojo/_base/lang","dojo/dom-style"],function(array,lang,_1017){return {_altCommaChar:null,StatusScope:{Single:0,All:1},setAltCommaChar:function(_1018){this._altCommaChar=_1018;},getAltCommaChar:function(){return this._altCommaChar;},validUploadFiles:function(files){if(!files||!lang.isArray(files)||files.length===0){return false;}return !array.some(files,function(item){return (item.name==null||item.size==null);});},addStatus:function(store,scope,_1019,_101a){var _101b=[];if(lang.isArray(store)){_101b=lang.clone(store);}if(!this.supportNativeDndFiles()){_101a=this.replaceComma(_101a);}var _101c=array.some(_101b,function(item){return (item.scope===scope&&item.itemName===_1019&&item.message===_101a);});if(!_101c){_101b.push({scope:scope,itemName:_1019,message:_101a});}return _101b;},supportNativeDndFiles:function(){return !!window.FileReader;},filterFileOnly:function(files){return array.filter(files,function(file){if(file.type===""&&(file.size===0||file.size%4096===0)){return false;}return true;});},replaceComma:function(data){return data.replace(new RegExp("\\"+this.getAltCommaChar(),"gim"),",");},toggleVisibility:function(_101d,_101e){_1017.set(_101d,"display",(_101e?"block":"none"));}};});},"epi/cms/contentediting/ContentViewModel":function(){define("epi/cms/contentediting/ContentViewModel",["dojo","dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/Stateful","epi/dependency","epi/datetime","epi/string","epi/shell/UndoManager","epi/shell/widget/dialog/Alert","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/ContentEditingValidator","epi/cms/contentediting/ContentModel","epi/cms/contentediting/ContentModelServerSync","epi/cms/command/ReloadContent","epi/i18n!epi/cms/nls/episerver.cms.contentediting","epi/i18n!epi/cms/nls/episerver.cms.components.versions"],function(dojo,array,_101f,_1020,_1021,lang,_1022,_1023,_1024,_1025,_1026,Alert,_1027,_1028,_1029,_102a,_102b,res,_102c){return _1020("epi.cms.contentediting.ContentViewModel",[_1022],{contentModel:null,metadata:null,syncService:null,editorFactory:null,syncInterval:10000,validator:null,contentDataStore:null,profileHandler:null,languageContext:null,_converterRegistry:null,_contentVersionStore:null,_syncRetryTimeout:60000,_undoManager:null,_undoManagerConnects:null,_syncServiceConnects:null,contextTypeName:"",contentLink:null,contentData:null,viewName:null,isCreatingNewVersion:false,hasUndoSteps:false,hasRedoSteps:false,isValid:true,hasPendingChanges:false,lastSaved:null,isSaved:true,isSaving:false,isOnline:true,hasErrors:false,isChangingContentStatus:false,constructor:function(){this._undoManagerConnects=[];this._syncServiceConnects=[];},postscript:function(){this.inherited(arguments);this.profileHandler=this.profileHandler||_1023.resolve("epi.shell.Profile");this.metadataManager=this.metadataManager||_1023.resolve("epi.shell.MetadataManager");var _102d=_1023.resolve("epi.storeregistry");this.contentDataStore=this.contentDataStore||_102d.get("epi.cms.contentdata");this._contentVersionStore=_102d.get("epi.cms.contentversion");this._converterRegistry=this._converterRegistry||_1023.resolve("epi.objectconverterregistry");this._undoManager=new _1026();this.validator=new _1028({contextId:this.contentLink,contextTypeName:this.contextTypeName});this._createSyncService();var _102e=lang.hitch(this,function(name,_102f,_1030){this.set(name,_1030);});this.validator.watch("isValid",_102e);this.validator.watch("hasErrors",_102e);this._undoManager.watch("hasUndoSteps",_102e);this._undoManager.watch("hasRedoSteps",_102e);},setActiveProperty:function(name){this.onSetActiveProperty(name);},suspend:function(){this.onContentChange();this.onSuspend();},onSuspend:function(){},destroy:function(){this.clear();this.disconnectLocal(this._undoManagerConnects);this.disconnectLocal(this._syncServiceConnects);this.inherited(arguments);},clear:function(){this._undoManager.clear();},setContentData:function(value,ctx){this.contentLink=value.contentLink;this.contentData=value;this.syncService.contentLink=this.contentLink;this.languageContext=ctx.languageContext;},_createSyncService:function(){this.disconnectLocal(this._syncServiceConnects);delete this.syncService;var _1031=new _102a({contentLink:this.contentLink,contentDataStore:this.contentDataStore});_1031.watch("hasPendingChanges",lang.hitch(this,function(name,old,value){this.set("hasPendingChanges",value);}));this.syncService=_1031;},connectLocal:function(_1032,obj,evt,_1033){if(!lang.isArray(_1032)){throw Error("First argument to connectLocal must be an Array");}return _1032.push(_101f.connect(obj,evt,this,_1033));},disconnectLocal:function(_1034){if(lang.isArray(_1034)){var _1035;while(_1035=_1034.pop()){_101f.disconnect(_1035);}}},resetNotifications:function(){this.validator.clearErrorsBySource(this.validator.validationSource.client);},getProperty:function(_1036){return this.contentModel.get(_1036);},setProperty:function(_1037,value){this._setModelProperty(_1037,value);},publishProperty:function(_1038,value){this.syncService.publishProperty(_1038,value).then(lang.hitch(this,function(){this.contentModel.set(_1038,value);_1021.when(this.contentDataStore.query({id:this.contentData.contentLink}),lang.hitch(this,function(_1039){this.set("contentData",_1039);}));}));},commitProperty:function(_103a,value,_103b){var _103c=(_103b!==undefined)?_103b:this.contentModel.get(_103a);this._commitProperty(_103a,value,_103c);},commitProperties:function(_103d){var _103e=array.map(_103d,function(item){var _103f=(item.oldValue!==undefined)?item.oldValue:this.contentModel.get(item.propertyName);return {propertyName:item.propertyName,value:item.value,oldValue:_103f};},this);this._commitProperties(_103e);},_commitProperties:function(_1040){array.forEach(_1040,function(item){this._setModelProperty(item.propertyName,item.value);},this);var _1041=array.map(_1040,function(item){return {propertyName:item.propertyName,value:item.oldValue,oldValue:item.value};});this._undoManager.createStep(this,this._commitProperties,[_1041],"Edit properties");},_setModelProperty:function(_1042,value){this.set("isSaved",false);this.syncService.scheduleForSync(_1042,value);this.contentModel.set(_1042,value);this.onPropertyEdited(_1042,value);},onPropertyEdited:function(_1043,value){},_commitProperty:function(_1044,value,_1045){this._setModelProperty(_1044,value);this._undoManager.createStep(this,this._commitProperty,[_1044,_1045,value],"Edit "+_1044);},_onSynchronizeSuccess:function(_1046,_1047,_1048){array.forEach(_1047,lang.hitch(this,function(_1049){this.validator.clearPropertyErrors(_1049.name,this.validator.validationSource.server);this._patchContentDataStore(_1046,_1049.name,null,_1049.value);}));this.validator.setGlobalErrors(_1048.validationErrors,this.validator.validationSource.server);},_onSynchronizeFailure:function(_104a,_104b,_104c,_104d){array.forEach(_104b,function(_104e){if("successfull" in _104e){if(_104e.successfull){this.validator.clearPropertyErrors(_104e.name,this.validator.validationSource.server);}else{this.validator.setPropertyErrors(_104e.name,[{"errorMessage":_104e.validationErrors,severity:this.validator.severity.error}],this.validator.validationSource.server);}}else{}},this);if(_104d){if(_104d.validationErrors){this.validator.setGlobalErrors(_104d.validationErrors,this.validator.validationSource.server);}else{this.validator.clearGlobalErrors(this.validator.validationSource.server);}}},_contentLinkChanged:function(_104f,_1050){this.contentLink=_1050;this.syncService.contentLink=_1050;this.validator.setContextId(_1050);var _1051={uri:"epi.cms.contentdata:///"+_1050};_101f.publish("/epi/shell/context/request",[_1051,{sender:this,contentLinkSyncChange:true,trigger:"internal"}]);},ensureWritableVersion:function(){var _1052=this.contentLink;if(!this.contentData.isNewVersionRequired){return _1052;}this.isCreatingNewVersion=true;var def=new _1021();_1021.when(this._contentVersionStore.put({originalContentLink:_1052}),lang.hitch(this,function(_1053){this._contentLinkChanged(_1052,_1053);this.isCreatingNewVersion=false;def.resolve(_1053);}),lang.hitch(this,function(){this.isCreatingNewVersion=false;def.reject();}));return def;},validate:function(){var def;if(!this.validator){def=new _1021();def.resolve();}else{def=this.validator.validate();}return def;},revertToPublished:function(){var _1054=this.contentLink;_1021.when(this._contentVersionStore.remove(_1054),lang.hitch(this,function(){this._loadPublishedVersion(_1054);}),lang.hitch(this,function(error){if(error.status===403){this.dialog=new Alert({description:_102c.deleteversion.cannotdeletepublished,onAction:lang.hitch(this,function(){var _1055=new _102b({forceReloadCurrentContent:true});_1055.execute();})});this.dialog.show();}if(error.status===404){this.dialog=new Alert({description:res.versionstatus.versionnotfound,onAction:lang.hitch(this,function(){this._loadPublishedVersion(_1054);})});this.dialog.show();}}));},_loadPublishedVersion:function(_1056){_1021.when(this._contentVersionStore.query({contentLink:_1056,language:this.languageContext?this.languageContext.language:"",query:"getpublishedversion"}),lang.hitch(this,function(_1057){if(_1057!==null){var _1058={uri:"epi.cms.contentdata:///"+_1057.contentLink,context:this};_101f.publish("/epi/shell/context/request",[_1058,{sender:this,trigger:"internal"}]);}}));},createDraft:function(){var _1059=this.contentLink;var _105a=this.contentData.status;var _105b=_1027.versionStatus;var _105c=_105a===_105b.DelayedPublish;return _1021.when(this._contentVersionStore.put({originalContentLink:_1059,isCommonDraft:_105c}),lang.hitch(this,function(_105d){var _105e={uri:"epi.cms.contentdata:///"+_105d,context:this};_101f.publish("/epi/shell/context/request",[_105e,{sender:this}]);}));},editCommonDraft:function(){var _105f=this.contentLink;return _1021.when(this._contentVersionStore.query({contentLink:_105f,query:"getcommondraftversion"}),lang.hitch(this,function(_1060){var _1061={uri:"epi.cms.contentdata:///"+_1060.contentLink,context:this};_101f.publish("/epi/shell/context/request",[_1061,{sender:this}]);}));},_populateContentModel:function(data,_1062){var props={},_1063,_1064;for(var _1065 in data){var _1066=_1062.getPropertyMetadata(_1065);var _1067=data[_1065];if(_1066.hasSubProperties()){props[_1065]=this._populateContentModel(_1067,_1066);}else{props[_1065]=_1067;_1063=_1066.customEditorSettings.converter;if(_1063){_1064=this._converterRegistry.getConverter(_1063,"runtimeType");if(_1064){props[_1065]=_1064.convert(_1063,"runtimeType",_1067);}}}}return props;},getPropertyMetaData:function(_1068){if(this.metadata){return this.metadata.getPropertyMetadata(_1068);}else{var _1069=[],def=new _1021();this.connectLocal(_1069,this,"onMetadataResolve",function(_106a){if(_106a){def.resolve(this.metadata.getPropertyMetadata(_1068));}else{def.reject();}this.disconnectLocal(_1069);});return def;}},getContentModelAndMetadata:function(){var def=new _1021();_1021.when(this.metadataManager.getMetadataForType("EPiServer.Core.ContentData",{contentLink:this.contentLink}),lang.hitch(this,function(_106b){this.metadata=_106b;this.set("contentModel",new _1029({initialData:this._populateContentModel(this.contentData.properties,_106b)}));this.onMetadataResolve(true);def.resolve();}),function(){this.onMetadataResolve(false);def.reject();});return def;},onMetadataResolve:function(_106c){},getMetadataThenUpdateModel:function(){var def=new _1021();_1021.when(this.metadataManager.getMetadataForType("EPiServer.Core.ContentData",{contentLink:this.contentLink}),lang.hitch(this,function(_106d){this.metadata=_106d;this.set("contentModel",lang.mixin(this.contentModel,new _1029({initialData:this._populateContentModel(this.contentData.properties,_106d)})));def.resolve();}),function(){def.reject();});return def;},save:function(){if(!this.isOnline){var def=new _1021();def.resolve(true);return def;}return this._save();},_save:function(){var def=new _1021(),_106e=lang.hitch(this,function(_106f){if(_106f){if(_106f.successful){this._onSynchronizeSuccess(_106f.contentLink,_106f.properties,_106f);}else{this._onSynchronizeFailure(_106f.contentLink,_106f.properties,_106f.validationErrors,_106f);}if(_106f&&_106f.hasContentLinkChanged){this._contentLinkChanged(_106f.contentLink,_106f.oldContentLink);}}this.set("isOnline",true);this.set("lastSaved",new Date());this.set("isSaving",false);this.set("isSaved",true);def.resolve(true);}),_1070=lang.hitch(this,function(_1071){this.set("hasErrors",true);this.set("isSaving",false);this.set("isSaved",false);this.set("isOnline",false);if(_1071){array.forEach(_1071.properties,lang.hitch(this,function(_1072){if(!this.syncService.pendingSync(_1072.name)){this.syncService.scheduleForSync(_1072.name,_1072.value);}}));}setTimeout(lang.hitch(this,function(){this.set("isOnline",true);this._save();}),this._syncRetryTimeout);def.reject(_1071);});if(this.isCreatingNewVersion||!this.hasPendingChanges){_106e();}else{_1021.when(this.ensureWritableVersion(),lang.hitch(this,function(){this.set("isSaving",true);_1021.when(this.syncService.save(),_106e,_1070);}),_1070);}return def;},undo:function(){this._undoManager.undo();},redo:function(){this._undoManager.redo();},_patchContentDataStore:function(_1073,_1074,_1075,_1076){var _1077={};lang.setObject(_1074,_1076,_1077);return this.contentDataStore.patchCache({contentLink:_1073,changedBy:this.profileHandler.userName,saved:_1024.serialize(new Date()),properties:_1077});},changeContentStatus:function(_1078){var _1079=this.contentLink;var def=new _1021();this.set("isChangingContentStatus",true);var _107a=lang.hitch(this,function(_107b){var _107c=_107b&&_107b.success;var _107d=this.validator;if(_107c){if(_1078==_1027.action.Publish||_1078==_1027.action.CheckIn||_1078==(_1027.saveAction.CheckIn|_1027.saveAction.DelayedPublish|_1027.saveAction.ForceCurrentVersion)){this.set("lastSaved",null);}if(_107d){_107d.clearGlobalErrors(_107d.validationSource.server);}def.resolve({id:_107b.id,oldId:_1079});}else{if(_107b&&_107b.validationErrors){if(_107d){_107d.setGlobalErrors(_107b.validationErrors,_107d.validationSource.server);_107d.validate();}def.reject(null);}else{def.reject((_107b&&_107b.errorMessage)?_107b.errorMessage:res.publish.error);}}this.set("isChangingContentStatus",false);});var _107e=lang.hitch(this,function(_107f){_101f.publish("/epi/cms/action/showerror");def.reject((_107f&&_107f.errorMessage)?_107f.errorMessage:res.publish.error);this.set("isChangingContentStatus",false);});this.onContentChange();_1021.when(this.validate(),lang.hitch(this,function(){_1021.when(this.save(),lang.hitch(this,function(){_1021.when(this.contentDataStore.executeMethod("ChangeStatus",_1079,{action:_1078}),_107a,_107e);}),_107e);}),_107e);return def;},onContentChange:function(){},hasEditAccess:function(){return _1027.hasAccess(this.contentData.accessMask,_1027.accessLevel.Edit);},hasAccess:function(_1080){var _1081=!this.languageContext||!this.languageContext.isTranslationNeeded;return _1081&&_1027.isActionAvailable(this.contentData,_1080||_1027.action.Edit,_1027.providerCapabilities.Edit);},canChangeContent:function(_1082){return this.hasAccess(_1082);}});});},"epi/cms/contentediting/viewsettings/VisitorGroupViewSetting":function(){define("epi/cms/contentediting/viewsettings/VisitorGroupViewSetting",["dojo/_base/declare","dojo/_base/lang","epi/cms/contentediting/_ViewSetting"],function(_1083,lang,_1084){return _1083([_1084],{key:"visitorgroup",usedForRendering:true,isTagItem:false,beforePreviewLoad:function(_1085,_1086){this.inherited(arguments);lang.mixin(_1085,this._getVisitorGroupUrlParam(_1086));},_getVisitorGroupUrlParam:function(_1087){var _1088=_1087?this.value:null;return {"visitorgroupsByID":_1088||null};}});});},"epi/shell/dnd/tree/dndSource":function(){define(["dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/dom-class","dojo/dom-geometry","dojo/_base/lang","dojo/on","dojo/touch","dojo/topic","dojo/dnd/Manager","dijit/tree/dndSource"],function(array,_1089,_108a,_108b,_108c,lang,on,touch,topic,_108d,_108e){return _108a([_108e],{generateText:false,itemTreeNodeType:null,singular:true,deleteSelectedNodes:function(){},userSelect:function(node){this.inherited(arguments,[node,false,false]);},onDndDrop:function(_108f,nodes,copy){if(this.containerState=="Over"){var tree=this.tree,model=tree.model,_1090=this.targetAnchor;this.isDragging=false;var _1091;var _1092=(_1090&&_1090.item)||tree.item;if(this.dropPosition=="Before"||this.dropPosition=="After"){_1092=(_1090.getParent()&&_1090.getParent().item)||tree.item;_1091=_1090.getIndexInParent();if(this.dropPosition=="After"){_1091=_1090.getIndexInParent()+1;}}var _1093;array.forEach(nodes,function(node,idx){var _1094=_108f.getItem(node.id);if(array.indexOf(_1094.type,this.itemTreeNodeType)!=-1){var _1095=_1094.data,_1096=_1095.item,_1097=_1095.getParent().item;}if(_108f==this){if(typeof _1091=="number"){if(_1092==_1097&&_1095.getIndexInParent()<_1091){_1091-=1;}}model.pasteItem(_1096,_1097,_1092,copy,_1091);}else{if(model.isItem(_1096)){model.pasteItem(_1096,_1097,_1092,copy,_1091);}else{if(!_1093){_1093=this.itemCreator(nodes,_1090.rowNode,_108f);}model.newItem(_1093[idx],_1092,_1091);}}},this);this.tree._expandNode(_1090);}this.onDndCancel();},getItem:function(key){var item=this.inherited(arguments);item.type=[this.itemTreeNodeType];return item;}});});},"epi/cms/widget/ChannelsButton":function(){define("epi/cms/widget/ChannelsButton",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/connect","dojo/_base/Deferred","dojo/dom-class","dijit/DropDownMenu","dijit/form/DropDownButton","dijit/focus","epi","epi/dependency","epi/cms/widget/ChannelSelector","epi/cms/widget/ResolutionSelector","epi/i18n!epi/cms/nls/episerver.cms.widget.channelbutton"],function(_1098,lang,array,_1099,_109a,_109b,_109c,_109d,_109e,epi,_109f,_10a0,_10a1,_10a2){return _1098("epi.cms.widget.ChannelsButton",[_109d],{_contextMenu:null,baseClass:"epi-mediumButton epi-chromelessButton",iconClass:"epi-iconDevice",contextMenuProperties:{},_channelSelector:null,_resolutionSelector:null,_viewSettingsManager:null,postMixInProperties:function(){this.inherited(arguments);lang.mixin(this.contextMenuProperties,{"class":"epi-DropDownMenu"});},postCreate:function(){this.inherited(arguments);this._viewSettingsManager=_109f.resolve("epi.viewsettingsmanager");var _10a3=this._viewSettingsManager.getSettingProperty("resolution");var _10a4=this._viewSettingsManager.getSettingProperty("epichannel");if(!this.dropDown){this.dropDown=dijit.DropDownMenu(this.contextMenuProperties);this._channelSelector=new _10a0({checkedItem:_10a4});_1099.connect(this._channelSelector,"onItemSelected",this,this._onChannelSelected);this._resolutionSelector=new _10a1({checkedItem:_10a3});_1099.connect(this._resolutionSelector,"onItemSelected",this,this._onResolutionSelected);this._addChildren(this._channelSelector);this._addChildren(this._resolutionSelector);_109a.when(this._channelSelector.isSetupFinished(),lang.hitch(this,function(_10a5){this._activeButton(!this._isDefaultSelection());this._updateTooltip();this._setupKeyboardNav();}));}},_setupKeyboardNav:function(){var _10a6=[];array.forEach([this._channelSelector,this._resolutionSelector],function(menu){_10a6=_10a6.concat(array.map(menu.menuNode.getChildren(),function(item){return {menuItem:item,menu:menu.menuNode};}));});var _10a7=0;var _10a8=lang.hitch(this,function(_10a9){_10a7+=_10a9==="next"?1:-1;_10a7=_10a7>=_10a6.length?0:_10a7;_10a7=_10a7<0?_10a6.length-1:_10a7;var _10aa=_10a6[_10a7];_10aa.menu.focusChild(_10aa.menuItem);});var _10ab=function(){_10a8("next");};var _10ac=function(){_10a8("prev");};_1099.connect(this.dropDown,"onOpen",this,function(e){_109e.focus(this._channelSelector.menuNode.domNode);});this._channelSelector.menuNode.focusNext=this._resolutionSelector.menuNode.focusNext=_10ab;this._channelSelector.menuNode.focusPrev=this._resolutionSelector.menuNode.focusPrev=_10ac;},_updateTooltip:function(){var _10ad=null;if(this._isDefaultSelection()){_10ad=_10a2.defaulttooltip;}else{var _10ae=this._channelSelector.currentSelectedItem;var _10af=this._resolutionSelector.currentSelectedItem;_10ad=lang.replace(_10a2.tooltip,{channel:_10ae.name,resolution:_10af.name});}this.set("title",_10ad);},_isDefaultSelection:function(){return (this._channelSelector.isDefaultItemSelected()&&this._resolutionSelector.isDefaultItemSelected());},_onChannelSelected:function(_10b0){var _10b1=this._resolutionSelector.getDefaultResolution(_10b0);if(!this._resolutionSelector.currentSelectedItem||(this._resolutionSelector.currentSelectedItem&&this._resolutionSelector.currentSelectedItem.name!=_10b1.name)){this._resolutionSelector.checkItem(_10b1);}this._changeView(_10b1,_10b0);},_onResolutionSelected:function(_10b2){this._changeView(_10b2);},_changeView:function(_10b3,_10b4){if(_10b3){if(_10b3.name==this._resolutionSelector.defaultItem.name){_1099.publish("/epi/cms/action/viewsettingvaluechanged",["resolution",null]);}else{var _10b5=_10b3.width+"x"+_10b3.height;_1099.publish("/epi/cms/action/viewsettingvaluechanged",["resolution",_10b5]);}}if(_10b4){if(_10b4.name==this._channelSelector.defaultItem.name){_1099.publish("/epi/cms/action/viewsettingvaluechanged",["epichannel",null]);}else{_1099.publish("/epi/cms/action/viewsettingvaluechanged",["epichannel",_10b4.channelName]);}}this._activeButton(!this._isDefaultSelection());this._updateTooltip();},_addChildren:function(item){this.dropDown.addChild(item);},_activeButton:function(_10b6){if(!this.dropDown){return;}if(_10b6){_109b.add(this.domNode,"dijitChecked");}else{_109b.remove(this.domNode,"dijitChecked");}}});});},"url:epi/cms/component/templates/Tasks.html":"<div>\r\n    <div class=\"epi-gadgetInnerToolbar\" data-dojo-attach-point=\"toolbar\">\r\n        <div data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"reloadButton\" data-dojo-attach-event=\"onClick: _reloadQuery\"\r\n            class=\"epi-chromelessButton epi-iconReload dijitInline dijitReset\">\r\n        </div>\r\n    </div>\r\n    <div data-dojo-type=\"epi.cms.component.ContentQueryGrid\" data-dojo-attach-point=\"contentQuery\">\r\n    </div>\r\n</div>\r\n","epi/cms/component/_PageTreeNode":function(){require({cache:{"url:epi/cms/component/templates/_PageTreeNode.html":"<div class=\"dijitTreeNode\" role=\"presentation\">\r\n    <div data-dojo-attach-point=\"rowNode\" class=\"dijitTreeRow\" role=\"presentation\" data-dojo-attach-event=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onclick:_onClick, ondblclick:_onDblClick\">\r\n        <span data-dojo-attach-point=\"contentNode\" class=\"dijitTreeContent\" role=\"presentation\">\r\n            <span data-dojo-attach-point=\"expandoNode\" class=\"dijitTreeExpando\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"></span>\r\n            \r\n            <span data-dojo-attach-point=\"labelNode\" class=\"dijitTreeLabel\" role=\"treeitem\"\r\n                  tabindex=\"-1\" aria-selected=\"false\" data-dojo-attach-event=\"onfocus:_onLabelFocus\">\r\n            </span>\r\n        </span>\r\n        <span data-dojo-attach-point=\"extraIconsContainer\" class=\"epi-dijitExtraIconContainer\" role=\"presentation\">       \r\n            <span data-dojo-attach-point=\"iconNodeLanguage\" class=\"epi-pt-currentLanguageMissing\" role=\"presentation\">&nbsp;</span>\r\n            <span data-dojo-attach-point=\"iconNodeAccess\" class=\"dijitTreeIcon\" role=\"presentation\">&nbsp;</span>\r\n            <span data-dojo-attach-point=\"iconNodeStatus\" class=\"dijitTreeIcon\" role=\"presentation\">&nbsp;</span>\r\n            <span data-dojo-attach-point=\"iconNodeMenu\" class=\"dijitTreeIcon\" role=\"presentation\" data-dojo-attach-event=\"onmousedown:_onMouseDownIconNodeMenu, click: _onClickIconNodeMenu\" >&nbsp;</span>\r\n        </span>\r\n    </div>\r\n    <div data-dojo-attach-point=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\r\n</div>"}});define("epi/cms/component/_PageTreeNode",["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/_base/event","dojo/_base/connect","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/aspect","dojo/Evented","dojo/text!./templates/_PageTreeNode.html","dijit/Tree","dijit/focus","epi/datetime","epi/dependency","epi/string","epi/shell/widget/_ModelBindingMixin","epi/shell/widget/Tooltip","epi/cms/contentediting/PageShortcutTypeSupport","epi/cms/widget/viewmodel/ContentStatusViewModel","epi/i18n!epi/cms/nls/episerver.cms.components.pagetree"],function(array,_10b7,_10b8,lang,event,_10b9,_10ba,_10bb,_10bc,_10bd,_10be,_10bf,Tree,_10c0,_10c1,_10c2,_10c3,_10c4,_10c5,_10c6,_10c7,res){return _10b7("epi.cms.component._PageTreeNode",[Tree._TreeNode,_10c4,_10be],{templateString:_10bf,res:res,_pageLocked:"epi-pt-accessRights",_pageBeingEdited:"epi-pt-edited",_contextMenuClass:"epi-iconContextMenu",_iconNodeClass:"",_tooltip:undefined,_inUseTooltip:undefined,_selected:false,_contentTypeStore:null,postMixInProperties:function(){this.inherited(arguments);var _10c8=_10c2.resolve("epi.storeregistry");this._contentTypeStore=_10c8.get("epi.cms.contenttype");this._application=_10c2.resolve("epi.cms.Application");},postCreate:function(){this.inherited(arguments);this.set("model",new _10c7({contentStatus:this.item.status}));_10b9.subscribe("/epi/cms/action/pageexpirationchange",lang.hitch(this,function(_10c9){var _10ca=_10c9.match("^[0-9]*")[0];if(this.item.contentLink==_10ca){_10b8.when(this.model.store.refresh(_10ca),lang.hitch(this,function(item){this.item=item;}));}}));if(this._application.getStartPage()==this.item.contentLink){this.tree._expandNode(this,false);}},modelBindingMap:{"statusIcon":["statusIcon"],"statusMessage":["statusMessage"]},_setStatusMessageAttr:function(_10cb){_10ba.set(this.iconNodeStatus,"title",_10c3.toTooltipText(_10cb));},_setStatusIconAttr:function(_10cc){if(!lang.isArray(_10cc)){return;}_10bb.remove(this.iconNodeStatus);_10bb.add(this.iconNodeStatus,"dijitTreeIcon");array.forEach(_10cc,function(_10cd){_10bb.add(this.iconNodeStatus,_10cd);},this);},destroy:function(){this.inherited(arguments);if(this._tooltip){this._tooltip.destroyRecursive();}if(this._inUseTooltip){this._inUseTooltip.destroyRecursive();}},setSelected:function(_10ce){this.inherited(arguments);this._selected=_10ce;if(this._selected){_10bb.add(this.iconNodeMenu,this._contextMenuClass);}else{_10bb.remove(this.iconNodeMenu,this._contextMenuClass);}},_toggleContextMenu:function(show){if(!this._selected){_10bb.toggle(this.iconNodeMenu,this._contextMenuClass);}},_onMouseEnter:function(evt){this.inherited(arguments);this._toggleContextMenu();},_onMouseLeave:function(evt){this.inherited(arguments);this._toggleContextMenu();},_onClickIconNodeMenu:function(evt){event.stop(evt);this.emit("onContextMenuClick",{node:this,target:evt.target,x:evt.pageX,y:evt.pageY});},_onMouseDownIconNodeMenu:function(evt){event.stop(evt);},_updateItemClasses:function(item){this.inherited(arguments);this._updateLayout();},_updateLayout:function(){this.inherited(arguments);this._updateLanguageIcon();this._updateAccessRightIcon();if(this.model){this.model.set("contentStatus",this.item.status);}this._createTooltip();this._resetFocus();},_resetFocus:function(){if(_10c0.curNode&&this.tree.selectedNode&&this.tree.selectedNode.labelNode&&_10c0.curNode!=this.tree.selectedNode.labelNode){return;}if(this.tree.selectedNode){this.tree.focusNode(this.tree.selectedNode);}},_updateAccessRightIcon:function(){if(this.item.accessMask===0||this.item.accessMask==1){_10bb.add(this.iconNodeAccess,this._pageLocked);_10ba.set(this.iconNodeAccess,"title",this.res.tooltip.pagelocked);_10bb.add(this.contentNode,"epi-treeReadOnly");}else{if(this.item.inUseNotifications&&this.item.inUseNotifications.length>0){_10bb.add(this.iconNodeAccess,this._pageBeingEdited);var _10cf=[{label:this.res.tooltip.beingedited}];array.forEach(this.item.inUseNotifications,function(_10d0){var date=_10c1.toUserFriendlyHtml(_10d0.created);_10cf.push({label:_10d0.userName+", "+date,htmlEncode:false});},this);this._inUseTooltip=this._populateTooltip(_10cf,[this.iconNodeAccess]);}else{_10bb.remove(this.iconNodeAccess,this._pageBeingEdited);_10bb.remove(this.iconNodeAccess,this._pageLocked);_10bb.remove(this.contentNode,"epi-treeReadOnly");}}},_updateLanguageIcon:function(){if(this.item.missingLanguageBranch){if(this.item.missingLanguageBranch.language){this.iconNodeLanguage.innerHTML=this.item.missingLanguageBranch.language;}if(this.item.missingLanguageBranch.warning){_10ba.set(this.iconNodeLanguage,"title",this.item.missingLanguageBranch.warning);}}else{_10bc.empty(this.iconNodeLanguage);_10ba.remove(this.iconNodeLanguage,"title");}},_getShortcutText:function(){var _10d1=new _10b8();var _10d2=this.item.properties.pageShortcutType;var _10d3=this.item.properties.pageShortcutLink;var _10d4={};switch(_10d2){case _10c6.pageShortcutTypes.Shortcut:_10b8.when(this.model.store.get(_10d3),lang.hitch(this,function(item){_10d4={label:res.tooltip.shortcut,text:"["+_10d3+"] "+(item.name)};_10d1.resolve(_10d4);}));break;case _10c6.pageShortcutTypes.External:_10d4={label:res.tooltip.linkto,text:this.item.properties.pageLinkURL};_10d1.resolve(_10d4);break;case _10c6.pageShortcutTypes.Inactive:_10d4={label:res.tooltip.nolinkonlytext};_10d1.resolve(_10d4);break;case _10c6.pageShortcutTypes.FetchData:_10b8.when(this.model.store.get(_10d3),lang.hitch(this,function(item){_10d4={label:res.tooltip.fetchesdatafrom,text:"["+_10d3+"] "+(item.name)};_10d1.resolve(_10d4);}));break;default:_10d4="";_10d1.resolve(_10d4);break;}return _10d1;},_createTooltip:function(){_10b8.when(this._contentTypeStore.get(this.item.contentTypeID),lang.hitch(this,function(_10d5){var title=this.item.name+" ("+_10d5.localizedName+")";_10ba.set(this.labelNode,"title",title);_10ba.set(this.iconNode,"title",title);}));},_populateTooltip:function(_10d6,_10d7){array.forEach(_10d7,function(node){return new _10c5({tooltipRows:lang.clone(_10d6),connectId:[node],position:["after-centered","below"]});});}});});},"put-selector/put":function(){(function(_10d8){var _10d9,_10da=/[-+,> ]/;_10d8([],_10d9=function(doc,_10db){"use strict";_10da=_10db||_10da;try{var _10dc=/(?:\s*([-+ ,<>]))?\s*(\.|!\.?|#)?([-\w%$]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,_10dd,doc=doc||document,_10de=1;put("i",{name:"a"});}catch(e){_10de=0;}function _10df(_10e0,text){_10e0.appendChild(doc.createTextNode(text));};function put(_10e1){var _10e2,_10e3,_10e4,_10e5,_10e6,_10e7,args=arguments;function _10e8(){if(_10e7&&_10e6&&_10e7!=_10e6){(_10e6==_10e1&&(_10e2||(_10e2=_10da.test(_10e9)&&doc.createDocumentFragment()))||_10e6).insertBefore(_10e7,_10e5||null);}};for(var i=0;i<args.length;i++){var _10e9=args[i];if(typeof _10e9=="object"){_10e4=false;if(_10e9 instanceof Array){_10e3=doc.createDocumentFragment();for(var key=0;key<_10e9.length;key++){_10e3.appendChild(put(_10e9[key]));}_10e9=_10e3;}if(_10e9.nodeType){_10e7=_10e9;_10e8();_10e6=_10e9;_10e5=0;}else{for(var key in _10e9){_10e7[key]=_10e9[key];}}}else{if(_10e4){_10e4=false;_10df(_10e7,_10e9);}else{if(i<1){_10e1=null;}_10e4=true;var _10ea=_10e9.replace(_10dc,function(t,_10eb,_10ec,value,_10ed,_10ee){if(_10eb){_10e8();if(_10eb=="-"||_10eb=="+"){_10e6=(_10e5=(_10e7||_10e6)).parentNode;_10e7=null;if(_10eb=="+"){_10e5=_10e5.nextSibling;}}else{if(_10eb=="<"){_10e6=_10e7=(_10e7||_10e6).parentNode;}else{if(_10eb==","){_10e6=_10e1;}else{if(_10e7){_10e6=_10e7;}}_10e7=null;}_10e5=0;}if(_10e7){_10e6=_10e7;}}var tag=!_10ec&&value;if(tag||(!_10e7&&(_10ec||_10ed))){if(tag=="$"){_10df(_10e6,args[++i]);}else{tag=tag||put.defaultTag;var _10ef=_10de&&args[i+1]&&args[i+1].name;if(_10ef){tag="<"+tag+" name=\""+_10ef+"\">";}_10e7=doc.createElement(tag);}}if(_10ec){if(value=="$"){value=args[++i];}if(_10ec=="#"){_10e7.id=value;}else{var _10f0=_10e7.className;var _10f1=_10f0&&(" "+_10f0+" ").replace(" "+value+" "," ");if(_10ec=="."){_10e7.className=_10f0?(_10f1+value).substring(1):value;}else{if(_10e9=="!"){put("div",_10e7,"<").innerHTML="";}else{_10f1=_10f1.substring(1,_10f1.length-1);if(_10f1!=_10f0){_10e7.className=_10f1;}}}}}if(_10ed){if(_10ee=="$"){_10ee=args[++i];}if(_10ed=="style"){_10e7.style.cssText=_10ee;}else{_10e7[_10ed.charAt(0)=="!"?(_10ed=_10ed.substring(1))&&"removeAttribute":"setAttribute"](_10ed,_10ee===""?_10ed:_10ee);}}return "";});if(_10ea){throw new SyntaxError("Unexpected char "+_10ea+" in "+_10e9);}_10e8();_10e6=_10e3=_10e7||_10e6;}}}if(_10e1&&_10e2){_10e1.appendChild(_10e2);}return _10e3;};put.defaultTag="div";put.forDocument=_10d9;return put;});})(typeof define=="undefined"?function(deps,_10f2){if(typeof window=="undefined"){require("./node-html")(module,_10f2);}else{put=_10f2();}}:define);},"epi/cms/contentediting/command/CancelAndEdit":function(){define("epi/cms/contentediting/command/CancelAndEdit",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/date","epi/shell/command/_Command","epi/cms/core/ContentReference","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/command/_ChangeContentStatus","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons.cancelandedit"],function(_10f3,_10f4,lang,_10f5,_10f6,_10f7,_10f8,_10f9,_10fa){return _10f3("epi.cms.contentediting.command.CancelAndEdit",[_10f9],{name:"cancelAndEdit",label:_10fa.label,tooltip:_10fa.title,iconClass:"epi-iconPen",action:_10f8.action.Reject,_execute:function(){this.inherited(arguments).then(lang.hitch(this,function(){var _10fb=this.model.contentData;this.model.setProperty("iversionable_startpublish",_10fb.isPendingPublish?_10fb.created:_10fb.lastPublished);}));},_onModelChange:function(){this.inherited(arguments);var _10fc=this.model.contentData,_10fd=_10fc.status,_10fe=_10f8.hasAccess(_10fc.accessMask,_10f8.accessLevel.Edit),_10ff=_10fe&&(_10fd===_10f8.versionStatus.DelayedPublish);this.set("canExecute",_10ff);this.set("isAvailable",_10ff);}});});},"epi/cms/widget/ContentSelectorDialog":function(){define("epi/cms/widget/ContentSelectorDialog",["dojo","dojo/_base/lang","dojo/_base/connect","dojo/_base/array","dojo/aspect","dijit","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/form/Button","epi","epi/cms/widget/ContentTree","epi/cms/core/ContentReference","epi/shell/widget/_ActionProviderWidget","epi/i18n!epi/cms/nls/episerver.cms.widget.contentselectordialog"],function(dojo,lang,_1100,array,_1101,dijit,_1102,_1103,_1104,_1105,epi,_1106,_1107,_1108,_1109){return dojo.declare("epi.cms.widget.ContentSelectorDialog",[_1102,_1103,_1104,_1108],{_contentRef:null,res:_1109,root:null,typeIdentifiers:null,showButtons:true,model:null,showRoot:true,expandSubRoot:false,canSelectOwnerContent:true,templateString:"<div><div data-dojo-attach-point=\"_treeNode\"></div></div>",buildRendering:function(){this.inherited(arguments);this.tree=new _1106({root:this.root,typeIdentifiers:this.typeIdentifiers,allowManipulation:false,model:this.model,showRoot:this.showRoot},this._treeNode);if(this.expandSubRoot){var _110a=this.connect(this.tree,"onLoad",lang.hitch(this,function(){var model=this.tree.model;if(this.tree.rootNode){array.forEach(this.tree.rootNode.getChildren(),function(child){if(model.mayHaveChildren(child.item)){this.tree._expandNode(child);}},this);}_1100.disconnect(_110a);}));}this.connect(this.tree,"onClick","_onTreeNodeClick");},_setValueAttr:function(value){if(value){this._contentRef=value;var _110b=this._contentRef==="-"?null:this._contentRef;_1101.after(this.tree,"onLoad",lang.hitch(this,function(){this.tree.selectContent(_110b);}));}else{this._contentRef=null;_1101.after(this.tree,"onLoad",lang.hitch(this,function(){this.tree.selectContent();}));}},_getValueAttr:function(){this.inherited(arguments);if(this._contentRef){return this._contentRef.toString();}else{return "";}},getActions:function(){return this.canSelectOwnerContent?[{name:"selectpage",label:_1109.currentpage,settings:{type:"submit"},action:dojo.hitch(this,function(){this._setValueOwnerContent();})}]:[];},_onTreeNodeClick:function(_110c){this.set("value",_110c.contentLink);this.onChange(this.get("value"));},_setValueOwnerContent:function(){this.set("value","-");},onChange:function(_110d){},focus:function(){this.tree.focus();}});});},"epi/cms/contentediting/_View":function(){define("epi/cms/contentediting/_View",["epi","dojo","dijit/_Widget","epi/Url"],function(epi,dojo,_110e,Url){return dojo.declare("epi.cms.contentediting._View",[_110e],{iframeWithOverlay:null,overlay:null,iFrame:null,layoutContainer:null,contextTypeName:null,viewModel:null,postMixInProperties:function(){this.inherited(arguments);if(this.iframeWithOverlay){this.iFrame=this.iframeWithOverlay.iframe;this.overlay=this.iframeWithOverlay.overlay;}this._viewConnections=[];},_setViewModelAttr:function(_110f){this._set("viewModel",_110f);},_setIframeWithOverlayAttr:function(value){this._set("iframeWithOverlay",value);this.iFrame=this.iframeWithOverlay.iframe;this.overlay=this.iframeWithOverlay.overlay;},onPreviewLoading:function(){},onPreviewReady:function(_1110,doc){this.set("viewModel",_1110);this.onPrepareOverlayComplete();},onPrepareOverlayComplete:function(){},onContentLinkSyncChange:function(){},onReloadRequired:function(){},_setReloadRequiredAttr:function(value){this._set("reloadRequired",value);},_getIsBlockingAttr:function(){return true;}});});},"epi/cms/contentediting/PublishActionMenu":function(){require({cache:{"url:epi/cms/contentediting/templates/PublishActionMenu.html":"<div class=\"epi-invertedTooltip epi-publishActionMenu\" role=\"menu\" tabIndex=\"${tabIndex}\" data-dojo-attach-event=\"onkeypress:_onKeyPress\" >\r\n    <div class=\"epi-tooltipDialogTop\" data-dojo-attach-point=\"topInfoSection\">\r\n        <ul>\r\n            <li data-dojo-attach-point=\"lastChangeStatusNode\" class=\"epi-lastchangeStatus\"></li>\r\n            <li data-dojo-attach-point=\"mainButtonSection\">\r\n                <button data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"mainButton\" data-dojo-attach-event=\"onClick: _onMainButtonClick\" class=\"epi-fullWidthButton\"></button>\r\n            </li>            \r\n        </ul>          \r\n        <div data-dojo-attach-point=\"lastPublishedIcon\" class=\"dijitTooltipConnector\"></div>\r\n    </div>\r\n    <div class=\"epi-tooltipDialogInfo\"data-dojo-attach-point=\"publishInfoSection\">\r\n        <ul>\r\n            <li data-dojo-attach-point=\"lastPublishedTitleNode\"></li>\r\n            <li>\r\n                <span data-dojo-attach-point=\"lastPublishedTextNode\"></span>&nbsp;\r\n                <a href=\"#\" title=\"${res.lastpublishedviewlinktooltip}\" data-dojo-attach-point=\"lastPublishedViewLinkNode\">${res.view}</a>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n    <div class=\"epi-tooltipDialogInfo\" data-dojo-attach-point=\"additionalInfoSection\">\r\n        <ul>\r\n            <li data-dojo-attach-point=\"additionalInfoNode\"></li>\r\n        </ul>\r\n    </div>\r\n    <table class=\"dijitReset epi-tooltipDialogMenu epi-menuInverted\" cellspacing=\"0\">\r\n\t    <tbody data-dojo-attach-point=\"containerNode\" ></tbody>\r\n    </table>\r\n</div>\r\n"}});define("epi/cms/contentediting/PublishActionMenu",["dojo/_base/declare","dojo/_base/array","dojo/_base/Deferred","dojo/_base/lang","dojo/dom-style","dojo/dom-attr","dojo/dom-class","dojo/html","dijit/DropDownMenu","dijit/_KeyNavContainer","dijit/_WidgetsInTemplateMixin","epi/shell/widget/_ModelBindingMixin","epi/shell/command/builder/MenuBuilder","epi/cms/contentediting/ContentActionSupport","dojo/text!./templates/PublishActionMenu.html","epi/i18n!epi/cms/nls/episerver.cms.contentediting.editactionpanel.publishactionmenu"],function(_1111,array,_1112,lang,_1113,_1114,_1115,html,_1116,_1117,_1118,_1119,_111a,_111b,_111c,res){return _1111("epi.cms.contentediting.PublishActionMenu",[_1116,_1118,_1119],{templateString:_111c,res:res,_menuBuilder:null,commands:null,mainButtonCommand:null,postMixInProperties:function(){this._menuBuilder=new _111a();},modelBindingMap:{"commands":["commands"],"mainButtonCommand":["mainButtonCommand"],"mainButtonSectionVisible":["mainButtonSectionVisible"],"lastChangeStatus":["lastChangeStatus"],"topInfoSectionVisible":["topInfoSectionVisible"],"publishInfoSectionVisible":["publishInfoSectionVisible"],"lastPublishedTitle":["lastPublishedTitle"],"lastPublishedTitleVisible":["lastPublishedTitleVisible"],"lastPublishedText":["lastPublishedText"],"lastPublishedViewLinkVisible":["lastPublishedViewLinkVisible"],"lastPublishedViewLinkHref":["lastPublishedViewLinkHref"],"additionalInfoSectionVisible":["additionalInfoSectionVisible"],"additionalInfoText":["additionalInfoText"]},_setCommandsAttr:function(_111d){this.focusedChild=null;this.destroyDescendants();this._addCommandsToMenu(_111d);this.focusFirstChild();},_setMainButtonCommandAttr:function(_111e){this._set("mainButtonCommand",_111e);if(_111e){this.mainButton.set("label",_111e.label);this.mainButton.set("disabled",!_111e.get("canExecute"));_1115.remove(this.mainButton.domNode,"epi-loading");if(this._addedMainButtonClass){_1115.remove(this.mainButton.domNode,this._addedMainButtonClass);}if(_111e.options&&_111e.options.mainButtonClass){this._addedMainButtonClass=_111e.options.mainButtonClass;_1115.add(this.mainButton.domNode,this._addedMainButtonClass);}}},_setMainButtonSectionVisibleAttr:function(_111f){_1113.set(this.mainButtonSection,"display",_111f?"":"none");_1113.set(this.mainButton.domNode,"display",_111f?"":"none");},_setLastChangeStatusAttr:{node:"lastChangeStatusNode",type:"innerHTML"},_setTopInfoSectionVisibleAttr:function(_1120){_1113.set(this.topInfoSection,"display",_1120?"":"none");},_setPublishInfoSectionVisibleAttr:function(_1121){_1113.set(this.publishInfoSection,"display",_1121?"":"none");},_setLastPublishedTitleAttr:{node:"lastPublishedTitleNode",type:"innerHTML"},_setLastPublishedTitleVisibleAttr:function(_1122){_1113.set(this.lastPublishedTitleNode,"display",_1122?"":"none");},_setLastPublishedTextAttr:{node:"lastPublishedTextNode",type:"innerHTML"},_setLastPublishedViewLinkVisibleAttr:function(_1123){_1113.set(this.lastPublishedViewLinkNode,"display",_1123?"":"none");},_setLastPublishedViewLinkHrefAttr:function(value){_1114.set(this.lastPublishedViewLinkNode,"href",value);},_setAdditionalInfoSectionVisibleAttr:function(_1124){_1113.set(this.additionalInfoSection,"display",_1124?"":"none");},_setAdditionalInfoTextAttr:{node:"additionalInfoNode",type:"innerHTML"},postCreate:function(){this.inherited(arguments);this.mainButton._setSelected=this.mainButton._onUnhover=function(){};},uninitialize:function(){if(this._commandsChangedHandler){this.disconnect(this._commandsChangedHandler);}this.inherited(arguments);},onOpen:function(){this.model.set("isOpen",true);this.inherited(arguments);},onClose:function(){this.model.set("isOpen",false);this.inherited(arguments);},_setModelAttr:function(){this.inherited(arguments);if(this._commandsChangedHandler){this.disconnect(this._commandsChangedHandler);}this._commandsChangedHandler=this.connect(this.model,"onCommandsChanged","onCommandsChanged");},onCommandsChanged:function(name,_1125,added){if(_1125){this._removeCommandsFromMenu(lang.isArray(_1125)?_1125:[_1125]);}if(added){this._addCommandsToMenu(lang.isArray(added)?added:[added]);}},_addCommandsToMenu:function(_1126){array.forEach(_1126,function(_1127){if(_1127!==this.model.mainButtonCommand){this._menuBuilder.create(_1127,this);}},this);},_removeCommandsFromMenu:function(_1128){var _1129=this.menu.getChildren();array.forEach(_1128,function(_112a){for(var i=_1129.length-1;i>=0;i--){var item=_1129[i];if(item._command==_112a){this.removeChild(item);break;}}},this);},_onMainButtonClick:function(){if(this.mainButtonCommand){this.mainButton.set("label",this.mainButtonCommand.executingLabel);_1115.add(this.mainButton.domNode,"epi-loading");var _112b=lang.hitch(this,function(){if(this.mainButtonCommand.resetLabelAfterExecution){this.mainButton.set("label",this.mainButtonCommand.label);}_1115.remove(this.mainButton.domNode,"epi-loading");if(this.mainButtonCommand.options&&!this.mainButtonCommand.options.keepMenuOpen){this.onExecute();}}),_112c=lang.hitch(this,function(){this.model.set("lastExecutedCommand",this.mainButtonCommand);});this.mainButtonCommand.execute().then(_112b,_112b).then(_112c);}},focusFirstChild:function(){if(this.mainButton.isFocusable()){return this.focusChild(this.mainButton);}else{return this.inherited(arguments);}},focusNext:function(){var _112d=this._getLastFocusableChild();if(!this.focusedChild.focused){return this.focusChild(this._getFirstFocusableChild());}else{if(this.focusedChild===_112d){this.focusedChild._setSelected(false);return _1113.get(this.mainButton.domNode,"display")==="none"?this.lastPublishedViewLinkNode.focus():this.focusChild(this.mainButton);}else{if(this.focusedChild===this.mainButton){return this.lastPublishedViewLinkNode.focus();}else{return this.inherited(arguments);}}}},focusPrev:function(){var _112e=this._getFirstFocusableChild();if(!this.focusedChild.focused){return _1113.get(this.mainButton.domNode,"display")==="none"?this.focusChild(this._getLastFocusableChild()):this.focusChild(this.mainButton);}else{if(this.focusedChild===_112e){this.focusedChild._setSelected(false);return this.lastPublishedViewLinkNode.focus();}else{return this.inherited(arguments);}}}});});},"epi/cms/widget/Breadcrumb":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/dom-class","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/aspect","dojo/query","dojo/NodeList-manipulate","dojo/topic","dijit/_Widget","dijit/_TemplatedMixin","dijit/layout/_LayoutWidget","epi/dependency","epi/shell/_HierarchicalModelMixin","epi/cms/core/ContentReference"],function(array,_112f,_1130,lang,_1131,_1132,_1133,_1134,_1135,query,_1136,topic,_1137,_1138,_1139,_113a,_113b,_113c,_113d){return _112f("epi.cms.widget.Breadcrumb",[_1139,_1138,_113b],{templateString:"<ul data-dojo-attach-point='containerNode'></ul>",contentLink:null,store:null,showCurrentNode:true,showLastBracket:false,displayAsText:true,minimumItemCount:null,baseClass:"epi-breadCrumbs",_resizeListener:null,_visibleItems:[],_currentContent:null,_ancestors:null,postMixInProperties:function(){var _113e=_113a.resolve("epi.storeregistry");this.store=this.store||_113e.get("epi.cms.content.light");this.minimumItemCount=this.minimumItemCount||2;},startup:function(){this._addResizeListener();},destroy:function(){if(this._resizeListener){this._resizeListener.remove();}this.destroyDescendants();this.inherited(arguments);},_addResizeListener:function(){if(this._resizeListener){return;}var _113f=this.getParent(),_1140=_113f;while(_1140&&!_1140.isLayoutContainer&&_1140.getParent()){_1140=_1140.getParent();}if(_1140&&_1140!==_113f){this._resizeListener=_1135.after(_1140,"resize",lang.hitch(this,function(){var _1141=_1133.getMarginBox(this.domNode);this.resize(_1141);}));}},resize:function(_1142){if(!_1142&&this._resizeListener){return;}else{this.layout();}},layout:function(){this._visibleItems=[];_1130.when(this._buildPath(),lang.hitch(this,function(){var _1143=_1133.getContentBox(this.domNode).w;if(_1143>this._availableWidth){var _1144=this._availableWidth-_1133.getMarginBox(this._leadingItem.domNode).w;this._ellipsisize(0,_1144);}}));},_setContentLinkAttr:function(value){this._set("contentLink",value);this._currentContent=null;this._ancestors=null;this.layout();},_buildPath:function(){var _1145=this.get("contentLink"),def=new _1130(),path="";if(this._currentContent&&this._ancestors){this._createAllItems();def.resolve(path);}else{if(_1145){var _1146=new _113c(_1145);var _1147=_1146.createVersionUnspecificReference().toString();_1130.when(this.store.get(_1147),lang.hitch(this,function(_1148){this.getAncestors(_1147,lang.hitch(this,function(_1149){this._currentContent=_1148;this._ancestors=_1149;this._createAllItems();def.resolve(path);}));}));}else{def.resolve(path);}}return def;},_createAllItems:function(){this._cleanUp();var _114a=[];for(var i=this._ancestors.length-1;i>=0;i--){var _114b=this._ancestors[i];if(!_114b.parentLink){continue;}_114a.push(_114b);if(_114b.isSubRoot){break;}}_114a.reverse();var _114c=_1133.getContentBox(this.domNode).w;this._availableWidth=_114c>=0?_114c:0;array.forEach(_114a,lang.hitch(this,function(_114d){this._createItem(_114d,true);}));if(this.showCurrentNode){this._createItem(this._currentContent,this.showLastBracket);}},_cleanUp:function(){this.destroyDescendants();this._leadingItem=null;this._visibleItems=[];},_createItem:function(_114e,_114f){var _1150=null,li=_1132.create("li");if(this.displayAsText){_1150=_1132.create("span");}else{_1150=_1132.create("a",{href:"#",id:_114e.contentLink});_1150.onclick=function(event){var _1151=event.target.id;var _1152={uri:_114e.uri};topic.publish("/epi/shell/context/request",_1152,{sender:this});};}query(_1150).text(_114e.name);_1132.place(_1150,li,"last");if(_114f){var _1153=_1132.create("span",{innerHTML:" &gt; ","class":"epi-breadCrumbsSeparator"});_1132.place(_1153,li,"last");}this._addAndLayout(li);},_addAndLayout:function(node){var toAdd=new _1137({},node);this._visibleItems.push(toAdd);this.addChild(toAdd);var _1154=this._getTotalVisibleItemsSize();if(_1154>this._availableWidth){this._ensureLeadingItem();while(_1154>this._availableWidth&&this._visibleItems.length>this.minimumItemCount){var _1155=this._visibleItems.splice(0,1)[0];_1134.set(_1155.domNode,"display","none");_1154=this._getTotalVisibleItemsSize();}}},_getTotalVisibleItemsSize:function(){var width=0;if(this._leadingItem){width+=_1133.getMarginBox(this._leadingItem.domNode).w;}array.forEach(this._visibleItems,function(item){width+=_1133.getMarginBox(item.domNode).w;});return width;},_ensureLeadingItem:function(){if(this._leadingItem){return;}var _1156=_1132.create("li"),_1157=_1132.create("span",{innerHTML:"..."}),_1158=_1132.create("span",{innerHTML:" &gt; ","class":"epi-breadCrumbsSeparator"});_1132.place(_1157,_1156,"last");_1132.place(_1158,_1156,"last");this._leadingItem=new _1137({},_1156);this.addChild(this._leadingItem,0);},_ellipsisize:function(_1159,_115a){if(_1159>=this._visibleItems.length){return;}var _115b=this._visibleItems.length-_1159,_115c=Math.floor(_115a/_115b),item=this._visibleItems[_1159],_115d=_1133.getMarginBox(item.domNode).w;if(_115d<=_115c){this._ellipsisize(_1159+1,_115a-_115d);}else{var _115e=query(this.displayAsText?"span":"a",item.domNode)[0],_115f=query("span.epi-breadCrumbsSeparator",item.domNode)[0],_1160=_115c-_1133.getMarginBox(_115f).w;if(_1160<0){_1160=0;}_1134.set(_115e,"width",_1160+"px");_1131.add(_115e,"dojoxEllipsis");this._ellipsisize(_1159+1,_115a-_115c);}}});});},"url:epi/cms/widget/templates/ContentSelector.html":"<div class=\"dijitReset dijitInputField dijitInputContainer dijitInline epi-resourceInputContainer\" id=\"widget_${id}\">\r\n    <div data-dojo-attach-point=\"displayNode, dropAreaNode, stateNode\" class=\"dijit dijitReset dijitInline dijitInlineTable dijitLeft dijitTextBox displayNode\">\r\n        <div class=\"dijitReset dijitLeft dijitInputField dijitInputContainer\">\r\n            <div data-dojo-attach-point=\"clearButton\" class=\"epi-clearButton\">&nbsp;</div>\r\n            <div data-dojo-attach-point=\"resourceName\" class=\"dijitInline epi-resourceName dojoxEllipsis\"/>\r\n                <span data-dojo-attach-point=\"selectedContentNameNode\"></span> <span data-dojo-attach-point=\"selectedContentLinkNode\"></span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div data-dojo-type=\"dijit.form.Button\" data-dojo-attach-event=\"onClick: _onButtonClick\" data-dojo-attach-point=\"button\" data-dojo-props=\"label:'...'\"></div>\r\n</div>","epi/cms/component/PageTree":function(){define("epi/cms/component/PageTree",["dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/_base/connect","dojo/dom-class","epi/dependency","epi/string","epi/shell/ClipboardManager","epi/shell/command/_WidgetCommandProviderMixin","epi/shell/widget/dialog/Alert","epi/shell/widget/dialog/Confirmation","epi/cms/_ContentContextMixin","epi/cms/contentediting/PageShortcutTypeSupport","epi/cms/widget/ContextMenu","epi/cms/command/NewContent","epi/cms/component/command/ShowAllLanguages","epi/cms/component/command/ViewTrash","epi/cms/component/_PageTreeNode","epi/cms/component/ContentFilter","epi/cms/component/SiteTreeModel","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/command/Editing","epi/cms/core/ContentReference","epi/cms/widget/ContentTree","./command/_GlobalToolbarCommandProvider","../command/CopyContent","../command/CutContent","../command/PasteContent","../command/DeleteContent","epi/shell/selection","epi/cms/component/ContentContextMenuCommandProvider","epi/i18n!epi/cms/nls/episerver.cms.components.createpage","epi/i18n!epi/cms/nls/episerver.cms.components.pagetree"],function(_1161,lang,_1162,_1163,_1164,_1165,_1166,_1167,_1168,Alert,_1169,_116a,_116b,_116c,_116d,_116e,_116f,_1170,_1171,_1172,_1173,_1174,_1175,_1176,_1177,_1178,_1179,_117a,_117b,_117c,_117d,_117e,res){return _1161("epi.cms.component.PageTree",[_1176,_116a,_1168],{res:res,contextTypeName:"epi.cms.contentdata",isMultiLingual:false,showAllLanguages:false,_separatorBeforeCssClass:"rowSeparatorBefore",_separatorAfterCssClass:"rowSeparatorAfter",_clipboardManager:null,_contextMenu:null,_contextMenuCommandProvider:null,_focusNode:null,betweenThreshold:5,accept:["epi.cms.page.lighturi"],typeIdentifiers:["epi.cms.page"],nodeConstructor:_1170,postMixInProperties:function(){this.inherited(arguments);this.application=_1165.resolve("epi.cms.Application");this.model.root=this.application.getRootPage();this.model.notAllowToDelete=[this.application.getRootPage(),this.application.getWastebasketPage(),this.application.getStartPage()];this.model.notAllowToCopy=[this.application.getRootPage(),this.application.getWastebasketPage()];this.checkAcceptance=lang.hitch(this,this.checkAcceptance);this.checkItemAcceptance=lang.hitch(this,this.checkItemAcceptance);this._clipboardManager=new _1167();this.selection=new _117c();this._startupCommands();this._contextMenuCommandProvider=new _117d({treeModel:this.model,clipboardManager:this._clipboardManager});},postCreate:function(){this.inherited(arguments);if(this.dndController){this.dndController.itemTreeNodeType="epi.cms.page.lighturi";}this.connect(this,"onClick","_onTreeNodeClicked");var _117f=lang.hitch(this,"_resetSelectionToLastSelected");this.subscribe("/epi/dnd/dropdata",_117f);this.subscribe("/dnd/cancel",_117f);},startup:function(){this.inherited(arguments);_1162.when(this.getCurrentContext(),lang.hitch(this,function(_1180){this.contextChanged(_1180);}));var _1181=_1165.resolve("epi.storeregistry");var _1182=_1181.get("epi.cms.sitestructure");var _1183=new _1172(_1182);_1162.when(_1183.getAllLanguagesForCurrentSite(),lang.hitch(this,function(items){this.set("isMultiLingual",items.length>=2);}));},_resetSelectionToLastSelected:function(){if(!this._lastSelectedContentId||!this.selectedItem){return;}if(this.selectedItem.contentLink!==this._lastSelectedContentId){this.selectContent(this._lastSelectedContentId);}},checkAcceptance:function(_1184,nodes){var _1185=true;_1184.forInSelectedItems(function(item){if(!_1185){return;}if(item.type.indexOf(this.dndController.itemTreeNodeType)==-1){_1185=false;}},this);return _1185;},checkItemAcceptance:function(_1186,_1187,_1188,copy){var _1189=true;var _118a=dijit.getEnclosingWidget(_1186),_118b=_118a&&_118a.item;if(!_118b){return false;}_1187.forInSelectedItems(function(item){if(!_1189){return;}var _118c=item.data,_118d=_118c.dndData,_118e=_118c.getParent(),_118f=_118e.item;_1189=this.model.canPasteItem(_118d,_118f,_118b,copy,_1188);},this);return _1189;},_onCopyOrCut:function(copy){this.inherited(arguments);if(copy){this._copyCommand.execute();}else{this._cutCommand.execute();}},_onPaste:function(){this.inherited(arguments);this._pasteCommand.execute();},_onDelete:function(){this.inherited(arguments);if(this._deleteCommand.canExecute){this._deleteCommand.execute();}else{this._showNotificationMessage(this.res.cannotdelete);}},_startupCommands:function(){this._createCommand=new _116d({order:10,contentType:_1171.PageType,iconClass:"epi-iconPlus",label:_117e.command.label,resources:_117e});this._showLanguagesCommand=new _116e({model:this});this._viewTrashCommand=new _116f({typeIdentifiers:this.typeIdentifiers});var _1190={category:"context",model:this.model,clipboard:this._clipboardManager,selection:this.selection};this._pasteCommand=new _117a(_1190);this._copyCommand=new _1178(_1190);this._cutCommand=new _1179(_1190);this._deleteCommand=new _117b(_1190);this.commands=[this._createCommand,_1174.translate,this._showLanguagesCommand,this._viewTrashCommand,this._copyCommand,this._cutCommand,this._pasteCommand,this._deleteCommand];},_setShowAllLanguagesAttr:function(value){this._set("showAllLanguages",value);this.model.set("showAllLanguages",value);},_onTreeNodeClicked:function(page,node,event){var self=this,_1191=this.currentContext?_1175.compareIgnoreVersion(page.contentLink,this.currentContext.id):true;function _1192(){var _1193={uri:page.uri};dojo.publish("/epi/shell/context/request",[_1193,{sender:self,forceContextChange:true,reSelect:!_1191}]);};if(!_1191){_1192();return;}if(this.selectContentThrottle){clearTimeout(this.selectContentThrottle);this.selectContentThrottle=null;}this.selectContentThrottle=setTimeout(_1192,300);},contentContextChanged:function(_1194,_1195){this.inherited(arguments);if(_1195&&_1195.sender===this&&!_1195.reSelect){return;}var _1196=new _1175(_1194.id);var _1197=_1196.createVersionUnspecificReference().toString();if(_1197===this.application.getWastebasketPage().toString()){return;}this._lastSelectedContentId=_1197;var _1198=_1195&&_1195.trigger!=="internal";this.selectContent(_1197,_1198);},selectContent:function(){_1162.when(this.inherited(arguments),lang.hitch(this,function(_1199){this._updateGlobalToolbarButtons();}));},_updateGlobalToolbarButtons:function(){var node=this.get("selectedNode"),_119a=node?[{type:"epi.cms.contentdata",data:node.item}]:[];this._createCommand.set("model",node&&node.item);this.selection.set("data",_119a);},contextChangeFailed:function(_119b,_119c,_119d){this.inherited(arguments);if(_119b){if(_119d&&_119d.sender===this){this.selectContent(_119b.contentLink);}}},_removeHighlightClass:function(){if(this._focusNode&&this._focusNode!=this.selectedNode&&this._focusNode.rowNode){_1164.remove(this._focusNode.rowNode,"dijitTreeRowSelected");}},_onContextMenuClose:function(){this._removeHighlightClass();},_onContextMenuOpen:function(){if(this._focusNode){_1164.add(this._focusNode.rowNode,"dijitTreeRowSelected");}},_set_focusNodeAttr:function(value){this._removeHighlightClass();this._focusNode=value;},_ellipsisContentText:function(_119e){var _119f="...";if(!_119e){return;}var _11a0=_119e.innerText?_119e.innerText:_119e.textContent;if(_11a0.length<=50){return;}_119e.textContent=_119e.innerText=_11a0.substring(0,47)+_119f;},_showContextMenu:function(evt){if(!this._contextMenu){this._contextMenu=new _116c({leftClickToOpen:true});this._contextMenu.addProvider(this._contextMenuCommandProvider);_1163.connect(this._contextMenu,"onClose",this,"_onContextMenuClose");_1163.connect(this._contextMenu,"onOpen",this,"_onContextMenuOpen");}this._contextMenuCommandProvider.updateCommandModel(evt.node.item);this._contextMenu.scheduleOpen(evt.target,null,{x:evt.x,y:evt.y});},_createTreeNode:function(){var _11a1=this.inherited(arguments);if(_11a1.item.contentLink==this.tree.model.rootPage){var _11a2=dojo.filter(_11a1.domNode.children,lang.hitch(this,function(_11a3){return _11a3.className==this._separatorAfterCssClass;}));}_11a1.on("onContextMenuClick",lang.hitch(this,function(node){this.set("_focusNode",node.node);this._showContextMenu(node);}));return _11a1;},getIconClass:function(item,_11a4){if(this.model.root==this.model.getIdentity(item)){return "epi-iconObjectRoot";}else{if(item.isWastebasket){return "epi-iconObjectTrash";}else{if(item.isStartPage){return "epi-iconObjectStart";}else{switch(item.properties.pageShortcutType){case _116b.pageShortcutTypes.Shortcut:return "epi-iconObjectInternalLink";case _116b.pageShortcutTypes.External:return "epi-iconObjectExternalLink";case _116b.pageShortcutTypes.Inactive:return "epi-iconObjectNoLink";case _116b.pageShortcutTypes.FetchData:return !item.hasTemplate?"epi-iconObjectContainerFetchContent":"epi-iconObjectFetchContent";default:return !item.hasTemplate?"epi-iconObjectContainer":"epi-iconObjectPage";}}}}},enableDrop:function(node,_11a5){node._droppable=_11a5;},_showNotificationMessage:function(_11a6){var _11a7=new Alert({destroyOnHide:true,description:_1166.toHTML(_11a6)});_11a7.show();}});});},"epi/cms/contentediting/NotificationBar":function(){require({cache:{"url:epi/cms/contentediting/templates/NotificationBar.html":"<div class=\"epi-notificationBar\">\r\n    <div data-dojo-attach-point=\"containerNode\"></div>\r\n</div>","url:epi/cms/contentediting/templates/NotificationBarItem.html":"<div class=\"epi-notificationBarItem\">\r\n    <div class=\"epi-notificationBarText\" data-dojo-attach-point=\"contentContainer\">\r\n        <p data-dojo-attach-point=\"textContainer\"></p>\r\n    </div>\r\n    <div class=\"epi-notificationBarButtonContainer\" data-dojo-attach-point=\"buttonContainer\">\r\n        <button data-dojo-type=\"dijit.form.Button\" class=\"epi-chromelessButton\" data-dojo-props=\"iconClass:'epi-iconClose', showLabel:false\" data-dojo-attach-event=\"onClick:_onClose\"></button>\r\n    </div>\r\n</div>"}});define("epi/cms/contentediting/NotificationBar",["dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/dom-style","dojo/dom-construct","dojo/_base/array","dijit/_TemplatedMixin","dijit/_Widget","dijit/_Container","dijit/_WidgetsInTemplateMixin","dojo/Evented","dijit/form/Button","dojox/html/ellipsis","dojo/text!./templates/NotificationBar.html","dojo/text!./templates/NotificationBarItem.html"],function(_11a8,lang,_11a9,_11aa,_11ab,array,_11ac,_11ad,_11ae,_11af,_11b0,_11b1,_11b2,_11b3,_11b4){var _11b5=_11a8("epi.cms.contentediting.NotificationBarItem",[_11ad,_11ac,_11af,_11b0],{templateString:_11b4,item:null,_handles:null,viewModel:null,postMixInProperties:function(){this._handles=[];this._buttons=[];},postCreate:function(){this.inherited(arguments);if(this.item.content){this._addContent(this.item);}this._addCommands(this.item);},destroy:function(){var _11b6;while(_11b6=this._buttons.pop()){_11b6.destroyRecursive();}this.inherited(arguments);},on:function(type,func){var _11b7=this.inherited(arguments);this._handles.push(_11b7);return _11b7;},uninitialize:function(){this.inherited(arguments);array.forEach(this._handles,function(_11b8){_11b8.remove();});},_onClose:function(e){e.preventDefault();this.emit("close",this);},_addContent:function(item){if(lang.isString(item.content)){this.textContainer.innerHTML=this.item.content;}else{_11ab.place(this.item.content,this.textContainer);}},_addCommands:function(item){if(lang.isArray(this.item.commands)){array.forEach(this.item.commands,lang.hitch(this,function(_11b9){this._addButtonForCommand(_11b9);}));}},_addButtonForCommand:function(_11ba){var _11bb=new _11b1({label:_11ba.label,title:_11ba.tooltip,iconClass:_11ba.iconClass,onClick:function(){_11ba.execute();}});if(_11ba.cssClass){_11a9.add(_11bb.domNode,_11ba.cssClass);}_11bb.set("disabled",!_11ba.canExecute);_11ba.watch("canExecute",lang.hitch(this,function(){_11bb.set("disabled",!_11ba.canExecute);}));if(_11ba.category==="leftAligned"){_11bb.placeAt(this.contentContainer,"first");}else{_11bb.placeAt(this.buttonContainer,"first");}this._buttons.push(_11bb);}});var _11bc=_11a8("epi.cms.contentediting.NotificationBar",[_11ad,_11ae,_11ac,_11af,_11b0],{templateString:_11b3,noBorderClass:"epi-notificationBarWithoutBorder",clear:function(){this._hideIfEmpty();array.forEach(this.getChildren(),function(_11bd){this.removeChild(_11bd);},this);this.emit("notificationsChanged");},destroy:function(){this.destroyDescendants();this.inherited(arguments);},add:function(_11be){var _11bf=new _11b5({item:_11be});_11bf.on("close",lang.hitch(this,"_onCloseNotification"));this.addChild(_11bf);this._hideIfEmpty();this.emit("notificationsChanged");},remove:function(_11c0){array.forEach(this.getChildren(),lang.hitch(this,function(_11c1){if(_11c1.item&&_11c1.item==_11c0){this._onCloseNotification(_11c1);}}));this._hideIfEmpty();},_onCloseNotification:function(item){this.removeChild(item);this._hideIfEmpty();this.emit("notificationsChanged");},_hideIfEmpty:function(){var show=this.getChildren().length>0;_11a9.toggle(this.domNode,this.noBorderClass,!show);_11aa.set(this.domNode,"display",show?"":"none");}});return _11bc;});},"epi/cms/component/command/DeleteVersion":function(){define("epi/cms/component/command/DeleteVersion",["dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","epi/cms/contentediting/ContentActionSupport","epi/dependency","epi/i18n!epi/cms/nls/episerver.cms.components.versions","epi/shell/command/_Command"],function(_11c2,lang,_11c3,_11c4,_11c5,_11c6,_11c7){return _11c2([_11c7],{label:_11c6.deletemenuitemtitle,iconClass:"epi-iconTrash",category:"context",constructor:function(){var _11c8=_11c5.resolve("epi.storeregistry");this._content=_11c8.get("epi.cms.contentdata");this._versions=_11c8.get("epi.cms.contentversion");},_execute:function(){return this._versions.remove(this.model.contentLink);},_onModelChange:function(){if(!this.model.allowToDelete){this.set("canExecute",false);return;}_11c3.when(this._content.get(this.model.contentLink),lang.hitch(this,function(_11c9){var _11ca=_11c4.action,_11cb=_11c9&&(_11c4.isActionAvailable(_11c9,_11ca.Edit)||_11c4.isActionAvailable(_11c9,_11ca.Delete));this.set("canExecute",_11cb);}));}});});},"epi/cms/dgrid/DnD":function(){define(["dojo/_base/declare","dojo/_base/lang","epi/dependency","dojo/dnd/Source","put-selector/put"],function(_11cc,lang,_11cd,_11ce,put){return _11cc([],{dndSourceTypes:null,dndParams:null,dndConstructor:_11ce,_typeDescriptor:null,postCreate:function(){this.inherited(arguments);this._setupDnD();var _11cf=_11cd.resolve("epi.cms.Application");this._typeDescriptor=_11cf.getTypeUIDescriptors();},insertRow:function(_11d0){var row=this.inherited(arguments);put(row,".dojoDndItem");this._setupDnD();this.dndSource.setItem(row.id,{data:_11d0,type:this._getDndType(_11d0)});return row;},_getDndType:function(_11d1){var _11d2;if(_11d1.typeIdentifier){var _11d3=this._typeDescriptor[_11d1.typeIdentifier];if(_11d3&&_11d3.dndTypes){_11d2=_11d3.dndTypes;}}if(!_11d2&&this.dndSourceType){_11d2=this.dndSourceType;}return _11d2;},_setupDnD:function(){if(this.dndSource){return;}this.dndSource=new (this.dndConstructor)(this.bodyNode,lang.mixin(this.dndParams,{grid:this,dropParent:this.contentNode}));this.dndSource.singular=true;}});});},"epi/cms/command/BackCommand":function(){define("epi/cms/command/BackCommand",["dojo/_base/declare","dojo/topic","epi/dependency","epi/shell/command/_Command","epi/i18n!epi/cms/nls/episerver.cms.command"],function(_11d4,topic,_11d5,_11d6,_11d7){return _11d4([_11d6],{label:_11d7.backtoprevious,tooltip:_11d7.backtoprevious,category:"leftAligned",iconClass:"epi-iconLeft",cssClass:"epi-chromelessButton epi-visibleLink",_previousContent:null,postscript:function(){this.inherited(arguments);this.contextHistory=this.contextHistory||_11d5.resolve("epi.cms.BackContextHistory");},_execute:function(){topic.publish("/epi/shell/context/request",{uri:this._previousContent.uri},{trigger:"back",sender:this});},_onModelChange:function(){this._previousContent=this.contextHistory.getPrevious();this.set("canExecute",this._previousContent!=null);}});});},"epi/cms/command/CopyContent":function(){define("epi/cms/command/CopyContent",["dojo/_base/declare","epi","epi/shell/command/_Command","epi/shell/command/_ClipboardCommandMixin","epi/shell/command/_SelectionCommandMixin"],function(_11d8,epi,_11d9,_11da,_11db){return _11d8([_11d9,_11da,_11db],{label:epi.resources.action.copy,iconClass:"epi-iconCopy",_execute:function(){this.clipboard.set("copy",true);this.clipboard.set("data",this.selection.data.concat());},_onModelChange:function(){var model=this.model,_11dc=false,_11dd=this.selection.data;if(model&&_11dd.length==1){var _11de=_11dd[0];_11dc=_11de.type=="epi.cms.contentdata"&&model.canCopy(_11de.data);}this.set("canExecute",_11dc);}});});},"url:epi/cms/contentediting/templates/SettingsPanel.html":"<div class=\"epi-documentHeader\">\r\n    <div data-dojo-type=\"epi.shell.widget.ContainerLayout\" data-dojo-attach-point=\"widgetContainer\"></div>\r\n    <div data-dojo-type=\"epi.cms.contentediting.ContentDetails\" data-dojo-attach-point=\"contentDetails\"></div>\r\n</div>","url:epi/cms/contentediting/templates/EditActionPanel.html":"<div style=\"display: inline-block\">\r\n    <div class=\"dijitInline dijitReset\" data-dojo-attach-point=\"stateNode\">\r\n        <span data-dojo-attach-point=\"statusNonEditableIcon\" class=\"dijitInline dijitReset dijitIcon\">&nbsp;</span>\r\n        <span class=\"epi-statusContainer dijitInline dijitReset\">\r\n            <span data-dojo-attach-point=\"statusTextIcon\" class=\"dijitInline dijitReset dijitIcon\"></span>\r\n            <span data-dojo-attach-point=\"statusTextNode\"></span>\r\n        </span><span class=\"epi-statusArrow dijitInline dijitReset\"></span><!-- These need to be on the same line because of stupid. -->\r\n    </div>\r\n\r\n\r\n\r\n    <div data-dojo-attach-point=\"dropDownButton\" data-dojo-type=\"dijit.form.DropDownButton\"\r\n        data-dojo-props=\"label: '${commonRes.action.publish}', 'class': 'epi-mediumButton epi-boldButton'\">\r\n        <div data-dojo-attach-point=\"dropDownMenu\" data-dojo-type=\"epi.cms.contentediting.PublishActionMenu\"></div>\r\n    </div>\r\n</div>","epi/cms/legacy/LegacyDialogPopup":function(){define("epi/cms/legacy/LegacyDialogPopup",["epi","dojo","dojo/i18n","dojo/_base/Deferred","dojo/DeferredList","epi/shell/widget/dialog/Dialog"],function(epi,dojo,i18n,_11df,_11e0,_11e1){return dojo.declare("epi.cms.legacy.LegacyDialogPopup",[_11e1],{url:null,dialogArguments:null,callbackArguments:null,features:null,autoFit:false,showLoadingOverlay:false,legacyDialogObject:null,defaultActionsVisible:false,contentClass:"epi-dialog-fullWidth",dialogClass:"",_legacyDialogContainer:null,_legacyDialogLoadDeferred:null,postCreate:function(){this.inherited(arguments);this._legacyDialogContainer=dojo.create("div");this.set("content",this._legacyDialogContainer);},onCallback:function(_11e2,_11e3){},onClose:function(){},onLoad:function(_11e4){},show:function(){var _11e5=new _11e0([this._loadLegacyDialog(),this.inherited(arguments)]);return _11e5.then(dojo.hitch(this,function(_11e6){var _11e7=_11e6[1];if(this.features&&this.features.left&&this.features.top){this.dialog._relativePosition={x:this.features.left,y:this.features.top};}return _11e7;}));},_loadLegacyDialog:function(){if(this._legacyDialogLoadDeferred){return this._legacyDialogLoadDeferred;}this._legacyDialogLoadDeferred=new _11df();require(["epi/cms/legacy/LegacyDialogWrapper"],dojo.hitch(this,function(_11e8){var _11e9=new _11e8({url:this.url,dialogArguments:this.dialogArguments,callbackArguments:this.callbackArguments,features:this.features,autoFit:this.autoFit,showLoadingOverlay:this.showLoadingOverlay},this._legacyDialogContainer);_11e9.startup();this.legacyDialogObject=_11e9.getLegacyDialog();this.connect(_11e9,"onCallback",dojo.hitch(this,function(_11ea,_11eb){this.onCallback(_11ea,_11eb);this.hide();}));this.connect(_11e9,"onLoad",dojo.hitch(this,function(){this.set("title",_11e9.title);this.onLoad(_11e9);}));this.connect(_11e9,"onCancel",dojo.hitch(this,function(){this.hide();}));this.connect(_11e9,"onResize",dojo.hitch(this,function(){this.layout();}));this.connect(this,"onHide",dojo.hitch(this,function(){_11e9.cleanup();this.onClose();}));this._legacyDialogLoadDeferred.resolve();}));return this._legacyDialogLoadDeferred;}});});},"epi/cms/conversion/PropertyContentAreaConverter":function(){define("epi/cms/conversion/PropertyContentAreaConverter",["dojo/_base/declare"],function(_11ec){return _11ec(null,{sourceDataType:"epi.cms.propertycontentarea",targetDataType:"runtimeType",registerConverter:function(_11ed){_11ed.registerConverter(this.sourceDataType,this.targetDataType,this);},convert:function(_11ee,_11ef,data){if(_11ee===this.sourceDataType&&_11ef===this.targetDataType){return data?data._unparsedString:data;}return null;}});});},"epi/cms/contentediting/command/SendForReview":function(){define("epi/cms/contentediting/command/SendForReview",["dojo/_base/declare","dojo/topic","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/command/_ChangeContentStatus","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons"],function(_11f0,topic,_11f1,_11f2,_11f3){return _11f0("epi.cms.contentediting.command.SendForReview",[_11f2],{name:"sendforreview",label:_11f3.sendforreview.label,executingLabel:_11f3.sendforreview.executinglabel,tooltip:_11f3.sendforreview.title,iconClass:"epi-iconCheckmark",action:_11f1.action.CheckIn,_execute:function(){topic.publish("/epi/cms/action/disableundoredoactions");return this.inherited(arguments);},_onModelChange:function(){this.inherited(arguments);var _11f4=this.model.contentData,_11f5=((_11f4.status===_11f1.versionStatus.CheckedOut)||(_11f4.status===_11f1.versionStatus.Rejected)||(_11f4.status===_11f1.versionStatus.Published&&_11f4.isCommonDraft))&&this.model.canChangeContent(this.action),_11f6=_11f5&&(_11f4.status!==_11f1.versionStatus.Published);this.set("canExecute",_11f6);this.set("isAvailable",_11f5);}});});},"epi/cms/contentediting/viewmodel/ShortcutDialogViewModel":function(){define("epi/cms/contentediting/viewmodel/ShortcutDialogViewModel",["dojo/_base/declare","dojo/Stateful","dojo/string","epi/cms/contentediting/PageShortcutTypeSupport","epi/epi","epi/shell/_StatefulGetterSetterMixin"],function(_11f7,_11f8,_11f9,_11fa,epi,_11fb){return _11f7([_11f8,_11fb],{value:null,intermediateValue:null,savedValue:null,contentLink:null,contentName:null,enableSaveButton:null,enableShortcutLink:null,enableExternalLink:null,postscript:function(){this.inherited(arguments);this.set("savedValue",this.value);},_setIntermediateValueAttr:function(value){this._set("intermediateValue",value);this.set("enableSaveButton",!epi.areEqual(this.intermediateValue,this.savedValue));this.set("enableShortcutLink",value&&(value.pageShortcutType==_11fa.pageShortcutTypes.Shortcut||value.pageShortcutType==_11fa.pageShortcutTypes.FetchData)?true:false);this.set("enableExternalLink",value&&value.pageShortcutType==_11fa.pageShortcutTypes.External?true:false);this.set("clearExternalLink",value&&value.pageShortcutType==_11fa.pageShortcutTypes.External&&this.savedValue.pageShortcutType!=_11fa.pageShortcutTypes.External?true:false);},_setSavedValueAttr:function(value){this._set("savedValue",value);this.set("enableSaveButton",false);},save:function(){this.set("savedValue",this.intermediateValue);}});});},"url:epi/cms/contentediting/templates/ContentDetails.html":"<div class=\"epi-containerLayout\">\r\n    <ul>\r\n        <li class=\"epi-formsRow\">\r\n            <label>${resources.visibleto.title}</label>\r\n            <div class=\"epi-formsWidgetWrapper\">\r\n                <span data-dojo-attach-point=\"visibleToNode\" class=\"dijitInline\"></span>\r\n                <div data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"manageAccessRightsButton\" data-dojo-attach-event=\"onClick: _onManageAccessRightsClick\" class=\"epi-chromelessButton epi-chromelessLinkButton epi-functionLink\">${resources.manage}</div>\r\n            </div>\r\n        </li>\r\n        <li class=\"epi-formsRow\">\r\n            <label>${resources.existinglanguages}</label>\r\n            <div class=\"epi-formsWidgetWrapper\">\r\n                <span data-dojo-attach-point=\"languagesNode\" class=\"dijitInline\"></span>\r\n            </div>\r\n        </li>\r\n        <li class=\"epi-formsRow\">\r\n            <label>${resources.idandtypename}</label> \r\n            <div class=\"epi-formsWidgetWrapper\">\r\n                <span data-dojo-attach-point=\"idNode\" class=\"dijitInline\"></span>, <span data-dojo-attach-point=\"typeNode\" class=\"dijitInline\"></span>\r\n            </div>\r\n        </li>\r\n        <li class=\"epi-formsRow\">\r\n            <label></label>\r\n            <div class=\"epi-formsWidgetWrapper\">\r\n                <div data-dojo-type=\"dijit.form.DropDownButton\" class=\"dijit dijitReset dijitInline epi-mediumButton\" data-dojo-props=\"tooltip: '${resources.toolsbutton.tooltip}'\">\r\n                    <span>${resources.toolsbutton.label}</span>\r\n                    <div data-dojo-type=\"dijit.DropDownMenu\" data-dojo-attach-point=\"additionalActionsMenu\"></div>\r\n                </div>\r\n            </div>\r\n        </li>\r\n    </ul>\r\n</div>","epi/cms/widget/ContentTreeModelConfirmation":function(){define("epi/cms/widget/ContentTreeModelConfirmation",["dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/aspect","dojo/string","epi/string","epi/shell/widget/dialog/Alert","epi/shell/widget/dialog/Confirmation","epi/cms/widget/sharedContentDialogHandler","epi/cms/contentediting/ContentActionSupport","epi/i18n!epi/cms/nls/episerver.cms.components.pagetree","epi/i18n!epi/cms/nls/episerver.cms.components.sharedblockscomponent.folder","epi/i18n!epi/cms/nls/episerver.cms.components.sharedblockscomponent.block"],function(_11fc,lang,_11fd,_11fe,_11ff,_1200,Alert,_1201,_1202,_1203,_1204,_1205,_1206){return function(model){var res=null;var _1207=function(_1208){var _1209=new Alert({destroyOnHide:true,description:_1200.toHTML(_1208)});_1209.show();};var _120a=function(title,_120b){var _120c=new _11fd();var _120d=new _1201({destroyOnHide:true,description:_1200.toHTML(_120b),title:title,onAction:function(_120e){_120e?_120c.resolve():_120c.cancel();}});_120d.show();return _120c;};var _120f=function(_1210){var _1211=[_1206,_1205,_1204];var _1212=["isBlock","isFolder","isPage"];res=_1204;if(_1210&&_1210.capabilities){for(var i=0;i<_1212.length;i++){if(_1210.capabilities[_1212[i]]){res=_1211[i];return;}}}};_11fe.around(model,"pasteItem",function(_1213){return function(_1214,_1215,_1216,copy,_1217){_120f(_1214);var _1218=true;if(_1216.isWastebasket){_1218=_1202({contentData:_1214});}else{if(_1217!==undefined&&(_1216.properties.pageChildOrderRule!==_1203.sortOrder.Index)){var _1219=_11ff.substitute(res.changepeerorderconfirmation,[model.getLabel(_1216)]);_1218=_120a(res.move.title,_1219);}else{if(!copy){_1218=_120a(res.move.title,res.moveconfirmation);}}}var _121a=arguments;return _11fd.when(_1218,function(){return _1213.apply(model,_121a);},function(){return false;});};});_11fe.after(model,"pasteItem",function(_121b){_121b.then(function(_121c){if(_121c&&_121c.message){_1207(_121c.message);}},function(){console.error("An unknown error occured when pasting an item: ",arguments);});return _121b;});return model;};});},"dijit/tree/dndSource":function(){define("dijit/tree/dndSource",["dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/dom-class","dojo/dom-geometry","dojo/_base/lang","dojo/on","dojo/touch","dojo/topic","dojo/dnd/Manager","./_dndSelector"],function(array,_121d,_121e,_121f,_1220,lang,on,touch,topic,_1221,_1222){return _121e("dijit.tree.dndSource",_1222,{isSource:true,accept:["text","treeNode"],copyOnly:false,dragThreshold:5,betweenThreshold:0,constructor:function(tree,_1223){if(!_1223){_1223={};}lang.mixin(this,_1223);this.isSource=typeof _1223.isSource=="undefined"?true:_1223.isSource;var type=_1223.accept instanceof Array?_1223.accept:["text","treeNode"];this.accept=null;if(type.length){this.accept={};for(var i=0;i<type.length;++i){this.accept[type[i]]=1;}}this.isDragging=false;this.mouseDown=false;this.targetAnchor=null;this.targetBox=null;this.dropPosition="";this._lastX=0;this._lastY=0;this.sourceState="";if(this.isSource){_121f.add(this.node,"dojoDndSource");}this.targetState="";if(this.accept){_121f.add(this.node,"dojoDndTarget");}this.topics=[topic.subscribe("/dnd/source/over",lang.hitch(this,"onDndSourceOver")),topic.subscribe("/dnd/start",lang.hitch(this,"onDndStart")),topic.subscribe("/dnd/drop",lang.hitch(this,"onDndDrop")),topic.subscribe("/dnd/cancel",lang.hitch(this,"onDndCancel"))];},checkAcceptance:function(){return true;},copyState:function(_1224){return this.copyOnly||_1224;},destroy:function(){this.inherited(arguments);var h;while(h=this.topics.pop()){h.remove();}this.targetAnchor=null;},_onDragMouse:function(e){var m=_1221.manager(),_1225=this.targetAnchor,_1226=this.current,_1227=this.dropPosition;var _1228="Over";if(_1226&&this.betweenThreshold>0){if(!this.targetBox||_1225!=_1226){this.targetBox=_1220.position(_1226.rowNode,true);}if((e.pageY-this.targetBox.y)<=this.betweenThreshold){_1228="Before";}else{if((e.pageY-this.targetBox.y)>=(this.targetBox.h-this.betweenThreshold)){_1228="After";}}}if(_1226!=_1225||_1228!=_1227){if(_1225){this._removeItemClass(_1225.rowNode,_1227);}if(_1226){this._addItemClass(_1226.rowNode,_1228);}if(!_1226){m.canDrop(false);}else{if(_1226==this.tree.rootNode&&_1228!="Over"){m.canDrop(false);}else{var model=this.tree.model,_1229=false;if(m.source==this){for(var _122a in this.selection){var _122b=this.selection[_122a];if(_122b.item===_1226.item){_1229=true;break;}}}if(_1229){m.canDrop(false);}else{if(this.checkItemAcceptance(_1226.rowNode,m.source,_1228.toLowerCase())&&!this._isParentChildDrop(m.source,_1226.rowNode)){m.canDrop(true);}else{m.canDrop(false);}}}}this.targetAnchor=_1226;this.dropPosition=_1228;}},onMouseMove:function(e){if(this.isDragging&&this.targetState=="Disabled"){return;}this.inherited(arguments);var m=_1221.manager();if(this.isDragging){this._onDragMouse(e);}else{if(this.mouseDown&&this.isSource&&(Math.abs(e.pageX-this._lastX)>=this.dragThreshold||Math.abs(e.pageY-this._lastY)>=this.dragThreshold)){var nodes=this.getSelectedTreeNodes();if(nodes.length){if(nodes.length>1){var seen=this.selection,i=0,r=[],n,p;nextitem:while((n=nodes[i++])){for(p=n.getParent();p&&p!==this.tree;p=p.getParent()){if(seen[p.id]){continue nextitem;}}r.push(n);}nodes=r;}nodes=array.map(nodes,function(n){return n.domNode;});m.startDrag(this,nodes,this.copyState(_121d.isCopyKey(e)));}}}},onMouseDown:function(e){this.mouseDown=true;this.mouseButton=e.button;this._lastX=e.pageX;this._lastY=e.pageY;this.inherited(arguments);},onMouseUp:function(e){if(this.mouseDown){this.mouseDown=false;this.inherited(arguments);}},onMouseOut:function(){this.inherited(arguments);this._unmarkTargetAnchor();},checkItemAcceptance:function(){return true;},onDndSourceOver:function(_122c){if(this!=_122c){this.mouseDown=false;this._unmarkTargetAnchor();}else{if(this.isDragging){var m=_1221.manager();m.canDrop(false);}}},onDndStart:function(_122d,nodes,copy){if(this.isSource){this._changeState("Source",this==_122d?(copy?"Copied":"Moved"):"");}var _122e=this.checkAcceptance(_122d,nodes);this._changeState("Target",_122e?"":"Disabled");if(this==_122d){_1221.manager().overSource(this);}this.isDragging=true;},itemCreator:function(nodes){return array.map(nodes,function(node){return {"id":node.id,"name":node.textContent||node.innerText||""};});},onDndDrop:function(_122f,nodes,copy){if(this.containerState=="Over"){var tree=this.tree,model=tree.model,_1230=this.targetAnchor;this.isDragging=false;var _1231;var _1232;_1231=(_1230&&_1230.item)||tree.item;if(this.dropPosition=="Before"||this.dropPosition=="After"){_1231=(_1230.getParent()&&_1230.getParent().item)||tree.item;_1232=_1230.getIndexInParent();if(this.dropPosition=="After"){_1232=_1230.getIndexInParent()+1;}}else{_1231=(_1230&&_1230.item)||tree.item;}var _1233;array.forEach(nodes,function(node,idx){var _1234=_122f.getItem(node.id);if(array.indexOf(_1234.type,"treeNode")!=-1){var _1235=_1234.data,_1236=_1235.item,_1237=_1235.getParent().item;}if(_122f==this){if(typeof _1232=="number"){if(_1231==_1237&&_1235.getIndexInParent()<_1232){_1232-=1;}}model.pasteItem(_1236,_1237,_1231,copy,_1232);}else{if(model.isItem(_1236)){model.pasteItem(_1236,_1237,_1231,copy,_1232);}else{if(!_1233){_1233=this.itemCreator(nodes,_1230.rowNode,_122f);}model.newItem(_1233[idx],_1231,_1232);}}},this);this.tree._expandNode(_1230);}this.onDndCancel();},onDndCancel:function(){this._unmarkTargetAnchor();this.isDragging=false;this.mouseDown=false;delete this.mouseButton;this._changeState("Source","");this._changeState("Target","");},onOverEvent:function(){this.inherited(arguments);_1221.manager().overSource(this);},onOutEvent:function(){this._unmarkTargetAnchor();var m=_1221.manager();if(this.isDragging){m.canDrop(false);}m.outSource(this);this.inherited(arguments);},_isParentChildDrop:function(_1238,_1239){if(!_1238.tree||_1238.tree!=this.tree){return false;}var root=_1238.tree.domNode;var ids=_1238.selection;var node=_1239.parentNode;while(node!=root&&!ids[node.id]){node=node.parentNode;}return node.id&&ids[node.id];},_unmarkTargetAnchor:function(){if(!this.targetAnchor){return;}this._removeItemClass(this.targetAnchor.rowNode,this.dropPosition);this.targetAnchor=null;this.targetBox=null;this.dropPosition=null;},_markDndStatus:function(copy){this._changeState("Source",copy?"Copied":"Moved");}});});},"url:epi/cms/widget/templates/MultipleFileUpload.html":"<div class=\"epi-multiFileUpload\">\r\n    <form method=\"post\" action=\"\" enctype=\"multipart/form-data\">\r\n        <div data-dojo-attach-point=\"breadcrumbBar\" data-dojo-type=\"epi.cms.widget.Breadcrumb\"></div>\r\n        <div data-dojo-attach-point=\"uploadToolbar\" class=\"epi-toolbar-unwrapped\">\r\n            <span title=\"${res.uploadform.addfiles}\" >\r\n                <input type=\"file\" multiple=\"true\" uploadOnSelect=\"true\" data-dojo-type=\"dojox.form.Uploader\" data-dojo-attach-point=\"uploaderInput\" \r\n                    data-dojo-props=\"iconClass:'epi-iconPlus', showLabel: false\" />\r\n            </span>\r\n            <div data-dojo-attach-point=\"toolbarDisableLayer\"></div>\r\n        </div>\r\n        <div data-dojo-attach-point=\"fileList\" data-dojo-type=\"epi.cms.widget.FileList\"></div>\r\n    </form>\r\n</div>","epi/cms/contentediting/ContainerLayoutTab":function(){require({cache:{"url:epi/cms/contentediting/templates/ContainerLayoutTab.html":"<div class=\"epi-containerLayoutTab\">\r\n    <div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-attach-point=\"topContainer\"></div>\r\n    <div data-dojo-type=\"dijit.layout.TabContainer\" data-dojo-attach-point=\"tabContainer\" data-dojo-props=\"doLayout: false, useMenu: true, useSlider: false, tabStrip: false\"></div>\r\n</div>"}});define("epi/cms/contentediting/ContainerLayoutTab",["epi","dojo","dijit","dojo/dom-geometry","epi/shell/widget/ContainerLayoutTab","dijit/layout/BorderContainer","dijit/layout/ContentPane","dijit/layout/TabContainer","dijit/_WidgetsInTemplateMixin","dojo/text!./templates/ContainerLayoutTab.html"],function(epi,dojo,dijit,_123a,_123b,_123c,_123d,_123e,_123f,_1240){return dojo.declare("epi.cms.contentediting.ContainerLayoutTab",[_123b,_123f],{templateString:_1240,postCreate:function(){this.inherited(arguments);this.connect(this.tabContainer,"selectChild",function(){this.resize();});},addChild:function(_1241,index){if(_1241.region==="top"){this.topContainer.set("content",_1241);}else{this.inherited(arguments);}},resize:function(size){if(size){_123a.setMarginBox(this.domNode,size);}this.tabContainer.resize();},selectChild:function(child){if(child.containerPane){this.tabContainer.selectChild(child.containerPane);}}});});},"epi/cms/contentediting/command/EditCommonDraft":function(){define("epi/cms/contentediting/command/EditCommonDraft",["dojo/_base/declare","epi/cms/contentediting/command/_ContentCommandBase","epi/cms/contentediting/ContentActionSupport","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons"],function(_1242,_1243,_1244,_1245){return _1242("epi.cms.contentediting.command.EditCommonDraft",[_1243],{name:"editcommondraft",label:_1245.editcommondraft.label,tooltip:_1245.editcommondraft.title,iconClass:"epi-iconPen",contentActionSupport:null,postscript:function(){this.inherited(arguments);this.contentActionSupport=this.contentActionSupport||_1244;},_execute:function(){this.model.editCommonDraft();},_onModelChange:function(){this.inherited(arguments);var _1246=this.model.contentData,_1247=_1246.status,_1248=_1244.versionStatus,_1249=this.contentActionSupport.hasAccess(_1246.accessMask,_1244.accessLevel.Edit),_124a=(_1247==_1248.Published||_1247==_1248.PreviouslyPublished)&&!_1246.isCommonDraft&&_1249&&this.contentActionSupport.hasProviderCapability(_1246.providerCapabilityMask,_1244.providerCapabilities.Edit);this.set("canExecute",_124a);this.set("isAvailable",_124a);}});});},"epi/cms/command/DeleteContent":function(){define("epi/cms/command/DeleteContent",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","epi","epi/dependency","epi/cms/contentediting/ContentActionSupport","epi/shell/command/_Command","epi/shell/command/_SelectionCommandMixin","epi/i18n!epi/cms/nls/episerver.cms.command"],function(_124b,_124c,lang,epi,_124d,_124e,_124f,_1250,res){return _124b([_124f,_1250],{label:res.movetotrash,iconClass:"epi-iconTrash",wasteBasketId:null,postscript:function(){this.inherited(arguments);this.wasteBasketId=this.wasteBasketId||_124d.resolve("epi.cms.Application").getWastebasketPage();},_execute:function(){var item=this.selection.data[0].data,_1251=this.clipboard&&this.clipboard.data,_1252=_1251&&_1251.length==1&&_1251[0],_1253=(_1252!=null&&_1252.data!=null)?this.model.isAncestor(item,_1252.data):false;if(this.model&&item){_124c.when(this.model.move?this.model.move(item,{contentLink:this.wasteBasketId,isWastebasket:true}):this.model.remove(item),lang.hitch(this,function(_1254){if(_1254&&_1254.isSuccess===true){_124c.when(_1253,lang.hitch(this,function(_1255){if(_1255===true){this.clipboard.clear();}}));if(this.model.onDeleted){this.model.onDeleted(item);}}}));}},_onModelChange:function(){var model=this.model,_1256=this.selection.data,_1257=false;if(model&&_1256.length==1){var _1258=_1256[0];_1257=_1258.type=="epi.cms.contentdata"&&this._validateDelete(_1258.data);}this.set("canExecute",_1257);},_validateDelete:function(_1259){return !_1259.isDeleted&&this.model.canDelete(_1259);}});});},"epi/cms/contentediting/viewmodel/ContentDetailsViewModel":function(){define("epi/cms/contentediting/viewmodel/ContentDetailsViewModel",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","epi","epi/datetime","epi/dependency","epi/username","epi/cms/contentediting/command/AccessRights","epi/cms/contentediting/command/LanguageSettings","epi/cms/contentediting/command/DynamicProperties","epi/shell/command/_CommandConsumerMixin","epi/shell/command/_GlobalCommandProviderMixin","epi/cms/contentediting/ContentActionSupport","epi/cms/core/ContentReference","epi/cms/contentediting/viewmodel/_ContentViewModelObserver"],function(array,_125a,lang,epi,_125b,_125c,_125d,_125e,_125f,_1260,_1261,_1262,_1263,_1264,_1265){return _125a([_1265,_1261,_1262],{commandKey:"epi.cms.contentdetailsmenu",res:null,contentTypeName:null,contentId:null,visibleToEveryOne:null,existingLanguages:null,accessRightsCommand:null,languageSettingsCommand:null,dynamicPropertiesCommand:null,expirationCommand:null,constructor:function(_1266){_125a.safeMixin(this,_1266);},postscript:function(){this.initializeCommandProviders();this.accessRightsCommand=new _125e();this.languageSettingsCommand=new _125f();this.dynamicPropertiesCommand=new _1260();if(!this.expirationCommand){var _1267=_125c.resolve("epi.cms.contentEditing.command.Editing");this.expirationCommand=_1267.manageExpiration;}if(!this.store){var _1268=_125c.resolve("epi.storeregistry");this.store=_1268.get("epi.cms.contenttype");}this.inherited(arguments);},uninitialize:function(){},_setDataModelAttr:function(value){this.updateCommandModel(value);this.accessRightsCommand.set("model",value);this.languageSettingsCommand.set("model",value);this.dynamicPropertiesCommand.set("model",value);this.inherited(arguments);},onDataModelChange:function(name,_1269,value){var _126a=this.dataModel.contentData,_126b=new _1264(_126a.contentLink);this.set("contentId",_126b.id);this.set("existingLanguages",array.map(_126a.existingLanguageBranches,function(item){return {text:item.languageId,isCurrentLanguage:item.languageId===_126a.currentLanguageBranch.languageId,contentLink:item.commonDraftLink};}));this.set("visibleToEveryOne",_126a.visibleToEveryOne);dojo.when(this.store.get(_126a.contentTypeID),dojo.hitch(this,function(type){this.set("contentTypeName",type.localizedName);}));this.set("commands",this.getCommands());},getCommands:function(){var _126c=this.inherited(arguments);return [this.dynamicPropertiesCommand,this.languageSettingsCommand,this.expirationCommand].concat(_126c);}});});},"epi/shell/widget/RadioMenuItem":function(){define("epi/shell/widget/RadioMenuItem",["epi","dojo","dijit","dijit/CheckedMenuItem","dojo/text!./templates/RadioMenuItem.htm"],function(epi,dojo,dijit,_126d,_126e){return dojo.declare("epi.shell.widget.RadioMenuItem",[_126d],{baseClass:"epi-radioMenuItem",templateString:_126e,_onClick:function(e){this._resetState();this.inherited(arguments);},_resetState:function(){dojo.forEach(this._getChildren(),function(child,index){child.set("checked",false);});},_getChildren:function(){return this.getParent().getChildren();}});});},"epi/cms/widget/_HasClearButton":function(){define("epi/cms/widget/_HasClearButton",["epi","dojo","dijit"],function(epi,dojo,dijit){return dojo.declare("epi.cms.widget._HasClearButton",null,{postCreate:function(){this.inherited(arguments);var _126f=this.clearButton.onClick?"onClick":"onclick";dojo.connect(this.clearButton,_126f,dojo.hitch(this,this.clearValue));},clearValue:function(){if(this.readOnly){return;}var value=this.getEmptyValue();this.set("value",value);},getEmptyValue:function(){return null;}});});},"url:epi/cms/widget/templates/_CategoryTreeNode.html":"<div class=\"dijitTreeNode epi-categoryTreeNode\" role=\"presentation\">\r\n    <a href=\"#\" tabIndex=\"-1\" data-dojo-attach-point=\"rowNode\" class=\"dijitTreeRow\" role=\"presentation\" data-dojo-attach-event=\"onmouseenter:_onMouseEnter, onmouseleave:_onMouseLeave, onclick:_onClick, ondblclick:_onDblClick\">\r\n        <span data-dojo-attach-point=\"contentNode\" class=\"dijitTreeContent\" role=\"presentation\">\r\n            <span data-dojo-attach-point=\"expandoNode\" class=\"dijitTreeExpando\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"expandoNodeText\" class=\"dijitExpandoText\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"iconNode\" class=\"dijitIcon dijitTreeIcon\" role=\"presentation\"></span>\r\n            <span data-dojo-attach-point=\"labelNode\" class=\"dijitTreeLabel epi-categoryTreeLabel\" role=\"treeitem\"\r\n                tabindex=\"-1\" aria-selected=\"false\" data-dojo-attach-event=\"onfocus:_onLabelFocus, onclick:_onLabelClick, keyup:_onLabelKeyUp\">\r\n            </span>\r\n        </span>\r\n    </a>\r\n    <div data-dojo-attach-point=\"containerNode\" class=\"dijitTreeContainer\" role=\"presentation\" style=\"display: none;\"></div>\r\n    <a href=\"#\" tabIndex=\"-1\" style=\"display: block;\" data-dojo-attach-point=\"rowSeparator\" class=\"rowSeparatorAfter\" role=\"presentation\"></a>\r\n</div>","epi/cms/widget/FolderTree":function(){define("epi/cms/widget/FolderTree",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/json","dijit/tree/_dndSelector","epi/cms/widget/_FolderTreeNode","epi/cms/widget/FolderTreeStoreModel","epi/cms/widget/ContentTree"],function(array,_1270,lang,_1271,json,_1272,_1273,_1274,_1275){return _1270("epi.cms.widget.FolderTree",[_1275],{editorWidth:"200px",clipboardManager:null,dndController:_1272,postMixInProperties:function(){this.inherited(arguments);if(!this.model){this.model=new _1274({store:this.store});this.persist=false;}},postCreate:function(){this.inherited(arguments);this.connect(this.model,"select",this._selectFolderByItem);this.connect(this.model,"onChildrenChange",lang.hitch(this,this._onResize));this.connect(this.model,"onDeleted",lang.hitch(this,this._onDeleted));},checkAcceptance:function(_1276){return _1276===this;},_updateItemDeletedHirachy:function(node){if(!node){return;}array.forEach(node.getChildren(),function(_1277){_1277.set({item:lang.mixin(_1277.item,{isDeleted:true})});this._updateItemDeletedHirachy(_1277);},this);},_onDeleted:function(item){var nodes=this.getNodesByItem(item);array.forEach(nodes,function(node){this._updateItemDeletedHirachy(node);},this);},_selectFolderByItem:function(item){var _1278=this.getNodesByItem(item)[0];this.selectFolder(_1278);},selectFolder:function(_1279){if(!_1279||(_1279&&_1279.item&&_1279.item.isDeleted)){return;}this.selectContent(_1279.item.contentLink,false);this.onFolderSelected(_1279);},_renameFolder:function(item,name){var _127a=new _1271();var _127b=lang.trim(name);if(!_127b){var _127c=this.tree.getNodesByItem(item)[0];_127c.rollbackLabel(item.name);_127a.resolve();return _127a;}_1271.when(this.model.rename(item.contentLink,{icontent_name:json.stringify(_127b)}),lang.hitch(this,function(_127d){_127a.callback(_127d);var _127e=this.getNodesByItem(item)[0];var _127f=_127e.getParent();item.name=_127b;this._updateChildren(_127f.item);}),lang.hitch(this,function(_1280){var _1281=this.tree.getNodesByItem(item)[0];_1281.rollbackLabel(item.name);_127a.cancel();}));return _127a;},_updateChildren:function(node){var _1282=new _1271();var _1283=!node?this.get("selectedNode").item:node;this.model.getChildren(_1283,lang.hitch(this,function(_1284){_1271.when(this.model.onChildrenChange(_1283,_1284),function(){_1282.callback();});}));return _1282;},_updateUI:function(child,_1285,_1286,_1287){var _1288=new _1271();if(_1287){_1271.when(this._updateChildren(_1285),function(){_1288.callback();});}else{_1271.when(this._updateChildren(_1286),lang.hitch(this,function(){_1271.when(this._updateChildren(_1285),function(){_1288.callback();});}));}return _1288;},blockContextChanged:function(ctx,_1289){},buildNodeFromTemplate:function(args){var _128a=new _1273(args);_128a.bindContextMenu(this.contextMenu);this.connect(_128a,"onRename",lang.hitch(this,function(val){this._renameFolder(_128a.item,val);}));this.connect(_128a,"onTreeNodeSelected",lang.hitch(this,function(_128b){this.onFolderSelected(_128b);}));this.connect(_128a,"onResize",lang.hitch(this,this._onResize));return _128a;},onFolderSelected:function(_128c){},_onKeyPress:function(e){var _128d=e.target&&dijit.getEnclosingWidget(e.target);if(!_128d){return;}e.target=_128d.domNode.parentNode;this.inherited(arguments);},_onResize:function(){this.onResize();},onResize:function(){}});});},"epi/shell/command/withConfirmation":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","epi/shell/widget/dialog/Confirmation"],function(_128e,lang,_128f,_1290){function _1291(_1292){var _1293=new _128f(),_1294=new _1290(_1292);_1294.connect(_1294,"onAction",function(_1295){if(_1295){_1293.resolve();}else{_1293.cancel();}});_1294.show();return _1293;};return function(_1296,_1297,_1298){var _1299=_1296._execute;_1296._execute=function(){function _129a(){_128f.when(_1299.apply(_1296,arguments),_129b.resolve,_129b.cancel);};var _129b=new _128f();_1297=_1297||_1291;_128f.when(_1297(_1298),_129a,_129b.cancel);return _129b;};return _1296;};});},"epi/cms/contentediting/ContentModelServerSync":function(){define("epi/cms/contentediting/ContentModelServerSync",["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/json","dojo/_base/lang","dojo/Stateful","epi/datetime","epi/string"],function(array,_129c,_129d,json,lang,_129e,_129f,_12a0){return _129c("epi.cms.contentediting.ContentModelServerSync",[_129e],{_queue:null,_isSynchronizing:false,hasPendingChanges:false,contentLink:null,contentDataStore:null,processInterval:200,_processIntervalId:0,_saveDeferred:null,_publish:false,constructor:function(_12a1){lang.mixin(this,_12a1);this._queue=[];},scheduleForSync:function(_12a2,value){if(value===undefined){return;}this.set("hasPendingChanges",true);value=_129f.transformDate(value);var index=this._propertyIndexInQueue(_12a2);if(index<0){this._queue.push({name:_12a2,value:value});}else{this._queue[index].value=value;}},publishProperty:function(_12a3,value){this._publish=true;this.scheduleForSync(_12a3,value);return this._synchronizeItem(true);},_propertyIndexInQueue:function(_12a4){var index=-1;array.some(this._queue,function(item,i){if(item.name===_12a4){index=i;return true;}});return index;},save:function(){return this._startSynchronizeInterval();},_startSynchronizeInterval:function(){if(this._processIntervalId>0){return this._saveDeferred;}var fn=lang.hitch(this,function(){return this._synchronizeItem();});var def=fn();if(this.processInterval>=0){this._processIntervalId=setInterval(fn,this.processInterval);}return def;},_stopSynchronizeInterval:function(){if(this._processIntervalId){clearInterval(this._processIntervalId);this._processIntervalId=0;}},_synchronizeItem:function(){if(this._isSynchronizing){return this._saveDeferred;}if(this._queue.length===0){return this._saveDeferred;}if(!this._saveDeferred){this._saveDeferred=new _129d();}this._isSynchronizing=true;var items=this._queue;this._queue=[];var _12a5=this.contentLink;var _12a6=lang.hitch(this,function(_12a7){var _12a8=true;var _12a9={};if(_12a7){array.forEach(_12a7.properties,lang.hitch(this,function(_12aa){_12aa.name=_12a0.pascalToCamel(_12aa.name);}));var _12ab=_12a7.savedContentLink;_12a9=lang.mixin({successful:false,contentLink:_12a8?_12a7.savedContentLink:_12a5,hasContentLinkChanged:_12a7.savedContentLink&&_12ab!=this.contentLink},_12a7);if(_12ab&&_12ab!=this.contentLink){_12a9.oldContentLink=this.contentLink;this.contentLink=_12ab;}}else{_12a8=false;}this._isSynchronizing=false;if(this._queue.length===0){this._stopSynchronizeInterval();this.set("hasPendingChanges",false);var def=this._saveDeferred;this._saveDeferred=null;if(_12a8){def.resolve(_12a9);}else{def.reject({contentLink:_12a5,properties:items,error:"Unexpected result returned from the server."});}}});var _12ac=lang.hitch(this,function(error){var _12ad={contentLink:_12a5,properties:items,error:error};this._isSynchronizing=false;if(this._queue.length===0){var def=this._saveDeferred;this._saveDeferred=null;this._stopSynchronizeInterval();this.set("hasPendingChanges",false);def.reject(_12ad);}});_129d.when(this._saveProperties(items),_12a6,_12ac);return this._saveDeferred;},pendingSync:function(_12ae){return this._propertyIndexInQueue(_12ae)!==-1;},_saveProperties:function(items){var _12af=this.contentLink;var _12b0={};array.forEach(items,lang.hitch(this,function(item){_12b0[item.name]=json.toJson(item.value);}));var _12b1={id:_12af,properties:_12b0,publishChanges:this._publish};this._publish=false;return this.contentDataStore.patch(_12b1,{id:_12b1.id});}});});},"dojox/validate/regexp":function(){define("dojox/validate/regexp",["dojo/_base/lang","dojo/regexp","dojox/main"],function(lang,_12b2,dojox){var _12b3=lang.getObject("validate.regexp",true,dojox);_12b3=dojox.validate.regexp={ipAddress:function(flags){flags=(typeof flags=="object")?flags:{};if(typeof flags.allowDottedDecimal!="boolean"){flags.allowDottedDecimal=true;}if(typeof flags.allowDottedHex!="boolean"){flags.allowDottedHex=true;}if(typeof flags.allowDottedOctal!="boolean"){flags.allowDottedOctal=true;}if(typeof flags.allowDecimal!="boolean"){flags.allowDecimal=true;}if(typeof flags.allowHex!="boolean"){flags.allowHex=true;}if(typeof flags.allowIPv6!="boolean"){flags.allowIPv6=true;}if(typeof flags.allowHybrid!="boolean"){flags.allowHybrid=true;}var _12b4="((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])";var _12b5="(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]";var _12b6="(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]";var _12b7="(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|"+"4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])";var hexRE="0[xX]0*[\\da-fA-F]{1,8}";var _12b8="([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}";var _12b9="([\\da-fA-F]{1,4}\\:){6}"+"((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])";var a=[];if(flags.allowDottedDecimal){a.push(_12b4);}if(flags.allowDottedHex){a.push(_12b5);}if(flags.allowDottedOctal){a.push(_12b6);}if(flags.allowDecimal){a.push(_12b7);}if(flags.allowHex){a.push(hexRE);}if(flags.allowIPv6){a.push(_12b8);}if(flags.allowHybrid){a.push(_12b9);}var _12ba="";if(a.length>0){_12ba="("+a.join("|")+")";}return _12ba;},host:function(flags){flags=(typeof flags=="object")?flags:{};if(typeof flags.allowIP!="boolean"){flags.allowIP=true;}if(typeof flags.allowLocal!="boolean"){flags.allowLocal=false;}if(typeof flags.allowPort!="boolean"){flags.allowPort=true;}if(typeof flags.allowNamed!="boolean"){flags.allowNamed=false;}var _12bb="(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)";var _12bc="(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)";var _12bd=flags.allowPort?"(\\:\\d+)?":"";var _12be="((?:"+_12bb+"\\.)+"+_12bc+"\\.?)";if(flags.allowIP){_12be+="|"+_12b3.ipAddress(flags);}if(flags.allowLocal){_12be+="|localhost";}if(flags.allowNamed){_12be+="|^[^-][a-zA-Z0-9_-]*";}return "("+_12be+")"+_12bd;},url:function(flags){flags=(typeof flags=="object")?flags:{};if(!("scheme" in flags)){flags.scheme=[true,false];}var _12bf=_12b2.buildGroupRE(flags.scheme,function(q){if(q){return "(https?|ftps?)\\://";}return "";});var _12c0="(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]+(?:\\?[^?#\\s/]*)?(?:#[A-Za-z][\\w.:-]*)?)?)?";return _12bf+_12b3.host(flags)+_12c0;},emailAddress:function(flags){flags=(typeof flags=="object")?flags:{};if(typeof flags.allowCruft!="boolean"){flags.allowCruft=false;}flags.allowPort=false;var _12c1="([!#-'*+\\-\\/-9=?A-Z^-~]+[.])*[!#-'*+\\-\\/-9=?A-Z^-~]+";var _12c2=_12c1+"@"+_12b3.host(flags);if(flags.allowCruft){_12c2="<?(mailto\\:)?"+_12c2+">?";}return _12c2;},emailAddressList:function(flags){flags=(typeof flags=="object")?flags:{};if(typeof flags.listSeparator!="string"){flags.listSeparator="\\s;,";}var _12c3=_12b3.emailAddress(flags);var _12c4="("+_12c3+"\\s*["+flags.listSeparator+"]\\s*)*"+_12c3+"\\s*["+flags.listSeparator+"]?\\s*";return _12c4;},numberFormat:function(flags){flags=(typeof flags=="object")?flags:{};if(typeof flags.format=="undefined"){flags.format="###-###-####";}var _12c5=function(_12c6){return _12b2.escapeString(_12c6,"?").replace(/\?/g,"\\d?").replace(/#/g,"\\d");};return _12b2.buildGroupRE(flags.format,_12c5);},ca:{postalCode:function(){return "([A-Z][0-9][A-Z] [0-9][A-Z][0-9])";},province:function(){return "(AB|BC|MB|NB|NL|NS|NT|NU|ON|PE|QC|SK|YT)";}},us:{state:function(flags){flags=(typeof flags=="object")?flags:{};if(typeof flags.allowTerritories!="boolean"){flags.allowTerritories=true;}if(typeof flags.allowMilitary!="boolean"){flags.allowMilitary=true;}var _12c7="AL|AK|AZ|AR|CA|CO|CT|DE|DC|FL|GA|HI|ID|IL|IN|IA|KS|KY|LA|ME|MD|MA|MI|MN|MS|MO|MT|"+"NE|NV|NH|NJ|NM|NY|NC|ND|OH|OK|OR|PA|RI|SC|SD|TN|TX|UT|VT|VA|WA|WV|WI|WY";var _12c8="AS|FM|GU|MH|MP|PW|PR|VI";var _12c9="AA|AE|AP";if(flags.allowTerritories){_12c7+="|"+_12c8;}if(flags.allowMilitary){_12c7+="|"+_12c9;}return "("+_12c7+")";}}};return _12b3;});},"epi/cms/contentediting/NewContentNameInputDialog":function(){require({cache:{"url:epi/cms/contentediting/templates/NewContentNameInputDialog.html":"<div class=\"epi-formContainer\">\r\n    <div data-dojo-attach-point=\"messageNode\"></div>\r\n    <br />\r\n    <div>\r\n        <label data-dojo-attach-point=\"contentNameLabelNode\">${nameLabel}</label>\r\n        <input type=\"text\" size=\"40\" data-dojo-attach-point=\"contentNameTextbox\" data-dojo-type=\"dijit.form.ValidationTextBox\"\r\n                data-dojo-props=\"required: true, trim:true\"\r\n                missingMessage: \"${res.errormessage.missingmessage}\" />\r\n    </div>\r\n</div>"}});define("epi/cms/contentediting/NewContentNameInputDialog",["dojo/_base/declare","dojo/_base/lang","dojo/dom-style","dijit/_CssStateMixin","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/form/TextBox","epi","epi/shell/widget/dialog/_DialogContentMixin","epi/shell/widget/_ModelBindingMixin","epi/shell/widget/_ActionProviderWidget","dojo/text!./templates/NewContentNameInputDialog.html","epi/i18n!epi/cms/nls/shell.common.buttons","epi/i18n!epi/cms/nls/episerver.cms.widget.newcontentnamedialog"],function(_12ca,lang,_12cb,_12cc,_12cd,_12ce,_12cf,_12d0,epi,_12d1,_12d2,_12d3,_12d4,_12d5,res){return _12ca("epi.cms.contentediting.NewContentNameInputDialog",[_12cd,_12ce,_12cf,_12d3,_12d1,_12cc],{templateString:_12d4,res:res,defaultContentName:null,message:null,title:null,nameLabel:epi.resources.header.name,_setMessageAttr:{node:"messageNode",type:"innerHTML"},postMixInProperties:function(){this.inherited(arguments);this.message=lang.replace(this.res.warningtext,{defaultname:this.defaultContentName});this._set("message",this.message);this.title=res.title;},postCreate:function(){this.inherited(arguments);this.contentNameTextbox.set("value",this.defaultContentName);this.contentNameTextbox.on("focus",function(){this.focusNode.select();});this.contentNameTextbox.on("keyup",lang.hitch(this,function(evt){var _12d6=this.contentNameTextbox.isValid();if(evt.keyCode==dojo.keys.ENTER&&_12d6){this.executeDialog();}}));this.contentNameTextbox.focus();},_getValueAttr:function(){return this.contentNameTextbox.get("value");},getActions:function(){this._actions=[{name:"ok",label:"Ok",settings:{type:"button","class":"Salt"},action:dojo.hitch(this,function(){if(this.contentNameTextbox.isValid()){this.executeDialog();}else{this.contentNameTextbox.focus();}})},{name:"cancel",label:_12d5.cancel,settings:{type:"button"},action:dojo.hitch(this,function(){this.cancelDialog();})}];return this._actions;}});});},"epi/cms/contentediting/viewsettings/ResolutionViewSetting":function(){define("epi/cms/contentediting/viewsettings/ResolutionViewSetting",["dojo/_base/declare","epi/cms/contentediting/_ViewSetting"],function(_12d7,_12d8){return _12d7([_12d8],{key:"resolution",usedForRendering:false,afterPreviewLoad:function(_12d9,_12da){this.inherited(arguments);if(_12d9){var size=_12da?this._getPreviewResolution():null;_12d9.set("previewSize",size);_12d9.set("previewClass",this.value?"epi-viewPort-"+this.value:"");}return null;},_getPreviewResolution:function(){var size=null;var _12db=this.value;if(_12db){var _12dc=_12db.split("x");if(_12dc.length==2){size={"w":_12dc[0],"h":_12dc[1]};}}return size;}});});},"url:epi/cms/widget/templates/SearchResultList.html":"<div class=\"epi-searchResultList\">\r\n    <div data-dojo-attach-point=\"gridContainerNode\">\r\n        <div data-dojo-attach-point=\"emptyMessage\" class=\"epi-searchResultListEmptyMessage\">${res.contentnotfound}</div>\r\n    </div>\r\n    <div class=\"dijitReset epi-searchResultListNavigation\">\r\n        <div data-dojo-attach-point=\"previousButton\" role=\"option\"></div>\r\n        <div data-dojo-attach-point=\"nextButton\" role=\"option\"></div>\r\n    </div>\r\n</div>","epi/cms/component/ContentFilter":function(){define({BlockType:"EPiServer.DataAbstraction.BlockType",PageType:"EPiServer.DataAbstraction.PageType",Folder:"EPiServer.Core.ContentFolder"});},"epi/cms/widget/command/CreateNewPageSelector":function(){define("epi/cms/widget/command/CreateNewPageSelector",["dojo/_base/declare","epi/cms/component/ContentFilter","epi/cms/widget/command/_CreateContentFromSelectorBase","epi/i18n!epi/cms/nls/episerver.cms.components.createpage","epi/i18n!epi/cms/nls/episerver.cms.widget.pageselector","epi/i18n!epi/cms/nls/episerver.cms.widget.createcontentselector"],function(_12dd,_12de,_12df,_12e0,_12e1,_12e2){return _12dd([_12df],{res:_12e0,contentType:_12de.PageType,showRoot:true,typeIdentifiers:"epi.cms.page",confirmActionText:_12e2.buttons.confirmation,description:_12e2.descriptionpage,title:_12e1.popuptitle,postscript:function(){this.inherited(arguments);this.value=this.application.getStartPage();this.root=this.application.getRootPage();}});});},"epi/cms/widget/ContentReferencesViewModel":function(){define("epi/cms/widget/ContentReferencesViewModel",["dojo/_base/array","dojo/_base/lang","dojo/_base/declare","dojo/_base/Deferred","dojo/Stateful","epi/dependency","epi/shell/_StatefulGetterSetterMixin"],function(array,lang,_12e3,_12e4,_12e5,_12e6,_12e7){return _12e3("epi.cms.widget.ContentReferencesViewModel",[_12e5,_12e7],{store:null,contentData:null,contentDataType:"page",mode:-1,showToolbar:true,pageReferences:[],blockReferences:[],numberOfReferences:{page:0,block:0,total:0},isLoading:false,constructor:function(_12e8){lang.mixin(this,_12e8);if(!this.store){var _12e9=_12e6.resolve("epi.storeregistry");this.store=_12e9.get("epi.cms.contentreferences");}var _12ea="page",root=this.contentData.capabilities||this.contentData;if(root.isBlock){_12ea="block";}else{if(root.isFolder){_12ea="folder";}}this.set("contentDataType",_12ea);},update:function(){var _12eb=new _12e4();this.set("isLoading",true);_12e4.when(this.store.refresh(this.contentData.contentLink),lang.hitch(this,function(data){data=data||[];var _12ec=[],_12ed=[];array.forEach(data,function(item){if(item&&item.isPage){_12ec.push(item);}else{_12ed.push(item);}});this.set("pageReferences",_12ec);this.set("blockReferences",_12ed);this.set("numberOfReferences",{page:_12ec.length,block:_12ed.length,total:data.length});this.set("showToolbar",data.length>0);this.set("isLoading",false);_12eb.resolve();}));return _12eb;},_setShowToolbarAttr:function(value){if(this.showToolbar){this._set("showToolbar",value);}}});});},"epi/cms/widget/overlay/_OverlayItemInfoMixin":function(){define("epi/cms/widget/overlay/_OverlayItemInfoMixin",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/dom-construct","epi/shell/widget/_ModelBindingMixin","epi/shell/widget/overlay/OverlayItemInfo","epi/cms/contentediting/ContentActionSupport","epi/cms/widget/viewmodel/ContentStatusViewModel"],function(_12ee,_12ef,lang,_12f0,_12f1,_12f2,_12f3,_12f4){return _12ee("epi.cms.widget.overlay._OverlayItemInfoMixin",[_12f1],{disableTooltip:false,postCreate:function(){this.set("model",new _12f4());this.model.set("statusIconArray",[["epi-iconHidden"],["epi-iconHidden"],["epi-iconHidden"],["epi-iconHidden"],["epi-iconHidden"],["epi-iconHidden"],["epi-iconHidden"],["epi-iconHidden"]]);this.subscribe("/dnd/start",lang.hitch(this,function(){if(!this.disableTooltip){this._set("disableTooltip",true);this._showStatusMessage(false);}}));this.subscribe("/dnd/cancel",lang.hitch(this,function(){this._set("disableTooltip",false);}));this.subscribe("/dnd/drop",lang.hitch(this,function(){this._set("disableTooltip",false);}));var _12f5=this.get("containerDomNode");if(_12f5){this.connect(this,"onMouseEnter",lang.hitch(this,function(){this._showStatusMessage(!this.get("disableTooltip"));}));this.connect(this,"onMouseLeave",lang.hitch(this,function(){this._showStatusMessage(false);}));}this.inherited(arguments);},destroy:function(){if(this._overlayItemInfo){this._overlayItemInfo.destroyRecursive();this._overlayItemInfo=null;}this.inherited(arguments);},modelBindingMap:{"contentStatus":["contentStatus"],"statusIcon":["statusIcon"],"statusMessage":["statusMessage"]},_setContentStatusAttr:function(_12f6){if(!this.model.validateStatus(_12f6)){this._destroyOverlayItemInfo();}},_setStatusIconAttr:function(_12f7){var _12f8=this.get("overlayItemInfo");if(!_12f8){return;}this.get("overlayItemInfo").set("statusIcon",_12f7);},_setStatusMessageAttr:function(_12f9){var _12fa=this.get("overlayItemInfo");if(!_12fa){return;}this.get("overlayItemInfo").set("statusMessage",_12f9);},_getContainerDomNodeAttr:function(){return this.containerDomNode||this.domNode;},_getOverlayItemInfoAttr:function(){if(!this.model.validateStatus(this.model.get("contentStatus"))){return null;}if(!this._overlayItemInfo){this._overlayItemInfo=new _12f2();_12f0.place(this._overlayItemInfo.domNode,this.get("containerDomNode"));}return this._overlayItemInfo;},_showStatusMessage:function(_12fb){var _12fc=this.get("overlayItemInfo");if(!_12fc){return;}_12fc.showStatusMessage(_12fb);},_destroyOverlayItemInfo:function(){if(this._overlayItemInfo){this._overlayItemInfo.destroyRecursive();this._overlayItemInfo=null;}}});});},"epi/cms/widget/ContentSearchBox":function(){define("epi/cms/widget/ContentSearchBox",["dojo/_base/declare","dojo/_base/lang","dojo/_base/event","dojo/aspect","dojo/Evented","dojo/keys","dojo/dom-attr","dojo/dom-style","epi/shell/widget/SuggestionBox","epi/cms/widget/SearchResultList"],function(_12fd,lang,event,_12fe,_12ff,keys,_1300,_1301,_1302,_1303){return _12fd("epi.cms.widget.ContentSearchBox",[_1302,_12ff],{autoComplete:false,dropDownClass:_1303,queryExpr:"${0}",minimumNumberOfChar:1,postCreate:function(){this.inherited(arguments);this.searchDelay=this.defaultDelay;this.on("beforeSearch",lang.hitch(this,function(){if(this.dropDown){_1301.set(this.dropDown.domNode,"width",this.textbox.clientWidth+"px");this.dropDown.showStandby(true);this._showResultList();}}));this.on("searchComplete",lang.hitch(this,function(_1304){if(this.dropDown){this.dropDown.showStandby(false);}}));_12fe.before(this,"_startSearch",function(_1305,args){if(!this.dropDown){var _1306=lang.hitch(this,function(){var _1307=this.id+"_popup",_1308=lang.isString(this.dropDownClass)?lang.getObject(this.dropDownClass,false):this.dropDownClass;this.dropDown=new _1308({onChange:lang.hitch(this,this._selectOption),id:_1307,dir:this.dir,textDir:this.textDir});_1300.remove(this.textbox,"aria-activedescendant");_1300.set(this.textbox,"area-owns",_1307);});_1306();this.dropDown.on("select",lang.hitch(this,function(value){this.emit("select",value);}));}this.emit("beforeSearch",{});return [_1305,args];});},_openResultList:function(_1309,query,_130a){this.emit("searchComplete",_1309);this._fetchHandle=null;this.dropDown.clearResultList();var _130b=_1309.length>0||_130a.start!==0;this.dropDown.showEmptyMessage(!_130b);this.dropDown.showGrid(_130b);if(_130b){this.dropDown.createOptions(_1309,_130a,lang.hitch(this,"_getMenuLabelFromItem"));}this._showResultList();},_onDropDownMouseDown:function(e){e.stopPropagation();},_onKey:function(evt){switch(evt.charOrCode){case keys.ENTER:if(this._opened||this._fetchHandle){this.inherited(arguments);}else{this._startSearchFromInput();event.stop(evt);}break;case keys.PAGE_DOWN:case keys.DOWN_ARROW:case keys.PAGE_UP:case keys.UP_ARROW:this.dropDown.handleKey(evt);event.stop(evt);break;case keys.LEFT_ARROW:case keys.RIGHT_ARROW:break;default:this.inherited(arguments);}},_startSearchFromInput:function(){if(!this.focusNode.value||this.focusNode.value.length<this.minimumNumberOfChar){this.closeDropDown();}else{this._startSearch(this.focusNode.value);}},_startSearchAll:function(){},_selectOption:function(_130c){this.closeDropDown();}});});},"epi/cms/widget/SearchBox":function(){define("epi/cms/widget/SearchBox",["dojo/_base/declare","dojo/_base/Deferred","dojo/_base/connect","dojo/_base/lang","dojo/dom-construct","dijit/_Widget","epi/shell/SearchManager","epi/cms/widget/ContentSearchBox"],function(_130d,_130e,_130f,lang,_1310,_1311,_1312,_1313){return _130d("epi.cms.widget.SearchBox",[_1311],{area:null,searchRoots:null,filterOnCulture:null,_searchBox:null,_searchManager:null,postCreate:function(){this.inherited(arguments);this._searchManager=new _1312();_130e.when(this._searchManager.getStore(),lang.hitch(this,function(store){this._searchBox=new _1313({"searchAttr":"searchQuery","store":store});this._searchBox.on("select",lang.hitch(this,function(value){this._searchBox.set("value","");this._searchBox.focus();this._searchBox.toggleClearButton();this.onItemAction(value);}));this.set("filterOnCulture",true);_1310.place(this._searchBox.domNode,this.domNode);}));},_setAreaAttr:function(value){this._set("area",value);if(this._searchBox){_130e.when(this._searchManager.getProviderQuery(value),lang.hitch(this,function(query){lang.mixin(this._searchBox.query,query);}));}},_setSearchRootsAttr:function(value){this._set("searchRoots",value);if(this._searchBox){lang.mixin(this._searchBox.query,{searchRoots:value});}},_setFilterOnCultureAttr:function(value){this._set("filterOnCulture",value);if(this._searchBox){lang.mixin(this._searchBox.query,{filterOnCulture:value});}},onItemAction:function(item){var _1314={uri:"epi.cms.contentdata:///"+item.metadata.id};_130f.publish("/epi/shell/context/request",[_1314,{sender:null}]);}});});},"dgrid/extensions/ColumnResizer":function(){define("dgrid/extensions/ColumnResizer",["dojo/_base/declare","dojo/on","dojo/query","dojo/_base/lang","dojo/dom","dojo/dom-geometry","dojo/has","../util/misc","put-selector/put","dojo/_base/html","xstyle/css!../css/extensions/ColumnResizer.css"],function(_1315,_1316,query,lang,dom,geom,has,_1317,put){var _1318=has("touch")&&webkitConvertPointFromNodeToPage;function _1319(table,span,_131a,_131b,id){for(var i=1;i<span;i++){table[_131a+i][_131b]=id;}};function _131c(_131d){var i=_131d.length,l=i,_131e=_131d[0].length,table=new Array(i);while(i--){table[i]=new Array(_131e);}var _131f={};for(i=0;i<l;i++){var row=table[i],_1320=_131d[i];for(var j=0,js=0;j<_131e;j++){var cell=_1320[js],k;if(typeof row[j]!="undefined"){continue;}row[j]=cell.id;if(cell.rowSpan&&cell.rowSpan>1){_1319(table,cell.rowSpan,i,j,cell.id);}if(i>0&&cell.colSpan&&cell.colSpan>1){for(k=1;k<cell.colSpan;k++){row[++j]=cell.id;if(cell.rowSpan&&cell.rowSpan>1){_1319(table,cell.rowSpan,i,j,cell.id);}}}_131f[cell.id]=_131d[0][j].id;js++;}}return _131f;};return _1315([],{resizeNode:null,minWidth:40,gridWidth:null,_resizedColumns:false,resizeColumnWidth:function(colId,width){if(width<=0){return;}var old=this._columnStyles[colId],x=this.styleColumn(colId,"width: "+width+"px;");old&&old.remove();this._columnStyles[colId]=x;},configStructure:function(){this._resizedColumns=false;for(var name in this._columnStyles){this._columnStyles[name].remove();}this._columnStyles={};this.inherited(arguments);},renderHeader:function(){this.inherited(arguments);var grid=this;grid.gridWidth=grid.headerNode.clientWidth-1;var assoc;if(this.columnSets&&this.columnSets.length){var csi=this.columnSets.length;while(csi--){assoc=lang.mixin(assoc||{},_131c(this.columnSets[csi]));}}else{if(this.subRows&&this.subRows.length>1){assoc=_131c(this.subRows);}}var _1321=query(".dgrid-cell",grid.headerNode),i=_1321.length;while(i--){var _1322=_1321[i],id=_1322.columnId,col=grid.columns[id],_1323=_1322.childNodes;if(!col){continue;}var _1324=put("div.dgrid-resize-header-container");_1322.contents=_1324;while(_1323.length>0){put(_1324,_1323[0]);}put(_1322,_1324,"div.dgrid-resize-handle.resizeNode-"+id).columnId=assoc?assoc[id]:id;}if(!grid.mouseMoveListen){_1316(grid.headerNode,".dgrid-resize-handle:mousedown"+(has("touch")?",.dgrid-resize-handle:touchstart":""),function(e){grid._resizeMouseDown(e,this);grid.mouseMoveListen.resume();grid.mouseUpListen.resume();});grid.mouseMoveListen=_1316.pausable(document.body,"mousemove"+(has("touch")?",touchmove":""),_1317.throttleDelayed(function(e){grid._updateResizerPosition(e);}));grid.mouseUpListen=_1316.pausable(document.body,"mouseup"+(has("touch")?",touchend":""),function(e){grid._resizeMouseUp(e);grid.mouseMoveListen.pause();grid.mouseUpListen.pause();});grid.mouseMoveListen.pause();grid.mouseUpListen.pause();}},_resizeMouseDown:function(e,_1325){e.preventDefault();dom.setSelectable(this.domNode,false);var grid=this;grid._startX=grid._getResizeMouseLocation(e);grid._gridX=_1318?webkitConvertPointFromNodeToPage(grid.bodyNode,new WebKitPoint(0,0)).x:geom.position(grid.bodyNode).x;grid._targetCell=query(".dgrid-column-"+_1325.columnId,grid.headerNode)[0];if(!grid._resizer){grid._resizer=put(grid.domNode,"div.dgrid-column-resizer");}grid._resizer.style.display="block";grid._updateResizerPosition(e);},_resizeMouseUp:function(e){this._readyToResize=false;if(!this._resizedColumns){var _1326=query(".dgrid-cell",this.headerNode);if(this.columnSets&&this.columnSets.length){_1326=_1326.filter(function(node){var idx=node.columnId.split("-");return idx[0]=="0";});}else{if(this.subRows&&this.subRows.length>1){_1326=_1326.filter(function(node){return node.columnId.charAt(0)=="0";});}}_1326.forEach(function(_1327){this.resizeColumnWidth(_1327.columnId,_1327.offsetWidth);},this);this._resizedColumns=true;}dom.setSelectable(this.domNode,true);var cell=this._targetCell,delta=this._getResizeMouseLocation(e)-this._startX,_1328=cell.offsetWidth+delta,obj=this._getResizedColumnWidths(),_1329=obj.totalWidth,_132a=obj.lastColId,_132b=query(".dgrid-column-"+_132a,this.headerNode)[0].offsetWidth;if(cell.columnId!=_132a){if(_1329+delta<this.gridWidth){this.styleColumn(_132a,"width: auto;");}else{if(_132b-delta<=this.minWidth){this.resizeColumnWidth(_132a,this.minWidth);}}}if(_1328<this.minWidth){_1328=this.minWidth;}this.resizeColumnWidth(cell.columnId,_1328);this.resize();this._hideResizer();},_updateResizerPosition:function(e){var _132c=this._getResizeMouseLocation(e),delta=_132c-this._startX,cell=this._targetCell,left=_132c-this._gridX;if(cell.offsetWidth+delta<this.minWidth){left=this._startX-this._gridX-(cell.offsetWidth-this.minWidth);}this._resizer.style.left=left+"px";},_hideResizer:function(){this._resizer.style.display="none";},_getResizeMouseLocation:function(e){var posX=0;if(e.pageX){posX=e.pageX;}else{if(e.clientX){posX=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;}}return posX;},_getResizedColumnWidths:function(){var _132d=0,_132e=query(".dgrid-cell",this.headerNode);if(this.columnSets&&this.columnSets.length){_132e=_132e.filter(function(node){var idx=node.columnId.split("-");return idx[1]=="0";});}else{if(this.subRows&&this.subRows.length>1){_132e=_132e.filter(function(node){return node.columnId.charAt(0)=="0";});}}var i=_132e.length;if(!i){return {};}var _132f=_132e[i-1].columnId;while(i--){_132d+=_132e[i].offsetWidth;}return {totalWidth:_132d,lastColId:_132f};}});});},"epi/cms/widget/_DndStateMixin":function(){define("epi/cms/widget/_DndStateMixin",["dojo","dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/aspect","dojo/dom-class"],function(dojo,array,_1330,lang,_1331,_1332,_1333){return _1330([],{baseDndStateClass:"epi-dropTarget",dndStateClass:null,dropTarget:null,_aspectAfterHandler:null,postCreate:function(){this.subscribe("/dnd/start","_onDndStart");this.subscribe("/dnd/cancel","_onDndCancel");this.subscribe("/dnd/drop","_onDndDrop");if(this.dropTarget){this._aspectAfterHandler=_1332.after(this.dropTarget,"onDndStart",lang.hitch(this,"_onAfterDndStart"));}},_getDndStateClassAttr:function(){var _1334=this.canAccept()?"Enabled":"Disabled";this.dndStateClass=this.baseDndStateClass+_1334;return this.dndStateClass;},canAccept:function(){return false;},_onDndStart:function(){if(!this.dropTarget){_1333.add(this.domNode,this.get("DndStateClass"));}},_onAfterDndStart:function(){_1333.add(this.domNode,this.get("DndStateClass"));},_onDndCancel:function(){_1333.remove(this.domNode,this.dndStateClass);},_onDndDrop:function(){_1333.remove(this.domNode,this.dndStateClass);},destroy:function(){this.inherited(arguments);if(this._aspectAfterHandler){this._aspectAfterHandler.remove();this._aspectAfterHandler=null;}}});});},"url:epi/cms/contentediting/templates/ContainerLayoutTab.html":"<div class=\"epi-containerLayoutTab\">\r\n    <div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-attach-point=\"topContainer\"></div>\r\n    <div data-dojo-type=\"dijit.layout.TabContainer\" data-dojo-attach-point=\"tabContainer\" data-dojo-props=\"doLayout: false, useMenu: true, useSlider: false, tabStrip: false\"></div>\r\n</div>","dojo/data/util/filter":function(){define(["dojo/_base/lang"],function(lang){var _1335=lang.getObject("dojo.data.util.filter",true);_1335.patternToRegExp=function(_1336,_1337){var rxp="^";var c=null;for(var i=0;i<_1336.length;i++){c=_1336.charAt(i);switch(c){case "\\":rxp+=c;i++;rxp+=_1336.charAt(i);break;case "*":rxp+=".*";break;case "?":rxp+=".";break;case "$":case "^":case "/":case "+":case ".":case "|":case "(":case ")":case "{":case "}":case "[":case "]":rxp+="\\";default:rxp+=c;}}rxp+="$";if(_1337){return new RegExp(rxp,"mi");}else{return new RegExp(rxp,"m");}};return _1335;});},"url:epi/cms/contentediting/templates/NotificationBarItem.html":"<div class=\"epi-notificationBarItem\">\r\n    <div class=\"epi-notificationBarText\" data-dojo-attach-point=\"contentContainer\">\r\n        <p data-dojo-attach-point=\"textContainer\"></p>\r\n    </div>\r\n    <div class=\"epi-notificationBarButtonContainer\" data-dojo-attach-point=\"buttonContainer\">\r\n        <button data-dojo-type=\"dijit.form.Button\" class=\"epi-chromelessButton\" data-dojo-props=\"iconClass:'epi-iconClose', showLabel:false\" data-dojo-attach-event=\"onClick:_onClose\"></button>\r\n    </div>\r\n</div>","dijit/tree/TreeStoreModel":function(){define("dijit/tree/TreeStoreModel",["dojo/_base/array","dojo/aspect","dojo/_base/declare","dojo/_base/json","dojo/_base/lang"],function(array,_1338,_1339,json,lang){return _1339("dijit.tree.TreeStoreModel",null,{store:null,childrenAttrs:["children"],newItemIdAttr:"id",labelAttr:"",root:null,query:null,deferItemLoadingUntilExpand:false,constructor:function(args){lang.mixin(this,args);this.connects=[];var store=this.store;if(!store.getFeatures()["dojo.data.api.Identity"]){throw new Error("dijit.Tree: store must support dojo.data.Identity");}if(store.getFeatures()["dojo.data.api.Notification"]){this.connects=this.connects.concat([_1338.after(store,"onNew",lang.hitch(this,"onNewItem"),true),_1338.after(store,"onDelete",lang.hitch(this,"onDeleteItem"),true),_1338.after(store,"onSet",lang.hitch(this,"onSetItem"),true)]);}},destroy:function(){var h;while(h=this.connects.pop()){h.remove();}},getRoot:function(_133a,_133b){if(this.root){_133a(this.root);}else{this.store.fetch({query:this.query,onComplete:lang.hitch(this,function(items){if(items.length!=1){throw new Error(this.declaredClass+": query "+json.stringify(this.query)+" returned "+items.length+" items, but must return exactly one item");}this.root=items[0];_133a(this.root);}),onError:_133b});}},mayHaveChildren:function(item){return array.some(this.childrenAttrs,function(attr){return this.store.hasAttribute(item,attr);},this);},getChildren:function(_133c,_133d,_133e){var store=this.store;if(!store.isItemLoaded(_133c)){var _133f=lang.hitch(this,arguments.callee);store.loadItem({item:_133c,onItem:function(_1340){_133f(_1340,_133d,_133e);},onError:_133e});return;}var _1341=[];for(var i=0;i<this.childrenAttrs.length;i++){var vals=store.getValues(_133c,this.childrenAttrs[i]);_1341=_1341.concat(vals);}var _1342=0;if(!this.deferItemLoadingUntilExpand){array.forEach(_1341,function(item){if(!store.isItemLoaded(item)){_1342++;}});}if(_1342==0){_133d(_1341);}else{array.forEach(_1341,function(item,idx){if(!store.isItemLoaded(item)){store.loadItem({item:item,onItem:function(item){_1341[idx]=item;if(--_1342==0){_133d(_1341);}},onError:_133e});}});}},isItem:function(_1343){return this.store.isItem(_1343);},fetchItemByIdentity:function(_1344){this.store.fetchItemByIdentity(_1344);},getIdentity:function(item){return this.store.getIdentity(item);},getLabel:function(item){if(this.labelAttr){return this.store.getValue(item,this.labelAttr);}else{return this.store.getLabel(item);}},newItem:function(args,_1345,_1346){var pInfo={parent:_1345,attribute:this.childrenAttrs[0]},_1347;if(this.newItemIdAttr&&args[this.newItemIdAttr]){this.fetchItemByIdentity({identity:args[this.newItemIdAttr],scope:this,onItem:function(item){if(item){this.pasteItem(item,null,_1345,true,_1346);}else{_1347=this.store.newItem(args,pInfo);if(_1347&&(_1346!=undefined)){this.pasteItem(_1347,_1345,_1345,false,_1346);}}}});}else{_1347=this.store.newItem(args,pInfo);if(_1347&&(_1346!=undefined)){this.pasteItem(_1347,_1345,_1345,false,_1346);}}},pasteItem:function(_1348,_1349,_134a,bCopy,_134b){var store=this.store,_134c=this.childrenAttrs[0];if(_1349){array.forEach(this.childrenAttrs,function(attr){if(store.containsValue(_1349,attr,_1348)){if(!bCopy){var _134d=array.filter(store.getValues(_1349,attr),function(x){return x!=_1348;});store.setValues(_1349,attr,_134d);}_134c=attr;}});}if(_134a){if(typeof _134b=="number"){var _134e=store.getValues(_134a,_134c).slice();_134e.splice(_134b,0,_1348);store.setValues(_134a,_134c,_134e);}else{store.setValues(_134a,_134c,store.getValues(_134a,_134c).concat(_1348));}}},onChange:function(){},onChildrenChange:function(){},onDelete:function(){},onNewItem:function(item,_134f){if(!_134f){return;}this.getChildren(_134f.item,lang.hitch(this,function(_1350){this.onChildrenChange(_134f.item,_1350);}));},onDeleteItem:function(item){this.onDelete(item);},onSetItem:function(item,_1351){if(array.indexOf(this.childrenAttrs,_1351)!=-1){this.getChildren(item,lang.hitch(this,function(_1352){this.onChildrenChange(item,_1352);}));}else{this.onChange(item);}}});});},"epi/cms/contentediting/FloatingEditorWrapper":function(){define("epi/cms/contentediting/FloatingEditorWrapper",["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/dom-geometry","dojo/dom-style","dojo/number","epi/shell/widget/dialog/LightWeight","epi/cms/contentediting/FlyoutEditorWrapper"],function(_1353,_1354,lang,_1355,_1356,_1357,_1358,_1359,_135a){return _1354("epi.cms.contentediting.FloatingEditorWrapper",[_135a],{_eventHandlers:[],_overlayContainer:null,_iframeWithOverlay:null,postMixInProperties:function(){var _135b=this.overlayItem;while(_135b){if(_135b.declaredClass==="epi.shell.widget.IframeWithOverlay"){this._iframeWithOverlay=_135b;break;}_135b=_135b.getParent();}},_createDialog:function(_135c){var _135d=function(_135e){if(!this.open||!_135e){return;}this._containerNodeCS=this._containerNodeCS||_1357.getComputedStyle(this.containerNode);if(!this._dialogChromeSize){_1357.set(this.containerNode,{display:"none"});this._chromeHeight=_1356.getMarginBox(this.domNode).h;_1357.set(this.containerNode,{display:"block",overflowY:"auto"});}_1356.setMarginBox(this.containerNode,{h:_135e.h-this._chromeHeight},this._containerNodeCS);_1357.set(this.domNode,{top:_135e.t+"px",left:_135e.l+"px"});};var _135f=new _1359({title:this.propertyDisplayName,content:_135c,duration:350,draggable:false,closeIconVisible:false,region:"trailing",resize:_135d,overlayItem:this.overlayItem,_position:function(){},_size:function(){}});_1355.add(_135f.domNode,"epi-floatingEditorWrapperDialog");_135f.placeAt(this._iframeWithOverlay,"last");_1357.set(_135f.domNode,{top:"-10000px"});return _135f;},startEdit:function(){function _1360(){this.tryToStopEditing(false);};this.inherited(arguments);this._eventHandlers.push(_1353.connect(this._iframeWithOverlay.scroller,"mousedown",this,_1360));},_removeEditingFeatures:function(){this.inherited(arguments);this._disconnectLocal(this._eventHandlers);},_disconnectLocal:function(_1361){if(lang.isArray(_1361)){var _1362;while(_1362=_1361.pop()){_1353.disconnect(_1362);}}}});});},"dijit/tree/_dndSelector":function(){define("dijit/tree/_dndSelector",["dojo/_base/array","dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","dojo/mouse","dojo/on","dojo/touch","dojo/_base/window","./_dndContainer"],function(array,_1363,_1364,lang,mouse,on,touch,win,_1365){return _1364("dijit.tree._dndSelector",_1365,{constructor:function(){this.selection={};this.anchor=null;this.tree.domNode.setAttribute("aria-multiselect",!this.singular);this.events.push(on(this.tree.domNode,touch.press,lang.hitch(this,"onMouseDown")),on(this.tree.domNode,touch.release,lang.hitch(this,"onMouseUp")),on(this.tree.domNode,touch.move,lang.hitch(this,"onMouseMove")));},singular:false,getSelectedTreeNodes:function(){var nodes=[],sel=this.selection;for(var i in sel){nodes.push(sel[i]);}return nodes;},selectNone:function(){this.setSelection([]);return this;},destroy:function(){this.inherited(arguments);this.selection=this.anchor=null;},addTreeNode:function(node,_1366){this.setSelection(this.getSelectedTreeNodes().concat([node]));if(_1366){this.anchor=node;}return node;},removeTreeNode:function(node){this.setSelection(this._setDifference(this.getSelectedTreeNodes(),[node]));return node;},isTreeNodeSelected:function(node){return node.id&&!!this.selection[node.id];},setSelection:function(_1367){var _1368=this.getSelectedTreeNodes();array.forEach(this._setDifference(_1368,_1367),lang.hitch(this,function(node){node.setSelected(false);if(this.anchor==node){delete this.anchor;}delete this.selection[node.id];}));array.forEach(this._setDifference(_1367,_1368),lang.hitch(this,function(node){node.setSelected(true);this.selection[node.id]=node;}));this._updateSelectionProperties();},_setDifference:function(xs,ys){array.forEach(ys,function(y){y.__exclude__=true;});var ret=array.filter(xs,function(x){return !x.__exclude__;});array.forEach(ys,function(y){delete y["__exclude__"];});return ret;},_updateSelectionProperties:function(){var _1369=this.getSelectedTreeNodes();var paths=[],nodes=[];array.forEach(_1369,function(node){nodes.push(node);paths.push(node.getTreePath());});var items=array.map(nodes,function(node){return node.item;});this.tree._set("paths",paths);this.tree._set("path",paths[0]||[]);this.tree._set("selectedNodes",nodes);this.tree._set("selectedNode",nodes[0]||null);this.tree._set("selectedItems",items);this.tree._set("selectedItem",items[0]||null);},onMouseDown:function(e){if(!this.current||this.tree.isExpandoNode(e.target,this.current)){return;}if(!mouse.isLeft(e)){return;}e.preventDefault();var _136a=this.current,copy=_1363.isCopyKey(e),id=_136a.id;if(!this.singular&&!e.shiftKey&&this.selection[id]){this._doDeselect=true;return;}else{this._doDeselect=false;}this.userSelect(_136a,copy,e.shiftKey);},onMouseUp:function(e){if(!this._doDeselect){return;}this._doDeselect=false;this.userSelect(this.current,_1363.isCopyKey(e),e.shiftKey);},onMouseMove:function(){this._doDeselect=false;},_compareNodes:function(n1,n2){if(n1===n2){return 0;}if("sourceIndex" in document.documentElement){return n1.sourceIndex-n2.sourceIndex;}else{if("compareDocumentPosition" in document.documentElement){return n1.compareDocumentPosition(n2)&2?1:-1;}else{if(document.createRange){var r1=doc.createRange();r1.setStartBefore(n1);var r2=doc.createRange();r2.setStartBefore(n2);return r1.compareBoundaryPoints(r1.END_TO_END,r2);}else{throw Error("dijit.tree._compareNodes don't know how to compare two different nodes in this browser");}}}},userSelect:function(node,multi,range){if(this.singular){if(this.anchor==node&&multi){this.selectNone();}else{this.setSelection([node]);this.anchor=node;}}else{if(range&&this.anchor){var cr=this._compareNodes(this.anchor.rowNode,node.rowNode),begin,end,_136b=this.anchor;if(cr<0){begin=_136b;end=node;}else{begin=node;end=_136b;}var nodes=[];while(begin!=end){nodes.push(begin);begin=this.tree._getNextNode(begin);}nodes.push(end);this.setSelection(nodes);}else{if(this.selection[node.id]&&multi){this.removeTreeNode(node);}else{if(multi){this.addTreeNode(node,true);}else{this.setSelection([node]);this.anchor=node;}}}}},getItem:function(key){var _136c=this.selection[key];return {data:_136c,type:["treeNode"]};},forInSelectedItems:function(f,o){o=o||win.global;for(var id in this.selection){f.call(o,this.getItem(id),id,this);}}});});},"epi/cms/widget/CategorySelector":function(){require({cache:{"url:epi/cms/widget/templates/CategorySelector.html":"<div class=\"dijitReset dijitInputField dijitInputContainer dijitInline epi-resourceInputContainer epi-categorySelector\" id=\"widget_${id}\">\r\n    <div data-dojo-attach-point=\"categoriesGroupContainer\" class=\"dijit dijitReset dijitInline dijitInlineTable dijitLeft dijitTextBox displayNode epi-categoriesGroup\">\r\n    </div> \r\n    <div data-dojo-type=\"dijit.form.Button\" data-dojo-attach-event=\"onClick: _onButtonClick\" data-dojo-attach-point=\"button\" class=\"epi-categoriesSelectorButton\" data-dojo-props=\"label:'+'\"></div>\r\n</div>"}});define("epi/cms/widget/CategorySelector",["dojo/_base/array","dojo/_base/declare","dojo/_base/Deferred","dojo/_base/lang","dojo/DeferredList","dojo/dom-attr","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/query","dijit/_TemplatedMixin","dijit/_Widget","dijit/_WidgetsInTemplateMixin","dijit/form/Button","dijit/Tooltip","dojox/html/entities","epi/cms/widget/_HasChildDialogMixin","epi/cms/widget/CategorySelectorDialog","epi/shell/widget/_ValueRequiredMixin","epi/dependency","epi/epi","epi/shell/widget/dialog/Dialog","dojo/text!./templates/CategorySelector.html","epi/i18n!epi/cms/nls/episerver.cms.widget.CategorySelector"],function(array,_136d,_136e,lang,_136f,_1370,_1371,_1372,_1373,query,_1374,_1375,_1376,_1377,_1378,_1379,_137a,_137b,_137c,_137d,epi,_137e,_137f,res){return _136d("epi.cms.widget.CategorySelector",[_1375,_1374,_1376,_137a,_137c],{templateString:_137f,localization:res,multiple:true,value:null,store:null,_categories:null,_categoriesParentsName:{},_displayUpdateDfd:null,onChange:function(value){},postMixInProperties:function(){this.inherited(arguments);if(!this.store){var _1380=_137d.resolve("epi.storeregistry");this.store=_1380.get("epi.cms.category");}},postCreate:function(){this.inherited(arguments);this._updateDisplayNode();},destroyDescendants:function(){if(this._tooltip){this._tooltip.destroy();delete this._tooltip;}this.inherited(arguments);},_setValueAttr:function(value){if(!lang.isArray(value)){value=[value];}var _1381=array.filter(value,function(v){return !!v;});this._setValueAndFireOnChange(_1381);if(_1381.length>0){this._set("value",_1381);}else{this._set("value",null);}this._started&&this.validate();},_setValueAndFireOnChange:function(value){if(epi.areEqual(this._categories,value)){return;}this._categories=value;this.onChange(this._categories);this._updateDisplayNode();},_getValueAttr:function(){return this._categories;},_setReadOnlyAttr:function(value){this._set("readOnly",value);_1373.set(this.button.domNode,"display",value?"none":"");_1371.toggle(this.domNode,"dijitReadOnly",value);},focus:function(){this.button.focus();},_createCategoryButton:function(_1382){if(query("div[data-epi-category-id="+_1382.id+"]",this.categoriesGroupContainer).length!==0){return;}var _1383=_1372.create("div",{"class":"dijitReset dijitLeft dijitInputField dijitInputContainer epi-categoryButton"});var _1384=_1372.create("div",{"class":"dijitInline epi-resourceName"});var _1385=_1372.create("div",{"class":"dojoxEllipsis",innerHTML:_1379.encode(_1382.description)});_1372.place(_1385,_1384);_1372.place(_1384,_1383);this._tooltip=new _1378({connectId:_1385,label:_1379.encode(this._getCategoryPath(_1382))});var _1386=_1372.create("div",{"class":"epi-removeButton",innerHTML:"&nbsp;"});_1370.set(_1386,"data-epi-category-id",_1382.id);var _1387=_1386.onClick?"onClick":"onclick";if(!this.readOnly){this.connect(_1386,_1387,lang.hitch(this,this._onRemoveClick));_1372.place(_1386,_1384);}else{_1372.place(_1372.create("span",{innerHTML:"&nbsp;"}),_1384);}_1372.place(_1383,this.categoriesGroupContainer);},_getCategoryPath:function(_1388){if(!_1388.parentsNameCollection||_1388.parentsNameCollection.length==1){return "";}var path=_1388.parentsNameCollection[1];for(i=2;i<_1388.parentsNameCollection.length;i++){path=path+"/"+_1388.parentsNameCollection[i];}return path;},_createNoCategoriesChosenSpan:function(){this.categoriesGroupContainer.innerHTML="";_1372.create("span",{innerHTML:this.localization.nocategorieschosen},this.categoriesGroupContainer);},_getCategory:function(_1389){var _138a=new _136e();_136e.when(this.store.refresh(_1389),function(cat){_138a.callback(cat);});return _138a;},_updateDisplayNode:function(){if(this._displayUpdateDfd){this._displayUpdateDfd.cancel();this._displayUpdateDfd=null;}this.categoriesGroupContainer.innerHTML="";if(!this._categories||this._categories.length===0){this._createNoCategoriesChosenSpan();return;}this._categoriesParentsName={};var _138b=[];array.forEach(this._categories,lang.hitch(this,function(_138c){_138b.push(this._getCategory(_138c));}));this._displayUpdateDfd=new _136f(_138b);_136e.when(this._displayUpdateDfd,lang.hitch(this,function(_138d){array.forEach(_138d,lang.hitch(this,function(_138e){if(!_138e[0]){return;}var cat=_138e[1];if(cat&&cat.visible){this._categoriesParentsName[cat.id]=cat.parentsNameCollection;this._createCategoryButton(cat);}else{var _138f=this._categories.indexOf(cat.id);if(_138f!=-1){this._categories.splice(_138f,1);}}if(this._categories.length===0){this._createNoCategoriesChosenSpan();}}));this._displayUpdateDfd=null;}),lang.hitch(this,function(){this._displayUpdateDfd=null;}));},_onRemoveClick:function(arg){if(!this._categories){return;}var _1390=parseInt(_1370.get(arg.target,"data-epi-category-id"),10);var _1391=this._categories.indexOf(_1390);if(_1391==-1){return;}var _1392=lang.clone(this._categories);_1392.splice(_1391,1);this.set("value",_1392);},_getCategoriesParentsNameClone:function(){var _1393={};array.forEach(this._categories,lang.hitch(this,function(_1394){_1393[_1394]=this._categoriesParentsName[_1394];}));return _1393;},_onShow:function(){this.categorySelectorDialog.set("value",lang.clone(this._categories));this.categorySelectorDialog.setCategoriesParentsNameClone(this._getCategoriesParentsNameClone());this.isShowingChildDialog=true;this.categorySelectorDialog.onShow();},_onExecute:function(){var _1395=this.categorySelectorDialog.get("value");this.set("value",_1395);},_isEmptyArray:function(array){return !array||array.length===0;},_onDialogHide:function(){this.focus();this.isShowingChildDialog=false;},_createDialog:function(){this.categorySelectorDialog=new _137b({});this.dialog=new _137e({title:this.localization.popuptitle,content:this.categorySelectorDialog,dialogClass:"epi-dialog-portrait"});this.connect(this.dialog,"onExecute","_onExecute");this.connect(this.dialog,"onShow","_onShow");this.connect(this.dialog,"onHide","_onDialogHide");this.dialog.startup();},_onButtonClick:function(){if(!this.dialog){this._createDialog();}this.dialog.show(true);}});});},"epi/cms/contentediting/command/ForPublishMenu":function(){define("epi/cms/contentediting/command/ForPublishMenu",["dojo/_base/lang"],function(lang){return function(_1396,_1397){_1397=lang.mixin({isMain:false,priority:0,resetLabelAfterExecution:true,mainButtonClass:null,keepMenuOpen:false,successStatus:null},_1397);_1396.options=_1397;return _1396;};});},"epi/cms/widget/ContextMenu":function(){define("epi/cms/widget/ContextMenu",["dojo/_base/declare","dojo/dom","dijit/focus","dijit/Menu","dijit/popup","epi/shell/command/_CommandConsumerMixin","epi/shell/command/builder/MenuAssembler","epi/shell/command/builder/MenuBuilder","epi/cms/contentediting/command/builder/MenuWithSeparatorBuilder"],function(_1398,dom,_1399,Menu,pm,_139a,_139b,_139c,_139d){return _1398([Menu,_139a],{leftClickToOpen:true,postCreate:function(){this.inherited(arguments);var _139e=new _139c(),_139f=new _139d(),_13a0=[{builder:_139e,target:this},{builder:_139f,target:this,category:"menuWithSeparator"}],_13a1=new _139b({configuration:_13a0,commandSource:this});_13a1.build();},scheduleOpen:function(_13a2,_13a3,_13a4){_1399.curNode&&dom.isDescendant(_1399.curNode,this.domNode)&&_1399.curNode.blur();this._scheduleOpen(_13a2,_13a3,_13a4);}});});},"url:epi/cms/contentediting/templates/ExpirationDialog.html":"<div class=\"epi-formContainer\">\r\n    <div data-dojo-type=\"epi.cms.widget.Breadcrumb\" data-dojo-attach-point=\"breadcrumb\" data-dojo-props=\"showCurrentNode: false\"></div>\r\n    <h1 data-dojo-attach-point=\"contentNameNode\" class=\"epi-breadCrumbsCurrentItem dijitInline dojoxEllipsis\"></h1>\r\n    <div data-dojo-attach-point=\"stateNode\" class=\"epi-notificationBar epi-notificationBarItem\">\r\n        <div class=\"epi-notificationBarText\" data-dojo-attach-point=\"infoTextNode\"></div>\r\n        <div class=\"epi-notificationBarButtonContainer\">\r\n            <button data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"removeButton\" data-dojo-attach-event=\"onClick: _onRemoveButtonClick\">${res.removebutton}</button>\r\n        </div>\r\n    </div>\r\n    <div data-dojo-type=\"dijit.form.Form\" class=\"epi-formArea\" data-dojo-attach-point=\"form\"></div>\r\n</div>","url:epi/cms/contentediting/templates/ShortcutDialog.html":"<div class=\"epi-formContainer\">\r\n    <div data-dojo-type=\"epi.cms.widget.Breadcrumb\" data-dojo-attach-point=\"breadcrumb\" data-dojo-props=\"showCurrentNode: false\"></div>\r\n    <h1 data-dojo-attach-point=\"contentNameNode\" class=\"epi-breadCrumbsCurrentItem dijitInline dojoxEllipsis\"></h1>\r\n    <div data-dojo-type=\"dijit.form.Form\" class=\"epi-formArea\" data-dojo-attach-point=\"form\"></div>\r\n</div>","epi/cms/widget/ContentSelector":function(){require({cache:{"url:epi/cms/widget/templates/ContentSelector.html":"<div class=\"dijitReset dijitInputField dijitInputContainer dijitInline epi-resourceInputContainer\" id=\"widget_${id}\">\r\n    <div data-dojo-attach-point=\"displayNode, dropAreaNode, stateNode\" class=\"dijit dijitReset dijitInline dijitInlineTable dijitLeft dijitTextBox displayNode\">\r\n        <div class=\"dijitReset dijitLeft dijitInputField dijitInputContainer\">\r\n            <div data-dojo-attach-point=\"clearButton\" class=\"epi-clearButton\">&nbsp;</div>\r\n            <div data-dojo-attach-point=\"resourceName\" class=\"dijitInline epi-resourceName dojoxEllipsis\"/>\r\n                <span data-dojo-attach-point=\"selectedContentNameNode\"></span> <span data-dojo-attach-point=\"selectedContentLinkNode\"></span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div data-dojo-type=\"dijit.form.Button\" data-dojo-attach-event=\"onClick: _onButtonClick\" data-dojo-attach-point=\"button\" data-dojo-props=\"label:'...'\"></div>\r\n</div>"}});define("epi/cms/widget/ContentSelector",["dojo","dojo/dom-class","dojo/dom-style","dojo/_base/Deferred","dojo/query","dijit","dijit/focus","dijit/_Widget","dijit/_TemplatedMixin","dijit/_CssStateMixin","dijit/_WidgetsInTemplateMixin","dijit/Tooltip","dijit/form/Button","dijit/layout/ContentPane","epi","epi/dependency","epi/shell/widget/dialog/Dialog","epi/cms/widget/_HasClearButton","epi/cms/widget/_HasChildDialogMixin","epi/cms/widget/_Droppable","epi/cms/widget/ContentSelectorDialog","epi/shell/widget/_ValueRequiredMixin","dojo/text!./templates/ContentSelector.html","epi/i18n!epi/cms/nls/episerver.cms.widget.PageSelector"],function(dojo,_13a5,_13a6,_13a7,query,dijit,_13a8,_13a9,_13aa,_13ab,_13ac,_13ad,_13ae,_13af,epi,_13b0,_13b1,_13b2,_13b3,_13b4,_13b5,_13b6,_13b7,_13b8){return dojo.declare("epi.cms.widget.ContentSelector",[_13a9,_13aa,_13ac,_13ab,_13b2,_13b3,_13b4,_13b6],{templateString:_13b7,localization:_13b8,root:null,typeIdentifiers:null,value:null,required:false,missingMessage:"",tooltipPosition:[],contentLink:null,canSelectOwnerContent:true,_dropTarget:null,_setSelectedContentNameAttr:function(value){query(this.selectedContentNameNode).text(value);},_setSelectedContentLinkAttr:{node:"selectedContentLinkNode",type:"innerHTML"},postMixInProperties:function(){this.inherited(arguments);var _13b9=_13b0.resolve("epi.storeregistry");this._store=_13b9.get("epi.cms.content.light");this.acceptDataTypes=this.acceptDataTypes||["epi.cms.pagereference"];},_setReadOnlyAttr:function(value){this._set("readOnly",value);_13a6.set(this.button.domNode,"display",value?"none":"");_13a6.set(this.clearButton,"display",value?"none":"");_13a5.toggle(this.domNode,"dijitReadOnly",value);},_setValueAttr:function(value){this._setValueAndFireOnChange(value);},_getDialog:function(){if(this.dialog){return this.dialog;}var _13ba=new _13a7();dojo.when(this._getContentData(this.contentLink),dojo.hitch(this,function(_13bb){this.contentSelector=new _13b5({canSelectOwnerContent:this.canSelectOwnerContent&&_13bb&&_13bb.capabilities&&!_13bb.capabilities.isBlock,showButtons:false,root:this.root,typeIdentifiers:this.typeIdentifiers});this.dialog=new _13b1({title:this.localization.popuptitle,dialogClass:"epi-dialog-portrait",content:this.contentSelector});this.connect(this.dialog,"onExecute","_onDialogExecute");this.connect(this.dialog,"onHide","_onDialogHide");_13ba.resolve(this.dialog);}));return _13ba;},_onButtonClick:function(){dojo.when(this._getDialog(),dojo.hitch(this,function(_13bc){this.isShowingChildDialog=true;this.contentSelector.set("value",this.value);_13bc.show();}));},_onDialogExecute:function(){var value=this.contentSelector.get("value");this._setValueAndFireOnChange(value);},_onDialogHide:function(){this.isShowingChildDialog=false;},_setValueAndFireOnChange:function(value){var _13bd=value==="-"?this.contentLink:value;dojo.when(this._getContentData(_13bd),dojo.hitch(this,function(_13be){var _13bf=this.value!==_13bd;this.value=_13bd;this._started&&this.validate();this._updateDisplayNode(_13be);if(_13bf){this.onChange(_13bd);}}));},_getContentData:function(_13c0){if(!_13c0){return null;}return this._store.get(_13c0);},_getValueAttr:function(){return this.value;},_onBlur:function(){this.inherited(arguments);this.validate();},focus:function(){this.button.focus();},onChange:function(value){},_updateDisplayNode:function(_13c1){if(_13c1){dojo.removeClass(this.domNode,"epi-noValue");dojo.removeClass(this.resourceName,"dijitPlaceHolder");this.set("selectedContentName",_13c1.name);this.set("selectedContentLink",_13c1.contentLink);}else{dojo.addClass(this.domNode,"epi-noValue");dojo.addClass(this.resourceName,"dijitPlaceHolder");this.set("selectedContentName",this.localization.helptext);this.set("selectedContentLink","");}}});});},"epi/cms/component/Versions":function(){define("epi/cms/component/Versions",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/_base/Deferred","dojo/_base/connect","dojo/aspect","dojo/dom-class","dojo/on","dojo/string","dojo/topic","dgrid/OnDemandGrid","dgrid/Selection","epi/shell/widget/Tooltip","epi/username","epi/shell/command/withConfirmation","epi/dependency","epi/cms/component/command/DeleteVersion","epi/cms/component/command/SetCommonDraft","epi/cms/contentediting/ContentActionSupport","epi/cms/core/ContentReference","epi/cms/widget/_GridWidgetBase","epi/i18n!epi/cms/nls/episerver.cms.components.versions","epi/shell/command/_WidgetCommandProviderMixin","epi/cms/component/command/ShowAllLanguages","epi/shell/widget/dialog/Alert","epi/shell/widget/dialog/Confirmation","epi/shell/widget/_FocusableMixin"],function(array,_13c2,lang,_13c3,_13c4,_13c5,_13c6,on,_13c7,topic,_13c8,_13c9,_13ca,_13cb,_13cc,_13cd,_13ce,_13cf,_13d0,_13d1,_13d2,_13d3,_13d4,_13d5,Alert,_13d6,_13d7){return _13c2("epi.cms.component.Versions",[_13d2,_13d4,_13d7],{showAllLanguages:false,isMultiLingual:false,_tooltips:[],postMixInProperties:function(){this._commonDrafts={};this.storeKeyName="epi.cms.contentversion";this.ignoreVersionWhenComparingLinks=false;this.inherited(arguments);var _13d8=_13cd.resolve("epi.cms.Application");this._currentContentLanguage=_13d8.currentContentLanguage();this.connect(this.store,"onItemChanged","_onItemChanged");},buildRendering:function(){this.inherited(arguments);var _13d9=dojo.declare([_13c8,_13c9]);this.grid=new _13d9({columns:{language:{label:epi.resources.header.language},statusName:{label:epi.resources.header.status,renderCell:function(item,value,node,_13da){var html=item.statusName;if(item.isCommonDraft){html="<span class=\"dijitReset dijitInline dijitIcon epi-iconPrimary epi-floatRight\"></span>"+item.statusName;}node.innerHTML=html;}},savedDate:{label:epi.resources.header.saved,formatter:this._localizeDate},savedBy:{label:epi.resources.header.by,formatter:this._createUserFriendlyUsername}},store:this.store,selectionMode:"single",sort:[{attribute:"savedDate",descending:true}]},this.domNode);},postCreate:function(){this.add("commands",new _13d5({model:this}));this._commonDraftCommand=new _13cf();_13c5.after(this._commonDraftCommand,"execute",lang.hitch(this,function(_13db){_13db.then(null,lang.hitch(this,this._onSetCommonDraftFailure));}));this._deleteVersionCommand=new _13ce();_13c5.after(this._deleteVersionCommand,"execute",lang.hitch(this,function(_13dc){_13dc.then(lang.hitch(this,this._onDeleteVersionSuccess),lang.hitch(this,this._onDeleteVersionFailure));}));this.add("commands",this._commonDraftCommand);this.add("commands",_13cc(this._deleteVersionCommand,null,{title:_13d3.deletemenuitemtitle,heading:_13d3.deleteversion.note,description:_13d3.deleteversion.confirmquestion}));},startup:function(){if(this._started){return;}this.inherited(arguments);_13c5.around(this.grid,"renderRow",lang.hitch(this,this._aroundRenderRow));this._toggleLanguage(false);this.fetchData();_13c4.subscribe("/epi/cms/action/pageexpirationchange",lang.hitch(this,function(_13dd){this.grid.set("store",this.store);}));},_setShowAllLanguagesAttr:function(value){this._set("showAllLanguages",value);this._toggleFilterByLanguage(value);},destroy:function(){this.inherited(arguments);this._destroyTooltips();},_onItemChanged:function(){this.fetchData();},fetchData:function(){_13c3.when(this.getCurrentContent(),lang.hitch(this,function(item){if(!item){return;}this._destroyTooltips();if(item.accessMask&&!_13d0.hasAccess(item.accessMask,_13d0.accessLevel.Edit)||item.providerCapabilityMask&&!_13d0.hasProviderCapability(item.providerCapabilityMask,_13d0.providerCapabilities.Edit)){this._showErrorMessage(epi.resources.messages.nopermissiontoviewdata);this.set("isMultiLingual",false);return;}var query={contentLink:item.contentLink};if(!this._allLanguages){query.language=this._currentContentLanguage;}this.grid.set("query",query);this.set("isMultiLingual",true);}));},_destroyTooltips:function(){array.forEach(this._tooltips,function(_13de){_13de.destroyRecursive();});this._tooltips=[];},_aroundRenderRow:function(_13df){return lang.hitch(this,function(item){if(item.isCommonDraft){var _13e0=this._commonDrafts[item.language];if(_13e0&&_13e0!=item.contentLink){this._removeCommonDraft(_13e0);}this._commonDrafts[item.language]=item.contentLink;}var row=_13df.apply(this.grid,arguments);_13c6.toggle(row,"dgrid-row-published",item.status===_13d0.versionStatus.Published);this._createTooltip(item,row);return row;});},_onSelect:function(e){var item=e.rows[0].data;this._updateMenu(item);this.inherited(arguments);},_updateMenu:function(item){this._commonDraftCommand.set("model",item);this._deleteVersionCommand.set("model",item);},_showNotificationMessage:function(_13e1){var _13e2=new Alert({title:_13d3.notificationtitle,description:_13e1});_13e2.show();},_selectCommonDraftVersion:function(uri){var _13e3={uri:uri};topic.publish("/epi/shell/context/request",_13e3,{sender:null});},_onDeleteVersionSuccess:function(){var _13e4=new _13d1(this.grid.get("query").contentLink);this._selectCommonDraftVersion("epi.cms.contentdata:///"+_13e4.id);},_onDeleteVersionFailure:function(_13e5){if(!_13e5||!_13e5.status){return;}else{if(_13e5.status===403){this._showNotificationMessage(_13d3.deleteversion.cannotdeletepublished);}else{this._showNotificationMessage(_13d3.deleteversion.cannotdelete);}}},_onSetCommonDraftFailure:function(){this._showNotificationMessage(_13d3.setcommondraft.failuremessage);},_removeCommonDraft:function(_13e6){if(_13e6){var item=this.grid.row(_13e6).data;if(item){item.isCommonDraft=false;this.store.put(item);}}},_toggleFilterByLanguage:function(_13e7){var query={contentLink:this.currentContext.id};if(!_13e7){query.language=this._currentContentLanguage;}this._toggleLanguage(_13e7);this.grid.set("query",query);this._allLanguages=_13e7;},_toggleLanguage:function(_13e8){var value=_13e8?"table-cell":"none";this.grid.styleColumn("language",_13c7.substitute("display:${0};",[value]));},_createTooltip:function(item,row){var _13e9=[{label:epi.resources.header.language,text:epi.resources.language[item.language]},{label:epi.resources.header.name,text:item.name},{label:epi.resources.header.status,text:_13d0.getVersionStatus(item.status)},{label:_13d3.saved,text:this._localizeDate(item.savedDate),htmlEncode:false},{label:_13d3.by,text:_13cb.toUserFriendlyString(item.savedBy,null,true)}];var _13ea=new _13ca({connectId:row,tooltipRows:_13e9});this._tooltips.push(_13ea);}});});},"epi/cms/widget/_ContentListMouseMixin":function(){define("epi/cms/widget/_ContentListMouseMixin",["dojo/_base/declare","dojo/dom-class"],function(_13eb,_13ec){return _13eb("epi.cms.widget._ContentListMouseMixin",null,{onHover:function(node){},onUnhover:function(node){},onSelect:function(node){_13ec.add(node,"dgrid-selected ui-state-active dgrid-focus");},onDeselect:function(node){_13ec.remove(node,"dgrid-selected ui-state-active dgrid-focus");}});});},"epi/shell/command/OptionCommand":function(){define(["dojo/_base/declare","epi/shell/command/_Command"],function(_13ed,_13ee){return _13ed([_13ee],{options:null,selected:null,property:null,postscript:function(){this.inherited(arguments);this.watch("selected",function(name,_13ef,_13f0){if(_13ef!==_13f0){this.execute();}});},_execute:function(){this.model.set(this.property,this.selected);},_onModelChange:function(){var model=this.model;this.set("canExecute",!!model);this.set("selected",model&&model[this.property]);}});});},"epi/cms/contentediting/editors/PreviewableDateTimeEditor":function(){define("epi/cms/contentediting/editors/PreviewableDateTimeEditor",["dojo/_base/declare","dojo/dom-construct","epi/datetime","epi/shell/widget/DateTimeSelectorDropDown","epi/cms/contentediting/editors/_PreviewableEditor"],function(_13f1,_13f2,_13f3,_13f4,_13f5){return _13f1("epi.cms.contentediting.editors.PreviewableDateTimeEditor",[_13f5],{required:false,controlParams:["required"],buildRendering:function(){this.control=new _13f4({datePackage:null});this.inherited(arguments);},onChange:function(val){this.set("labelValue",_13f3.toUserFriendlyHtml(val));}});});},"epi/cms/widget/BlockList":function(){define("epi/cms/widget/BlockList",["dojo/_base/declare","dojo/dom-construct","dojo/_base/lang","dojo/_base/array","dojo/_base/Deferred","dojo/_base/connect","dojo/dnd/Source","dojo/dom-style","dojo/store/Memory","dojo/dom-class","dojo/query","dojo/aspect","dojo/Stateful","dojox/html/entities","dijit/_Widget","dijit/layout/_LayoutWidget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dgrid/OnDemandGrid","dgrid/Selection","dgrid/Keyboard","epi","epi/dependency","epi/shell/command/_WidgetCommandProviderMixin","epi/shell/command/withConfirmation","epi/shell/selection","epi/shell/dgrid/Formatter","epi/shell/_StatefulGetterSetterMixin","epi/cms/command/CopyContent","epi/cms/command/CutContent","epi/cms/command/DeleteContent","epi/cms/component/command/ChangeContext","epi/cms/contentediting/ContentActionSupport","epi/cms/widget/BlockListViewModel","epi/cms/widget/ContextMenu","epi/cms/widget/sharedContentDialogHandler","epi/cms/dgrid/DnD","epi/i18n!epi/cms/nls/episerver.cms.components.sharedblockscomponent"],function(_13f6,_13f7,lang,array,_13f8,_13f9,_13fa,_13fb,_13fc,_13fd,query,_13fe,_13ff,_1400,_1401,_1402,_1403,_1404,_1405,_1406,_1407,epi,_1408,_1409,_140a,_140b,_140c,_140d,_140e,_140f,_1410,_1411,_1412,_1413,_1414,_1415,DnD,res){return _13f6("epi.cms.widget.BlockList",[_1401,_1409,_13ff,_140d],{clipboardManager:null,_source:null,selectedFolder:null,currentContext:null,contentActionSupport:null,_res:res,dndTypes:["epi.cms.blockreference","epi.cms.contentreference"],_mouseOverClass:"epi-dgrid-mouseover",_contentTypeStore:null,store:null,constructor:function(){this.selection=new _140b();},postMixInProperties:function(){this.inherited(arguments);var _1416=_1408.resolve("epi.storeregistry");this._contentTypeStore=_1416.get("epi.cms.contenttype");var _1417=function(){return _1416.get("epi.cms.content.light");};this.store=this.store||_1417();this.contentActionSupport=this.contentActionSupport||_1412;},buildRendering:function(){this.inherited(arguments);var self=this;var _1418=_13f6([_1405,_1406,_1407,DnD,_140c]);this.grid=new _1418({columns:{icon:{renderCell:function(item,value,node,_1419){node.innerHTML="<span class='dijitInline dijitIcon epi-iconObjectSharedBlock'></span>";}},name:{renderCell:function(item,value,node,_141a){value=_1400.encode(value);_13f8.when(self._contentTypeStore.get(item.contentTypeID),function(_141b){var title=value+" ("+_141b.localizedName+")";var _141c="<div class=\"dojoxEllipsis\" title=\"{0}\">{1}</div>";node.innerHTML=lang.replace(_141c,[title,value]);});}},"contextmenu":{renderCell:function(item,value,node,_141d){var _141e="<div class='epi-blockListEditAction' title='{0}'>                                            <span class='dijitInline dijitIcon epi-iconContextMenu' title ='{1}'>&nbsp;</span><div>";node.innerHTML=lang.replace(_141e,[epi.resources.action.edit,res.blockmenu]);}}},noDataMessage:this._getNoDataMessage(),selectionMode:"single",deselectOnRefresh:false,dndSourceType:self.dndTypes,dndParams:{creator:self._blockNodeCreator,copyOnly:true,selfAccept:false,accept:[]}},this.domNode);this.grid.set("showHeader",false);},postCreate:function(){this.inherited(arguments);var self=this;this.watch("selectedFolder",lang.hitch(this,function(){this.model.contentData=this.selectedFolder;this.grid.set("noDataMessage",this._getNoDataMessage());_13f8.when(this._bindingData(),lang.hitch(this,function(){this._updateCuttingRowUI();}));}));this.contextMenu=new _1414();this.contextMenu.addProvider(this);this.grid.on(".epi-createBlock:click",function(){self.createCommand.execute();});this.grid.on(".dgrid-row:click",function(event){var row=self.grid.row(event);self.onSelectionChange(row.data);});this.grid.on(".dgrid-row:dblclick",lang.hitch(this,function(event){if(this._editCommand.canExecute){this._editCommand.execute();}}));this.grid.on(".dgrid-row:mouseover",function(event){_13fd.add(this,self._mouseOverClass);});this.grid.on(".dgrid-row:mouseout",function(event){_13fd.remove(this,self._mouseOverClass);});this.grid.on(".epi-iconContextMenu:click",function(evt){self.contextMenu.scheduleOpen(this,null,{x:evt.pageX,y:evt.pageY});});this.connect(this.store,"onItemChanged","_onItemChanged");this.connect(this.getParent(),"onFocus","_onParentFocused");},startup:function(){if(this._started){return;}this.inherited(arguments);this.model=new _1413({store:this.store});_13f9.connect(this.model,"onDelete",this,this._onDeleted);this._setupCommands();},destroy:function(){if(this.grid){this.grid.destroy();this.grid=null;}if(this.contextMenu){this.contextMenu.destroyRecursive();this.contextMenu=null;}this.inherited(arguments);},_onParentFocused:function(){this._selectActiveBlock();},_bindingData:function(){var self=this,_141f=new _13f8();if(self.model){_13f8.when(self.model.fetchData(),function(_1420){var _1421=new _13fc({data:_1420,idProperty:"contentLink"});self.grid.set("store",_1421);_141f.resolve();});}return _141f;},_setupCommands:function(){var _1422={category:"context",model:this.model,selection:this.selection,clipboard:this.clipboardManager};this._editCommand=new _1411({category:"context",forceContextChange:true});this.set("commands",[this._editCommand,new _140f(_1422),new _140e(_1422),_140a(new _1410(_1422),_1415,{selection:this.selection})]);},_blockNodeCreator:function(item,hint){node=_13f7.create("div").appendChild(document.createTextNode(item.name));return {"node":node,"type":lang.clone(this.dndTypes),"data":item};},_selectActiveBlock:function(){this.grid.clearSelection();var _1423=this._selectedBlockContentLink?this._selectedBlockContentLink:(this.currentContext?this.currentContext.id:null);if(_1423){var row=this._getRow(_1423);if(row){this.grid.select(row);if(row.data){this.onSelectionChange(row.data);}return;}}},restore:function(){this.resize();},onSelectionChange:function(item){var _1424=item?[{type:"epi.cms.contentdata",data:item}]:[];if(item){this._selectedBlockContentLink=item.contentLink;}this._editCommand.set("model",item);this.selection.set("data",_1424);},_onPaste:function(){},_onDeleted:function(_1425){var _1426=this.clipboardManager.getDataObject(),item=_1426?_1426[0]:null;if(item&&item.data.contentLink===_1425.contentLink){this.clipboardManager.clear();}_13f8.when(this._bindingData(),lang.hitch(this,function(){this.onSelectionChange();}));},_onItemChanged:function(id,item){_13f8.when(this._bindingData(),lang.hitch(this,function(){this._updateCuttingRowUI();}));},highlightItem:function(_1427){if(_1427){this._selectedBlockContentLink=_1427;this._selectActiveBlock();}},showCommands:function(){this._setCommandVisbility(true);},hideCommands:function(){this._setCommandVisbility(false);},_setCommandVisbility:function(_1428){array.forEach(this.commands,function(_1429){_1429.set("isAvailable",_1428);});},_getRow:function(_142a){return this.grid.row(_142a.match("^[0-9]*")[0]);},toggleCuttingRowUI:function(item,isCut){if(item!=null){var row=this._getRow(item.contentLink);if(row&&row.element){_13fd.toggle(row.element,"epi-opacity50",isCut);}}},_updateCuttingRowUI:function(){if(!this.clipboardManager.isCopy()){var _142b=this.clipboardManager.getDataObject(),_142c=_142b!=null?_142b[0].data:null;this.toggleCuttingRowUI(_142c,true);}},_setCreateCommandAttr:function(_142d){this._set("createCommand",_142d);if(this.commandHandle){this.commandHandle.unwatch();}this.commandHandle=_142d.watch("canExecute",lang.hitch(this,function(){this.grid.set("noDataMessage",this._getNoDataMessage());}));},_getNoDataMessage:function(){var _142e="";if(this.createCommand&&this.createCommand.canExecute){_142e="<span class=\"epi-createBlock\">                        <span class=\"dijitReset dijitInline dijitIcon epi-iconPlus\"></span>                        <span class=\"dijitReset dijitInline\">"+res.linktocreateblock+"</span>                    </span>";}return _142e;}});});},"epi/cms/widget/CategorySelectorDialog":function(){define("epi/cms/widget/CategorySelectorDialog",["epi","dojo","dijit","dojo/i18n","dijit/_Widget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","epi/cms/widget/CategoryTree","dijit/form/Button","epi/dependency"],function(epi,dojo,dijit,i18n,_142f,_1430,_1431,_1432,_1433,_1434){return dojo.declare("epi.cms.widget.CategorySelectorDialog",[_142f,_1430,_1431],{templateString:"<div class=\"epi-categorySelectorDialog\">                            <div data-dojo-attach-point=\"tree\" data-dojo-type=\"epi.cms.widget.CategoryTree\" data-dojo-attach-event=\"onOpen: _onOpen, onClose: _onClose\"></div>                         </div>",_categories:null,_categoriesParentsName:{},postCreate:function(){this.inherited(arguments);this.connect(this.tree,"onTreeNodeCheckBoxChange",dojo.hitch(this,this._onCategoryCheckBoxChange));this.connect(this.tree,"onTreeNodeCreated",dojo.hitch(this,this._onCategoryNodeCreated));},_onCategoryNodeCreated:function(_1435,item){if(this._categories==null){return;}var _1436=this._categories.indexOf(item.id)!=-1;_1435.setCheckAttribute(_1436);if(!item.hasChildren){return;}this._updateSelectedChildrenCount(item,_1435);},_onCategoryCheckBoxChange:function(_1437,item){var index=this._categories.indexOf(item.id);var exist=index!=-1;var _1438=this.tree.getTreeNodeById(item.id);if(_1438==null){return;}var _1439=_1438.getParent();if(_1437&&!exist){while(_1439!=this.tree.rootNode){this._incrementSelectedCount(_1439);_1439=_1439.getParent();}this._incrementSelectedCount(this.tree.rootNode);this._categories.push(item.id);this._categoriesParentsName[item.id]=item.parentsNameCollection;}if(!_1437&&exist){while(_1439!=this.tree.rootNode){this._decrementSelectedCount(_1439);_1439=_1439.getParent();}this._decrementSelectedCount(this.tree.rootNode);this._categories.splice(index,1);this._categoriesParentsName[item.id]={};}},_onOpen:function(item,node){node.updateLabel();},_onClose:function(item,node){node.updateLabel();},_setSelectedCount:function(node,_143a){if(node==null){return;}node.setSelectedChildrenCount(_143a);},_incrementSelectedCount:function(node){if(node==null){return;}var value=this._getSelectedCount(node);this._setSelectedCount(node,value+1);},_decrementSelectedCount:function(node){if(node==null){return;}var value=this._getSelectedCount(node);this._setSelectedCount(node,value-1);},_getSelectedCount:function(node){if(node==null){return 0;}return node.getSelectedChildrenCount();},_updateSelectedChildrenCount:function(item,_143b){var count=0;dojo.forEach(this._categories,dojo.hitch(this,function(_143c){if(item.id!=_143c){var _143d=false;var _143e=this._categoriesParentsName[_143c];if(item.parentsNameCollection.length<_143e.length){_143d=true;for(i=0;i<item.parentsNameCollection.length;i++){if(item.parentsNameCollection[i]!=_143e[i]){_143d=false;break;}}}if(_143d){count++;}}}));this._setSelectedCount(_143b,count);},_checkCategories:function(_143f){var _1440=this.tree.getTreeNodeById(_143f.id);if(_1440==null){return;}var _1441=this._categories.indexOf(_143f.id)!=-1;_1440.setCheckAttribute(_1441);if(!_143f.hasChildren){return;}this._updateSelectedChildrenCount(_143f,_1440);dojo.forEach(_143f.children,dojo.hitch(this,function(child,i){this._checkCategories(child);}));},onShow:function(){if(this._categories==null){return;}if(this.tree&&this.tree.rootNode){this._checkCategories(this.tree.rootNode.item);}},setCategoriesParentsNameClone:function(value){this._categoriesParentsName=value;},_setValueAttr:function(value){this._categories=value;if(!this._categories){this._categories=[];}},_getValueAttr:function(){return this._categories;},getCategoryItemById:function(_1442){var node=this.tree.getTreeNodeById(_1442);if(!node){return null;}return node.item;}});});},"epi/shell/widget/Tooltip":function(){define(["dojo/_base/declare","dojo/string","dojox/html/entities","dojox/html/ellipsis","dijit/Tooltip"],function(_1443,_1444,_1445,_1446,_1447){return _1443("epi.shell.widget.Tooltip",_1447,{showDelay:600,tooltipRows:null,tooltipRowTemplate:"<span>${label}</span>: ${text}",tooltipRowNoTextTemplate:"<span>${label}</span>",postCreate:function(){if(this.tooltipRows){this.label="<ul class='dijitInline dijitReset epi-tooltip-ellipsis'>";for(var i=0;i<this.tooltipRows.length;i++){var row=this.tooltipRows[i];if(!row.text){row.text="";}if(row.htmlEncode===undefined||row.htmlEncode===true){row.label=_1445.encode(row.label);row.text=_1445.encode(row.text);}if(!row.text){this.label+="<li class='dojoxEllipsis'>"+_1444.substitute(this.tooltipRowNoTextTemplate,row)+"</li>";}else{this.label+="<li class='dojoxEllipsis'>"+_1444.substitute(this.tooltipRowTemplate,row)+"</li>";}}this.label+="</ul>";}this.inherited(arguments);}});});},"epi/cms/contentediting/editors/ContentAreaEditorViewModel":function(){define("epi/cms/contentediting/editors/ContentAreaEditorViewModel",["dojo/_base/array","dojo/_base/declare","dojo/_base/event","dojo/topic","dojo/Stateful","epi/shell/command/_CommandProviderMixin","epi/cms/contentediting/command/BlockRemove","epi/cms/contentediting/command/BlockEdit","epi/cms/contentediting/command/BlockMoveUp","epi/cms/contentediting/command/BlockMoveDown"],function(array,_1448,event,topic,_1449,_144a,_144b,_144c,_144d,_144e){return _1448("epi.cms.contentediting.editors.ContentAreaEditorViewModel",[_1449,_144a],{selectedItem:null,_childItems:null,isTop:false,isBottom:false,constructor:function(){this._childItems=[];this._setupCommands();},onChildrenChange:function(){},find:function(){return this._childItems;},add:function(child){this._childItems.push(child);},getItemByIndex:function(index){return this._childItems[index];},getItemIndex:function(child){return array.indexOf(this._childItems,child);},getNext:function(_144f){var index=array.indexOf(this._childItems,_144f);if(index<this._childItems.length-1){return this._childItems[index+1];}return null;},getPrev:function(_1450){var index=array.indexOf(this._childItems,_1450);if(index>0){return this._childItems[index-1];}return null;},clear:function(){for(var i=this._childItems.length-1;i>=0;i--){delete this._childItems[i];}this._childItems=[];},swap:function(_1451,_1452){var _1453=array.indexOf(this._childItems,_1451);var _1454=array.indexOf(this._childItems,_1452);if(_1453>=0&&_1454>=0){this._childItems[_1453]=_1452;this._childItems[_1454]=_1451;_1453=_1451.index;_1451.index=_1452.index;_1452.index=_1453;}},move:function(item,index){var _1455=this._childItems[index];if(_1455){this.swap(item,_1455);}},getValue:function(){var value=array.map(this._childItems,function(item){return item.getValue();},this);return value;},setSelectedItem:function(value){this.selectedItem=value;this.isTop=(this.selectedItem.index===0);this.isBottom=(this.selectedItem.index==this._childItems.length-1);this.updateCommandModel(this);},resetItemIndex:function(){array.forEach(this._childItems,function(item,index){item.isTop=false;item.isBottom=false;item.index=index;});if(this.selectedItem){this.isTop=(this.selectedItem.index===0);this.isBottom=(this.selectedItem.index==this._childItems.length-1);}},edit:function(){if(this.selectedItem){var _1456=this.selectedItem.contentLink;var _1457={uri:"epi.cms.contentdata:///"+_1456};topic.publish("/epi/shell/context/request",_1457,{});}},remove:function(child){var _1458=child||this.selectedItem;if(_1458){var index=array.indexOf(this._childItems,_1458);if(index>=0){this._childItems.splice(index,1);}this.onChildrenChange();}},moveUp:function(){this.swap(this.selectedItem,this.getItemByIndex(this.selectedItem.index-1));this.onChildrenChange();},moveDown:function(){this.swap(this.selectedItem,this.getItemByIndex(this.selectedItem.index+1));this.onChildrenChange();},_setupCommands:function(){this.set("commands",[new _144c(),new _144d(),new _144e(),new _144b()]);}});});},"epi/cms/component/GlobalToolbar":function(){require({cache:{"url:epi/cms/component/templates/GlobalToolbar.html":"<div class=\"dijit epi-globalToolbar\" role=\"toolbar\" tabIndex=\"${tabIndex}\" data-dojo-attach-point=\"containerNode\">\r\n    <div class=\"epi-toolbarGroupContainer\">\r\n        <div data-dojo-attach-point=\"leadingContainerNode\" class=\"epi-toolbarLeading epi-toolbarGroup\"></div>\r\n        <div data-dojo-attach-point=\"centerContainerNode\" class=\"epi-toolbarCenter epi-toolbarGroup\"></div>\r\n        <div data-dojo-attach-point=\"trailingContainerNode\" class=\"epi-toolbarTrailing epi-toolbarGroup\"></div>\r\n    </div>\r\n</div>"}});define("epi/cms/component/GlobalToolbar",["dojo/_base/declare","dojo/_base/lang","dojo/dom-style","dojo/store/Memory","dijit/registry","dijit/Toolbar","epi/shell/command/_CommandModelBindingMixin","epi/shell/command/_WidgetCommandConsumerMixin","epi/shell/command/builder/_Builder","epi/shell/command/builder/GroupedButtonBuilder","epi/shell/command/builder/MenuAssembler","epi/shell/command/builder/DropDownButtonBuilder","dojo/text!./templates/GlobalToolbar.html","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons"],function(_1459,lang,_145a,_145b,_145c,_145d,_145e,_145f,_1460,_1461,_1462,_1463,_1464,_1465){var _1466=_1459([_1460],{_create:function(_1467){var _1468=_1459([_1467.settings.widget,_145e]),_1469=new _1468(_1467.settings);return _1469;},_addToContainer:function(_146a,_146b){_146a.placeAt(_146b);_146a.startup();}});var _146c=_1459([_1462],{_getBuildInfo:function(_146d){if(_146d.settings.category){var i=this.configuration.length-1;for(;i>0;i--){if(this.configuration[i].category==_146d.settings.category){return this.configuration[i];}}}return this.configuration[0];}});return _1459("epi.cms.component.GlobalToolbar",[_145d,_145f],{templateString:_1464,commandKey:"epi.cms.globalToolbar",postCreate:function(){this.inherited(arguments);var _146e=new _1466();var _146f=new _1463({settings:{title:_1465.createcontent.title,"class":"epi-mediumButton epi-disabledDropdownArrow",iconClass:"epi-iconPlus",showLabel:false}});var _1470=new _1461({settings:{baseClass:"epi-mediumButton epi-expandoButton"}});var _1471=[{category:"leading",builder:_146e,target:this.leadingContainerNode},{category:"view",builder:_1470,target:this.leadingContainerNode},{category:"center",builder:_146e,target:this.centerContainerNode},{category:"trailing",builder:_146e,target:this.trailingContainerNode},{category:"create",builder:_146f,target:this.leadingContainerNode}];var _1472=new _146c({configuration:_1471,commandSource:this});_1472.build();},_getNextFocusableChild:function(child,dir){var _1473=this.getChildren();var index=_1473.indexOf(child);index=(dir>0)?index+1:index-1;if(index<0){index=_1473.length-1;}else{if(index>=_1473.length){index=0;}}return _1473[index];}});});},"epi/cms/component/SharedBlocks":function(){require({cache:{"url:epi/cms/component/templates/SharedBlocks.html":"<div>\r\n    <div class=\"epi-gadgetInnerToolbar\" data-dojo-attach-point=\"searchBoxContainer\">\r\n        <div data-dojo-type=\"epi.cms.widget.SearchBox\" data-dojo-attach-point=\"searchBox\" ></div>\r\n    </div>\r\n    <div data-dojo-attach-point=\"container\" data-dojo-type=\"dijit.layout.BorderContainer\" class=\"epi-sharedBlockContainer\">\r\n        <div data-dojo-type=\"dijit.layout.ContentPane\" data-dojo-props=\"splitter:false, region:'center'\" class=\"epi-widgetResizeContent epi-secondaryGadgetContainer epi-gadgetTopContainer\" data-dojo-attach-point=\"folderContainerNode\">\r\n            <div data-dojo-attach-point=\"folderList\" data-dojo-type=\"epi.cms.widget.FolderList\"></div>\r\n        </div>\r\n        <div data-dojo-type=\"dijit.layout.ContentPane\" class=\"epi-blockContainer\" data-dojo-props=\"region:'bottom', splitter:true\">\r\n            <div data-dojo-attach-point=\"blockList\" data-dojo-type=\"epi.cms.widget.BlockList\" ></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n"}});define("epi/cms/component/SharedBlocks",["dojo/_base/declare","dojo/_base/array","dojo/_base/lang","dojo/_base/connect","dojo/_base/Deferred","dojo/dom-geometry","dojo/dom-class","dijit/_Widget","dijit/layout/_LayoutWidget","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dijit/Tree","dijit/layout/BorderContainer","dijit/layout/ContentPane","epi","epi/dependency","epi/UriParser","epi/shell/ClipboardManager","epi/shell/command/_WidgetCommandProviderMixin","epi/shell/command/OptionCommand","epi/shell/widget/layout/ComponentContainer","epi/cms/_ContentContextMixin","epi/cms/command/NewContent","epi/cms/component/ContentFilter","epi/cms/component/command/ViewTrash","epi/cms/widget/FolderList","epi/cms/widget/BlockList","epi/cms/widget/SearchBox","epi/shell/widget/_FocusableMixin","dojo/text!./templates/SharedBlocks.html","epi/i18n!epi/cms/nls/episerver.cms.components.createblock"],function(_1474,array,lang,_1475,_1476,_1477,_1478,_1479,_147a,_147b,_147c,Tree,_147d,_147e,epi,_147f,_1480,_1481,_1482,_1483,_1484,_1485,_1486,_1487,_1488,_1489,_148a,_148b,_148c,_148d,_148e){var _148f={rootMenu:0,folderMenu:1,blockMenu:2};var _1490={folderType:3,blockType:4};return _1474("epi.cms.component.SharedBlocks",[_1479,_147a,_147b,_147c,_1482,_1485],{_tree:null,templateString:_148d,_copyModeBlock:"SharedBlocks.CopyMode.Block",_copyModeFolder:"SharedBlocks.CopyMode.Folder",_copyMode:null,_clipboardManager:null,_currentFolder:null,_folderMenuType:null,_application:null,typeIdentifiers:["epi.cms.folder","epi.cms.block"],_componentsController:null,_widgetResizeHandle:null,postMixInProperties:function(){this._componentsController=_147f.resolve("epi.shell.controller.Components");this._application=this._application||_147f.resolve("epi.cms.Application");this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this.searchBox.set("area","cms/blocks");_1476.when(this._getFolderRoots(),lang.hitch(this,function(_1491){this.searchBox.set("searchRoots",_1491.join(","));}));this.searchBox.onItemAction=lang.hitch(this,function(value){var _1492=value.metadata;this._highlightSelectedBlock(_1492.id,_1492.parentId);});this.connect(this.folderList,"onFolderChanged",this._onFolderChanged);this.connect(this.folderList,"onResize",lang.hitch(this,this._onResize));this.connect(this.blockList,"onSelectionChange",this._onBlockChanged);this._initCommonComponents();this._clipboardManager.watch("data",lang.hitch(this,this._onClipboardChanged));},startup:function(){if(this._started){return;}this.inherited(arguments);this._newCommand=new _1486({contentType:_1487.BlockType,iconClass:"epi-iconPlus",label:_148e.command.label,resources:_148e});this.add("commands",this._newCommand);this.blockList.set("createCommand",this._newCommand);this.add("commands",new _1488({typeIdentifiers:this.typeIdentifiers}));_1476.when(this.getCurrentContent(),lang.hitch(this,function(_1493){this.contentContextChanged(lang.mixin(_1493,{id:_1493.contentLink}),this);}));this.connect(this.getParent(),"onResize","_onResize");},restore:function(){this.resize();},_onResize:function(){this.resize({h:_1477.getMarginBox(this.domNode).h});this.onResize();},onResize:function(){},resize:function(size){this.inherited(arguments);var _1494=_1477.getMarginBox(this.searchBoxContainer);this.container.resize({h:size.h-_1494.h});},_onFolderChanged:function(_1495){this.blockList.set("selectedFolder",_1495.item);this._newCommand.set("model",_1495.item);this._folderMenuType=_1495.isRootNode?_148f.rootMenu:_148f.folderMenu;this.toggleContext(this._folderMenuType);this._toggleActive(this.folderList,this.blockList);},_onBlockChanged:function(_1496){if(_1496){this.toggleContext(_148f.blockMenu);}else{this.toggleContext(this._folderMenuType?this._folderMenuType:_148f.rootMenu);if(this.blockList.currentContext){this._highlightSelectedBlock(this.blockList.currentContext.id,this.blockList.currentContext.parentLink);}}this._toggleActive(this.blockList,this.folderList);},_toggleActive:function(_1497,_1498){_1478.remove(_1498.domNode,"epi-focused");_1478.add(_1497.domNode,"epi-focused");},contentContextChanged:function(_1499,_149a){if(!_1499||!_1499.id||!_1499.capabilities||!_1499.capabilities.isBlock){return;}var _149b=_1499;_1476.when(this.folderList.highlightNode(_149b.parentLink),lang.hitch(this,function(){this.blockList.set("currentContext",_149b);_1476.when(this.getCurrentContent(),lang.hitch(this,function(_149c){if(_149c.isDeleted===true){this.folderList.highlightNode(this.folderList.siteBlockFolder);return;}this.blockList.highlightItem(_149c.contentLink);this.blockList.onSelectionChange(_149c);}));}));},_initCommonComponents:function(){this._initClipboard();},_initClipboard:function(){this._clipboardManager=new _1481();this.folderList._tree.clipboardManager=this._clipboardManager;this.blockList.clipboardManager=this._clipboardManager;},_clearClipboard:function(){if(this._clipboardManager){this._clipboardManager.clear();}},_canPaste:function(_149d){var _149e=this.blockList.selectedFolder;if(!_149d.item){return _149e.contentLink!==_149d.parentLink;}var _149f=_149d.item||page;if(_149e.contentLink===_149f.parentLink){return false;}},toggleContext:function(type){switch(type){case _148f.rootMenu:this.blockList.hideCommands();this.folderList.showCommands(true);break;case _148f.folderMenu:this.blockList.hideCommands();this.folderList.showCommands(false);break;case _148f.blockMenu:this.blockList.showCommands();this.folderList.hideCommands();break;default:break;}},_toggleMenuItem:function(_14a0,_14a1,_14a2){if(_14a0&&_14a0["disableItem"]){_14a0["disableItem"](_14a1,_14a2);}},_getFolderRoots:function(){var _14a3=this._application.getSiteBlockFolder();var _14a4=this._application.getGlobalBlockFolder();var _14a5=[];if(_14a4){_14a5.push(_14a4);}if(_14a3&&!epi.areEqual(_14a4,_14a3)){_14a5.push(_14a3);}return _14a5;},_highlightSelectedBlock:function(_14a6,_14a7){if(!_14a6||!_14a7){return;}_1476.when(this.folderList.highlightNode(_14a7),lang.hitch(this,function(){this.blockList.highlightItem(_14a6);}));},_onClipboardChanged:function(){var _14a8=this._clipboardManager.getDataObject(),_14a9=_14a8!=null?_14a8[0].data:null;if(this._previousCutItem!=null){if(this._previousCutItem.contentTypeID==_1490.folderType){this.folderList.toggleCuttingNodeUI(this._previousCutItem,false);}else{this.blockList.toggleCuttingRowUI(this._previousCutItem,false);}}if(!this._clipboardManager.isCopy()&&_14a9!=null){this._previousCutItem=_14a9;if(this._previousCutItem.contentTypeID==_1490.folderType){this.folderList.toggleCuttingNodeUI(this._previousCutItem,true);}else{this.blockList.toggleCuttingRowUI(this._previousCutItem,true);}}else{this._previousCutItem=null;}}});});},"url:dijit/templates/Tree.html":"<div class=\"dijitTree dijitTreeContainer\" role=\"tree\"\n\tdata-dojo-attach-event=\"onkeypress:_onKeyPress\">\n\t<div class=\"dijitInline dijitTreeIndent\" style=\"position: absolute; top: -9999px\" data-dojo-attach-point=\"indentDetector\"></div>\n</div>\n","epi/cms/widget/NotificationStatusBar":function(){require({cache:{"url:epi/cms/widget/templates/NotificationStatusBar.html":"<div>\r\n    <div class=\"epi-dijitTooltipTitleBar\">\r\n        <span class=\"epi-dijitTooltipTitle\">${res.title}</span>\r\n        <span class=\"epi-closeButton dijitDialogCloseIcon\" data-dojo-attach-point=\"closeIcon\" title=\"${res.title}\" role=\"button\"></span>\r\n    </div>\r\n    <div class=\"epi-dijitTooltipContent\" data-dojo-attach-point=\"zoneLayoutNode\">\r\n        <div data-dojo-attach-point=\"zoneContainer\">\r\n            <div data-dojo-type=\"epi.cms.widget.NotificationStatusZone\" data-dojo-attach-point=\"errorZone\" data-dojo-props=\"title: '${res.errortitle}', type: 'error'\"></div>\r\n            <div data-dojo-type=\"epi.cms.widget.NotificationStatusZone\" data-dojo-attach-point=\"warningZone\" data-dojo-props=\"title: '${res.warningtitle}', type: 'warning'\"></div>\r\n            <div data-dojo-type=\"epi.cms.widget.NotificationStatusZone\" data-dojo-attach-point=\"infoZone\"  data-dojo-props=\"title: '${res.notetitle}', type: 'note'\"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n"}});define("epi/cms/widget/NotificationStatusBar",["dojo","dojo/_base/declare","dijit/_Widget","epi/cms/widget/TooltipDialog","epi/dependency","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dojo/text!./templates/NotificationStatusBar.html","dojox/html/entities","epi/i18n!epi/cms/nls/episerver.cms.widget.statusbar.notificationstatus","dijit/layout/BorderContainer","epi/cms/widget/NotificationStatusZone"],function(dojo,_14aa,_14ab,_14ac,_14ad,_14ae,_14af,_14b0,_14b1,_14b2,_14b3,_14b4){return _14aa("epi.cms.widget.NotificationStatusBar",[_14ab,_14ae,_14af],{res:_14b2,templateString:_14b0,_itemTemplate:"<li>{message}</li>",_notificationTooltipDialogCssClass:"epi-notificationToolipDialog epi-notificationToolipDialogCompact",_dimmedOutCssClass:"epi-notificationIcon-DimmedOut",_notificationErrorClass:"epi-notificationIcon-Error",_notificationWarningClass:"epi-notificationIcon-Warning",_notificationNoteClass:"epi-notificationIcon-Note",_totalNotifications:0,messageContext:null,_tooltipDialog:null,messageService:null,_observeHandle:null,zoneContainer:null,page:null,baseClass:"epi-notificationIcon",postMixInProperties:function(){this.inherited(arguments);this.messageService=this.messageService||_14ad.resolve("epi.shell.MessageService");},postCreate:function(){this.inherited(arguments);this._tooltipDialog=new _14ac({connectorMargin:47,hideOnBlur:true,content:this.zoneLayoutNode});this._buildIconBlock();dojo.addClass(this._tooltipDialog.domNode,this._notificationTooltipDialogCssClass);this.connect(this.domNode,"onclick",dojo.hitch(this,this._show));this.connect(this.closeIcon,"onclick",dojo.hitch(this,this._hideTooltip));this.subscribe("/epi/cms/action/showerror",this.show);},update:function(_14b5){this._hideTooltip();this.messageContext=_14b5;this._listenMessagePool();this._updateUI();},destroy:function(){this._unListenMessagePool();this.inherited(arguments);},_listenMessagePool:function(){this._unListenMessagePool();this._observeHandle=this.messageService.observe(this.messageContext,dojo.hitch(this,function(){this._updateUI();}));},_unListenMessagePool:function(){if(this._observeHandle){this._observeHandle.cancel();delete this._observeHandle;}},getMessages:function(_14b6){var query=(_14b6)?dojo.mixin({typeName:_14b6},this.messageContext):this.messageContext;return this.messageService.query(query);},_updateNotificationZone:function(zone,_14b7,items){if(items&&items.length>0){dojo.forEach(items,function(item){zone.addRow(dojo.replace(_14b7,{message:_14b1.encode(item.message)}),"last");});zone.show();}else{zone.hide();}},_updateUI:function(){this.errorZone.empty();this.warningZone.empty();this.infoZone.empty();var _14b8=this.getMessages("error");var _14b9=this.getMessages("warn");var _14ba=this.getMessages("info");this._totalNotifications=_14b8.length+_14b9.length+_14ba.length;this._buildIconBlock();this._updateNotificationZone(this.errorZone,this._itemTemplate,_14b8);this._updateNotificationZone(this.warningZone,this._itemTemplate,_14b9);this._updateNotificationZone(this.infoZone,this._itemTemplate,_14ba);this._updateIconStatus(_14b8.length,_14b9.length,_14ba.length);},_buildIconBlock:function(){this.domNode.innerHTML=this._totalNotifications;if(this._totalNotifications===0){dojo.addClass(this.domNode,this._dimmedOutCssClass);dojo.removeClass(this.domNode,this._notificationNoteClass);dojo.removeClass(this.domNode,this._notificationWarningClass);dojo.removeClass(this.domNode,this._notificationErrorClass);this._hideTooltip();}else{dojo.removeClass(this.domNode,this._dimmedOutCssClass);}},_updateIconStatus:function(_14bb,_14bc,_14bd){if(_14bb){dojo.addClass(this.domNode,this._notificationErrorClass);dojo.removeClass(this.domNode,this._notificationNoteClass);dojo.removeClass(this.domNode,this._notificationWarningClass);}else{if(_14bc){dojo.addClass(this.domNode,this._notificationWarningClass);dojo.removeClass(this.domNode,this._notificationNoteClass);}else{if(_14bd){dojo.addClass(this.domNode,this._notificationNoteClass);}}}},_setPageAttr:function(value){this._set("page",value);this.update({contextTypeName:"epi.cms.contentdata",contextId:value.contentLink});},show:function(){this._keepShowing=true;this._showTooltip();},_show:function(e){if(e){dojo.stopEvent(e);}this._showTooltip();},_showTooltip:function(){if(this._totalNotifications===0){return;}this._tooltipDialog.showTooltipDialog(this.domNode,["below-alt"]);},_hideTooltip:function(){this._tooltipDialog.hideTooltipDialog();}});});},"url:epi/cms/widget/templates/_ItemSelector.html":"<div>\r\n    <div class=\"epi-tooltipDialogTop\">\r\n        <span data-dojo-attach-point=\"header\"></span>\r\n        <div data-dojo-attach-point=\"lastPublishedIcon\" class=\"dijitTooltipConnector\"></div>\r\n    </div>\r\n    \r\n    <div dojoType=\"dijit.Menu\" data-dojo-attach-point=\"menuNode\" contextMenuForWindow=\"false\" class=\"epi-DropDownMenu\"></div>\r\n</div>","dijit/form/_ComboBoxMenu":function(){define("dijit/form/_ComboBoxMenu",["dojo/_base/declare","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dojo/keys","../_WidgetBase","../_TemplatedMixin","./_ComboBoxMenuMixin","./_ListMouseMixin"],function(_14be,_14bf,_14c0,_14c1,keys,_14c2,_14c3,_14c4,_14c5){return _14be("dijit.form._ComboBoxMenu",[_14c2,_14c3,_14c5,_14c4],{templateString:"<div class='dijitReset dijitMenu' data-dojo-attach-point='containerNode' style='overflow: auto; overflow-x: hidden;'>"+"<div class='dijitMenuItem dijitMenuPreviousButton' data-dojo-attach-point='previousButton' role='option'></div>"+"<div class='dijitMenuItem dijitMenuNextButton' data-dojo-attach-point='nextButton' role='option'></div>"+"</div>",baseClass:"dijitComboBoxMenu",postCreate:function(){this.inherited(arguments);if(!this.isLeftToRight()){_14bf.add(this.previousButton,"dijitMenuItemRtl");_14bf.add(this.nextButton,"dijitMenuItemRtl");}},_createMenuItem:function(){return _14c0.create("div",{"class":"dijitReset dijitMenuItem"+(this.isLeftToRight()?"":" dijitMenuItemRtl"),role:"option"});},onHover:function(node){_14bf.add(node,"dijitMenuItemHover");},onUnhover:function(node){_14bf.remove(node,"dijitMenuItemHover");},onSelect:function(node){_14bf.add(node,"dijitMenuItemSelected");},onDeselect:function(node){_14bf.remove(node,"dijitMenuItemSelected");},_page:function(up){var _14c6=0;var _14c7=this.domNode.scrollTop;var _14c8=_14c1.get(this.domNode,"height");if(!this.getHighlightedOption()){this.selectNextNode();}while(_14c6<_14c8){var _14c9=this.getHighlightedOption();if(up){if(!_14c9.previousSibling||_14c9.previousSibling.style.display=="none"){break;}this.selectPreviousNode();}else{if(!_14c9.nextSibling||_14c9.nextSibling.style.display=="none"){break;}this.selectNextNode();}var _14ca=this.domNode.scrollTop;_14c6+=(_14ca-_14c7)*(up?-1:1);_14c7=_14ca;}},handleKey:function(evt){switch(evt.charOrCode){case keys.DOWN_ARROW:this.selectNextNode();return false;case keys.PAGE_DOWN:this._page(false);return false;case keys.UP_ARROW:this.selectPreviousNode();return false;case keys.PAGE_UP:this._page(true);return false;default:return true;}}});});},"epi/cms/contentediting/command/AccessRights":function(){define("epi/cms/contentediting/command/AccessRights",["dojo/_base/declare","epi/cms/contentediting/ContentActionSupport","epi/cms/contentediting/command/_LegacyDialogCommandBase","epi/i18n!epi/cms/nls/episerver.cms.contentediting.contentdetails.command.accessrights"],function(_14cb,_14cc,_14cd,_14ce){return _14cb([_14cd],{name:"AccessRights",label:_14ce.label,tooltip:_14ce.tooltip,dialogPath:"Edit/EditSecurity.aspx",raiseCloseEvent:true,postscript:function(){this.inherited(arguments);this.set("canExecute",true);this.set("isAvailable",true);},_onModelChange:function(){var _14cf=this.model.contentData,_14d0=_14cc.hasAccess(_14cf.accessMask,_14cc.accessLevel.Administer),_14d1=this.model.canChangeContent();this.set("canExecute",_14cf.capabilities.securable&&_14d0&&_14d1);}});});},"url:epi/cms/widget/templates/Trash.html":"<div class=\"epi-trash\">\r\n    <div class=\"epi-listingTopContainer\">\r\n        <h1 class=\"dijitInline\">${resources.heading}</h1>\r\n        <div class=\"epi-mediumButton epi-boldButton epi-emptyCommand\" data-dojo-attach-point=\"emptyTrashMenu\" data-dojo-type=\"epi.cms.widget.EmptyTrashMenu\"\r\n            data-dojo-props=\"title: '${resources.emptytrash.tooltip}'\"></div>\r\n    </div>\r\n    <div data-dojo-attach-point=\"stackContainer\">\r\n        <div data-dojo-type=\"dijit.layout.TabContainer\" data-dojo-attach-point=\"tabContainer\" data-dojo-props=\"doLayout:false, useMenu:true, useSlider:false\"> <!-- doLayout=\"false\" for flexible height -->\r\n        </div>\r\n    </div>\r\n</div>\r\n","epi/cms/contentediting/command/IgnoreInUseNotification":function(){define(["dojo/_base/declare","epi/dependency","epi/shell/command/_Command","epi/i18n!epi/cms/nls/episerver.cms.contentediting.toolbar.buttons"],function(_14d2,_14d3,_14d4,_14d5){return _14d2([_14d4],{name:"IgnoreInUseNotification",label:_14d5.ignoreinusenotification.label,tooltip:_14d5.ignoreinusenotification.title,iconClass:"epi-iconPen",inUseNotificationManager:null,postscript:function(){this.inherited(arguments);if(this.inUseNotificationManager===null){this.inUseNotificationManager=_14d3.resolve("epi.cms.contentediting.inUseNotificationManager");}this.set("canExecute",true);this.set("isAvailable",true);},_execute:function(){this.inUseNotificationManager.ignoreOthersNotifications=true;this.model.viewName=null;this._requestContextChange(this.model.contentData.uri,true);},_onModelChange:function(){var _14d6=this.model.contentData,_14d7=this.inUseNotificationManager.hasInUseNotificationWarning(_14d6.inUseNotifications),_14d8,_14d9;_14d8=this.inUseNotificationManager.ignoreOthersNotifications;this.inUseNotificationManager.ignoreOthersNotifications=true;_14d9=this.model.canChangeContent();this.inUseNotificationManager.ignoreOthersNotifications=_14d8;this.set("isAvailable",_14d7&&_14d9);},_requestContextChange:function(uri,_14da){var _14db={uri:uri};var _14dc={sender:this,forceContextChange:_14da};dojo.publish("/epi/shell/context/request",[_14db,_14dc]);}});});},"epi/cms/widget/command/EmptyTrash":function(){define("epi/cms/widget/command/EmptyTrash",["dojo/_base/declare","epi/shell/command/_Command"],function(_14dd,_14de){return _14dd([_14de],{label:null,tooltip:null,trashId:null,_execute:function(){if(this.canExecute){this.model.emptyTrash(this.trashId);}},_onModelChange:function(){var _14df=!!this.trashId;this.set("canExecute",_14df);}});});},"url:epi/shell/widget/templates/SearchBox.html":"<div class=\"dijit dijitReset dijitInline dijitLeft dijitTextBox epi-searchInput epi-contentSearchBox\" id=\"widget_${id}\">\r\n    <span data-dojo-attach-point=\"clearButton\" class=\"dijitReset dijitRight epi-clearButton\" role=\"presentation\"></span>\r\n    <div class=\"dijitReset dijitInputField dijitInputContainer\">\r\n        <input data-dojo-attach-point=\"textbox,focusNode\" type=\"text\" class=\"dijitReset dijitInputInner\" role=\"textbox\" />\r\n        <span class=\"dijitPlaceHolder dijitInputField\" data-dojo-attach-point=\"_phspan,placeHolderNode\"></span>\r\n    </div>\r\n</div>","url:epi/cms/contentediting/editors/templates/ContentBlockEditor.html":"<div class=\"epi-content-block-editor\">\r\n    <a href=\"#\" data-dojo-attach-point=\"itemNode\" style=\"display: block;\" data-dojo-attach-event=\"onclick:_onClick\">\r\n        <span data-dojo-attach-point=\"contentNode\" class=\"epi-content-block-node\">\r\n            <span data-dojo-attach-point=\"labelNode\" class=\"dojoxEllipsis\"></span>\r\n            <span data-dojo-attach-point=\"extraIconsContainer\" class=\"epi-floatRight\">\r\n                <span data-dojo-attach-point=\"iconNodeMenu\" class=\"epi-iconContextMenu\" style=\"visibility: hidden;\" data-dojo-attach-event=\"onclick:_onContextMenu\"></span>\r\n            </span>\r\n        </span>\r\n    </a>\r\n</div>","epi/shell/widget/overlay/OverlayItemInfo":function(){define(["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/dom-construct","dojo/dom-style","dijit/_TemplatedMixin","dijit/_Widget","dijit/_WidgetsInTemplateMixin","dojox/html/entities","epi/string","epi/shell/widget/Tooltip","dojo/text!./templates/OverlayItemInfo.html"],function(array,_14e0,lang,_14e1,_14e2,_14e3,_14e4,_14e5,_14e6,_14e7,_14e8,_14e9,_14ea){return _14e0("epi.shell.widget.overlay.OverlayItemInfo",[_14e5,_14e4,_14e6],{templateString:_14ea,postCreate:function(){this.inherited(arguments);this.showStatusMessage(false);},destroy:function(){this.inherited(arguments);this._destroyTooltip();},showStatusMessage:function(_14eb){if(this._tooltip){_14eb?this._tooltip.open(this.domNode):this._tooltip.close();}},_setStatusMessageAttr:function(_14ec){if(!_14ec){return;}var _14ed=lang.isArray(_14ec);if(this._tooltip){if(_14ed){this._tooltip.tooltipRows=_14ec;}else{this._tooltip.label=_14e7.encode(_14ec);}}else{var _14ee=_14e2.create("div",{"class":"epi-overlay-content-tooltip",innerHTML:_14e8.toHTML(_14e7.encode(_14ec))}),_14ef=_14ed?{tooltipRows:_14ec}:{label:_14ee.outerHTML};this._tooltip=new _14e9(_14ef);}},_destroyTooltip:function(){if(this._tooltip){this._tooltip.destroyRecursive();this._tooltip=null;}}});});},"epi/cms/contentediting/ValidationTextboxWithWarning":function(){define("epi/cms/contentediting/ValidationTextboxWithWarning",["dojo/_base/declare","dojox/validate/regexp","dijit/form/ValidationTextBox"],function(_14f0,_14f1,_14f2){return _14f0([_14f2],{regExpForWarning:null,acceptUrl:false,acceptMailAddress:false,_refreshState:function(){this.focused?this._validateWhenTyping():this.validate(false);},_isValidWhenTyping:function(){var value=this.textbox.value;return (this.acceptUrl&&(new RegExp(_14f1.url({scheme:true}))).test(value))||(this.acceptMailAddress&&(new RegExp("mailto\\:"+_14f1.emailAddress())).test(value))||(this.regExpForWarning&&(new RegExp("^(?:"+this.regExpForWarning+")"+(this.required?"":"?")+"$")).test(value));},_validateWhenTyping:function(){var _14f3="";var _14f4=this.disabled||this.isValid(true);if(_14f4){this._maskValidSubsetError=true;}var _14f5=this._isEmpty(this.textbox.value);var _14f6=!_14f4&&this._isValidSubset();this._set("state",_14f4?(this._isValidWhenTyping()?"":"Incomplete"):(((_14f5||_14f6)&&this._maskValidSubsetError)?"Incomplete":"Error"));this.focusNode.setAttribute("aria-invalid",_14f4?"false":"true");if(this.state=="Error"){this._maskValidSubsetError=_14f6;_14f3=this.getErrorMessage(true);}else{if(this.state=="Incomplete"){_14f3=this.getPromptMessage(true);this._maskValidSubsetError=!this._hasBeenBlurred;}else{if(_14f5){_14f3=this.getPromptMessage(true);}}}this.set("message",_14f3);return _14f4;}});});},"dijit/form/DataList":function(){define("dijit/form/DataList",["dojo/_base/declare","dojo/dom","dojo/_base/lang","dojo/query","dojo/store/Memory","../registry"],function(_14f7,dom,lang,query,_14f8,_14f9){function _14fa(_14fb){return {id:_14fb.value,value:_14fb.value,name:lang.trim(_14fb.innerText||_14fb.textContent||"")};};return _14f7("dijit.form.DataList",_14f8,{constructor:function(_14fc,_14fd){this.domNode=dom.byId(_14fd);lang.mixin(this,_14fc);if(this.id){_14f9.add(this);}this.domNode.style.display="none";this.inherited(arguments,[{data:query("option",this.domNode).map(_14fa)}]);},destroy:function(){_14f9.remove(this.id);},fetchSelectedItem:function(){var _14fe=query("> option[selected]",this.domNode)[0]||query("> option",this.domNode)[0];return _14fe&&_14fa(_14fe);}});});},"epi/cms/contentediting/ShortcutDialog":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/dom-style","dojo/dom-class","dojo/html","dijit/_CssStateMixin","epi/cms/widget/Breadcrumb","epi/shell/widget/dialog/_DialogContentMixin","epi/shell/widget/FormContainer","epi/shell/widget/_ModelBindingMixin","epi/shell/widget/_ActionProviderWidget","dojo/text!./templates/ShortcutDialog.html","epi/i18n!epi/cms/nls/episerver.cms.widget.shortcutblockeditor","epi/i18n!epi/cms/nls/shell.common.buttons"],function(_14ff,lang,_1500,_1501,html,_1502,_1503,_1504,_1505,_1506,_1507,_1508,res,_1509){return _14ff("epi.cms.contentediting.ShortcutDialog",[_1505,_1507,_1504,_1502,_1506],{templateString:_1508,contentLink:null,contentName:null,baseClass:"epi-statusIndicator",_externalLinkWidget:null,_shortcutLinkWidget:null,_shortcutTypeWidget:null,_targetFrameWidget:null,_switchLinkTypeFirstRunDone:false,modelBindingMap:{"contentLink":["contentLink"],"contentName":["contentName"],"enableSaveButton":["enableSaveButton"],"enableShortcutLink":["enableShortcutLink"],"enableExternalLink":["enableExternalLink"],"clearExternalLink":["clearExternalLink"]},_setContentLinkAttr:function(value){this.breadcrumb.set("contentLink",value);},_setContentNameAttr:{node:"contentNameNode",type:"innerHTML"},_setEnableSaveButtonAttr:function(value){if(this._actions&&this._actions.length){this.setActionProperty("save","disabled",!value);}},_setEnableShortcutLinkAttr:function(value){if(this._shortcutLinkWidget){this._shortcutLinkWidget.set("required",value);this._shortcutLinkWidget.set("state","");var _150a=this._getAncestorNode(this._shortcutLinkWidget.domNode,"epi-formsRow");if(_150a){_1500.set(_150a,"display",value?"":"none");}}},_setEnableExternalLinkAttr:function(value){if(this._externalLinkWidget){this._externalLinkWidget.set("required",value);this._externalLinkWidget.set("disabled",!value);this._externalLinkWidget._set("state","");var _150b=this._getAncestorNode(this._externalLinkWidget.domNode,"epi-formsRow");if(_150b){_1500.set(_150b,"display",value?"":"none");}}},_getAncestorNode:function(node,_150c){var _150d=node?node.parentNode:null;if(!_150d){return null;}if(!_1501.contains(_150d,_150c)){return this._getAncestorNode(_150d,_150c);}return _150d;},_setClearExternalLinkAttr:function(value){if(this._externalLinkWidget&&value&&!this._switchLinkTypeFirstRunDone){this._externalLinkWidget.reset();this._switchLinkTypeFirstRunDone=true;}},onFieldCreated:function(_150e,_150f){switch(_150e){case "pageLinkURL":this._externalLinkWidget=_150f;this._externalLinkWidget.set("invalidMessage",res.protocolwarning);this._externalLinkWidget.set("acceptUrl",true);this._externalLinkWidget.set("acceptMailAddress",true);this._externalLinkWidget.set("regExp","^[a-z][a-z\\d+-.]*:.*");this.connect(this._externalLinkWidget.domNode,"onkeyup",lang.hitch(this,function(evt){this.model.set("enableSaveButton",true);}));break;case "pageShortcutLink":this._shortcutLinkWidget=_150f;this._shortcutLinkWidget.set("contentLink",this.model.get("contentLink"));this._shortcutLinkWidget.set("canSelectOwnerContent",false);break;case "pageShortcutType":this._shortcutTypeWidget=_150f;break;case "pageTargetFrame":this._targetFrameWidget=_150f;break;default:break;}},onChange:function(value){this.inherited(arguments);this.model.set("intermediateValue",lang.mixin(value,{"pageShortcutTypeName":this._shortcutTypeWidget?this._shortcutTypeWidget.get("displayedValue"):""}));},_getValueAttr:function(){return this.model.get("intermediateValue");},getActions:function(){this._actions=[{name:"save",label:_1509.save,settings:{type:"button",disabled:true,"class":"Salt"},action:lang.hitch(this,function(){if(this.validate()){this.executeDialog();}else{this.model.set("enableSaveButton",false);}})},{name:"cancel",label:_1509.cancel,settings:{type:"button"},action:lang.hitch(this,function(){this.cancelDialog();})}];return this._actions;}});});},"dijit/form/_ListBase":function(){define("dijit/form/_ListBase",["dojo/_base/declare","dojo/window"],function(_1510,_1511){return _1510("dijit.form._ListBase",null,{selected:null,_getTarget:function(evt){var tgt=evt.target;var _1512=this.containerNode;if(tgt==_1512||tgt==this.domNode){return null;}while(tgt&&tgt.parentNode!=_1512){tgt=tgt.parentNode;}return tgt;},selectFirstNode:function(){var first=this.containerNode.firstChild;while(first&&first.style.display=="none"){first=first.nextSibling;}this._setSelectedAttr(first);},selectLastNode:function(){var last=this.containerNode.lastChild;while(last&&last.style.display=="none"){last=last.previousSibling;}this._setSelectedAttr(last);},selectNextNode:function(){var _1513=this._getSelectedAttr();if(!_1513){this.selectFirstNode();}else{var next=_1513.nextSibling;while(next&&next.style.display=="none"){next=next.nextSibling;}if(!next){this.selectFirstNode();}else{this._setSelectedAttr(next);}}},selectPreviousNode:function(){var _1514=this._getSelectedAttr();if(!_1514){this.selectLastNode();}else{var prev=_1514.previousSibling;while(prev&&prev.style.display=="none"){prev=prev.previousSibling;}if(!prev){this.selectLastNode();}else{this._setSelectedAttr(prev);}}},_setSelectedAttr:function(node){if(this.selected!=node){var _1515=this._getSelectedAttr();if(_1515){this.onDeselect(_1515);this.selected=null;}if(node&&node.parentNode==this.containerNode){this.selected=node;_1511.scrollIntoView(node);this.onSelect(node);}}else{if(node){this.onSelect(node);}}},_getSelectedAttr:function(){var v=this.selected;return (v&&v.parentNode==this.containerNode)?v:(this.selected=null);}});});},"epi/cms/component/FileManagement":function(){require({cache:{"url:epi/cms/component/templates/FileManagement.html":"<div style=\"position: relative;\">\r\n    <iframe frameborder=\"0\" data-dojo-attach-point=\"containerIframe\" style=\"display: block; width: 100%; height: 100%\"></iframe>\r\n    <div data-dojo-attach-point=\"dndItemOverlay\" style=\"display: none; overflow:hidden; position: absolute; background: rgba(0, 0, 0, 0.01);\"></div>\r\n    <div data-dojo-attach-point=\"dndIFrameOverlay\" style=\"display: none; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0, 0, 0, 0.01);\"></div>\r\n</div>"}});define("epi/cms/component/FileManagement",["dojo/_base/declare","dojo/_base/lang","dojo/_base/array","dojo/_base/event","dojo/_base/connect","dojo/dnd/Source","dojo/dom-attr","dojo/dom-construct","dojo/dom-geometry","dojo/dom-style","dojo/Evented","dojo/keys","dojo/NodeList-dom","dojo/on","dojo/query","dijit/layout/_LayoutWidget","dijit/_TemplatedMixin","dijit/form/Button","epi","epi/dependency","epi/routes","epi/shell/widget/dialog/Dialog","epi/cms/widget/FilesUploadDropZone","epi/cms/widget/MultipleFileUpload","epi/cms/widget/UploadUtil","dojo/text!./templates/FileManagement.html","epi/i18n!epi/cms/nls/episerver.cms.widget.uploadmultiplefiles.uploadform"],function(_1516,lang,array,event,_1517,_1518,_1519,_151a,_151b,_151c,_151d,keys,_151e,on,query,_151f,_1520,_1521,epi,_1522,_1523,_1524,_1525,_1526,_1527,_1528,_1529){return _1516("epi.cms.component.FileManagement",[_151f,_1520,_151d],{container:null,_source:null,_dialog:null,_navigatorArea:null,_fileManagementBody:null,_addFileButton:null,_filesUploadDropZone:null,_uploadDirectory:null,_breadcrumbParts:null,_dropZoneCreated:false,_disableDndOnUpload:false,_uploading:false,templateString:_1528,constructor:function(){this._connections=[];},postCreate:function(){this.inherited(arguments);this.subscribe("/epi/shell/context/changed",lang.hitch(this,function(_152a){if(!_152a.capabilities.contentResources){return;}if(typeof this.containerIframe.contentWindow.virtualPathChanged=="function"){this.containerIframe.contentWindow.virtualPathChanged("pageAndVersionId:"+_152a.id);}}));this._source=new _1518(this.dndItemOverlay,{creator:lang.hitch(this,this._dndSourceItemCreator),copyOnly:true,selfAccept:false,selfCopy:false,accept:[]});this.connect(this.dndItemOverlay,"onmouseout",function(evt){this._updateItemOverlay(null);});this.connect(this.dndItemOverlay,"onclick",function(evt){event.stop(evt);var item=this.currentOverlayItem,_152b=this.containerIframe;_152b.contentWindow.handleClick({target:item,currentTarget:item,bubbles:true,cancelable:true,which:1,ctrlKey:_1517.isCopyKey(evt)});});this.connect(this.dndItemOverlay,"oncontextmenu",this._onContextMenu);this.connect(this.dndItemOverlay,"dblclick",this._handleDblClick);this.subscribe("/dnd/start",function(){this._updateIframeOverlay(true);});this.subscribe("/dnd/cancel",function(){this._updateIframeOverlay(false);});this.subscribe("/dnd/drop",function(){this._updateIframeOverlay(false);});},startup:function(){if(this._started){return;}var _152c=_1522.resolve("epi.shell.ContextService");var _152d=(_152c.currentContext!=null)?_152c.currentContext.id:"";var _152e=_1523.getActionPath({moduleArea:"LegacyCMS",path:"Edit/FileManagerBrowser.aspx",IsInLegacyWrapper:true,id:_152d});_1519.set(this.containerIframe,"src",_152e);this.connect(this.containerIframe,"onload",lang.hitch(this,this._onIframeLoad));this.inherited(arguments);},destroy:function(){this._detachEvents();delete this._connections;this.inherited(arguments);},currentOverlayItem:null,currentOverlayItemHtml:"",setCurrentOverlayItem:function(item,data){this._updateItemOverlay(item);this._source.selectAll();this._source.deleteSelectedNodes();this._source.insertNodes(true,[{type:["fileurl"],data:data}]);},_dndSourceItemCreator:function(item,hint){var node;if(hint=="avatar"){node=_151a.create("div",{innerHTML:this.currentOverlayItemHtml});}else{node=_151a.create("div",{innerHTML:"&nbsp;"});_151c.set(node,{"background":"rgba(0, 0, 0, 0.01)","position":"absolute","top":"0","left":"0","right":"0","bottom":"0"});}return {"node":node,"type":item.type,"data":item.data};},_updateItemOverlay:function(item){this.currentOverlayItem=item;this.currentOverlayItemHtml=item?String(item.innerHTML):"";if(this.currentOverlayItem){var pos=_151b.position(this.currentOverlayItem,true);_151c.set(this.dndItemOverlay,{left:pos.x+"px",top:pos.y+"px",width:pos.w+"px",height:pos.h+"px",display:"block"});}else{_151c.set(this.dndItemOverlay,"display","none");}},_updateIframeOverlay:function(show){_151c.set(this.dndIFrameOverlay,"display",(show?"block":"none"));},_getMousePositionInFrame:function(evt){var item=this.currentOverlayItem;var _152f=this.containerIframe;var iPos=_151b.position(_152f,true);var pos=_151b.position(item,true);var oPos={x:Math.floor(evt.clientX-iPos.x),y:Math.floor(evt.clientY-iPos.y)};return oPos;},_onContextMenu:function(evt){var item=this.currentOverlayItem;var _1530=this.containerIframe;var oPos=this._getMousePositionInFrame(evt);_151c.set(this.dndItemOverlay,"display","none");event.stop(evt);_1530.contentWindow.handleItemClick({target:item,currentTarget:item,clientX:oPos.x,clientY:oPos.y,preventDefault:function(){},stopPropagation:function(){},metaKey:0,ctrlKey:0},true);},_handleDblClick:function(evt){var item=this.currentOverlayItem;var _1531=this.containerIframe;var oPos=this._getMousePositionInFrame(evt);_151c.set(this.dndItemOverlay,"display","none");event.stop(evt);_1531.contentWindow.handleDblClick({target:item,currentTarget:item,clientX:oPos.x,clientY:oPos.y,preventDefault:function(){},stopPropagation:function(){},metaKey:0,ctrlKey:0});},_onIframeLoad:function(){this._detachEvents();var _1532=this;function _1533(evt){var url=this.attributes["dhtmlpath"].value;_1532.setCurrentOverlayItem(this,url);};this.get("fileManagementBody").query("a.FM-FileLink[dhtmltype=\"File\"]").connect("onmouseover",_1533);this.get("fileManagementBody")[0].className+="Sleek";this._setupMultipleFileUpload();},_setupMultipleFileUpload:function(){var _1534=lang.hitch(this,function(evt){this._showUploadForm(null);});var _1535=this.get("addFileButton");if(_1535){_1517.connect(_1535,"onclick",lang.hitch(this,function(evt){event.stop(evt);_1534(evt);}));}var _1536=this.containerIframe.contentWindow.handleItemClick;this.containerIframe.contentWindow.handleItemClick=lang.hitch(this,function(e,_1537){_1536(e,_1537);if(_1537){var _1538=query(".epi-contextMenu-NewFile");if(_1538){array.forEach(_1538,function(item){var _1539=_1519.get(item,"data-clickEventConnected");if(!_1539){EPi.RemoveEventListener(item,"click",item.handleOpenMenuItem);_1517.connect(item,"onclick",lang.hitch(this,function(evt){var _153a=evt.currentTarget;if(!_153a.fEnabled){event.stop(evt);return;}_1534(evt);var _153b=document.createEvent("HTMLEvents");_153b.initEvent("click",false,true);EPi.GetDocument(window.top).dispatchEvent(_153b);}));_1519.set(item,"data-clickEventConnected","true");}},this);}}});if(_1527.supportNativeDndFiles()){var _153c=this.get("navigatorArea");if(_153c){_151c.set(_153c,"marginBottom","100px");}if(!this._dropZoneCreated){var _153d=new _1525({outsideDomNode:this.get("fileManagementBody")[0]});_151a.place(_153d.domNode,this.domNode,"last");this.connect(_153d,"onClick",lang.hitch(this,function(){this._showUploadForm(null);}));this.connect(_153d,"onDrop",this._onDrop);this._dropZoneCreated=true;}this.set("toggleDropZone",!(!_1535||_1519.get(_1535,"disabled")));}},_getNavigatorAreaAttr:function(){var _153e=this.get("fileManagementBody");if(!_153e){return;}return this._navigatorArea=_153e.query("#navigatorArea")[0];},_getFileManagementBodyAttr:function(){return this._fileManagementBody=query(this.containerIframe.contentDocument.body);},_getAddFileButtonAttr:function(){var _153f=this.get("fileManagementBody");if(!_153f){return;}return this._addFileButton=_153f.query(".epi-fileManagement-NewFile")[0];},_getFilesUploadDropZoneAttr:function(){return this._filesUploadDropZone=query(".epi-filesUploadDropZone",this.domNode)[0];},_setToggleDropZoneAttr:function(show){var _1540=this.get("filesUploadDropZone");if(_1540){_1527.toggleVisibility(_1540,show);}},_onDrop:function(evt,_1541){_1541=_1527.filterFileOnly(_1541);if(!_1541||_1541.length<=0){return;}this._showUploadForm(_1541);},_getUploadDirectoryAttr:function(){var _1542=this.get("fileManagementBody");var _1543=_1542.query("input[type=hidden][name$=\"curDirectory\"]")[0];if(_1543){return this._uploadDirectory=_1543.value;}return null;},_getBreadcrumbPartsAttr:function(){var _1544=this.get("fileManagementBody");var _1545=query(".FM-BreadCrumb >",_1544[0]);if(_1545){return this._breadcrumbParts=array.map(_1545,function(_1546){return query(_1546).text();});}return null;},_showUploadForm:function(files){var _1547=new _1526();this._dialog=new _1524({title:_1529.addfiles,content:_1547,defaultActionsVisible:false,closeIconVisible:false});_1547.on("beforeUploaderChange",lang.hitch(this,function(){this._uploading=true;}));_1547.on("uploadComplete",lang.hitch(this,function(){if(typeof this.containerIframe.contentWindow.DoEmptyPostback==="function"){this.containerIframe.contentWindow.DoEmptyPostback();if(this._dialog&&!this._dialog.open){this._dialog.destroy();}}this._uploading=false;}));_1547.on("close",lang.hitch(this,function(_1548){if(this._dialog){if(_1548){this._dialog.hide();}else{this._dialog.destroy();}}}));this._dialog.definitionConsumer.add({name:"close",label:epi.resources.action.close,action:function(){_1547.close();}});this._dialog.resize({w:700});this._dialog.show();if(!this._disableDndOnUpload){this._disableMultipleFileUploadDnd();this._disableDndOnUpload=true;}_1547.set("breadcrumb",this.get("breadcrumbParts"));_1547.set("uploadDirectory",this.get("uploadDirectory"));_1547.upload(files);},_detachEvents:function(){array.forEach(this._connections,function(item,index){try{_1517.disconnect(item);}catch(e){}});this._connections=[];},_disableMultipleFileUploadDnd:function(){var _1549=lang.hitch(this,function(evt){if(this._uploading){if(evt.preventDefault){evt.preventDefault();}try{evt.dataTransfer.effectAllowed="none";}catch(ex){}evt.dataTransfer.dropEffect="none";return false;}});this.connect(dijit._underlay.domNode,"dragover",_1549);this.connect(this._dialog.domNode,"dragover",_1549);}});});},"url:epi/cms/component/templates/CreateContent.html":"<div class=\"epi-createContent\">\r\n    <div class=\"epi-listingTopContainer\" data-dojo-attach-point=\"selectTypeNode\">\r\n        <h1 data-dojo-attach-point=\"titleNode\"></h1>\r\n        <div class=\"epi-breadCrumb\" data-dojo-attach-point=\"breadcrumbNode\" data-dojo-type=\"epi.cms.widget.Breadcrumb\" data-dojo-props=\"showLastBracket:true\"></div>\r\n        <label data-dojo-attach-point=\"contentNameLabelNode\"></label>\r\n        <input type=\"text\" size=\"40\" data-dojo-attach-point=\"contentNameNode\" data-dojo-type=\"dijit.form.TextBox\" />\r\n        <div class=\"epi-cancelLink\">\r\n            <button data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"cancelButton\" data-dojo-attach-event=\"onClick: _onCancelClick\">${resources.cancel}</button>\r\n        </div>\r\n    </div>\r\n    <div class=\"epi-listingTopContainer\" data-dojo-attach-point=\"requiredPropertiesNode\" style=\"display:none\">\r\n        <h1 data-dojo-attach-point=\"selectedTypeTitle\"></h1>\r\n        <div data-dojo-attach-point=\"breadcrumbRequiredNode\" data-dojo-type=\"epi.cms.widget.Breadcrumb\"></div>\r\n        <span class=\"epi-contentName\" data-dojo-attach-point=\"contentName\"></span>\r\n    </div>\r\n    <div data-dojo-attach-point=\"stackContainer\">\r\n        <h4 data-dojo-attach-point=\"requiredPropTitleNode\" class=\"epi-formsDescriptionHeader\"></h4>\r\n    </div>\r\n</div>","*now":function(r){r(["dojo/i18n!*preload*epi/cms/nls/widgets*[\"ar\",\"ca\",\"cs\",\"da\",\"de-de\",\"el\",\"en-gb\",\"en-us\",\"es-es\",\"fi-fi\",\"fr-fr\",\"he-il\",\"hu\",\"it-it\",\"ja-jp\",\"ko-kr\",\"nl-nl\",\"nb\",\"pl\",\"pt-br\",\"pt-pt\",\"ru\",\"sk\",\"sl\",\"sv\",\"th\",\"tr\",\"zh-tw\",\"zh-cn\",\"ROOT\"]"]);}}});