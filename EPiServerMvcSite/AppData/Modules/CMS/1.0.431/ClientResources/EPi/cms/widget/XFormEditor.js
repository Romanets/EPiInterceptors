//>>built
define("epi/cms/widget/XFormEditor",["dojo/_base/declare","dojo/_base/event","dojo/_base/lang","dojo/_base/Deferred","dojo/dom-class","dojo/dom-style","dojo/dom-construct","dojo/query","dojo/html","dijit/focus","dijit/form/Button","epi/shell/widget/dialog/Dialog","epi/dependency","epi/cms/legacy/LegacyFormEditor","epi/cms/_ContentContextMixin","epi/cms/legacy/LegacyDialogPopup","epi/routes","epi/cms/widget/XFormPropertyWidget","epi/i18n!epi/cms/nls/episerver.cms.legacy.legacyformeditor","epi/i18n!epi/cms/nls/episerver.cms.widget.xformeditor"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e,_f,_10,_11,_12,res,_13){return _1("epi.cms.widget.XFormEditor",[_e,_f],{localization:_3.mixin(res,_13),destroyOnHide:true,editorWidgetClass:_12,store:null,templateString:"            <div class=\"dijit dijitReset dijitInline dijitLeft epi-xFormEditor\" id=\"widget_${id}\" >                <div data-dojo-attach-point=\"output\" data-dojo-type=\"dijit.form.TextBox\" value=\"${localization.helptext}\"></div>                <div data-dojo-type=\"dijit.form.Button\" data-dojo-attach-point=\"openButton\" data-dojo-attach-event=\"onClick: openEditor\" data-dojo-props=\"label:'${localization.buttonlabel}'\"></div>                <a href=\"#\" data-dojo-attach-point=\"viewDataLnk\" data-dojo-attach-event=\"click: _openViewDataDialog\" title=\"${localization.viewdata.tooltip}\" class=\"disabled\">${localization.viewdata.text}</a>            </div>",postMixInProperties:function(){this.inherited(arguments);var _14=_d.resolve("epi.storeregistry");this.store=this.store||_14.get("epi.cms.xform");},openEditor:function(){this.inherited(arguments);this.onFocus();},_createDialog:function(){_3.mixin(this.params,{"contentLink":this.contentLink?this.contentLink:this.currentContext.id});this.inherited(arguments);},_openViewDataDialog:function(evt){_2.stop(evt);if(_5.contains(this.viewDataLnk,"disabled")){return;}this._showFormDataDialog("Edit/XFormViewData.aspx",this.contentLink,this.value);},_onCancel:function(){this.inherited(arguments);this.setDisplayValue(this.value);},_onDialogCancel:function(){this.inherited(arguments);this.setDisplayValue(this.value);},_showFormDataDialog:function(_15,_16,_17){var _18=_11.getActionPath({id:_16,path:_15,moduleArea:"LegacyCMS",IsInLegacyWrapper:true,formid:_17}),_19=new _10({url:_18,dialogArguments:window.document,showCancelButton:true,features:{width:750,height:300},autoFit:true,showLoadingOverlay:false});this.connect(_19,"onLoad",function(_1a){if(!_1a){return;}var h1=_8("h1[class=\"EP-prefix\"]",_1a.containerIframe.contentDocument.body);_7.create("span",{innerHTML:this.localization.viewdata.forms+" >"},h1.parent()[0],"first");var _1b=_8("select[id$=\"SelectForm\"]",_1a.containerIframe.contentDocument.body);if(_1b){_6.set(_1b.parent()[0],"display","none");}var _1c=_8("input[type=\"checkbox\"][id$=\"ShowResultFromAllPages\"]",_1a.containerIframe.contentDocument.body);if(_1c){_6.set(_1c.parent()[0],"display","none");}});_19.show();},setDisplayValue:function(_1d){if(!_1d){this.output.set("value",this.localization.helptext);_5.add(this.viewDataLnk,"disabled");return;}_4.when(this.store.query({id:_1d}),_3.hitch(this,function(_1e){if(_1e&&_1e.name){this.output.set("value",_1e.name);this.contentLink&&_5.remove(this.viewDataLnk,"disabled");}else{this.set("value",null);}this.onBlur();}));}});});