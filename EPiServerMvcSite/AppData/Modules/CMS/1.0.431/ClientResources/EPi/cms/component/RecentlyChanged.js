//>>built
define("epi/cms/component/RecentlyChanged",["dojo","dojo/_base/lang","epi","epi/cms/contentediting/ContentActionSupport","epi/cms/core/ContentReference","epi/cms/widget/_GridWidgetBase","epi/dependency","epi/i18n!epi/cms/nls/episerver.cms.components.recentlychanged","epi/shell/command/_WidgetCommandProviderMixin","epi/shell/command/OptionCommand","epi/shell/command/ToggleCommand","epi/shell/widget/layout/ComponentContainer","epi/shell/widget/dialog/Alert","epi/shell/widget/_FocusableMixin"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c,_d,_e){return _1.declare("epi.cms.component.RecentlyChanged",[_6,_9,_e],{_componentsController:null,onlyShowMyChanges:false,showItem:10,postMixInProperties:function(){this.storeKeyName="epi.cms.content.search";this._componentsController=_7.resolve("epi.shell.controller.Components");this.inherited(arguments);},buildRendering:function(){this.inherited(arguments);var _f=_2.mixin({columns:{name:{label:_3.resources.header.name,className:"epi-width50",renderCell:_2.hitch(this,this._renderContentItem)},status:{label:_3.resources.header.status,renderCell:function(_10,_11,_12,_13){_12.innerHTML=_4.getVersionStatus(_11);},className:"epi-width15"},changed:{label:_3.resources.header.saved,formatter:this._localizeDate,className:"epi-width15"},changedBy:{label:_3.resources.header.by,formatter:this._createUserFriendlyUsername,className:"epi-width10"}},store:this.store,selectionMode:"single"},this.defaultGridMixin);this.grid=new this._gridClass(_f,this.domNode);},startup:function(){if(this._started){return;}this.inherited(arguments);var _14=new _b({label:_8.showmychanges,category:"setting",model:this,property:"onlyShowMyChanges"});this.add("commands",_14);this.fetchData();},_setOnlyShowMyChangesAttr:function(_15){this._set("onlyShowMyChanges",_15);if(this._started){this._saveSettingComponent("onlyShowMyChanges",_15);}},fetchData:function(){this.grid.set("queryOptions",{ignore:["query"],sort:[{attribute:"name",descending:true}]});var _16={query:"recentlychanged",onlyShowMyChanges:this.onlyShowMyChanges};this.grid.set("query",_16);},_saveSettingComponent:function(_17,_18){var _19=this._componentsController.getComponentDefinition(this.id);var _1a=this.getParent();while(_1a){if(_1a.isInstanceOf(_c)){break;}_1a=_1a.getParent();}if(_19){_19.settings.onlyShowMyChanges=_18;this._componentsController.saveComponent(_1a,_19,function(){},function(){var _1b=new _d({description:_8.errormessage});_1b.show();});this.fetchData();}},onContextChanged:function(){this.grid.clearSelection();var _1c=new _5(this.currentContext.id).createVersionUnspecificReference().toString();var row=this.grid.row(_1c);if(row){this.grid.select(row);}}});});