//>>built
define("epi/cms/legacy/EditPropertyWidget",["epi","dojo","dijit","dojo/i18n","dojo/string","epi/cms/contentediting/RenderManager","epi/cms/legacy/LegacyDialogWrapper","epi/routes"],function(_1,_2,_3,_4,_5,_6,_7,_8){return _2.declare("epi.cms.legacy.EditPropertyWidget",[_7],{editorFeatures:null,value:"",contentLink:null,contentTypeId:null,contentLanguage:null,propertyName:null,fullName:null,_reloadOnNextEdit:false,onChange:function(_9){},postMixInProperties:function(){this.features=_2.mixin({width:400,height:30},this.editorFeatures);this.autoFit=true;this.connect(this,"onCallback","_onCallback");this.inherited(arguments);},startup:function(){this.inherited(arguments);var _a={moduleArea:"LegacyCMS",path:"edit/EditProperty.aspx",epslanguage:this.contentLanguage,propertyname:this.fullName};_2.mixin(_a,this.contentLink?{id:this.contentLink}:{contentTypeId:this.contentTypeId});this.set("url",_8.getActionPath(_a));},_setUrlAttr:function(_b){this._currentUrl=_b;var _c=_2.toJson(this.value);var _d=_5.substitute("<html><body><form method='post' action='${0}' ><input type='hidden' name='value' value='${1}' /></form></body></html>",[_b,_c]);this.containerIframe.contentDocument.write(_d);this.containerIframe.contentDocument.forms[0].submit();},_onCallback:function(_e){var _f=_e.value;var _10=_2.fromJson(_f);if(this._oldStringValue===undefined){this._oldStringValue=_2.toJson(this.value);}if(_f!==this._oldStringValue){this._oldStringValue=_2.toJson(_10);this.value=_10;this.onChange(_10);}else{this.onCancel();}},resize:function(){this.inherited(arguments);if(this._reloadOnNextEdit){this._reloadOnNextEdit=false;this._reloadUrl(true);}},_setValueAttr:function(_11){this._set("value",_11);if(this._started){this._reloadOnNextEdit=true;}}});});