//>>built
define("epi/cms/contentediting/editors/SelectionEditor",["dojo/_base/array","dojo/_base/declare","dojo/_base/lang","dojo/dom-class","dojo/on","dijit/form/Select","dijit/MenuItem","dijit/MenuSeparator","epi/shell/layout/_LayoutWidget","epi/shell/widget/_ValueRequiredMixin"],function(_1,_2,_3,_4,on,_5,_6,_7,_8,_9){return _2([_8,_5,_9],{baseClass:"dijitSelect",actualValue:null,value:null,maxHeight:-1,postMixInProperties:function(){this.inherited(arguments);this.options=_1.map(this.selections,function(_a){return {label:_a.text,value:_a.value,selected:(_a.value==this.value)||(!_a.value&&!this.value)};},this);this.actualValue=this.value;},postCreate:function(){this.inherited(arguments);on(this,"change",_3.hitch(this,function(){this.validate();this.onLayoutChanged();}));},_getMenuItemForOption:function(_b){if(_b.type=="separator"){return new _7();}else{var _c=_3.hitch(this,"_setValueAttr",_b);var _d=new _6({option:_b,label:_b.label||this.emptyLabel,onClick:_c,disabled:_b.disabled||false});_d.focusNode.setAttribute("role","listitem");return _d;}},_getValueFromOpts:function(){var _e=this.getOptions()||[];if(!this.multiple&&_e.length){var _f=_1.filter(_e,function(i){return i.selected;})[0];if(_f&&_f.value!==undefined){return _f.value;}else{_e[0].selected=true;return _e[0].value;}}else{if(this.multiple){return _1.map(_1.filter(_e,function(i){return i.selected;}),function(i){return i.value;})||[];}}return "";},_setValueAttr:function(_10,_11){var _12=this.getOptions()||[];if(_10===null||typeof _10!="object"){_10=_1.filter(_12,function(i){return (i.value==_10)||(!i.value&&!_10);});}if(!_3.isArray(_10)){_10=[_10];}if(this._onChangeActive){var _13=_10[0]?_10[0].value:null;this._pendingOnChange=this.actualValue!==_13;this.actualValue=_13;}_1.forEach(_12,function(i){i.selected=_1.some(_10,function(v){return v.value===i.value;});});var val=_1.map(_10,function(i){return i.value;}),_14=_1.map(_10,function(i){return i.label;});this._set("value",this.multiple?val:val[0]);this._setDisplay(this.multiple?_14:_14[0]);this._updateSelection();this._handleOnChange(this.value,_11);},_updateSelection:function(){this._set("value",this._getValueFromOpts());var _15=this.value;if(_15!==undefined){if(!_3.isArray(_15)){_15=[_15];}_1.forEach(this._getChildren(),function(_16){var _17=_1.some(_15,function(v){return _16.option&&(v===_16.option.value);});_4.toggle(_16.domNode,this.baseClass+"SelectedOption",_17);_16.domNode.setAttribute("aria-selected",_17);},this);}}});});