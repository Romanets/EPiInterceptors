//>>built
require({cache:{"url:epi/cms/widget/templates/NotificationStatusBar.html":"<div>\r\n    <div class=\"epi-dijitTooltipTitleBar\">\r\n        <span class=\"epi-dijitTooltipTitle\">${res.title}</span>\r\n        <span class=\"epi-closeButton dijitDialogCloseIcon\" data-dojo-attach-point=\"closeIcon\" title=\"${res.title}\" role=\"button\"></span>\r\n    </div>\r\n    <div class=\"epi-dijitTooltipContent\" data-dojo-attach-point=\"zoneLayoutNode\">\r\n        <div data-dojo-attach-point=\"zoneContainer\">\r\n            <div data-dojo-type=\"epi.cms.widget.NotificationStatusZone\" data-dojo-attach-point=\"errorZone\" data-dojo-props=\"title: '${res.errortitle}', type: 'error'\"></div>\r\n            <div data-dojo-type=\"epi.cms.widget.NotificationStatusZone\" data-dojo-attach-point=\"warningZone\" data-dojo-props=\"title: '${res.warningtitle}', type: 'warning'\"></div>\r\n            <div data-dojo-type=\"epi.cms.widget.NotificationStatusZone\" data-dojo-attach-point=\"infoZone\"  data-dojo-props=\"title: '${res.notetitle}', type: 'note'\"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n"}});define("epi/cms/widget/NotificationStatusBar",["dojo","dojo/_base/declare","dijit/_Widget","epi/cms/widget/TooltipDialog","epi/dependency","dijit/_TemplatedMixin","dijit/_WidgetsInTemplateMixin","dojo/text!./templates/NotificationStatusBar.html","dojox/html/entities","epi/i18n!epi/cms/nls/episerver.cms.widget.statusbar.notificationstatus","dijit/layout/BorderContainer","epi/cms/widget/NotificationStatusZone"],function(_1,_2,_3,_4,_5,_6,_7,_8,_9,_a,_b,_c){return _2("epi.cms.widget.NotificationStatusBar",[_3,_6,_7],{res:_a,templateString:_8,_itemTemplate:"<li>{message}</li>",_notificationTooltipDialogCssClass:"epi-notificationToolipDialog epi-notificationToolipDialogCompact",_dimmedOutCssClass:"epi-notificationIcon-DimmedOut",_notificationErrorClass:"epi-notificationIcon-Error",_notificationWarningClass:"epi-notificationIcon-Warning",_notificationNoteClass:"epi-notificationIcon-Note",_totalNotifications:0,messageContext:null,_tooltipDialog:null,messageService:null,_observeHandle:null,zoneContainer:null,page:null,baseClass:"epi-notificationIcon",postMixInProperties:function(){this.inherited(arguments);this.messageService=this.messageService||_5.resolve("epi.shell.MessageService");},postCreate:function(){this.inherited(arguments);this._tooltipDialog=new _4({connectorMargin:47,hideOnBlur:true,content:this.zoneLayoutNode});this._buildIconBlock();_1.addClass(this._tooltipDialog.domNode,this._notificationTooltipDialogCssClass);this.connect(this.domNode,"onclick",_1.hitch(this,this._show));this.connect(this.closeIcon,"onclick",_1.hitch(this,this._hideTooltip));this.subscribe("/epi/cms/action/showerror",this.show);},update:function(_d){this._hideTooltip();this.messageContext=_d;this._listenMessagePool();this._updateUI();},destroy:function(){this._unListenMessagePool();this.inherited(arguments);},_listenMessagePool:function(){this._unListenMessagePool();this._observeHandle=this.messageService.observe(this.messageContext,_1.hitch(this,function(){this._updateUI();}));},_unListenMessagePool:function(){if(this._observeHandle){this._observeHandle.cancel();delete this._observeHandle;}},getMessages:function(_e){var _f=(_e)?_1.mixin({typeName:_e},this.messageContext):this.messageContext;return this.messageService.query(_f);},_updateNotificationZone:function(_10,_11,_12){if(_12&&_12.length>0){_1.forEach(_12,function(_13){_10.addRow(_1.replace(_11,{message:_9.encode(_13.message)}),"last");});_10.show();}else{_10.hide();}},_updateUI:function(){this.errorZone.empty();this.warningZone.empty();this.infoZone.empty();var _14=this.getMessages("error");var _15=this.getMessages("warn");var _16=this.getMessages("info");this._totalNotifications=_14.length+_15.length+_16.length;this._buildIconBlock();this._updateNotificationZone(this.errorZone,this._itemTemplate,_14);this._updateNotificationZone(this.warningZone,this._itemTemplate,_15);this._updateNotificationZone(this.infoZone,this._itemTemplate,_16);this._updateIconStatus(_14.length,_15.length,_16.length);},_buildIconBlock:function(){this.domNode.innerHTML=this._totalNotifications;if(this._totalNotifications===0){_1.addClass(this.domNode,this._dimmedOutCssClass);_1.removeClass(this.domNode,this._notificationNoteClass);_1.removeClass(this.domNode,this._notificationWarningClass);_1.removeClass(this.domNode,this._notificationErrorClass);this._hideTooltip();}else{_1.removeClass(this.domNode,this._dimmedOutCssClass);}},_updateIconStatus:function(_17,_18,_19){if(_17){_1.addClass(this.domNode,this._notificationErrorClass);_1.removeClass(this.domNode,this._notificationNoteClass);_1.removeClass(this.domNode,this._notificationWarningClass);}else{if(_18){_1.addClass(this.domNode,this._notificationWarningClass);_1.removeClass(this.domNode,this._notificationNoteClass);}else{if(_19){_1.addClass(this.domNode,this._notificationNoteClass);}}}},_setPageAttr:function(_1a){this._set("page",_1a);this.update({contextTypeName:"epi.cms.contentdata",contextId:_1a.contentLink});},show:function(){this._keepShowing=true;this._showTooltip();},_show:function(e){if(e){_1.stopEvent(e);}this._showTooltip();},_showTooltip:function(){if(this._totalNotifications===0){return;}this._tooltipDialog.showTooltipDialog(this.domNode,["below-alt"]);},_hideTooltip:function(){this._tooltipDialog.hideTooltipDialog();}});});